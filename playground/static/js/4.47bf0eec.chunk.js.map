{"version":3,"sources":["../node_modules/monaco-editor/esm/vs/language/typescript/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/typescript/lib/typescriptServicesMetadata.js","../node_modules/monaco-editor/esm/vs/language/css/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/json/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/language/html/monaco.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/_.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/abap/abap.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/apex/apex.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/azcli/azcli.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/bat/bat.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/cameligo/cameligo.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/clojure/clojure.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/coffee/coffee.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/cpp/cpp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/csharp/csharp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/csp/csp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/css/css.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/dockerfile/dockerfile.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/fsharp/fsharp.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/go/go.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/graphql/graphql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/handlebars/handlebars.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/html/html.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/ini/ini.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/java/java.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/javascript/javascript.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/kotlin/kotlin.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/less/less.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/lua/lua.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/markdown/markdown.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/mips/mips.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/msdax/msdax.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/mysql/mysql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/objective-c/objective-c.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pascal/pascal.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pascaligo/pascaligo.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/perl/perl.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pgsql/pgsql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/php/php.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/postiats/postiats.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/powerquery/powerquery.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/powershell/powershell.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/pug/pug.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/python/python.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/r/r.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/razor/razor.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/redis/redis.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/redshift/redshift.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/restructuredtext/restructuredtext.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/ruby/ruby.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/rust/rust.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sb/sb.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/scheme/scheme.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/scss/scss.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/shell/shell.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/solidity/solidity.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sophia/sophia.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/sql/sql.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/st/st.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/swift/swift.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/tcl/tcl.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/twig/twig.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/vb/vb.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/xml/xml.contribution.js","../node_modules/monaco-editor/esm/vs/basic-languages/yaml/yaml.contribution.js","../node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/bracketMatching.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/moveCaretCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/caretOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/transpose.js","../node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/clipboard.js","../node_modules/monaco-editor/esm/vs/base/common/lazy.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/types.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeAction.js","../node_modules/monaco-editor/esm/vs/editor/contrib/message/messageController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/lightBulbWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionMenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionUi.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionCommands.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionContributions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelens.js","../node_modules/monaco-editor/esm/vs/base/common/codicons.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelensWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codeLensCache.js","../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelensController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/color.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorDetector.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/blockCommentCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/lineCommentCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/comment/comment.js","../node_modules/monaco-editor/esm/vs/base/browser/contextmenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/contextmenu.js","../node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/cursorUndo.js","../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dragAndDropCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dnd.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findDecorations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/replaceAllCommand.js","../node_modules/monaco-editor/esm/vs/base/common/search.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/replacePattern.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findModel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/checkbox/checkbox.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInputCheckboxes.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findOptionsWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findState.js","../node_modules/monaco-editor/esm/vs/base/browser/formattedTextRenderer.js","../node_modules/monaco-editor/esm/vs/base/common/history.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/inputbox/inputBox.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInput.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/replaceInput.js","../node_modules/monaco-editor/esm/vs/platform/browser/contextScopedHistoryWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/find/findController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingRanges.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingDecorations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/hiddenRangeModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/indentRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/syntaxRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/intializingRangeProvider.js","../node_modules/monaco-editor/esm/vs/editor/contrib/folding/folding.js","../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/fontZoom.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/formattingEdit.js","../node_modules/monaco-editor/esm/vs/platform/extensions/common/extensions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/format.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/formatActions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/peekView/peekView.js","../node_modules/monaco-editor/esm/vs/editor/browser/widget/embeddedCodeEditorWidget.js","../node_modules/monaco-editor/esm/vs/base/common/idGenerator.js","../node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/zoneWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/referencesModel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/highlightedlabel/highlightedLabel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/iconLabel/iconLabel.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/countBadge/countBadge.js","../node_modules/monaco-editor/esm/vs/base/common/labels.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/splitview/splitview.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesTree.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToSymbol.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/symbolNavigation.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToCommands.js","../node_modules/monaco-editor/esm/vs/base/common/htmlContent.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/clickLinkGesture.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.js","../node_modules/monaco-editor/esm/vs/platform/severityIcon/common/severityIcon.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoErrorWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/getHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverOperation.js","../node_modules/monaco-editor/esm/vs/base/common/marked/marked.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverWidgets.js","../node_modules/monaco-editor/esm/vs/base/common/insane/insane.js","../node_modules/monaco-editor/esm/vs/base/browser/markdownRenderer.js","../node_modules/monaco-editor/esm/vs/editor/contrib/markdown/markdownRenderer.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesContentHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesGlyphHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplaceCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplace.js","../node_modules/monaco-editor/esm/vs/editor/common/commands/trimTrailingWhitespaceCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/copyLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentUtils.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/moveLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/sortLinesCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/linesOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/links/getLinks.js","../node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js","../node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/multicursor.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/provideSignatureHelp.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHints.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/renameInputField.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/rename.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/wordSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/bracketSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/smartSelect.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggest.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetParser.js","../node_modules/monaco-editor/esm/vs/platform/workspaces/common/workspaces.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetVariables.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetSession.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetController2.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestMemory.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestAlternatives.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/completionModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordDistance.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/outlineTree.js","../node_modules/monaco-editor/esm/vs/platform/files/common/files.js","../node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordContextKey.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestCommitCharacters.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestRangeHighlighter.js","../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/tokenization.js","../node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/toggleTabFocusMode.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/wordHighlighter.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/wordOperations.js","../node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/wordPartOperations.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/accessibilityHelp/accessibilityHelp.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/inspectTokens/inspectTokens.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/keybindingLabel/keybindingLabel.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenModel.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenViewer.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDefaults.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeModel.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeDnd.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeViewModel.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/tree.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeView.js","../node_modules/monaco-editor/esm/vs/base/parts/tree/browser/treeImpl.js","../node_modules/monaco-editor/esm/vs/base/browser/ui/progressbar/progressbar.js","../node_modules/monaco-editor/esm/vs/base/parts/quickopen/browser/quickOpenWidget.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickOpenEditorWidget.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/editorQuickOpen.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/gotoLine.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/outlineModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/quickOpen/quickOpen.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickOpen/quickOutline.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/referenceSearch/standaloneReferenceSearch.js","../node_modules/monaco-editor/esm/vs/editor/standalone/browser/toggleHighContrast/toggleHighContrast.js"],"names":["ModuleKind","JsxEmit","NewLineKind","ScriptTarget","ModuleResolutionKind","Emitter","monaco","LanguageServiceDefaultsImpl","compilerOptions","diagnosticsOptions","this","_onDidChange","_onDidExtraLibsChange","_extraLibs","Object","create","_eagerModelSync","setCompilerOptions","setDiagnosticsOptions","_onDidExtraLibsChangeTimeout","defineProperty","prototype","get","event","enumerable","configurable","getExtraLibs","addExtraLib","content","_filePath","filePath","_this","Math","random","toString","substring","dispose","myVersion","version","_fireOnDidExtraLibsChangeSoon","extraLib","setExtraLibs","libs","length","_i","libs_1","lib","setTimeout","fire","undefined","getCompilerOptions","_compilerOptions","options","getDiagnosticsOptions","_diagnosticsOptions","setMaximumWorkerIdleTime","value","setEagerModelSync","getEagerModelSync","typescriptDefaults","allowNonTsExtensions","target","Latest","noSemanticValidation","noSyntaxValidation","javascriptDefaults","allowJs","getTypeScriptWorker","getMode","then","mode","getJavaScriptWorker","languages","typescript","typescriptVersion","onLanguage","setupTypeScript","setupJavaScript","languageId","modeConfiguration","_languageId","setModeConfiguration","_modeConfiguration","diagnosticDefault","validate","lint","compatibleVendorPrefixes","vendorPrefix","duplicateProperties","emptyRules","importStatement","boxModel","universalSelector","zeroUnits","fontFaceProperties","hexColorLength","argumentsInColorFunction","unknownProperties","ieHack","unknownVendorSpecificProperties","propertyIgnoredDueToDisplay","important","float","idSelector","modeConfigurationDefault","completionItems","hovers","documentSymbols","definitions","references","documentHighlights","rename","colors","foldingRanges","diagnostics","selectionRanges","cssDefaults","scssDefaults","lessDefaults","css","setupMode","jsonDefaults","allowComments","schemas","enableSchemaRequest","documentFormattingEdits","documentRangeFormattingEdits","tokens","json","register","id","extensions","aliases","mimetypes","setOptions","_options","formatDefaults","tabSize","insertSpaces","wrapLineLength","unformatted","contentUnformatted","indentInnerHtml","preserveNewLines","maxPreserveNewLines","indentHandlebars","endWithNewline","extraLiners","wrapAttributes","handlebarOptionsDefault","format","suggest","html5","razorOptionsDefault","razor","getConfigurationDefault","links","htmlLanguageId","htmlDefaults","angular1","ionic","handlebarDefaults","razorDefaults","html","_monaco","self","languageDefinitions","lazyLanguageLoaders","LazyLanguageLoader","_loadingTriggered","_lazyLoadPromise","Promise","resolve","reject","_lazyLoadPromiseResolve","_lazyLoadPromiseReject","getOrCreate","whenLoaded","load","loader","mod","err","registerLanguage","def","lazyLanguageLoader","setMonarchTokensProvider","language","setLanguageConfiguration","conf","filenames","firstLine","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","overviewRulerBracketMatchForeground","registerColor","dark","light","hc","nls","JumpToBracketAction","_super","call","label","alias","precondition","kbOpts","kbExpr","EditorContextKeys","editorTextFocus","primary","weight","run","accessor","editor","controller","BracketMatchingController","jumpToBracket","EditorAction","SelectToBracketAction","description","args","name","schema","type","properties","default","selectBrackets","selectToBracket","BracketsData","position","brackets","_editor","_lastBracketsData","_lastVersionId","_decorations","_updateBracketsSoon","_register","RunOnceScheduler","_updateBrackets","_matchBrackets","getOption","schedule","onDidChangeCursorPosition","e","onDidChangeModelContent","onDidChangeModel","onDidChangeModelLanguageConfiguration","onDidChangeConfiguration","hasChanged","deltaDecorations","getContribution","ID","hasModel","model","getModel","newSelections","getSelections","map","selection","getStartPosition","matchBracket","newCursorPosition","containsPosition","enclosingBrackets","findEnclosingBrackets","nextBracket","findNextBracket","range","Selection","lineNumber","column","setSelections","revealRange","forEach","selectFrom","selectTo","sort","Range","compareRangesUsingStarts","open_1","close_1","getEndPosition","push","_recomputeBrackets","newDecorations","newDecorationsLen","_a","bracketData","selections","versionId","getVersionId","previousData","positions","positionsLen","i","len","isEmpty","Position","compare","newData","newDataLen","previousIndex","previousLen","isBefore","equals","_DECORATION_OPTIONS_WITH_OVERVIEW_RULER","_DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER","ModelDecorationOptions","stickiness","className","overviewRuler","color","themeColorFromId","OverviewRulerLane","Center","Disposable","registerEditorContribution","registerEditorAction","registerThemingParticipant","theme","collector","bracketMatchBackground","getColor","editorBracketMatchBackground","addRule","bracketMatchBorder","editorBracketMatchBorder","MenuRegistry","appendMenuItem","group","command","title","key","comment","order","MoveCaretCommand","isMovingLeft","_selection","_isMovingLeft","_cutStartIndex","_cutEndIndex","_moved","_selectionId","getEditOperations","builder","s","trackSelection","startLineNumber","endLineNumber","startColumn","endColumn","getLineMaxColumn","left","middle","right","selectionStartLineNumber","lineContent","getLineContent","newLineContent","addEditOperation","computeCursorState","helper","result","getTrackedSelection","setStartPosition","setEndPosition","MoveCaretAction","opts","commands","selections_1","pushUndoStop","executeCommands","MoveCaretLeftAction","writable","MoveCaretRightAction","TransposeLettersAction","textInputFocus","mac","lastColumn","endPosition","getPosition","MoveOperations","rightPosition","middlePosition","leftPosition","beginPosition","leftChar","getValueInRange","fromPositions","rightChar","replaceRange","ReplaceCommand","supportsCut","platform","document","queryCommandSupported","supportsCopy","supportsCopyWithSyntaxHighlighting","browser","supportsPaste","ExecCommandAction","browserCommand","runCommand","focusedEditor","ICodeEditorService","getFocusedCodeEditor","hasTextFocus","trigger","execCommand","focus","ExecCommandCutAction","win","secondary","contextMenuOpts","menuOpts","menuId","getSelection","ExecCommandCopyAction","ExecCommandPasteAction","ExecCommandCopyWithSyntaxHighlightingAction","CopyOptions","forceCopyWithSyntaxHighlighting","Lazy","executor","_didRun","getValue","_value","_error","CodeActionKind","other","contains","startsWith","sep","intersects","append","part","None","Empty","QuickFix","Refactor","Source","SourceOrganizeImports","SourceFixAll","excludesAction","providedKind","exclude","include","CodeActionCommandArgs","kind","apply","preferred","fromUser","arg","defaults","getKindFromUser","getApplyFromUser","getPreferredUser","defaultAutoApply","toLowerCase","defaultKind","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","__spreadArrays","il","arguments","r","k","a","j","jl","ManagedCodeActionSet","actions","disposables","allActions","mergeSort","codeActionsComparator","validActions","filter","action","disabled","isNonEmptyArray","message","localeCompare","some","fix","isPreferred","getCodeActions","rangeOrSelection","token","codeActionContext","only","cts","TextModelCancellationTokenSource","providers","modes","all","provider","providedCodeActionKinds","excludes","includeSourceActions","mayIncludeActionsOfKind","getCodeActionProviders","DisposableStore","promises","providedCodeActions","err_1","provideCodeActions","isCancellationRequested","add","actionKind","onlyIncludePreferredActions","filtersAction","isPromiseCanceledError","onUnexpectedExternalError","listener","onDidChange","newProviders","cancel","flatten","finally","registerLanguageCommand","resource","validatedRangeOrSelection","codeActionSet","URI","illegalArgument","IModelService","isISelection","liftSelection","isIRange","validateRange","CancellationToken","__decorate","decorators","desc","c","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","MessageController","contextKeyService","closeTimeout","_messageWidget","MutableDisposable","_messageListeners","_visible","MESSAGE_VISIBLE","bindTo","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","reset","showMessage","bounds","alert","set","clear","MessageWidget","onDidBlurEditorText","closeMessage","onDidDispose","TimeoutTimer","onMouseMove","fadeOut","RawContextKey","IContextKeyService","MessageCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","text","allowEditorOverflow","suppressMouseDown","revealLinesInCenterIfOutsideViewport","_position","_domNode","createElement","classList","textContent","appendChild","anchor","addContentWidget","messageWidget","handle","clearTimeout","getDomNode","removeEventListener","addEventListener","removeContentWidget","getId","preference","border","inputValidationInfoBorder","borderWidth","HIGH_CONTRAST","background","inputValidationInfoBackground","foreground","inputValidationInfoForeground","LightBulbState","__assign","assign","CodeActionAction","callback","Action","CodeActionMenu","_delegate","_contextMenuService","keybindingService","_showingActions","_keybindingResolver","CodeActionKeybindingResolver","getKeybindings","show","codeActions","at","actionsToShow","menuActions","resolver","includeDisabledActions","canceled","getMenuActions","isIPosition","_toCoords","x","getResolver","showContextMenu","getAnchor","getActions","onHide","autoSelectFirstItem","getKeyBinding","_b","toCodeActionAction","onSelectCodeAction","_c","CodeActionProviderRegistry","_getAdditionalMenuItems","items","Separator","revealPosition","render","cursorCoords","getScrolledVisiblePosition","editorCoords","getDomNodePagePosition","top","height","IContextMenuService","IKeybindingService","_keybindingProvider","allCodeActionBindings","item","codeActionCommands","indexOf","resolvedKeybinding","commandArgs","binding","bestKeybindingForCodeAction","candidates","candidate","reduceRight","currentBest","Hidden","Showing","editorPosition","widgetPosition","LightBulbWidget","_quickFixActionId","_preferredFixActionId","_keybindingService","_onClick","onClick","_state","editorModel","state","getLineCount","hide","Gesture","ignoreTarget","dom","preventDefault","lineHeight","pad","floor","posx","buttons","monitor","GlobalMouseMoveMonitor","startMonitoring","standardMouseMoveMerger","enabled","_updateLightBulbTitle","onDidUpdateKeybindings","update","atPosition","getOptions","fontInfo","indent","TextModel","computeIndentLevel","isFolded","getTopForLineNumber","effectiveLineNumber","spaceWidth","_posPref","hasAutoFix","layoutContentWidget","preferredKb","lookupKeybinding","getLabel","kb","editorLightBulbForegroundColor","editorLightBulbForeground","editorLightBulbAutoFixForegroundColor","editorLightBulbAutoFixForeground","CodeActionsState","CodeActionUi","quickFixActionId","preferredFixActionId","delegate","instantiationService","_activeCodeActions","_codeActionWidget","createInstance","applyCodeAction","_lightBulbWidget","widget","showCodeActionList","newState","e_1","validActionToApply","invalidAction","_d","rawValue","onUnexpectedError","tryGetValidActionToApply","context","getInvalidActionThatWouldHaveBeenApplied","notAvailableMessage","isVisible","autoApply","find","IInstantiationService","SUPPORTED_CODE_ACTIONS","CodeActionOracle","_markerService","_signalChange","_delay","_autoTriggerTimer","onMarkerChanged","_onMarkerChanges","_onCursorChange","_getRangeOfSelectionUnlessWhitespaceEnclosed","_createEventAndSignalChange","resources","isEqual","uri","cancelAndSet","_getRangeOfMarker","read","marker","markerRange","intersectRanges","lift","line","test","Triggered","CodeActionModel","_progressService","_codeActionOracle","_onDidChangeState","onDidChangeState","_supportedCodeActions","_update","onDidChangeModelLanguage","setState","has","supportedActions","isArray","join","createCancelablePromise","showWhile","skipNotify","contextKeyForSupportedActions","ContextKeyExpr","regex","keys","RegExp","escapeRegExpCharacters","argsSchema","required","defaultSnippets","enum","enumDescriptions","QuickFixController","markerService","progressService","_instantiationService","_model","_ui","QuickFixAction","Id","AutoFixAction","retrigger","_applyCodeAction","_trigger","showCodeActions","manualTriggerAtCurrentPosition","triggerPosition","invokeFunction","IMarkerService","IEditorProgressService","bulkEditService","commandService","telemetryService","notificationService","IBulkEditService","ICommandService","ITelemetryService","INotificationService","publicLog2","codeActionTitle","codeActionKind","codeActionIsPreferred","edit","executeCommand","Error","error","triggerCodeActionsForEditorSelection","and","hasCodeActionsProvider","_accessor","CodeActionCommand","runEditorCommand","userArgs","RefactorAction","when","SourceAction","OrganizeImportsAction","FixAllAction","CodeLensModel","lenses","_disposables","list","symbol","getCodeLensData","CodeLensProviderRegistry","ordered","providerRanks","Map","provideCodeLenses","catch","itemResolveCount","_loop_1","Boolean","resolveCodeLens","escapeCodiconsRegex","markdownEscapedCodiconsRegex","renderCodiconsRegex","renderCodicons","replace","escaped","codicon","animation","CodeLensViewZone","afterLineNumber","onHeight","_onHeight","heightInLines","domNode","onComputedHeight","_lastHeight","CodeLensContentWidget","_commands","_isEmpty","_id","_idPool","updatePosition","withCommands","animate","innerHtml","hasSymbol","lens","escape","String","innerHTML","getCommand","link","parentElement","getLineFirstNonWhitespaceColumn","_widgetPosition","CodeLensHelper","_removeDecorations","_addDecorations","_addDecorationsCallbacks","addDecoration","decoration","removeDecoration","decorationId","commit","changeAccessor","resultingDecorations","CodeLensWidget","data","viewZoneChangeAccessor","updateCallback","_isDisposed","_className","_data","_decorationIds","codeLensData","EMPTY","plusRange","_viewZone","_viewZoneId","addZone","_createContentWidgetIfNecessary","_contentWidget","removeZone","isDisposed","isValid","getDecorationRange","updateCodeLensSymbols","computeIfNecessary","hasAttribute","updateCommands","symbols","resolved","getLineNumber","layoutZone","codeLensForeground","editorCodeLensForeground","activeLinkForeground","editorActiveLinkForeground","ICodeLensCache","createDecorator","CacheItem","lineCount","CodeLensCache","storageService","_fakeProvider","class_1","_cache","LRUCache","runWhenIdle","remove","raw","_deserialize","once","onWillSaveState","reason","WillSaveStateReason","SHUTDOWN","store","_serialize","put","copyItems","copyModel","delete","lines","Set","values","JSON","stringify","parse","element","IStorageService","registerSingleton","CodeLensContribution","_commandService","_notificationService","_codeLensCache","_globalToDispose","_localToDispose","_lenses","_oldCodeLensModels","_modelChangeCounter","_isEnabled","_onModelChange","prevIsEnabled","_updateLensStyle","_styleClassName","hash","_styleElement","getContainerDomNode","_localDispose","_currentCodeLensModel","round","fontSize","newStyle","_currentFindCodeLensSymbolsPromise","_currentResolveCodeLensSymbolsPromise","cachedLenses","_renderCodeLensSymbols","registration","scheduler","detectVisibleLenses","_detectVisibleLenses","_onViewportChanged","counterValue","changeDecorations","decorationsAccessor","changeViewZones","viewZonesAccessor","toDispose","lastLensLineNumber","l","splice","onDidScrollChange","scrollTopChanged","onDidLayoutChange","toDisposable","scrollState","StableEditorScrollState","capture","_disposeAllLenses","restore","onMouseUp","tagName","disposableTimeout","cachedLensesNow","decChangeAccessor","lastGroup","maxLineNumber","groups","viewZoneAccessor","codeLensIndex","groupsIndex","symbolsLineNumber","codeLensLineNumber","toResolve","request","resolvePromise","resolvedSymbols","getColorPresentations","colorInfo","provideColorPresentations","rawCIs","ColorProviderRegistry","reverse","provideDocumentColors","result_2","ci","red","green","blue","alpha","presentations","ColorDetector","_codeEditorService","_configurationService","_decorationsIds","_colorDatas","_colorDecoratorIds","_decorationsTypes","isEnabled","onModelChanged","removeAllDecorations","_timeoutTimer","_computePromise","getLanguageIdentifier","deprecatedConfig","colorDecorators","stop","beginCompute","RECOMPUTE_TIME","result_1","getColors","colorInfos","updateDecorations","updateColorDecorators","colorDatas","decorations","colorData","newDecorationsTypes","rgba","RGBA","subKey","registerDecorationType","before","contentText","margin","width","backgroundColor","resolveDecorationOptions","subType","removeDecorationType","getColorData","getDecorationsInRange","IConfigurationService","BlockCommentCommand","insertSpace","_insertSpace","_usedEndToken","_haystackHasNeedleAtOffset","haystack","needle","offset","needleLength","codeA","charCodeAt","codeB","_createOperationsForBlockComment","startToken","endToken","startLineText","endLineText","startTokenIndex","lastIndexOf","endTokenIndex","startLineAfterStartToken","endLineBeforeEndToken","_createRemoveBlockCommentOperations","_createAddBlockCommentOperations","ops_1","addTrackedEditOperation","res","EditOperation","insert","tokenizeIfCheap","getLanguageIdAtPosition","config","LanguageConfigurationRegistry","getComments","blockCommentStartToken","blockCommentEndToken","inverseEditOperations","getInverseEditOperations","startTokenEditOperation","endTokenEditOperation","srcRange","deltaColumn","LineCommentCommand","_tabSize","_type","_deltaColumn","_moveEndPositionDown","_gatherPreflightCommentStrings","commentStr","lineCommentToken","ignore","commentStrOffset","commentStrLength","_analyzeLines","shouldRemoveComments","onlyWhitespaceLines","lineData","lineContentStartOffset","strings","commentStrEndOffset","supported","_gatherPreflightData","_executeLineComments","_createRemoveLineCommentsOperations","_normalizeInsertionPoint","_createAddLineCommentsOperations","cursorPosition","positionLineNumber","positionColumn","_attemptRemoveBlockComment","startTokenAllowedBeforeColumn","max","_executeBlockComment","firstNonWhitespaceIndex","selectionStartColumn","afterCommentStr","nextVisibleColumn","currentVisibleColumn","isTab","columnSize","lenJ","minVisibleColumn","j_1","lenJ_1","CommentLineAction","modelOptions","commentsOptions","ToggleCommentLineAction","AddLineCommentAction","KeyChord","RemoveLineCommentAction","BlockCommentAction","linux","selections_2","ContextSubMenu","entries","SubmenuAction","ContextMenuController","_contextViewService","_contextKeyService","_menuService","_toDispose","_contextMenuIsBeingShownCount","onContextMenu","_onContextMenu","onMouseWheel","hideContextView","onKeyDown","keyCode","stopPropagation","setPosition","hasSelectionAtPosition","posy","_getMenuActions","_doShowContextMenu","menu","createMenu","groups_1","addedItems","actions_1","SubmenuItemAction","subActions","submenu","oldHoverSetting","updateOptions","hover","getActionViewItem","keybinding","_keybindingFor","ActionViewItem","isMenu","customActionViewItem","icon","wasCancelled","IContextViewService","IMenuService","ShowContextMenu","CursorState","thisLen","equalsSelection","StackElement","cursorState","scrollTop","scrollLeft","CursorUndoRedoController","_isCursorUndoRedo","_undoStack","_redoStack","onDidChangeCursorSelection","oldSelections","oldModelVersionId","modelVersionId","prevState","getScrollTop","getScrollLeft","shift","cursorUndo","_applyState","cursorRedo","stackElement","setScrollPosition","CursorUndo","CursorRedo","DragAndDropCommand","targetPosition","copy","targetSelection","hasTriggerModifier","isMacintosh","altKey","ctrlKey","DragAndDropController","onMouseDown","_onEditorMouseDown","_onEditorMouseUp","onMouseDrag","_onEditorMouseDrag","onMouseDrop","_onEditorMouseDrop","onEditorKeyDown","onKeyUp","onEditorKeyUp","onDidBlurEditorWidget","onEditorBlur","_dndDecorationIds","_mouseDown","_modifierPressed","_dragSelection","_removeDecoration","mouseStyle","TRIGGER_KEY_VALUE","mouseEvent","possibleSelections","showAt","_hitContent","_hitMargin","newCursorPosition_1","shiftKey","primarySelection","_DECORATION_OPTIONS","FindDecorations","_overviewRulerApproximateDecorations","_findScopeDecorationId","_rangeHighlightDecorationId","_highlightedDecorationId","_startPosition","_allDecorations","getCount","getFindScope","newStartPosition","setCurrentFindMatch","_getDecorationIndex","index","getCurrentMatchesPosition","desiredRange","candidates_1","candidateOpts","_FIND_MATCH_DECORATION","_CURRENT_FIND_MATCH_DECORATION","nextMatch","newCurrentDecorationId","matchPosition","equalsRange","changeDecorationOptions","rng","lineBeforeEnd","lineBeforeEndMaxColumn","_RANGE_HIGHLIGHT_DECORATION","findMatches","findScope","findMatchesOptions","newOverviewRulerApproximateDecorations","_FIND_MATCH_NO_OVERVIEW_DECORATION","approxPixelsPerLine","getLayoutInfo","mergeLinesDelta","ceil","prevStartLineNumber","prevEndLineNumber","_FIND_MATCH_ONLY_OVERVIEW_DECORATION","newFindMatchesDecorations","_FIND_SCOPE_DECORATION","matchBeforePosition","matchAfterPosition","concat","zIndex","showIfCollapsed","overviewRulerFindMatchForeground","minimap","minimapFindMatch","MinimapPosition","Inline","isWholeLine","ReplaceAllCommand","editorSelection","ranges","replaceStrings","_editorSelection","_ranges","_replaceStrings","_trackedEditorSelectionId","o1","o2","resultOps","previousOp","resultOps_1","buildReplaceStringWithCasePreserved","matches","pattern","containsHyphens","validateSpecificSpecialCharacter","containsUnderscores","buildReplaceStringForSpecificSpecialCharacter","toUpperCase","substr","specialCharacter","split","splitPatternAtSpecialCharacter","splitMatchAtSpecialCharacter","replaceString","splitValue","slice","StaticValueReplacePattern","staticValue","DynamicPiecesReplacePattern","pieces","ReplacePattern","fromStaticValue","ReplacePiece","buildReplaceString","preserveCase","piece","_substitute","matchIndex","remainder","ReplacePieceBuilder","source","_source","_lastCharIndex","_result","_resultLen","_currentStaticPiece","emitUnchanged","toCharIndex","_emitStatic","emitStatic","emitMatchIndex","finalize","CONTEXT_FIND_WIDGET_VISIBLE","CONTEXT_FIND_INPUT_FOCUSED","CONTEXT_REPLACE_INPUT_FOCUSED","ToggleCaseSensitiveKeybinding","ToggleWholeWordKeybinding","ToggleRegexKeybinding","ToggleSearchScopeKeybinding","FIND_IDS","FindModelBoundToEditorModel","_startSearchingTimer","_updateDecorationsScheduler","research","_ignoreModelContentChanged","isFlush","onFindReplaceStateChange","_onStateChanged","searchScope","searchString","isReplaceRevealed","isRegex","wholeWord","matchCase","isTooLargeForSyncing","setIfNotSet","moveCursor","_getSearchRange","getFullModelRange","newFindScope","_findMatches","changeMatchInfo","_moveToNextMatch","_hasMatches","matchesCount","_cannotFind","revealRangeInCenterIfOutsideViewport","_setCurrentFindMatch","match","matchesPosition","setSelection","_prevSearchPosition","isUsingLineStops","_moveToPrevMatch","isRecursed","prevMatchRange","searchRange","prevMatch","findPreviousMatch","containsRange","moveToPrevMatch","_nextSearchPosition","after","nextMatchRange","_getNextMatch","captureMatches","forceMove","findNextMatch","moveToNextMatch","_getReplacePattern","chCode","nextChCode","nextNextChCode","parseReplaceString","replacePattern","_executeEditorCommand","limitResultCount","replaceAll","_largeReplaceAll","_regularReplaceAll","searchData","SearchParams","parseSearchRequest","searchRegex","multiline","ignoreCase","global","resultText","modelText","fullModelRange","hasReplacementPatterns","ReplaceCommandThatPreservesSelection","m","selectAllMatches","defaultOpts","inputActiveOptionBorder","Color","fromHex","inputActiveOptionBackground","Checkbox","_onChange","onChange","_onKeyDown","_opts","objects","_checked","isChecked","actionClassName","tabIndex","setAttribute","applyStyles","onclick","ev","checked","ignoreGesture","onkeydown","keyboardEvent","getAttribute","newIsChecked","style","styles","borderColor","enable","disable","DOM","Widget","NLS_CASE_SENSITIVE_CHECKBOX_LABEL","NLS_WHOLE_WORD_CHECKBOX_LABEL","NLS_REGEX_CHECKBOX_LABEL","CaseSensitiveCheckbox","appendTitle","WholeWordsCheckbox","RegexCheckbox","FindOptionsWidget","themeService","_hideSoon","_hide","_isVisible","display","inputActiveOptionBorderColor","getTheme","inputActiveOptionBackgroundColor","caseSensitive","_keybindingLabelFor","change","wholeWords","addOverlayWidget","somethingChanged","isRevealed","_revealTemporarily","_onMouseOut","_onMouseOver","_applyTheme","onThemeChange","bind","actionId","removeOverlayWidget","highlightFindOptions","_show","inputStyles","widgetBackground","editorWidgetBackground","widgetForeground","editorWidgetForeground","widgetShadowColor","widgetShadow","hcBorder","contrastBorder","effectiveOptionValue","override","FindReplaceState","_onFindReplaceStateChange","_searchString","_replaceString","_isRevealed","_isReplaceRevealed","_isRegex","_isRegexOverride","_wholeWord","_wholeWordOverride","_matchCase","_matchCaseOverride","_preserveCase","_preserveCaseOverride","_searchScope","_matchesPosition","_matchesCount","_currentMatch","currentMatch","changeEvent","updateHistory","oldEffectiveIsRegex","oldEffectiveWholeWords","oldEffectiveMatchCase","oldEffectivePreserveCase","isRegexOverride","wholeWordOverride","matchCaseOverride","preserveCaseOverride","renderFormattedText","formattedText","_renderFormattedText","treeNode","actionHandler","child","createTextNode","href","disposeables","children","nodeChild","root","actionViewItemIndex","current","stack","stream","StringStream","eos","isEscapedFormatType","formatTagType","peek","textCurrent","advance","newCurrent","parseFormattedText","inline","char","HistoryNavigator","history","limit","_initialize","_limit","_history","_navigator","previous","parent","first","last","_reduceToLimit","elements","_elements","ArrayNavigator","history_1","entry","$","inputBackground","inputForeground","inputValidationWarningBorder","inputValidationWarningBackground","inputValidationErrorBorder","inputValidationErrorBackground","InputBox","container","contextViewProvider","maxHeight","Number","POSITIVE_INFINITY","_onDidHeightChange","onDidHeightChange","mixin","placeholder","ariaLabel","inputBorder","inputValidationWarningForeground","inputValidationErrorForeground","validationOptions","validation","flexibleHeight","wrapper","input","onfocus","onblur","flexibleMaxHeight","mirror","scrollableElement","ScrollableElement","vertical","flexibleWidth","whiteSpace","wordWrap","onScroll","onSelectionChange","Event","domEvent","anchorNode","updateScrollDimensions","setPlaceHolder","oninput","onValueChange","onBlur","onFocus","Bal","updateMirror","actionbar","ActionBar","_hideMessage","_showMessage","placeHolder","setAriaLabel","removeAttribute","newValue","cachedHeight","blur","hasFocus","activeElement","select","setSelectionRange","start","end","horizontalPadding","parseFloat","paddingLeft","paddingRight","cachedContentHeight","scrollHeight","setScrollDimensions","force","classForType","alertText","stylesForType","aria","hideMessage","errorMsg","inputElement","div","layout","showContextView","anchorAlignment","renderOptions","spanElement","formatContent","renderText","suffix","borderStyle","previousHeight","min","insertAtCursor","selectionStart","selectionEnd","HistoryInputBox","addToHistory","getCurrentValue","showNextValue","getNextValue","showPreviousValue","getPreviousValue","currentValue","NLS_DEFAULT_LABEL","FindInput","_showOptionButtons","fixFocusOnOptionClickEnabled","_onDidOptionChange","onDidOptionChange","_onMouseDown","_onInput","_onKeyUp","_onCaseSensitiveKeyDown","onCaseSensitiveKeyDown","_onRegexKeyDown","onRegexKeyDown","_lastHighlightFindOptions","appendCaseSensitiveLabel","appendWholeWordsLabel","appendRegexLabel","inputBox","viaKeyboard","indexes","newIndex","controls","onkeyup","onmousedown","setFocusInputOnOptionClick","setEnabled","setValue","checkBoxStyles","inputBoxStyles","getCaseSensitive","setCaseSensitive","getWholeWords","setWholeWords","getRegex","setRegex","focusOnCaseSensitive","clearMessage","NLS_PRESERVE_CASE_LABEL","PreserveCaseCheckbox","ReplaceInput","cachedOptionsWidth","_onPreserveCaseKeyDown","onPreserveCaseKeyDown","getPreserveCase","setPreserveCase","focusOnPreserve","newWidth","getContextScopedWidget","contextKey","getContext","createAndBindHistoryNavigationWidgetScopedContextKeyService","scopedContextKeyService","createScoped","createWidgetScopedContextKeyService","bindContextScopedWidget","historyNavigationEnablement","ContextScopedFindInput","showFindOptions","historyNavigator","ContextScopedReplaceInput","showReplaceOptions","KeybindingsRegistry","registerCommandAndKeybindingRule","arg2","NLS_FIND_INPUT_LABEL","NLS_FIND_INPUT_PLACEHOLDER","NLS_PREVIOUS_MATCH_BTN_LABEL","NLS_NEXT_MATCH_BTN_LABEL","NLS_TOGGLE_SELECTION_FIND_TITLE","NLS_CLOSE_BTN_LABEL","NLS_REPLACE_INPUT_LABEL","NLS_REPLACE_INPUT_PLACEHOLDER","NLS_REPLACE_BTN_LABEL","NLS_REPLACE_ALL_BTN_LABEL","NLS_TOGGLE_REPLACE_MODE_BTN_LABEL","NLS_MATCHES_COUNT_LIMIT_TITLE","NLS_MATCHES_LOCATION","NLS_NO_RESULTS","MAX_MATCHES_COUNT_WIDTH","ctrlKeyMod","FindWidgetViewZone","heightInPx","stopPropagationForMultiLineUpwards","textarea","isMultiline","stopPropagationForMultiLineDownwards","FindWidget","codeEditor","_cachedHeight","_codeEditor","_controller","_contextViewProvider","_storageService","_ctrlEnterReplaceAllWarningPrompted","getBoolean","_isReplaceVisible","_ignoreChangeEvent","_updateHistoryDelayer","Delayer","_buildDomNode","_updateButtons","_tryUpdateWidgetWidth","_findInput","updateAccessibilitySupport","addExtraSpaceOnTop","_showViewZone","_removeViewZone","_updateToggleSelectionFindButton","onDidFocusEditorWidget","globalBufferTerm","getGlobalBufferTerm","_findInputFocused","_findFocusTracker","onDidFocus","_updateSearchScope","onDidBlur","_replaceInputFocused","_replaceFocusTracker","_replaceInput","_layoutViewZone","_reveal","_tryUpdateHeight","_toggleSelectionFind","showRedOutline","_updateMatchesCount","_delayedUpdateHistory","_updateHistory","minWidth","firstChild","removeChild","alertFn","_getAriaLabel","clientWidth","isSelection","_closeBtn","findInputIsNonEmpty","_prevBtn","_nextBtn","_replaceBtn","_replaceAllBtn","_toggleReplaceBtn","toggleClass","setExpanded","canReplace","autoFindInSelection","isSelectionMultipleLine","layoutOverlayWidget","adjustEditorScrollTop","seedSearchStringFromSelection","startCoords","startLeft","startTop","leftOfFindWidget","endCoords","focusTheEditor","viewZone","_getHeight","setScrollTop","adjustScroll","newHeight","scrollAdjustment","layoutInfo","contentWidth","editorWidth","minimapWidth","collapsedFindWidget","reducedFindWidget","narrowFindWidget","_resized","maxWidth","FIND_WIDGET_INITIAL_WIDTH","findInputWidth","totalheight","totalHeight","focusFindInput","focusReplaceInput","_onFindInputMouseDown","middleButton","_onFindInputKeyDown","querySelector","_onReplaceInputKeyDown","info","getHorizontalSashTop","_sash","getHorizontalSashLeft","getHorizontalSashWidth","PART_WIDTH","SimpleButton","onTrigger","getAction","findPart","actionsContainer","replacePart","replaceActionsContainer","_resizeSash","Sash","orientation","originalWidth","onDidStart","evt","startX","currentX","onDidReset","currentWidth","expanded","shouldHaveIt","addBackgroundColorRule","selector","editorFindMatchHighlight","editorFindMatch","editorFindRangeHighlight","findMatchHighlightBorder","editorFindMatchHighlightBorder","findMatchBorder","editorFindMatchBorder","findRangeHighlightBorder","editorFindRangeHighlightBorder","errorForeground","resizeBorderBackground","editorWidgetResizeBorder","editorWidgetBorder","focusOutline","focusBorder","getSelectionSearchString","wordAtPosition","getWordAtPosition","word","getValueLengthInRange","CommonFindController","clipboardService","_findWidgetVisible","_clipboardService","loadQueryState","shouldRestartFind","disposeModel","_start","forceRevealReplace","seedSearchStringFromGlobalClipboard","shouldFocus","shouldAnimate","updateSearchScope","saveQueryState","setGlobalBufferTerm","actualIsRegex","actualWholeWord","actualMatchCase","actualPreserveCase","isFindInputFocused","getState","closeFindWidget","toggleCaseSensitive","toggleWholeWords","toggleRegex","toggleSearchScope","setSearchString","selectionSearchString","stateChanges","currentSelection","globalFindClipboard","readFindText","writeFindText","IClipboardService","FindController","_themeService","_widget","_findOptionsWidget","_createFindWidget","IThemeService","optional","StartFindAction","StartFindWithSelectionAction","MatchFindAction","_run","NextMatchFindAction","NextMatchFindAction2","PreviousMatchFindAction","PreviousMatchFindAction2","SelectionMatchFindAction","NextSelectionMatchFindAction","PreviousSelectionMatchFindAction","StartFindReplaceAction","findInputFocused","FindCommand","FoldingRegions","startIndexes","endIndexes","types","_startIndexes","_endIndexes","_collapseStates","Uint32Array","_types","_parentsComputed","ensureParentIndices","parentIndexes_1","isInsideLast","getStartLineNumber","getEndLineNumber","parentIndex","getType","hasTypes","isCollapsed","arrayIndex","bit","setCollapsed","toRegion","FoldingRegion","getParentIndex","findIndex","low","high","mid","findRange","containedBy","containsLine","FoldingModel","textModel","decorationProvider","_updateEventEmitter","_textModel","_decorationProvider","_regions","_editorDecorationIds","_isInitialized","toggleCollapseState","regions","processed","regions_1","regionIndex","editorDecorationId","newCollapseState","getDecorationOption","collapseStateChanged","newRegions","blockedLineNumers","newEditorDecorations","initRange","blockedLineNumers_1","blockedLineNumber","isBlocked","maxColumn","decorationRange","nextCollapsed","collapsedIndex","decRange","collapsedStartLineNumber","getMemento","collapsedRanges","applyMemento","toToogle","state_1","region","getRegionAtLine","getAllRegionsAtLine","level","getRegionsInside","MAX_VALUE","levelStack","setCollapseStateLevelsDown","foldingModel","doCollapse","levels","lineNumbers","toToggle","lineNumbers_2","regionsInside","setCollapseStateLevelsUp","lineNumbers_3","setCollapseStateForMatchingLines","regExp","setCollapseStateForType","FoldingDecorationProvider","autoHideFoldingControls","showFoldingHighlights","COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","COLLAPSED_VISUAL_DECORATION","EXPANDED_AUTO_HIDE_VISUAL_DECORATION","EXPANDED_VISUAL_DECORATION","oldDecorations","afterContentClassName","linesDecorationsClassName","HiddenRangeModel","_foldingModel","_foldingModelListener","updateHiddenRanges","_hiddenRanges","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","applyHiddenRanges","hiddenRanges","hasRanges","isHidden","adjustSelections","hasChanges","lastRange","adjustLine","isInside","adjustedStartLine","adjustedEndLine","findFirstInSorted","IndentRangeProvider","compute","cancelationToken","foldingRules","getFoldingRules","offSide","markers","foldingRangesLimit","RangesCollector","previousRegions","endAbove","line_1","insertFirst","toIndentRanges","computeRanges","_indentOccurrences","_length","_foldingRangesLimit","maxIndent","startIndex","foldingContext","SyntaxRangeProvider","cancellationToken","rangeData","provideFoldingRanges","nLines","ranges_1","rank","collectSyntaxRanges","sanitizeRanges","_nestingLevels","_nestingLevelCounts","nestingLevel","maxLevel","sorted","d1","d2","diff","sorted_1","InitializingRangeProvider","initialRanges","onTimeout","timeoutTime","decorationIds","getLineLength","timeout","foldingRangeData","CONTEXT_FOLDING_ENABLED","FoldingController","localToDispose","_useFoldingProviders","hiddenRangeModel","rangeProvider","foldingRegionPromise","foldingStateMemento","foldingModelPromise","updateScheduler","cursorChangedScheduler","mouseDownInfo","foldingDecorationProvider","foldingEnabled","options_1","options_2","onModelContentChanged","options_3","onFoldingStrategyChanged","saveViewState","isTooLargeForTokenization","collapsedRegions","isInitialized","restoreViewState","getFoldingModel","hr","onHiddenRangesChanges","revealCursor","FoldingRangeProviderRegistry","onCursorPositionChanged","onEditorMouseDown","onEditorMouseUp","getRangeProvider","foldingProviders","selectionLineNumbers","setHiddenAreas","reveal","leftButton","iconClicked","detail","offsetLeftInGutter","offsetLeft","offsetX","recursive","revealPositionInCenterIfOutsideViewport","FoldingAction","foldingController","reportTelemetry","invoke","getSelectedLines","getLineNumbers","selectionLines","foldingArgumentsConstraint","foldingArgs","direction","every","UnfoldAction","constraint","_foldingController","UnFoldRecursivelyAction","_args","FoldAction","lineNumbers_4","setCollapseStateUp","ToggleFoldAction","doCollapse_1","lineNumbers_1","FoldRecursivelyAction","selectedLines","FoldAllBlockCommentsAction","FoldingRangeKind","Comment","comments","FoldAllRegionsAction","Region","UnfoldAllRegionsAction","FoldAllAction","UnfoldAllAction","FoldLevelAction","getFoldingLevel","parseInt","ID_PREFIX","foldLevel","blockedLineNumbers","setCollapseStateAtLevel","registerInstantiatedEditorAction","foldBackgroundBackground","transparent","editorSelectionBackground","foldBackground","EditorFontZoomIn","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","FormattingEdit","_handleEolEdits","edits","newEol","singleEdits","edits_1","eol","pushEOL","_isFullModelReplaceEdit","editRange","execute","_edits","executeEdits","replaceMove","ExtensionIdentifier","_lower","toKey","alertFormattingEdits","getRealAndSyntheticDocumentFormattersOrdered","seen","docFormatter_1","DocumentFormattingEditProviderRegistry","formatter","extensionId","displayName","provideDocumentFormattingEdits","provideDocumentRangeFormattingEdits","rangeFormatter_1","DocumentRangeFormattingEditProviderRegistry","FormattingConflicts","_selectors","LinkedList","formatDocumentRangeWithSelectedProvider","editorOrModel","instaService","selected","isCodeEditor","formatDocumentRangeWithProvider","workerService","rawEdits","range_1","initialSelection_1","IEditorWorkerService","EditorStateCancellationTokenSource","getFormattingOptions","computeMoreMinimalEdits","pushEditOperations","forceMoveMarkers","undoEdits","undoEdits_1","range_2","areIntersectingOrTouching","formatDocumentWithSelectedProvider","formatDocumentWithProvider","initialSelection_2","undoEdits_2","range_3","getDocumentRangeFormattingEditsUntilResult","providers_1","getDocumentFormattingEditsUntilResult","providers_2","getOnTypeFormattingEdits","ch","OnTypeFormattingEditProviderRegistry","autoFormatTriggerCharacters","provideOnTypeFormattingEdits","CommandsRegistry","registerCommand","assertType","isUri","FormatOnType","_workerService","_callOnDispose","_callOnModel","support","triggerChars","CharacterSet","onDidType","lastCharCode","fromCharCode","unbind","changes","FormatOnPaste","onDidPaste","FormatDocumentAction","hasDocumentFormattingProvider","FormatSelectionAction","hasDocumentSelectionFormattingProvider","hasNonEmptySelection","PeekContext","EmbeddedCodeEditorWidget","domElement","parentEditor","codeEditorService","accessibilityService","getRawOptions","_parentEditor","_overwriteOptions","_onParentConfigurationChanged","getParentEditor","newOptions","IAccessibilityService","CodeEditorWidget","IdGenerator","prefix","_prefix","_lastId","nextId","defaultGenerator","defaultColor","defaultOptions","showArrow","showFrame","frameColor","arrowColor","keepEditorSelection","ViewZoneDelegate","afterColumn","onDomNodeTop","_onDomNodeTop","_onComputedHeight","OverlayWidgetDelegate","Arrow","_ruleName","_IdGenerator","_color","_height","_updateStyle","where","ZoneWidget","_arrow","_overlayWidget","_positionMarkerId","_isShowing","isAccessible","_getWidth","_getLeft","_onWidth","_fillContainer","_initSash","_applyStyles","borderTopColor","borderBottomColor","verticalScrollbarWidth","minimapLeft","_onViewZoneTop","_onViewZoneHeight","containerHeight","_decoratingElementsHeight","_doLayout","rangeOrPos","_showImpl","viewZoneDomNode","overflow","maxHeightInLines","arrowHeight","frameThickness","width_1","frameWidth","borderTopWidth","borderBottomWidth","revealLine","isLastLine","revealLineInCenter","setCssClass","classToReplace","widthInPixel","heightInPixel","_relayout","newHeightInLines","isResizeable","startY","onDidEnd","lineDelta","currentY","roundedLineDelta","IPeekViewService","_widgets","addExclusiveWidget","existing","onDidClose","inPeekEditor","notInPeekEditor","toNegated","PeekContextController","headerBackgroundColor","white","primaryHeadingColor","secondaryHeadingColor","PeekViewWidget","_onDidClose","_headElement","_primaryHeading","_secondaryHeading","_bodyElement","_fillHead","_fillBody","titleElement","_onTitleClick","_fillTitleIcon","_metaHeading","actionBarOptions","_getActionBarOptions","_actionbarWidget","setTitle","primaryHeading","secondaryHeading","setMetaTitle","headHeight","bodyHeight","_doLayoutHead","_doLayoutBody","peekViewTitleBackground","peekViewTitleForeground","peekViewTitleInfoForeground","peekViewBorder","peekViewResultsBackground","black","peekViewResultsMatchForeground","peekViewResultsFileForeground","peekViewResultsSelectionBackground","peekViewResultsSelectionForeground","peekViewEditorBackground","peekViewEditorGutterBackground","peekViewResultsMatchHighlight","peekViewEditorMatchHighlight","peekViewEditorMatchHighlightBorder","activeContrastBorder","OneReference","isProviderFirst","_range","_rangeCallback","localize","basename","FilePreview","_modelReference","preview","object","textEditorModel","getWordUntilPosition","beforeRange","afterRange","inside","highlight","FileReferences","_preview","_loadFailure","fsPath","textModelResolverService","_resolved","createModelReference","modelReference","ReferencesModel","_onDidChangeReferenceRange","onDidChangeReferenceRange","_links","_title","providersFirst","_compareReferences","links_1","oneRef","targetSelectionRange","ref","clone","nextOrPreviousReference","reference","idx","childCount","groupCount","nearestReference","nearest","prefixLen","offsetDist","abs","referenceAt","firstReference","HighlightedLabel","supportCodicons","highlights","didEverRender","escapeNewLines","htmlContent","pos","substring_1","extraClasses","total","extra","highlights_1","FastLabelNode","_element","disposed","_textContent","empty","_empty","marginLeft","IconLabel","labelContainer","nameContainer","descriptionContainer","supportHighlights","nameNode","LabelWithHighlights","Label","supportDescriptionHighlights","descriptionNodeFactory","setLabel","classes","italic","descriptionNode","descriptionMatches","descriptionTitle","singleLabel","domId","separator","labelEscapeNewLines","labels","labelStart","labelRange","intersect","splitMatches","name_1","badgeBackground","badgeForeground","CountBadge","count","badgeBorder","countFormat","titleFormat","setCount","setTitleFormat","getPathLabel","userHomeProvider","rootProvider","file","baseResource","getWorkspaceFolder","hasMultipleRoots","getWorkspace","folders","pathLabel","relativePath","rootName","scheme","Schemas","untitled","with","query","fragment","hasDriveLetter","normalize","normalizeDriveLetter","isWindows","path","userHome","normalizedUserHome","normalizedUserHomeCached","original","normalized","rtrim","posix","isLinux","startsWithIgnoreCase","tildify","getBaseLabel","base","charAt","State","Sizing","DataSource","_resolverService","hasChildren","failure","getChildren","val","ITextModelService","Delegate","getHeight","getTemplateId","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","getKeyboardNavigationLabel","parts","IdentityProvider","FileReferencesTemplate","_uriLabel","badge","attachBadgeStyler","dirname","getUriLabel","relative","ILabelService","templateId","renderTemplate","renderElement","node","template","createMatches","filterData","disposeTemplate","templateData","OneReferenceTemplate","score","filePreview","FuzzyScore","isDefault","AriaProvider","getAriaLabel","ariaMessage","defaultStyles","separatorBorder","ViewItem","view","size","disposable","_cachedVisibleSize","_size","cachedVisibleSize","setVisible","visible","clamp","viewMinimumSize","viewMaximumSize","minimumSize","maximumSize","priority","snap","pointerEvents","layoutContext","layoutContainer","VerticalViewItem","HorizontalViewItem","Distribute","Split","Invisible","SplitView","contentSize","proportions","viewItems","sashItems","Idle","_onDidSashChange","onDidSashChange","_onDidSashReset","_startSnappingEnabled","_endSnappingEnabled","inverseAltBehavior","proportionalLayout","el","sashContainer","viewContainer","descriptor","views","viewDescriptor","sizing","doAddView","reduce","saveProportions","_orthogonalStartSash","sash","orthogonalStartSash","_orthogonalEndSash","orthogonalEndSash","startSnappingEnabled","updateSashEnablement","endSnappingEnabled","isTransparent","removeProperty","setProperty","addView","previousSize","lowPriorityIndexes","highPriorityIndexes","resize","distributeEmptySpace","layoutViews","onSashStart","alt","firstIndex","combinedDisposable","resetSashDragState","sashDragState","snapBefore","snapAfter","sizes","minDelta","NEGATIVE_INFINITY","maxDelta","viewItem","upIndexes","downIndexes","minDeltaUp","maxDeltaUp","maxDeltaDown","minDeltaDown","minDelta_1","maxDelta_1","snapBeforeIndex","findFirstSnapIndex","snapAfterIndex","halfSize","limitDelta","onSashChange","delta","newDelta","isLastSash","newSizes","viewItemIndex","newMinDelta","newMaxDelta","resizeIndex","onSashEnd","onViewChange","relayout","resizeView","Busy","distributeViewSizes","flexibleViewItems","flexibleSize","flexibleViewItems_1","getViewSize","skipLayout","insertBefore","viewSize","onChangeDisposable","containerDisposable","orientation_1","layoutProvider","getSashPosition","getVerticalSashLeft","sash_1","sashEventMapper","onStartDisposable","onStart","onChangeDisposable_1","onEndDisposable","onEnd","onDidResetDisposable","disposable_1","sashItem","overloadMinDelta","overloadMaxDelta","highPriorityIndexes_1","index_1","pushToStart","lowPriorityIndexes_1","index_2","pushToEnd","upItems","upSizes","downItems","downSizes","snapped","snapView","deltaUp","deltaDown","lowPriorityIndex","emptyDelta","highPriorityIndexes_2","lowPriorityIndexes_2","collapsesDown","expandsDown","reverseViews","collapsesUp","expandsUp","snappedBefore","snappedAfter","indexes_1","indexes_2","DecorationsManager","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","removeDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","toRemove","newRange","spansMultipleLines","LayoutData","ratio","fromJSON","ReferenceWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","setModel","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","peekView","focusOnReferenceTree","domFocus","focusOnPreviewEditor","isPreviewEditorFocused","_getFocusedReference","metaKey","containerElement","_messageContainer","_previewContainer","scrollBeyondLastLine","scrollbar","verticalScrollbarSize","horizontal","useShadows","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","createFromString","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","overrideStyles","listBackground","WorkbenchAsyncDataTree","onEvent","_revealReference","onDidChangeFocus","onDidOpen","browserEvent","MouseEvent","KeyboardEvent","tapCount","setFocus","newModel","_onNewModel","_decorationsManager","rerender","setInput","getFocus","revealParent","promise","scrollType","sel","_revealedReference","inMemory","basenameOrAuthority","getInput","expand","collapseToStart","revealRangeInCenter","findMatchHighlightColor","referenceHighlightColor","referenceHighlightBorder","hcOutline","resultsBackground","resultsMatchForeground","resultsFileForeground","resultsSelectedBackground","resultsSelectedForeground","editorBackground","editorGutterBackground","ctxReferenceSearchVisible","ReferencesController","_editorService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","toggleWidget","modelPromise","peekMode","closeWidget","_peekMode","openReference","_gotoReference","requestId","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","fwd","currentPosition","editorFocus","previewEditorFocus","focusEditor","openCodeEditor","openedEditor","model_1","sideBySide","withController","fn","outerEditor","getOuterEditor","or","registerCommandAlias","registerKeybindingRule","not","WorkbenchListFocusContextKey","IListService","lastFocusedList","getLocationLinks","registry","provide","coalesce","getDefinitionsAtPosition","DefinitionProviderRegistry","provideDefinition","getDeclarationsAtPosition","DeclarationProviderRegistry","provideDeclaration","getImplementationsAtPosition","ImplementationProviderRegistry","provideImplementation","getTypeDefinitionsAtPosition","TypeDefinitionProviderRegistry","provideTypeDefinition","getReferencesAtPosition","compact","ReferenceProviderRegistry","resultWithoutDeclaration","provideReferences","includeDeclaration","registerModelAndPositionCommand","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","refModel","editorState","EditorState","getActiveCodeEditor","seenUri","seenPosition","revealNext","revealInCenterIfOutsideViewport","status","_e","_f","_g","_h","editorService","_listener","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","SymbolNavigationAction","configuration","_configuration","symbolNavService","raceCancellation","_getLocationModel","altAction","altActionId","referenceCount","_getAlternativeCommand","muteMessage","_getNoResultFoundMessage","_onResult","gotoLocation","targetEditor","_getGoToPreference","openInPeek","_openInPeek","_openReference","openToSide","modelNow_1","ids_1","isLocationLink","DefinitionAction","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","GoToDefinitionAction","hasDefinitionProvider","isInEmbeddedEditor","OpenDefinitionToSideAction","PeekDefinitionAction","DeclarationAction","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","hasDeclarationProvider","PeekDeclarationAction","TypeDefinitionAction","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","hasTypeDefinitionProvider","PeekTypeDefinitionAction","ImplementationAction","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","hasImplementationProvider","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","GoToReferencesAction","hasReferenceProvider","PeekReferencesAction","GenericGoToLocationAction","_references","_gotoMultipleBehaviour","_token","corePosition","multiple","invokeWithinContext","control","MarkdownString","isTrustedOrOptions","_isTrusted","_supportThemeIcons","isTrusted","supportThemeIcons","appendText","appendMarkdown","appendCodeblock","langId","code","isEmptyMarkdownString","oneOrMany","isMarkdownString","thing","markdownStringEqual","removeMarkdownEscapes","hasModifier","modifier","ClickLinkMouseEvent","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","createOptions","multiCursorModifier","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","lastMouseMoveEvent","hasTriggerKeyOnMouseDown","newOpts","onEditorMouseMove","resetHandler","scrollLeftChanged","GotoDefinitionAtPositionEditorContribution","modeService","toUnhook","toUnhookForKeyboard","linkDecorations","currentWordAtPosition","previousPromise","linkGesture","startFindDefinitionFromMouse","withNullAsUndefined","gotoDefinition","removeLinkDecorations","startFindDefinitionFromCursor","startFindDefinition","withKey","findDefinition","results","wordRange","previewValue","getPreviewValue","originSelectionRange","modeId","getModeIdByFilepathOrFirstLine","rangeToUse","getPreviewRangeBasedOnBrackets","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","endIndent","trim","startIndent","ignoreFirstEmpty","currentBracket","lastBracket","open","isOpen","nextLineNumber","nextColumn","hoverMessage","inlineClassName","IModeService","SeverityIcon","severity","Severity","Ignore","Info","Warning","errorIconForeground","problemsErrorIconForeground","warningIconForeground","problemsWarningIconForeground","infoIconForeground","problemsInfoIconForeground","onRelatedInformation","_openerService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","_messageBlock","_relatedBlock","related","_scrollable","horizontalScrollbarSize","relatedInformation","sourceAndCodeLength","lines_1","applyFontInfo","lastLineElement","lines_2","innerText","codeElement","detailsElement","sourceElement","_codeLink","relatedInformationNode","paddingTop","relatedInformation_1","relatedResource","relatedMessage","scrollWidth","typicalFullwidthCharacterWidth","getHeightInLines","MarkerNavigationWidget","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","MarkerSeverity","_backgroundColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","editorMarkerNavigationWarning","editorMarkerNavigationInfo","_parentContainer","_icon","_container","_message","showAtMarker","markerIdx","markerCount","computeRequiredHeight","toSeverity","revealPositionInCenter","updateMarker","showStale","_heightInPixel","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","linkFg","textLinkForeground","MarkerModel","_toUnbind","_markers","_nextIdx","_ignoreSelectionChange","_onCurrentMarkerChanged","_onMarkerSetChanged","setMarkers","currentMarker","oldMarker","MarkerNavigationAction","compareMarker","binarySearch","withoutWatchingEditorPosition","_initIdx","found","isBeforeOrEqual","canNavigate","move","inCircles","oldIdx","atEdge","findMarkerAtPosition","MarkerController","_disposeOnClose","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","getOrCreateModel","_getMarkers","_onMarkerChanged","prevMarkerKeybinding","PrevMarkerAction","nextMarkerKeybinding","NextMarkerAction","LABEL","closeMarkersNavigation","pinned","revealIfOpened","onCurrentMarkerChanged","onMarkerSetChanged","changedResources","severities","IOpenerService","multiFile","_isNext","_multiFile","newMarker","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","ColorPickerModel","availableColorPresentations","presentationIndex","_onColorFlushed","onColorFlushed","_onDidChangeColor","onDidChangeColor","_onDidChangePresentation","onDidChangePresentation","originalColor","_colorPresentations","colorPresentations","presentation","selectNextColorPresentation","flushColor","guessColorPresentation","originalText","ColorPickerHeader","pickedColorNode","colorBox","Format","CSS","editorHoverBackground","CLICK","isLighter","ColorPickerBody","pixelRatio","saturationBox","SaturationBox","onDidSaturationValueChange","opacityStrip","OpacityStrip","onDidOpacityChange","hueStrip","HueStrip","onDidHueChange","hsva","HSVA","h","canvas","origin","onDidChangePosition","offsetY","mouseUpListener","stopMonitoring","paintSelection","offsetWidth","offsetHeight","paint","saturatedColor","ctx","whiteGradient","createLinearGradient","addColorStop","blackGradient","rect","fillStyle","fill","isMonitoring","Strip","overlay","slider","updateSliderPosition","onDidChangeTop","opaque","ColorPickerWidget","onDidChangeZoomLevel","header","getHover","HoverProviderRegistry","provideHover","hasRange","hasHtmlContent","contents","__marked_exports","HoverOperation","computer","success","progress","hoverTime","_computer","_hoverTime","_firstWaitScheduler","_triggerAsyncComputation","_secondWaitScheduler","_triggerSyncComputation","_loadingMessageScheduler","_showLoadingMessage","_asyncComputationPromise","_asyncComputationPromiseDone","_completeCallback","_errorCallback","_progressCallback","setHoverTime","_firstWaitTime","_secondWaitTime","_loadingMessageTime","computeAsync","asyncResult","_withAsyncResult","_onError","computeSync","onResult","_onComplete","getResult","_onProgress","getResultWithLoadingMessage","ContentHoverWidget","_stoleFocus","_containerDomNode","DomScrollableElement","updateFont","_showAtPosition","_showAtRange","getElementsByClassName","updateContents","onContentsChange","scanDomNode","GlyphHoverWidget","_showAtLineNumber","editorLayout","topForLineNumber","editorScrollTop","clientHeight","glyphMarginLeft","glyphMarginWidth","codeTags","getElementsByTagName","codeClasses","block","newline","fences","noop","heading","nptable","blockquote","table","lheading","paragraph","Lexer","marked","rules","normal","pedantic","gfm","tables","_label","bullet","_tag","_comment","merge","lex","src","loose","cap","bull","listStart","listItems","space","tag","isordered","istask","ischecked","exec","lang","depth","splitCells","align","cells","smartLists","task","sanitize","pre","sanitizer","autolink","url","reflink","nolink","strong","em","br","del","InlineLexer","renderer","Renderer","breaks","TextRenderer","Parser","slugger","Slugger","encode","escapeTest","escapeReplace","replacements","escapeTestNoEncode","escapeReplaceNoEncode","unescape","opt","cleanUrl","prot","decodeURIComponent","originIndependentUrl","baseUrls","resolveUrl","encodeURI","_punctuation","_escapes","_scheme","_email","_attribute","_href","_extended_email","_backpedal","output","prevCapZero","out","inLink","inRawBlock","lastParenIndex","findClosingBracket","linkLen","outputLink","escapes","codespan","mangle","smartypants","image","infostring","langPrefix","quote","headerIds","headerPrefix","slug","xhtml","listitem","checkbox","tablerow","tablecell","flags","baseUrl","inlineText","tok","parseText","row","cell","errMsg","silent","console","log","originalSlug","obj","tableRow","str","curr","invert","suffLen","currChar","pending","getDefaults","parser","lexer","inlineLexer","__insane_func","o","u","exports","1","require","module","toMap","uris","2","allowedAttributes","iframe","img","allowedClasses","allowedSchemes","allowedTags","3","voids","4","insane","strict","buffer","5","string","6","assignment","7","he","lowercase","rstart","rend","rattrs","rtag","rtagend","chars","lastItem","createStack","parsePart","parseComment","parseEdge","parseEndTag","parseStartTag","parseTagDecode","parseTag","same","rest","unary","attrs","doubleQuotedValue","singleQuotedValue","unquotedValue","decode","8","attributes","ignoring","classesOk","attrsOk","lkey","colon","questionmark","testUrl","unignore","transformText","9","unescapes","rescaped","runescaped","escapeHtmlChar","unescapeHtmlChar","escapeHtml","unescapeHtml","10","asKey","accumulator","renderMarkdown","markdown","signalInnerHTML","_uriMassage","cloneAndChange","revive","encodeURIComponent","isDomUri","withInnerHTML","dimensions","splitted","parameters","heightFromParams","widthFromParams","widthIsFinite","isFinite","heightIsFinite","parseHrefAndDimensions","codeBlockRenderer","strValue","span","codeBlockRenderCallback","dataset","markedOptions","http","https","mailto","vscodeRemote","vscodeRemoteResource","renderedMarkdown","MarkdownRenderer","_modeService","NullOpenerService","_onDidRenderCodeBlock","onDidRenderCodeBlock","languageAlias","getModeIdForLanguageName","triggerMode","TokenizationRegistry","getPromise","tokenizeToString","fontFamily","fromUserGesture","ColorHover","MarkerHover","ModesContentComputer","_markerDecorationsService","setRange","clearResult","colorDetector","lineDecorations","getLineDecorations","didFindColor","hoverRange","getMarker","asArray","isFromSynchronousComputation","_getLoadingMessage","markerCodeActionTrigger","ModesContentHoverWidget","markerDecorationsService","renderDisposable","_messages","_lastRange","_highlightDecorations","_isChangingDecorations","_shouldFocus","_colorPicker","_hoverOperation","_withResult","delay","FOCUS","BLUR","_renderMessages","onModelDecorationsChanged","startShowingAt","filteredMessages","msg","second","firstElement","secondElement","IMarkerData","makeKey","hoverContentsEquals","isColorPickerVisible","complete","renderRange","messages","renderColumn","highlightRange","createDocumentFragment","isEmptyHoverContent","containColorPicker","markdownDisposeables","markerMessages","color_1","editorModel_1","widget_1","updateEditorModel","textEdits","textEdit","identifier","additionalTextEdits","updateColorPresentations","colorListener","colorChangeListener","markdownHoverElement","hoverContentsElement","renderedContents","renderMarkerHover","markerHoverForStatusbar","renderMarkerStatusbar","markerHover","hoverElement","markerElement","messageElement","opacity","sourceAndCodeElement","message_1","relatedInfoContainer","marginTop","cursor","messageElement_1","this_1","actionsElement","renderAction","commandId","quickfixPlaceholderElement","transition","codeActionsPromise","showing","elementPosition","actionOptions","actionContainer","iconClass","MarginComputer","_lineNumber","setLineNumber","toHoverMessage","lineDecorations_1","glyphMarginClassName","glyphMarginHoverMessage","ModesGlyphHoverWidget","openerService","_renderDisposeables","_lastLineNumber","_markdownRenderer","messages_1","ModesHoverController","_toUnhook","_glyphWidget","_isMouseDown","_hoverClicked","_hookEvents","_didChangeConfigurationHandler","_hideWidgets","_unhookEvents","_createHoverWidgets","hideWidgetsEventHandler","hoverOpts","_isHoverEnabled","_isHoverSticky","sticky","_onEditorMouseMove","onDidChangeModelDecorations","_onModelDecorationsChanged","onMouseLeave","_onEditorScrollChanged","contentWidget","glyphWidget","targetType","epsilon","typicalHalfwidthCharacterWidth","isAfterLines","horizontalDistanceToText","showContentHover","IMarkerDecorationsService","ShowHoverAction","ShowDefinitionPreviewHoverAction","editorHoverHighlightColor","editorHoverHighlight","hoverBackground","hoverBorder","editorHoverBorder","hoverForeground","editorHoverForeground","actionsBackground","editorHoverStatusBarBackground","codeBackground","textCodeBlockBackground","InPlaceReplaceCommand","originalSelection","_editRange","_originalSelection","_text","InPlaceReplaceController","editorWorkerService","up","currentRequest","modelURI","canNavigateValueSet","navigateValueSet","DECORATION","decorationRemover","InPlaceReplaceUp","InPlaceReplaceDown","TrimTrailingWhitespaceCommand","cursors","_cursors","rLen","cursorIndex","cursorLen","maxLineColumn","minEditColumn","lastNonWhitespaceIndex","fromColumn","trimTrailingWhitespace","CopyLinesCommand","isCopyingDown","_isCopyingDown","_selectionDirection","_startLineNumberDelta","_endLineNumberDelta","sourceLines","sourceText","getDirection","createWithDirection","getSpaceCnt","spacesCnt","generateIndent","tabsCnt","MoveLinesCommand","isMovingDown","autoIndent","_isMovingDown","_autoIndent","_moveEndLineSelectionShrink","modelLineCount","indentSize","indentConverter","buildIndentConverter","virtualModel","getLineTokens","otherLineNumber","movingLineNumber_1","movingLineText","insertingText_1","shouldAutoIndent","movingLineMatchResult","matchEnterRule","newIndentation","indentUtils","newSpaceCnt","oldIndentation","trimLeft","indentOfMovingLine","getGoodIndentForLine","oldSpaceCnt","ret","getIndentEditsOfMovingBlock","newIndentatOfMovingBlock","spaceCntOffset","indentOfFirstLine","oldIndent","shiftIndent","indentation","ShiftCommand","unshiftIndent","oneLineAbove","oneLineAboveText","validPrecedingLine","enter","getEnterAction","enterPrefix","indentAction","IndentAction","Indent","IndentOutdent","Outdent","indentMetadataOfMovelingLine","getIndentMetadata","isCheapToTokenize","languageAtSelectionStart","getIndentRulesSupport","originalIndent","newIndent","SortLinesCommand","descending","selectionId","getCollator","_COLLATOR","Intl","Collator","getSortData","sortLines","canRun","linesToSort","AbstractCopyLinesAction","down","CopyLinesUpAction","CopyLinesDownAction","DuplicateSelectionAction","insertSelection","ReplaceCommandThatSelectsText","AbstractMoveLinesAction","selections_3","MoveLinesUpAction","MoveLinesDownAction","AbstractSortLinesAction","selections_4","SortLinesAscendingAction","SortLinesDescendingAction","TrimTrailingWhitespaceAction","DeleteLinesAction","_getLinesToRemove","linesDeleted","operations","mergedOperations","previousOperation","IndentLinesAction","_getCursors","TypeOperations","OutdentLinesAction","CoreEditingCommands","InsertLineBeforeAction","lineInsertBefore","InsertLineAfterAction","lineInsertAfter","AbstractDeleteAllToBoundaryAction","primaryCursor","rangesToDelete","_getRangesToDelete","effectiveRanges","nextRange","endCursorState","_getEndCursorState","DeleteAllLeftAction","endPrimaryCursor","deletedLines","endCursor","newStartLine","unshift","deleteFromLine","deleteFromColumn","DeleteAllRightAction","JoinLinesAction","reducedSelections","lastSelection","previousValue","lineOffset","columnDeltaOffset","selectionEndPositionOffset","trimmedLinesContent","i_1","lineText","firstNonWhitespaceIdx","lineTextWithoutIndent","deleteSelection","resultSelection","TransposeAction","AbstractCaseAction","wordSeparators","_modifyText","UpperCaseAction","toLocaleUpperCase","LowerCaseAction","toLocaleLowerCase","TitleCaseAction","excludedChars","startUpperCase","currentChar","Link","_link","_provider","toJSON","tooltip","resolveLink","LinksList","tuples","newLinks","_union","isDisposable","tuples_1","oldLinks","oldIndex","oldLen","newLen","oldLink","newLink","getLinks","lists","LinkProviderRegistry","provideLinks","general","collapseOnReplaceEdit","active","LinkOccurrence","useMetaKey","_getOptions","isActive","executeCmd","getHoverMessage","activate","deactivate","LinkDetector","listenersToRemove","clickLinkGesture","cleanUpActiveLinkDecoration","onModelModeChanged","async","computePromise","activeLinksList","currentOccurrences","activeLinkDecorationId","occurance","occurrence_1","getLinkOccurrence","occurrence_2","occurrence","openLinkOccurrence","messageOrError","warn","decorations_1","decoration_1","currentOccurrence","OpenLinkAction","linkDetector","InsertCursorAbove","useLogicalLine","logicalLine","readOnly","pushStackElement","setStates","CursorMoveCommands","addCursorUp","getAll","InsertCursorBelow","addCursorDown","InsertCursorAtEndOfEachLineSelected","getCursorsForSelection","currentLineMaxColumn","InsertCursorAtEndOfLineSelected","InsertCursorAtTopOfLineSelected","MultiCursorSessionResult","revealScrollType","MultiCursorSession","findController","isDisconnectedFromFindController","searchText","findState","addSelectionToNextFindMatch","allSelections","moveSelectionToNextFindMatch","lastAddedSelection","addSelectionToPreviousFindMatch","previousMatch","_getPreviousMatch","moveSelectionToPreviousFindMatch","selectAll","MultiCursorSelectionController","_sessionDispose","_session","_endSession","_beginSessionIfNeeded","session","_setSelections","_expandEmptyToWord","_applySessionResult","getSession","modelRangesContainSameText","resultingSelections","inSelection","MultiCursorSelectionControllerAction","multiCursorController","AddSelectionToNextFindMatchAction","AddSelectionToPreviousFindMatchAction","MoveSelectionToNextFindMatchAction","MoveSelectionToPreviousFindMatchAction","SelectHighlightsAction","CompatChangeAll","SelectionHighlighterState","softEquals","SelectionHighlighter","updateSoon","_setState","_createState","findStateSearchString","mySearchString","hasFindOccurrences","DocumentHighlightProviderRegistry","allMatches","cmp","areIntersecting","_SELECTION_HIGHLIGHT","_SELECTION_HIGHLIGHT_OVERVIEW","overviewRulerSelectionHighlightForeground","selectedText","Context","Visible","MultipleSignatures","provideSignatureHelp","supports","registerDefaultLanguageCommand","triggerKind","Invoke","isRetrigger","triggerCharacter","ParameterHintState","Default","Pending","Active","hints","ParameterHintsModel","DEFAULT_DELAY","_onChangedHints","onChangedHints","triggerOnType","_pendingTriggers","_lastSignatureHelpResult","retriggerChars","triggerId","throttledDelayer","onEditorConfigurationChange","onCursorChange","onModelContentChange","doTrigger","signatures","activeSignature","cycle","updateActiveSignature","activeSignatureHelp","triggerContext","error_1","mergeTriggerContexts","isTriggered","signatureHelpTriggerCharacters","signatureHelpRetriggerCharacters","lastCharIndex","triggerCharCode","TriggerCharacter","ContentChange","ParameterHintsWidget","renderDisposeables","announcedLabel","markdownRenderer","keyVisible","keyMultipleSignatures","newParameterHints","createParamaterHintDOMNodes","overloads","onPreviousClick","onNextClick","signature","docs","userSelect","domNodes","chain","on","updateMaxHeight","hasParameters","renderParameters","activeParameter","documentation","hasDocs","labelToAnnounce","getParameterLabel","currentParameter","getParameterLabelOffsets","beforeSpan","paramSpan","afterSpan","paramIdx","param","ParameterHintsController","TriggerParameterHintsAction","hasSignatureHelpProvider","ParameterHintsCommand","CONTEXT_RENAME_INPUT_VISIBLE","RenameInputField","_acceptKeybindings","_visibleContextKey","_updateFont","_updateStyles","_input","updateLabel","accept","boxShadow","fontWeight","acceptInput","wantsPreview","_currentAcceptInput","cancelInput","_currentCancelInput","supportPreview","disposeOnDone","newName","revealLineInCenterIfOutsideViewport","RenameSkeleton","_providers","RenameProviderRegistry","hasProvider","resolveRenameLocation","firstProvider","provideRenameEdits","rejects","rejectReason","RenameController","_instaService","_bulkEditService","_logService","_configService","_dispoableStore","_cts","CancellationTokenSource","_renameInputField","IdleValue","skeleton","loc","resolveLocationOperation","inputFieldResult","renameOperation","hasPreviewHandler","renameResult","showPreview","ariaSummary","acceptRenameInput","cancelRenameInput","ILogService","ITextResourceConfigurationService","RenameAction","hasRenameProvider","RenameCommand","Registry","as","Extensions","Configuration","registerConfiguration","scope","WordSelectionRangeProvider","provideSelectionRanges","positions_1","bucket","_addInWordRanges","_addWordRanges","_addWhitespaceLine","lastCh","isLowerAsciiLetter","isUpperAsciiLetter","getLineLastNonWhitespaceColumn","BracketSelectionRangeProvider","_bracketsRightYield","_bracketsLeftYield","counts","t1","Date","now","_maxRounds","bracket","_maxDuration","close","findPrevBracket","closing","innerBracket","outerBracket","_addBracketLeading","startLine","aboveLine","column_1","SelectionRanges","mov","SmartSelectController","_ignoreSelection","_selectionListener","forward","arrays","AbstractSmartSelect","_forward","GrowSelectionAction","ShrinkSelectionAction","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","oneRanges","oneRawRanges_1","oneRangesWithTrivia","prev","cur","rangeNoWhitespace","rangeFull","registerModelCommand","MultipleSuggestions","MakesTextEdit","AcceptSuggestionsOnEnter","CompletionItem","completion","isResolved","distance","textLabel","labelLow","sortTextLow","sortText","filterTextLow","filterText","editStart","editInsertEnd","editReplaceEnd","cached_1","resolveCompletionItem","onCancellationRequested","CompletionOptions","snippetSortOrder","kindFilter","providerFilter","provideSuggestionItems","defaultReplaceRange","defaultInsertRange","orderedGroups","allSuggestions","hasResult","factory","provideCompletionItems","suggestions","suggestion","_snippetSuggestSupport","getSuggestionComparator","defaultComparator","_snippetComparators","snippetConfig","resolving","maxItemsToResolve","items_1","incomplete","onlyOnceSuggestions","Scanner","isDigitCharacter","isVariableCharacter","tokenText","_table","isNaN","Marker","_children","Text","others","newChildren","_fixParent","children_1","child_1","TextmateSnippet","_this_1","TransformableMarker","Placeholder","compareByIndex","isFinalTabstop","Choice","transform","Transform","regexp","didMatch","_replace","FormatString","elseValue","shorthandName","ifValue","_toPascalCase","Variable","walk","visitor","marker_1","_placeholders","last_1","all_1","placeholderInfo","fullLen","enclosingPlaceholders","resolveVariables","SnippetParser","_scanner","insertFinalTabstop","enforceFinalTabstop","snippet","_parse","placeholderDefaultValues","incompletePlaceholders","placeholderCount","incompletePlaceholders_1","defaultValues","defaultValues_1","_accept","_backTo","_until","nextToken","_parseEscaped","_parseTabstopOrVariableName","_parseComplexPlaceholder","_parseComplexVariable","_parseAnything","_parseTransform","choice","_parseChoiceElement","variable","regexValue","regexOptions","_parseFormatString","complex","shorthand","isSingleFolderWorkspaceIdentifier","CompositeSnippetVariableResolver","_delegates","SelectionBasedVariableResolver","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace_1","whitespaceCommonLength_1","commonPrefixLength","ModelBasedVariableResolver","_labelService","ClipboardBasedVariableResolver","_readClipboardText","_selectionIdx","_selectionCount","_spread","clipboardText","isFalsyOrWhitespace","CommentBasedVariableResolver","TimeBasedVariableResolver","getFullYear","getMonth","valueOf","getDate","getHours","getMinutes","getSeconds","dayNames","getDay","dayNamesShort","monthNames","monthNamesShort","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","workspace","configPath","toWorkspaceIdentifier","_resolveWorkspaceName","_resoveWorkspacePath","filename","endsWith","folderpath","RandomBasedVariableResolver","getColorGraceful","OneSnippet","_nestingLevel","_snippet","_offset","_placeholderGroups","groupBy","placeholders","_placeholderGroupsIdx","_placeholderDecorations","toRemove_1","_initDecorations","placeholderOffset","placeholderLen","getPositionAt","_decor","inactiveFinal","inactive","couldSkipThisPlaceholder","activePlaceholders","_hasPlaceholderBeenCollapsed","activeFinal","enclosingPlaceholder","id_1","computePossibleSelections","placeholdersWithEqualIndex_1","nested","assert","indexLastPlaceholder","nestedPlaceholder","placeholder_1","_defaultOptions","overwriteBefore","overwriteAfter","adjustWhitespace","SnippetSession","_templateMerges","_snippets","_template","adjustIndentation","adjustNewlines","templateLeadingWhitespace","normalizeIndentation","getEOL","adjustSelection","positionColumnBefore","positionColumnAfter","createEditsAndSnippets","snippets","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","readClipboardText","readTextSync","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","indexedSelections_1","extensionBefore","extensionAfter","snippetSelection","getOffsetAt","_logInfo","hasPlaceholder","_move","oneSelection","isAtFirstPlaceholder","isAtLastPlaceholder","isSelectionWithinPlaceholders","allPossibleSelections","array","undoStopBefore","undoStopAfter","SnippetController2","_snippetListener","_modelVersionId","_inSnippet","InSnippetMode","_hasNextTabstop","HasNextTabstop","_hasPrevTabstop","HasPrevTabstop","_doInsert","getAlternativeVersionId","_updateState","_handleChoice","_currentChoice","first_1","option","insertText","repeat","triggerSuggest","finish","resetSelection","isInSnippet","CommandCtor","ctrl","Memory","topScore","preselect","NoMemory","memorize","LRUMemory","_seq","touch","lineSuffix","indexPreselect","indexRecency","seq","data_1","completionKindFromString","PrefixMemory","_trie","TernarySearchTree","forStrings","findSubstr","data_2","SuggestMemoryService","_storagePrefix","share","_persistSoon","_saveState","affectsConfiguration","onDidChangeStorage","_mode","_shareMem","shareMem","_strategy","ISuggestMemoryService","SuggestAlternatives","_index","_ckOtherSuggestions","OtherSuggestions","_acceptNext","_ignore","acceptNext","_moveIndex","CompletionModel","lineContext","wordDistance","snippetSuggestions","_snippetCompareFn","_compareCompletionItems","_items","_column","_wordDistance","_refilterKind","_lineContext","_compareCompletionItemsSnippetsUp","_compareCompletionItemsSnippetsDown","leadingLineContent","characterCountDelta","_filteredItems","_ensureCachedState","_isIncomplete","adopt","except","_stats","_createCachedState","suggestionCount","snippetCount","textCount","wordLow","scoreFn","filterGraceful","fuzzyScore","fuzzyScoreGracefulAggressive","wordLen","wordPos","compareIgnoreCase","anyScore","WordDistance","service","wordRanges","localityBonus","canComputeWordRanges","computeWordRanges","wordLines","isFalsyOrEmpty","bestWordRange","blockDistance","class_2","LineContext","auto","shy","leadingWord","shouldAutoTrigger","SuggestModel","_editorWorker","_quickSuggestDelay","_triggerCharacterListener","_triggerQuickSuggest","_completionDisposables","_onDidCancel","_onDidTrigger","_onDidSuggest","onDidCancel","onDidTrigger","onDidSuggest","_currentSelection","_updateTriggerCharacters","_updateQuickSuggest","CompletionProviderRegistry","_updateActiveSuggestSession","editorIsComposing","onDidCompositionStart","onDidCompositionEnd","_refilterCompletionItems","supportsByTriggerCharacter","triggerCharacters","getSnippetSuggestSupport","checkTriggerCharacter","lastChar","isLowSurrogate","isHighSurrogate","_completionModel","_requestToken","_context","prevSelection","snippetsPreventQuickSuggestions","quickSuggestions","lineTokens","tokenType","getStandardTokenType","findTokenIndexAtOffset","_onNewContext","onlyFrom","existingItems","suggestCtx","itemKindFilter","_createItemKindFilter","cmpFn","suggestOptions","showMethods","showFunctions","showConstructors","showFields","showVariables","showClasses","showStructs","showInterfaces","showModules","showProperties","showEvents","showOperators","showUnits","showValues","showConstants","showEnums","showEnumMembers","showKeywords","showWords","showColors","showFiles","showReferences","showFolders","showTypeParameters","showSnippets","adopted","oldLineContext","isFrozen","completionModel","SYMBOL_ICON_ARRAY_FOREGROUND","SYMBOL_ICON_BOOLEAN_FOREGROUND","SYMBOL_ICON_CLASS_FOREGROUND","SYMBOL_ICON_COLOR_FOREGROUND","SYMBOL_ICON_CONSTANT_FOREGROUND","SYMBOL_ICON_CONSTRUCTOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_FOREGROUND","SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND","SYMBOL_ICON_EVENT_FOREGROUND","SYMBOL_ICON_FIELD_FOREGROUND","SYMBOL_ICON_FILE_FOREGROUND","SYMBOL_ICON_FOLDER_FOREGROUND","SYMBOL_ICON_FUNCTION_FOREGROUND","SYMBOL_ICON_INTERFACE_FOREGROUND","SYMBOL_ICON_KEY_FOREGROUND","SYMBOL_ICON_KEYWORD_FOREGROUND","SYMBOL_ICON_METHOD_FOREGROUND","SYMBOL_ICON_MODULE_FOREGROUND","SYMBOL_ICON_NAMESPACE_FOREGROUND","SYMBOL_ICON_NULL_FOREGROUND","SYMBOL_ICON_NUMBER_FOREGROUND","SYMBOL_ICON_OBJECT_FOREGROUND","SYMBOL_ICON_OPERATOR_FOREGROUND","SYMBOL_ICON_PACKAGE_FOREGROUND","SYMBOL_ICON_PROPERTY_FOREGROUND","SYMBOL_ICON_REFERENCE_FOREGROUND","SYMBOL_ICON_SNIPPET_FOREGROUND","SYMBOL_ICON_STRING_FOREGROUND","SYMBOL_ICON_STRUCT_FOREGROUND","SYMBOL_ICON_TEXT_FOREGROUND","SYMBOL_ICON_TYPEPARAMETER_FOREGROUND","SYMBOL_ICON_UNIT_FOREGROUND","SYMBOL_ICON_VARIABLE_FOREGROUND","symbolIconArrayColor","symbolIconBooleanColor","symbolIconClassColor","symbolIconMethodColor","symbolIconColorColor","symbolIconConstantColor","symbolIconConstructorColor","symbolIconEnumeratorColor","symbolIconEnumeratorMemberColor","symbolIconEventColor","symbolIconFieldColor","symbolIconFileColor","symbolIconFolderColor","symbolIconFunctionColor","symbolIconInterfaceColor","symbolIconKeyColor","symbolIconKeywordColor","symbolIconModuleColor","outlineNamespaceColor","symbolIconNullColor","symbolIconNumberColor","symbolIconObjectColor","symbolIconOperatorColor","symbolIconPackageColor","symbolIconPropertyColor","symbolIconReferenceColor","symbolIconSnippetColor","symbolIconStringColor","symbolIconStructColor","symbolIconTextColor","symbolIconTypeParameterColor","symbolIconUnitColor","symbolIconVariableColor","FileKind","getIconClasses","modelService","fileKind","ROOT_FOLDER","FOLDER","DataUri","parseMetaData","META_DATA_LABEL","cssEscape","dotSegments","detectedModeId","mime","META_DATA_MIME","getModeId","PLAINTEXT_MODE_ID","detectModeId","editorSuggestWidgetBackground","editorSuggestWidgetBorder","editorSuggestWidgetForeground","editorForeground","editorSuggestWidgetSelectedBackground","listFocusBackground","editorSuggestWidgetHighlightForeground","listHighlightForeground","colorRegExp","canExpandCompletionItem","getAriaId","ItemRenderer","triggerKeybindingLabel","_modelService","addClass","colorspan","main","iconContainer","iconLabel","signatureLabel","qualifierLabel","detailsLabel","readMore","configureFont","fontFeatureSettings","fontSizePx","lineHeightPx","completionKindToCssClass","labelOptions","extractColor","getIconTheme","hasFileIcons","labelClasses","from","FILE","detailClasses","hasFolderIcons","addClasses","tags","removeClass","qualifier","toggleDetails","SuggestionDetails","kbToggleDetails","renderLoading","renderItem","explainMode","renderDisposeable","md","_debugDisplayName","scrollDown","much","scrollUp","scrollBottom","pageDown","pageUp","setBorderWidth","SuggestWidget","isAuto","loadingTimeout","currentSuggestionDetails","ignoreFocusEvents","showTimeout","onDidSelectEmitter","onDidFocusEmitter","onDidHideEmitter","onDidShowEmitter","onDidSelect","onDidHide","onDidShow","maxWidgetWidth","listWidth","firstFocusInCurrentList","preferDocPositionTop","docsPositionPreviousWidgetY","_onDetailsKeydown","onDetailsKeyDown","msgDetailsLess","msgDetailMore","focusedItem","addDisposableListener","hideWidget","listElement","applyStatusBarStyle","hideStatusBar","statusBarElement","statusBarLeftSpan","statusBarRightSpan","setStatusBarLeftText","setStatusBarRightText","details","applyIconStyle","showIcons","List","openController","shouldOpen","mouseSupport","expandDocsSettingFromStorage","attachListStyler","listInactiveFocusBackground","listInactiveFocusOutline","onEditorLayoutChange","onListMouseDownOrTap","onTap","onListSelection","onFocusChange","onListFocus","onCursorSelectionChanged","suggestWidgetVisible","SuggestContext","suggestWidgetMultipleSuggestions","addStandardDisposableListener","expandSideOrBelow","detailsBorderColor","focusBorderColor","detailsFocusBorderColor","setAriaOptions","activeDescendant","wantsInsert","insertMode","kbAccept","kbAcceptAlt","loading","showDetails","stateChanged","listHeight","LOADING_MESSAGE","NO_SUGGESTIONS_MESSAGE","showTriggered","showSuggestions","selectionIndex","visibleCount","stats","publicLog","selectNextPage","focusNextPage","selectNext","focusNext","selectLast","focusLast","selectPreviousPage","focusPreviousPage","selectPrevious","focusPrevious","selectFirst","focusFirst","getFocusedItem","getFocusedElements","toggleDetailsFocus","updateExpandDocsSetting","maxWidgetHeight","adjustDocsPosition","toggleExplainMode","updateListHeight","unfocusedHeight","contentHeight","maxVisibleSuggestions","cursorX","cursorY","widgetCoords","widgetX","widgetY","hasClass","matchHighlight","WordContextKey","_enabled","_ckAtEnd","AtEnd","checkForWordEnd","CommitCharacterController","_onItem","onWillType","_active","acceptCharacters","commitCharacters","SuggestRangeHighlighter","focused","_highlight","_widgetListener","_reset","_shiftKeyListener","_currentItem","newDeco","insertHighlight","getOverwriteInfo","isPressed","wordInfo","ShiftKey","_subscriptions","_isPressed","LineSuffix","_marker","SuggestController","editorWorker","_memoryService","_lineSuffix","_insertSuggestion","commitCharacterController","makesTextEdit","insertTextRules","toKeybinding","SimpleKeybinding","isModifierKey","_alternatives","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","modelVersionNow","TriggerSuggestAction","canUndo","undo","_alertCompletionItem","toggleMode","triggerSuggestAndAcceptBest","positionNow","fallback","any","acceptSelectedSuggestion","keepAlternativeSuggestions","alternativeOverwriteConfig","acceptNextSuggestion","acceptPrevSuggestion","cancelSuggestWidget","selectNextSuggestion","selectNextPageSuggestion","selectLastSuggestion","selectPrevSuggestion","selectPrevPageSuggestion","selectFirstSuggestion","toggleSuggestionDetails","toggleSuggestionFocus","hasCompletionItemProvider","SuggestCommand","isObject","ForceRetokenizeAction","resetTokenization","sw","StopWatch","forceTokenization","elapsed","ToggleTabFocusModeAction","TabFocus","getTabFocusMode","setTabFocusMode","editorWordHighlight","editorWordHighlightStrong","editorWordHighlightBorder","editorWordHighlightStrongBorder","overviewRulerWordHighlightForeground","overviewRulerWordHighlightStrongForeground","ctxHasWordHighlights","getOccurrencesAtPosition","orderedByScore","provideDocumentHighlights","OccurenceAtPositionRequest","_wordRange","_getCurrentWordRange","_compute","currentWordRange","requestIsValid","SemanticOccurenceAtPositionRequest","TextualOccurenceAtPositionRequest","_selectionIsEmpty","DocumentHighlightKind","currentSelectionIsEmpty","WordHighlighter","workerRequestTokenId","workerRequestCompleted","workerRequestValue","lastCursorPositionChangeTime","renderDecorationsTimer","_hasWordHighlights","_ignorePositionChangeEvent","occurrencesHighlight","_onPositionChanged","_stopAll","workerRequest","hasDecorations","_getSortedHighlights","moveNext","dest","moveBack","workerRequestIsValid","getTime","_beginRenderDecorations","myRequestId_1","currentTime","minimumRenderTime","renderDecorations","_getDecorationOptions","Write","_WRITE_OPTIONS","_TEXT_OPTIONS","_REGULAR_OPTIONS","WordHighlighterContribution","wordHighligher","createWordHighlighterIfPossible","WordHighlightNavigationAction","NextWordHighlightAction","PrevWordHighlightAction","TriggerWordHighlightAction","selectionHighlight","editorSelectionHighlight","wordHighlight","wordHighlightStrong","selectionHighlightBorder","editorSelectionHighlightBorder","wordHighlightBorder","wordHighlightStrongBorder","MoveWordCommand","_inSelectionMode","inSelectionMode","_wordNavigationType","wordNavigationType","getMapForWordSeparators","inPosition","outPosition","_moveTo","fromModelSelection","to","WordLeftCommand","WordOperations","moveWordLeft","WordRightCommand","moveWordRight","CursorWordStartLeft","CursorWordEndLeft","CursorWordLeft","CursorWordStartLeftSelect","CursorWordEndLeftSelect","CursorWordLeftSelect","CursorWordAccessibilityLeft","CONTEXT_ACCESSIBILITY_MODE_ENABLED","EditorOptions","defaultValue","CursorWordAccessibilityLeftSelect","CursorWordStartRight","CursorWordEndRight","CursorWordRight","CursorWordStartRightSelect","CursorWordEndRightSelect","CursorWordRightSelect","CursorWordAccessibilityRight","CursorWordAccessibilityRightSelect","DeleteWordCommand","_whitespaceHeuristics","whitespaceHeuristics","deleteRange","_delete","DeleteWordLeftCommand","deleteWordLeft","DeleteWordRightCommand","deleteWordRight","DeleteWordStartLeft","DeleteWordEndLeft","DeleteWordLeft","DeleteWordStartRight","DeleteWordEndRight","DeleteWordRight","DeleteWordPartLeft","WordPartOperations","deleteWordPartLeft","DeleteWordPartRight","deleteWordPartRight","WordPartLeftCommand","moveWordPartLeft","CursorWordPartLeft","CursorWordPartLeftSelect","WordPartRightCommand","moveWordPartRight","CursorWordPartRight","CursorWordPartRightSelect","CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE","AccessibilityHelpController","AccessibilityHelpWidget","_isVisibleKey","createFastDomNode","setClassName","setDisplay","_contentDomNode","_layout","AccessibilityHelpNLS","emergencyConfOn","accessibilitySupport","_buildContent","openingDocs","accessibilityHelpUrl","_descriptionForCommand","noKbMsg","charactersSelected","singleSelectionRange","singleSelection","multiSelectionRange","multiSelection","noSelection","getSelectionLabel","readonlyDiffEditor","editableDiffEditor","readonlyEditor","editableEditor","turnOnMessage","changeConfigToOnMac","changeConfigToOnWinLinux","auto_on","auto_off","tabFocusModeOnMsg","tabFocusModeOnMsgNoKb","tabFocusModeOffMsg","tabFocusModeOffMsgNoKb","openDocMac","openDocWinLinux","outroMsg","w","WIDTH","HEIGHT","setWidth","setHeight","setTop","setLeft","ShowAccessibilityHelpAction","showAccessibilityHelpAction","AccessibilityHelpCommand","IPadShowKeyboard","shouldHaveWidget","ShowKeyboardWidget","InspectTokensController","standaloneColorService","launch","InspectTokensWidget","IStandaloneThemeService","InspectTokens","InspectTokensNLS","inspectTokensAction","_tokenizationSupport","languageIdentifier","tokenizationSupport","getInitialState","NULL_STATE","tokenize","deltaOffset","nullTokenize","tokenize2","nullTokenize2","getSafeTokenizationSupport","_ID","_getTokensAtLine","token1Index","tokens1","token2Index","tokens2","tokenStartIndex","tokenEndIndex","charIndex","charCode","renderTokenText","metadata","_decodeMetadata","_tokenTypeToString","_fontStyleToString","fontStyle","formatHex","colorMap","getColorMap","TokenMetadata","getLanguageId","getTokenType","getFontStyle","getForeground","getBackground","stateBeforeLine","_getStateBeforeLine","tokenizationResult1","tokenizationResult2","startState","endState","KeybindingLabel","os","areSame","getParts","firstPart","chordPart","renderPart","renderUnboundKeybindings","renderUnbound","modifierLabels","UILabelProvider","renderKey","keyLabel","IDS","QuickOpenEntry","labelHighlights","descriptionHighlights","getLabelOptions","getDescription","getDetail","getIcon","getTooltip","getDescriptionTooltip","getKeybinding","hidden","setHighlights","detailHighlights","getHighlights","QuickOpenEntryGroup","groupLabel","withBorder","getGroupLabel","setGroupLabel","showBorder","setShowBorder","NoActionProvider","hasActions","tree","actionProvider","actionRunner","entryContainer","row1","row2","keybindingContainer","OS","detailContainer","actionBarContainer","actionBar","groupData","pickerGroupBorder","pickerGroupForeground","QuickOpenModel","_entries","_dataSource","_renderer","_filter","_runner","_accessibilityProvider","modelProvider","isFunction","dataSource","getParent","AccessibilityProvider","getPosInSet","getSetSize","Filter","updateStyles","KeybindingDispatcher","_arr","createKeybinding","dispatch","toChord","DefaultController","clickBehavior","openMode","downKeyBindingDispatcher","upKeyBindingDispatcher","onUp","onDown","onLeft","onRight","onPageUp","onPageDown","onHome","onSpace","onEscape","onEnter","onLeftClick","eventish","payload","originalEvent","didClickOnTwistie","isClickOnTwistie","clearFocus","clearSelection","shouldToggleExpansion","isExpanded","collapse","errors","isDoubleClick","openOnSingleClick","twistieStyle","window","getComputedStyle","backgroundImage","twistieWidth","initialTarget","onKey","bindings","getHighlight","clearHighlight","focus_1","didCollapse","focusParent","focus_2","didExpand","focusFirstChild","toggleExpansion","DefaultDragAndDrop","getDragURI","onDragStart","onDragOver","targetElement","drop","DefaultFilter","DefaultAccessibilityProvider","DefaultTreestyler","styleElement","selectorSuffix","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listDropBackground","listFocusOutline","newStyles","LockData","_onDispose","onDispose","_item","Lock","locks","isLocked","lock","getLock","ItemRegistry","_onDidRevealItem","EventMultiplexer","onDidRevealItem","_onExpandItem","onExpandItem","_onDidExpandItem","onDidExpandItem","_onCollapseItem","onCollapseItem","_onDidCollapseItem","onDidCollapseItem","_onDidAddTraitItem","onDidAddTraitItem","_onDidRemoveTraitItem","onDidRemoveTraitItem","_onDidRefreshItem","onDidRefreshItem","_onRefreshItemChildren","onRefreshItemChildren","_onDidRefreshItemChildren","onDidRefreshItemChildren","_onDidDisposeItem","onDidDisposeItem","Assert","isRegistered","onDidReveal","onExpand","onDidExpand","onCollapse","onDidCollapse","onDidAddTrait","onDidRemoveTrait","onDidRefresh","onRefreshChildren","onDidRefreshChildren","deregister","getItem","Item","_onDidCreate","_onDidReveal","_onExpand","_onDidExpand","_onCollapse","_onDidCollapse","_onDidAddTrait","_onDidRemoveTrait","_onDidRefresh","_onRefreshChildren","_onDidRefreshChildren","_onDidDispose","doesHaveChildren","needsChildrenRefresh","lastChild","traits","shouldAutoexpand","getElement","getDepth","_setExpanded","relativeTop","eventData","refreshChildren","autoExpandSingleChildren","collapseChildrenPromise_1","forEachChild","addTrait","trait","removeTrait","hasTrait","getAllTraits","safe","setNeedsChildrenRefresh_1","doRefresh","isNested","staleItems","addChild","staleItemId","mapEachChild","updateVisibility","refresh","getNavigator","TreeNavigator","isAncestorOf","startItem","afterItem","atHead","atTail","isFirstChild","isLastChild","NaN","sorter","otherElement","RootItem","subTreeOnly","lastDescendantOf","parent_1","TreeModel","registryDisposable","_onSetInput","onSetInput","_onDidSetInput","onDidSetInput","_onRefresh","onRefresh","_onDidHighlight","onDidHighlight","_onDidSelect","_onDidFocus","Relay","traitsToItems","setHighlight","resolveUnknownParentChain","eventPayload","setTraits","includeHidden","getElementsWithTrait","nextItem","nav","previousItem","focusNth","navItem","fromItem","removeTraits","traitItems","itemsToRemoveTrait","ElementsDragAndDropData","dataTransfer","getData","ExternalElementsDragAndDropData","DesktopDragAndDropData","files","HeightMap","heightMap","getContentHeight","onInsertItems","afterItemId","totalSize","sizeDiff","boundSplice","itemsToInsert","createViewItem","onInsertItem","onRefreshItem","onRemoveItems","itemId","onRemoveItem","onRefreshItemSet","sortedItems","onRefreshItems","ArrayIterator","cummDiff","needsRender","indexAt","center","indexAfter","itemAtIndex","itemAfter","ContextMenuEvent","_posx","_posy","_target","MouseContextMenuEvent","KeyboardContextMenuEvent","RowCache","alloc","cache","release","removeFromParent","garbageCollect","cachedRow","unbindDragStart","Lifecycle","_draggable","_styles","_templateId","skipUserRender","draggable","accessibility","base64Id","paddingOnRow","twistiePixels","indentPixels","firstElementChild","dnd","horizontalScrolling","Browser","insertInDOM","afterElement","TreeView","BINDING","removeFromDOM","RootViewItem","lastPointerType","lastClickTimeStamp","contentWidthUpdateDelayer","isRefreshing","refreshingPreviousChildrenIds","currentDragAndDropData","currentDropTarget","currentDropTargets","currentDropDisposable","gestureDisposable","dragAndDropScrollInterval","dragAndDropScrollTimeout","dragAndDropMouseY","highlightedItemWasDraggable","onHiddenScrollTop","_onDOMFocus","onDOMFocus","_onDOMBlur","_onDidScroll","counter","instance","horizontalScrollMode","modelListeners","viewListeners","preventRootFocus","treeStyler","styler","alwaysFocused","verticalScrollMode","msTouchAction","msContentZooming","Touch","addTarget","rowsContainer","showTwistie","focusTracker","button","onMouseMiddleClick","Tap","Change","onTouchChange","onMsPointerDown","onMsGestureTap","onThrottledMsGestureChange","lastEvent","translationY","translationX","onDrop","onDragEnd","lastRenderTop","lastRenderHeight","didJustPressContextMenuKey","shouldInvalidateDropReaction","onRowsChanged","setupMSGesture","getHTMLElement","isFocused","MSGesture","msGesture","isTreeVisible","viewHeight","viewWidth","renderTop","renderBottom","thisRenderBottom","insertItemInDOM","removeItemFromDOM","topItem","releaseModel","onRefreshing","onRefreshed","onClearingInput","onModelFocusChange","onItemChildrenRefreshing","onItemChildrenRefreshed","onItemRefresh","onItemExpanding","onItemExpanded","onItemCollapsing","onItemReveal","onItemAddTrait","onItemRemoveTrait","updateScrollWidth","keys_1","lastPageIndex","lastPageElement","previousScrollTop","firstPageIndex","firstPageElement","getScrollDimensions","getScrollPosition","MappedIterator","inputItem","showLoading","loadingTimer","LOADING_DECORATION_DELAY","childrenIds","navigator_1","childItem","previousChildrenIds_1","afterModelItems_1","navigator_2","skipDiff","doToInsertItemsAlreadyExist","Diff","getElements","ComputeDiff","modifiedLength","modifiedStart","diff_1","diffChange","originalLength","originalStart","beforeItem","onItemsRefresh","viewItemBottom","wrapperBottom","refreshViewItem","shouldBeRendered","Mouse","getItemAround","Platform","resultEvent","Keyboard","effectAllowed","setData","DataTransfers","RESOURCES","setDragImage","getDragLabel","dragImage_1","StaticDND","CurrentDragAndDropData","setupDragAndDropScrollInterval","viewTop","setInterval","scrollDiff","upperLimit","cancelDragAndDropScrollTimeout","cancelDragAndDropScrollInterval","clearInterval","DRAG_LEAVE","dropTarget","currentDropElement","reaction","bubble","canDrop","dropEffect","effect","one","currentDropElementReaction","autoExpand","timeoutPromise_1","event_1","pointerType","MSPOINTER_TYPE_MOUSE","MSPOINTER_TYPE_TOUCH","addPointer","pointerId","elementFromPoint","clientX","clientY","elementAfter","parentNode","TreeContext","TreeDefaults","Tree","_onDidChangeFocus","_onDidChangeSelection","onDidChangeSelection","_onHighlightChange","Model","View","isDOMFocused","domBlur","progressBarBackground","ProgressBar","workedVal","showDelayedScheduler","off","removeClasses","totalWork","doDone","delayed","QuickOpenController","DEFAULT_INPUT_ARIA_LABEL","QuickOpenWidget","callbacks","CONTEXT_MENU","gainingFocus","loosingFocus","KEY_DOWN","StandardKeyboardEvent","stops","currentTarget","querySelectorAll","progressBar","inputContainer","inputPlaceHolder","INPUT","onType","shouldOpenInBackground","navigateInTree","elementSelected","resultCount","treeContainer","createTree","treeCreator","treeElement","elementFocused","StandardMouseEvent","quickNavigateConfiguration","KEY_UP","keybindings","focus_3","layoutDimensions","helpText","isShift","oldFocus","newFocus","arivaActiveDescendant","keymods","extractKeyMods","runner","preferredMode","ctrlCmd","isLoosingFocus","doShowWithPrefix","restoreLastInput","doShowWithInput","autoFocus","inputSelection","onShow","lastInput","setInputAndLayout","isElementVisible","updateResultCount","autoFocusPrefixMatch","caseSensitiveMatch","caseInsensitiveMatch","lowerCasePrefix","entries_1","entryToFocus","autoFocusFirstEntry","autoFocusIndex","autoFocusSecondEntry","autoFocusLastEntry","itemHeight","minItemsToShow","preferredItemsHeight","MAX_ITEMS_HEIGHT","maxEntries","maxItemsToShow","entryHeight","onOk","onInputChanging","inputChangingTimeoutHandle","dimension","quickOpenWidth","MAX_WIDTH","relatedTarget","onFocusLost","QuickOpenEditorWidget","quickOpenWidget","inputAriaLabel","attachQuickOpenStyler","destroy","Dimension","rangeHighlightDecorationId","lastKnownEditorSelection","onClose","clearDecorations","getAutoFocus","decorateLine","BaseEditorQuickOpenAction","_inputAriaLabel","getController","searchValue","GotoLineEntry","parseResult","parseInput","numbers","diffModel","modified","validatePosition","GoToLineNLS","gotoLineLabelValidLineAndColumn","gotoLineLabelValidLine","gotoLineLabelEmptyWithLineLimit","gotoLineLabelEmptyWithLineAndColumnLimit","currentLine","gotoLineAriaLabel","runOpen","runPreview","toSelection","GotoLineAction","gotoLineActionInput","gotoLineActionLabel","EditorActionCommandEntry","keyAriaLabel","QuickCommandNLS","ariaLabelEntryWithKey","ariaLabelEntry","QuickCommandAction","quickCommandActionInput","quickCommandActionLabel","_editorActionsToEntries","_sort","elementA","elementB","elementAName","elementBName","getSupportedActions","matchesFuzzy","TreeElement","findId","candidateId","_key","OutlineElement","OutlineGroup","providerIndex","MovingAverage","_n","_val","OutlineModel","_groups","_keys","for","_requests","promiseCnt","_create","now_1","avg","_requestDurations","DocumentSymbolProviderRegistry","provideDocumentSymbols","_makeOutlineElement","newProvider","_compact","childInfo","_counter","_hash","getDocumentSymbols","flat","roots","flatEntries","overrideContainerLabel","containerName","selectionRange","compareEntriesUsingStart","SymbolEntry","QuickOutlineNLS","entryAriaLabel","getRange","QuickOutlineAction","quickOutlineActionInput","quickOutlineActionLabel","hasDocumentSymbolProvider","toQuickOpenEntries","symbolEntry","flattened","normalizedSearchValue","flattened_1","SymbolKinds","toCssClassName","sortScoped","sortNormal","currentType","currentResult","typeCounter","typeToLabel","_symbols_","_modules_","_class_","_interface_","_method_","_function_","_property_","_variable_","_variable2_","_constructor_","_call_","elementARange","elementBRange","elementAType","elementBType","r_1","StandaloneReferencesController","configurationService","ToggleHighContrast","ToggleHighContrastNLS","toggleHighContrast","_originalThemeName","standaloneThemeService","setTheme","themeName"],"mappings":"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","file":"static/js/4.47bf0eec.chunk.js","sourcesContent":["import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { typescriptVersion } from './lib/typescriptServicesMetadata.js'; // do not import the whole typescriptServices here\r\nvar Emitter = monaco.Emitter;\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(compilerOptions, diagnosticsOptions) {\r\n        this._onDidChange = new Emitter();\r\n        this._onDidExtraLibsChange = new Emitter();\r\n        this._extraLibs = Object.create(null);\r\n        this._eagerModelSync = false;\r\n        this.setCompilerOptions(compilerOptions);\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this._onDidExtraLibsChangeTimeout = -1;\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidExtraLibsChange\", {\r\n        get: function () {\r\n            return this._onDidExtraLibsChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.getExtraLibs = function () {\r\n        return this._extraLibs;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.addExtraLib = function (content, _filePath) {\r\n        var _this = this;\r\n        var filePath;\r\n        if (typeof _filePath === 'undefined') {\r\n            filePath = \"ts:extralib-\" + Math.random().toString(36).substring(2, 15);\r\n        }\r\n        else {\r\n            filePath = _filePath;\r\n        }\r\n        if (this._extraLibs[filePath] && this._extraLibs[filePath].content === content) {\r\n            // no-op, there already exists an extra lib with this content\r\n            return {\r\n                dispose: function () { }\r\n            };\r\n        }\r\n        var myVersion = 1;\r\n        if (this._extraLibs[filePath]) {\r\n            myVersion = this._extraLibs[filePath].version + 1;\r\n        }\r\n        this._extraLibs[filePath] = {\r\n            content: content,\r\n            version: myVersion,\r\n        };\r\n        this._fireOnDidExtraLibsChangeSoon();\r\n        return {\r\n            dispose: function () {\r\n                var extraLib = _this._extraLibs[filePath];\r\n                if (!extraLib) {\r\n                    return;\r\n                }\r\n                if (extraLib.version !== myVersion) {\r\n                    return;\r\n                }\r\n                delete _this._extraLibs[filePath];\r\n                _this._fireOnDidExtraLibsChangeSoon();\r\n            }\r\n        };\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setExtraLibs = function (libs) {\r\n        // clear out everything\r\n        this._extraLibs = Object.create(null);\r\n        if (libs && libs.length > 0) {\r\n            for (var _i = 0, libs_1 = libs; _i < libs_1.length; _i++) {\r\n                var lib = libs_1[_i];\r\n                var filePath = lib.filePath || \"ts:extralib-\" + Math.random().toString(36).substring(2, 15);\r\n                var content = lib.content;\r\n                this._extraLibs[filePath] = {\r\n                    content: content,\r\n                    version: 1\r\n                };\r\n            }\r\n        }\r\n        this._fireOnDidExtraLibsChangeSoon();\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype._fireOnDidExtraLibsChangeSoon = function () {\r\n        var _this = this;\r\n        if (this._onDidExtraLibsChangeTimeout !== -1) {\r\n            // already scheduled\r\n            return;\r\n        }\r\n        this._onDidExtraLibsChangeTimeout = setTimeout(function () {\r\n            _this._onDidExtraLibsChangeTimeout = -1;\r\n            _this._onDidExtraLibsChange.fire(undefined);\r\n        }, 0);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getCompilerOptions = function () {\r\n        return this._compilerOptions;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setCompilerOptions = function (options) {\r\n        this._compilerOptions = options || Object.create(null);\r\n        this._onDidChange.fire(undefined);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getDiagnosticsOptions = function () {\r\n        return this._diagnosticsOptions;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(undefined);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setMaximumWorkerIdleTime = function (value) {\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setEagerModelSync = function (value) {\r\n        // doesn't fire an event since no\r\n        // worker restart is required here\r\n        this._eagerModelSync = value;\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.getEagerModelSync = function () {\r\n        return this._eagerModelSync;\r\n    };\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\n//#region enums copied from typescript to prevent loading the entire typescriptServices ---\r\nvar ModuleKind;\r\n(function (ModuleKind) {\r\n    ModuleKind[ModuleKind[\"None\"] = 0] = \"None\";\r\n    ModuleKind[ModuleKind[\"CommonJS\"] = 1] = \"CommonJS\";\r\n    ModuleKind[ModuleKind[\"AMD\"] = 2] = \"AMD\";\r\n    ModuleKind[ModuleKind[\"UMD\"] = 3] = \"UMD\";\r\n    ModuleKind[ModuleKind[\"System\"] = 4] = \"System\";\r\n    ModuleKind[ModuleKind[\"ES2015\"] = 5] = \"ES2015\";\r\n    ModuleKind[ModuleKind[\"ESNext\"] = 99] = \"ESNext\";\r\n})(ModuleKind || (ModuleKind = {}));\r\nvar JsxEmit;\r\n(function (JsxEmit) {\r\n    JsxEmit[JsxEmit[\"None\"] = 0] = \"None\";\r\n    JsxEmit[JsxEmit[\"Preserve\"] = 1] = \"Preserve\";\r\n    JsxEmit[JsxEmit[\"React\"] = 2] = \"React\";\r\n    JsxEmit[JsxEmit[\"ReactNative\"] = 3] = \"ReactNative\";\r\n})(JsxEmit || (JsxEmit = {}));\r\nvar NewLineKind;\r\n(function (NewLineKind) {\r\n    NewLineKind[NewLineKind[\"CarriageReturnLineFeed\"] = 0] = \"CarriageReturnLineFeed\";\r\n    NewLineKind[NewLineKind[\"LineFeed\"] = 1] = \"LineFeed\";\r\n})(NewLineKind || (NewLineKind = {}));\r\nvar ScriptTarget;\r\n(function (ScriptTarget) {\r\n    ScriptTarget[ScriptTarget[\"ES3\"] = 0] = \"ES3\";\r\n    ScriptTarget[ScriptTarget[\"ES5\"] = 1] = \"ES5\";\r\n    ScriptTarget[ScriptTarget[\"ES2015\"] = 2] = \"ES2015\";\r\n    ScriptTarget[ScriptTarget[\"ES2016\"] = 3] = \"ES2016\";\r\n    ScriptTarget[ScriptTarget[\"ES2017\"] = 4] = \"ES2017\";\r\n    ScriptTarget[ScriptTarget[\"ES2018\"] = 5] = \"ES2018\";\r\n    ScriptTarget[ScriptTarget[\"ES2019\"] = 6] = \"ES2019\";\r\n    ScriptTarget[ScriptTarget[\"ES2020\"] = 7] = \"ES2020\";\r\n    ScriptTarget[ScriptTarget[\"ESNext\"] = 99] = \"ESNext\";\r\n    ScriptTarget[ScriptTarget[\"JSON\"] = 100] = \"JSON\";\r\n    ScriptTarget[ScriptTarget[\"Latest\"] = 99] = \"Latest\";\r\n})(ScriptTarget || (ScriptTarget = {}));\r\nvar ModuleResolutionKind;\r\n(function (ModuleResolutionKind) {\r\n    ModuleResolutionKind[ModuleResolutionKind[\"Classic\"] = 1] = \"Classic\";\r\n    ModuleResolutionKind[ModuleResolutionKind[\"NodeJs\"] = 2] = \"NodeJs\";\r\n})(ModuleResolutionKind || (ModuleResolutionKind = {}));\r\n//#endregion\r\nvar typescriptDefaults = new LanguageServiceDefaultsImpl({ allowNonTsExtensions: true, target: ScriptTarget.Latest }, { noSemanticValidation: false, noSyntaxValidation: false });\r\nvar javascriptDefaults = new LanguageServiceDefaultsImpl({ allowNonTsExtensions: true, allowJs: true, target: ScriptTarget.Latest }, { noSemanticValidation: true, noSyntaxValidation: false });\r\nfunction getTypeScriptWorker() {\r\n    return getMode().then(function (mode) { return mode.getTypeScriptWorker(); });\r\n}\r\nfunction getJavaScriptWorker() {\r\n    return getMode().then(function (mode) { return mode.getJavaScriptWorker(); });\r\n}\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        ModuleKind: ModuleKind,\r\n        JsxEmit: JsxEmit,\r\n        NewLineKind: NewLineKind,\r\n        ScriptTarget: ScriptTarget,\r\n        ModuleResolutionKind: ModuleResolutionKind,\r\n        typescriptVersion: typescriptVersion,\r\n        typescriptDefaults: typescriptDefaults,\r\n        javascriptDefaults: javascriptDefaults,\r\n        getTypeScriptWorker: getTypeScriptWorker,\r\n        getJavaScriptWorker: getJavaScriptWorker\r\n    };\r\n}\r\nmonaco.languages.typescript = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./tsMode.js');\r\n}\r\nmonaco.languages.onLanguage('typescript', function () {\r\n    return getMode().then(function (mode) { return mode.setupTypeScript(typescriptDefaults); });\r\n});\r\nmonaco.languages.onLanguage('javascript', function () {\r\n    return getMode().then(function (mode) { return mode.setupJavaScript(javascriptDefaults); });\r\n});\r\n","export var typescriptVersion = \"3.7.5\";\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- CSS configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, diagnosticsOptions, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"diagnosticsOptions\", {\r\n        get: function () {\r\n            return this._diagnosticsOptions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar diagnosticDefault = {\r\n    validate: true,\r\n    lint: {\r\n        compatibleVendorPrefixes: 'ignore',\r\n        vendorPrefix: 'warning',\r\n        duplicateProperties: 'warning',\r\n        emptyRules: 'warning',\r\n        importStatement: 'ignore',\r\n        boxModel: 'ignore',\r\n        universalSelector: 'ignore',\r\n        zeroUnits: 'ignore',\r\n        fontFaceProperties: 'warning',\r\n        hexColorLength: 'error',\r\n        argumentsInColorFunction: 'error',\r\n        unknownProperties: 'warning',\r\n        ieHack: 'ignore',\r\n        unknownVendorSpecificProperties: 'ignore',\r\n        propertyIgnoredDueToDisplay: 'warning',\r\n        important: 'ignore',\r\n        float: 'ignore',\r\n        idSelector: 'ignore'\r\n    }\r\n};\r\nvar modeConfigurationDefault = {\r\n    completionItems: true,\r\n    hovers: true,\r\n    documentSymbols: true,\r\n    definitions: true,\r\n    references: true,\r\n    documentHighlights: true,\r\n    rename: true,\r\n    colors: true,\r\n    foldingRanges: true,\r\n    diagnostics: true,\r\n    selectionRanges: true\r\n};\r\nvar cssDefaults = new LanguageServiceDefaultsImpl('css', diagnosticDefault, modeConfigurationDefault);\r\nvar scssDefaults = new LanguageServiceDefaultsImpl('scss', diagnosticDefault, modeConfigurationDefault);\r\nvar lessDefaults = new LanguageServiceDefaultsImpl('less', diagnosticDefault, modeConfigurationDefault);\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        cssDefaults: cssDefaults,\r\n        lessDefaults: lessDefaults,\r\n        scssDefaults: scssDefaults\r\n    };\r\n}\r\nmonaco.languages.css = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./cssMode.js');\r\n}\r\nmonaco.languages.onLanguage('less', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(lessDefaults); });\r\n});\r\nmonaco.languages.onLanguage('scss', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(scssDefaults); });\r\n});\r\nmonaco.languages.onLanguage('css', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(cssDefaults); });\r\n});\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- JSON configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, diagnosticsOptions, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setDiagnosticsOptions(diagnosticsOptions);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"diagnosticsOptions\", {\r\n        get: function () {\r\n            return this._diagnosticsOptions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setDiagnosticsOptions = function (options) {\r\n        this._diagnosticsOptions = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar diagnosticDefault = {\r\n    validate: true,\r\n    allowComments: true,\r\n    schemas: [],\r\n    enableSchemaRequest: false\r\n};\r\nvar modeConfigurationDefault = {\r\n    documentFormattingEdits: true,\r\n    documentRangeFormattingEdits: true,\r\n    completionItems: true,\r\n    hovers: true,\r\n    documentSymbols: true,\r\n    tokens: true,\r\n    colors: true,\r\n    foldingRanges: true,\r\n    diagnostics: true,\r\n    selectionRanges: true\r\n};\r\nvar jsonDefaults = new LanguageServiceDefaultsImpl('json', diagnosticDefault, modeConfigurationDefault);\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        jsonDefaults: jsonDefaults\r\n    };\r\n}\r\nmonaco.languages.json = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./jsonMode.js');\r\n}\r\nmonaco.languages.register({\r\n    id: 'json',\r\n    extensions: ['.json', '.bowerrc', '.jshintrc', '.jscsrc', '.eslintrc', '.babelrc', '.har'],\r\n    aliases: ['JSON', 'json'],\r\n    mimetypes: ['application/json'],\r\n});\r\nmonaco.languages.onLanguage('json', function () {\r\n    getMode().then(function (mode) { return mode.setupMode(jsonDefaults); });\r\n});\r\n","import '../../editor/editor.api.js';\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nvar Emitter = monaco.Emitter;\r\n// --- HTML configuration and defaults ---------\r\nvar LanguageServiceDefaultsImpl = /** @class */ (function () {\r\n    function LanguageServiceDefaultsImpl(languageId, options, modeConfiguration) {\r\n        this._onDidChange = new Emitter();\r\n        this._languageId = languageId;\r\n        this.setOptions(options);\r\n        this.setModeConfiguration(modeConfiguration);\r\n    }\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"onDidChange\", {\r\n        get: function () {\r\n            return this._onDidChange.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"options\", {\r\n        get: function () {\r\n            return this._options;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LanguageServiceDefaultsImpl.prototype, \"modeConfiguration\", {\r\n        get: function () {\r\n            return this._modeConfiguration;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LanguageServiceDefaultsImpl.prototype.setOptions = function (options) {\r\n        this._options = options || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    LanguageServiceDefaultsImpl.prototype.setModeConfiguration = function (modeConfiguration) {\r\n        this._modeConfiguration = modeConfiguration || Object.create(null);\r\n        this._onDidChange.fire(this);\r\n    };\r\n    ;\r\n    return LanguageServiceDefaultsImpl;\r\n}());\r\nexport { LanguageServiceDefaultsImpl };\r\nvar formatDefaults = {\r\n    tabSize: 4,\r\n    insertSpaces: false,\r\n    wrapLineLength: 120,\r\n    unformatted: 'default\": \"a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',\r\n    contentUnformatted: 'pre',\r\n    indentInnerHtml: false,\r\n    preserveNewLines: true,\r\n    maxPreserveNewLines: null,\r\n    indentHandlebars: false,\r\n    endWithNewline: false,\r\n    extraLiners: 'head, body, /html',\r\n    wrapAttributes: 'auto'\r\n};\r\nvar htmlOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true, angular1: true, ionic: true }\r\n};\r\nvar handlebarOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true }\r\n};\r\nvar razorOptionsDefault = {\r\n    format: formatDefaults,\r\n    suggest: { html5: true, razor: true }\r\n};\r\nfunction getConfigurationDefault(languageId) {\r\n    return {\r\n        completionItems: true,\r\n        hovers: true,\r\n        documentSymbols: true,\r\n        links: true,\r\n        documentHighlights: true,\r\n        rename: true,\r\n        colors: true,\r\n        foldingRanges: true,\r\n        selectionRanges: true,\r\n        diagnostics: languageId === htmlLanguageId,\r\n        documentFormattingEdits: languageId === htmlLanguageId,\r\n        documentRangeFormattingEdits: languageId === htmlLanguageId // turned off for Razor and Handlebar\r\n    };\r\n}\r\nvar htmlLanguageId = 'html';\r\nvar handlebarsLanguageId = 'handlebars';\r\nvar razorLanguageId = 'razor';\r\nvar htmlDefaults = new LanguageServiceDefaultsImpl(htmlLanguageId, htmlOptionsDefault, getConfigurationDefault(htmlLanguageId));\r\nvar handlebarDefaults = new LanguageServiceDefaultsImpl(handlebarsLanguageId, handlebarOptionsDefault, getConfigurationDefault(handlebarsLanguageId));\r\nvar razorDefaults = new LanguageServiceDefaultsImpl(razorLanguageId, razorOptionsDefault, getConfigurationDefault(razorLanguageId));\r\n// Export API\r\nfunction createAPI() {\r\n    return {\r\n        htmlDefaults: htmlDefaults,\r\n        razorDefaults: razorDefaults,\r\n        handlebarDefaults: handlebarDefaults\r\n    };\r\n}\r\nmonaco.languages.html = createAPI();\r\n// --- Registration to monaco editor ---\r\nfunction getMode() {\r\n    return import('./htmlMode.js');\r\n}\r\nmonaco.languages.onLanguage(htmlLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(htmlDefaults); });\r\n});\r\nmonaco.languages.onLanguage(handlebarsLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(handlebarDefaults); });\r\n});\r\nmonaco.languages.onLanguage(razorLanguageId, function () {\r\n    getMode().then(function (mode) { return mode.setupMode(razorDefaults); });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\n// Allow for running under nodejs/requirejs in tests\r\nvar _monaco = (typeof monaco === 'undefined' ? self.monaco : monaco);\r\nvar languageDefinitions = {};\r\nvar lazyLanguageLoaders = {};\r\nvar LazyLanguageLoader = /** @class */ (function () {\r\n    function LazyLanguageLoader(languageId) {\r\n        var _this = this;\r\n        this._languageId = languageId;\r\n        this._loadingTriggered = false;\r\n        this._lazyLoadPromise = new Promise(function (resolve, reject) {\r\n            _this._lazyLoadPromiseResolve = resolve;\r\n            _this._lazyLoadPromiseReject = reject;\r\n        });\r\n    }\r\n    LazyLanguageLoader.getOrCreate = function (languageId) {\r\n        if (!lazyLanguageLoaders[languageId]) {\r\n            lazyLanguageLoaders[languageId] = new LazyLanguageLoader(languageId);\r\n        }\r\n        return lazyLanguageLoaders[languageId];\r\n    };\r\n    LazyLanguageLoader.prototype.whenLoaded = function () {\r\n        return this._lazyLoadPromise;\r\n    };\r\n    LazyLanguageLoader.prototype.load = function () {\r\n        var _this = this;\r\n        if (!this._loadingTriggered) {\r\n            this._loadingTriggered = true;\r\n            languageDefinitions[this._languageId].loader().then(function (mod) { return _this._lazyLoadPromiseResolve(mod); }, function (err) { return _this._lazyLoadPromiseReject(err); });\r\n        }\r\n        return this._lazyLoadPromise;\r\n    };\r\n    return LazyLanguageLoader;\r\n}());\r\nexport function loadLanguage(languageId) {\r\n    return LazyLanguageLoader.getOrCreate(languageId).load();\r\n}\r\nexport function registerLanguage(def) {\r\n    var languageId = def.id;\r\n    languageDefinitions[languageId] = def;\r\n    _monaco.languages.register(def);\r\n    var lazyLanguageLoader = LazyLanguageLoader.getOrCreate(languageId);\r\n    _monaco.languages.setMonarchTokensProvider(languageId, lazyLanguageLoader.whenLoaded().then(function (mod) { return mod.language; }));\r\n    _monaco.languages.onLanguage(languageId, function () {\r\n        lazyLanguageLoader.load().then(function (mod) {\r\n            _monaco.languages.setLanguageConfiguration(languageId, mod.conf);\r\n        });\r\n    });\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'abap',\r\n    extensions: ['.abap'],\r\n    aliases: ['abap', 'ABAP'],\r\n    loader: function () { return import('./abap.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'apex',\r\n    extensions: ['.cls'],\r\n    aliases: ['Apex', 'apex'],\r\n    mimetypes: ['text/x-apex-source', 'text/x-apex'],\r\n    loader: function () { return import('./apex.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'azcli',\r\n    extensions: ['.azcli'],\r\n    aliases: ['Azure CLI', 'azcli'],\r\n    loader: function () { return import('./azcli.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'bat',\r\n    extensions: ['.bat', '.cmd'],\r\n    aliases: ['Batch', 'bat'],\r\n    loader: function () { return import('./bat.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'cameligo',\r\n    extensions: ['.mligo'],\r\n    aliases: ['Cameligo'],\r\n    loader: function () { return import('./cameligo.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'clojure',\r\n    extensions: ['.clj', '.cljs', '.cljc', '.edn'],\r\n    aliases: ['clojure', 'Clojure'],\r\n    loader: function () { return import('./clojure.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'coffeescript',\r\n    extensions: ['.coffee'],\r\n    aliases: ['CoffeeScript', 'coffeescript', 'coffee'],\r\n    mimetypes: ['text/x-coffeescript', 'text/coffeescript'],\r\n    loader: function () { return import('./coffee.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'c',\r\n    extensions: ['.c', '.h'],\r\n    aliases: ['C', 'c'],\r\n    loader: function () { return import('./cpp.js'); }\r\n});\r\nregisterLanguage({\r\n    id: 'cpp',\r\n    extensions: ['.cpp', '.cc', '.cxx', '.hpp', '.hh', '.hxx'],\r\n    aliases: ['C++', 'Cpp', 'cpp'],\r\n    loader: function () { return import('./cpp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'csharp',\r\n    extensions: ['.cs', '.csx', '.cake'],\r\n    aliases: ['C#', 'csharp'],\r\n    loader: function () { return import('./csharp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'csp',\r\n    extensions: [],\r\n    aliases: ['CSP', 'csp'],\r\n    loader: function () { return import('./csp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'css',\r\n    extensions: ['.css'],\r\n    aliases: ['CSS', 'css'],\r\n    mimetypes: ['text/css'],\r\n    loader: function () { return import('./css.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'dockerfile',\r\n    extensions: ['.dockerfile'],\r\n    filenames: ['Dockerfile'],\r\n    aliases: ['Dockerfile'],\r\n    loader: function () { return import('./dockerfile.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'fsharp',\r\n    extensions: ['.fs', '.fsi', '.ml', '.mli', '.fsx', '.fsscript'],\r\n    aliases: ['F#', 'FSharp', 'fsharp'],\r\n    loader: function () { return import('./fsharp.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'go',\r\n    extensions: ['.go'],\r\n    aliases: ['Go'],\r\n    loader: function () { return import('./go.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'graphql',\r\n    extensions: ['.graphql', '.gql'],\r\n    aliases: ['GraphQL', 'graphql', 'gql'],\r\n    mimetypes: ['application/graphql'],\r\n    loader: function () { return import('./graphql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'handlebars',\r\n    extensions: ['.handlebars', '.hbs'],\r\n    aliases: ['Handlebars', 'handlebars'],\r\n    mimetypes: ['text/x-handlebars-template'],\r\n    loader: function () { return import('./handlebars.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'html',\r\n    extensions: ['.html', '.htm', '.shtml', '.xhtml', '.mdoc', '.jsp', '.asp', '.aspx', '.jshtm'],\r\n    aliases: ['HTML', 'htm', 'html', 'xhtml'],\r\n    mimetypes: ['text/html', 'text/x-jshtm', 'text/template', 'text/ng-template'],\r\n    loader: function () { return import('./html.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'ini',\r\n    extensions: ['.ini', '.properties', '.gitconfig'],\r\n    filenames: ['config', '.gitattributes', '.gitconfig', '.editorconfig'],\r\n    aliases: ['Ini', 'ini'],\r\n    loader: function () { return import('./ini.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'java',\r\n    extensions: ['.java', '.jav'],\r\n    aliases: ['Java', 'java'],\r\n    mimetypes: ['text/x-java-source', 'text/x-java'],\r\n    loader: function () { return import('./java.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'javascript',\r\n    extensions: ['.js', '.es6', '.jsx'],\r\n    firstLine: '^#!.*\\\\bnode',\r\n    filenames: ['jakefile'],\r\n    aliases: ['JavaScript', 'javascript', 'js'],\r\n    mimetypes: ['text/javascript'],\r\n    loader: function () { return import('./javascript.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'kotlin',\r\n    extensions: ['.kt'],\r\n    aliases: ['Kotlin', 'kotlin'],\r\n    mimetypes: ['text/x-kotlin-source', 'text/x-kotlin'],\r\n    loader: function () { return import('./kotlin.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'less',\r\n    extensions: ['.less'],\r\n    aliases: ['Less', 'less'],\r\n    mimetypes: ['text/x-less', 'text/less'],\r\n    loader: function () { return import('./less.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'lua',\r\n    extensions: ['.lua'],\r\n    aliases: ['Lua', 'lua'],\r\n    loader: function () { return import('./lua.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'markdown',\r\n    extensions: ['.md', '.markdown', '.mdown', '.mkdn', '.mkd', '.mdwn', '.mdtxt', '.mdtext'],\r\n    aliases: ['Markdown', 'markdown'],\r\n    loader: function () { return import('./markdown.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'mips',\r\n    extensions: ['.s'],\r\n    aliases: ['MIPS', 'MIPS-V'],\r\n    mimetypes: ['text/x-mips', 'text/mips', 'text/plaintext'],\r\n    loader: function () { return import('./mips.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'msdax',\r\n    extensions: ['.dax', '.msdax'],\r\n    aliases: ['DAX', 'MSDAX'],\r\n    loader: function () { return import('./msdax.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'mysql',\r\n    extensions: [],\r\n    aliases: ['MySQL', 'mysql'],\r\n    loader: function () { return import('./mysql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'objective-c',\r\n    extensions: ['.m'],\r\n    aliases: ['Objective-C'],\r\n    loader: function () { return import('./objective-c.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pascal',\r\n    extensions: ['.pas', '.p', '.pp'],\r\n    aliases: ['Pascal', 'pas'],\r\n    mimetypes: ['text/x-pascal-source', 'text/x-pascal'],\r\n    loader: function () { return import('./pascal.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pascaligo',\r\n    extensions: ['.ligo'],\r\n    aliases: ['Pascaligo', 'ligo'],\r\n    loader: function () { return import('./pascaligo.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n*  Copyright (c) Microsoft Corporation. All rights reserved.\r\n*  Licensed under the MIT License. See License.txt in the project root for license information.\r\n*--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'perl',\r\n    extensions: ['.pl'],\r\n    aliases: ['Perl', 'pl'],\r\n    loader: function () { return import('./perl.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pgsql',\r\n    extensions: [],\r\n    aliases: ['PostgreSQL', 'postgres', 'pg', 'postgre'],\r\n    loader: function () { return import('./pgsql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'php',\r\n    extensions: ['.php', '.php4', '.php5', '.phtml', '.ctp'],\r\n    aliases: ['PHP', 'php'],\r\n    mimetypes: ['application/x-php'],\r\n    loader: function () { return import('./php.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'postiats',\r\n    extensions: ['.dats', '.sats', '.hats'],\r\n    aliases: ['ATS', 'ATS/Postiats'],\r\n    loader: function () { return import('./postiats.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'powerquery',\r\n    extensions: ['.pq', '.pqm'],\r\n    aliases: ['PQ', 'M', 'Power Query', 'Power Query M'],\r\n    loader: function () { return import('./powerquery.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'powershell',\r\n    extensions: ['.ps1', '.psm1', '.psd1'],\r\n    aliases: ['PowerShell', 'powershell', 'ps', 'ps1'],\r\n    loader: function () { return import('./powershell.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'pug',\r\n    extensions: ['.jade', '.pug'],\r\n    aliases: ['Pug', 'Jade', 'jade'],\r\n    loader: function () { return import('./pug.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'python',\r\n    extensions: ['.py', '.rpy', '.pyw', '.cpy', '.gyp', '.gypi'],\r\n    aliases: ['Python', 'py'],\r\n    firstLine: '^#!/.*\\\\bpython[0-9.-]*\\\\b',\r\n    loader: function () { return import('./python.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'r',\r\n    extensions: ['.r', '.rhistory', '.rprofile', '.rt'],\r\n    aliases: ['R', 'r'],\r\n    loader: function () { return import('./r.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'razor',\r\n    extensions: ['.cshtml'],\r\n    aliases: ['Razor', 'razor'],\r\n    mimetypes: ['text/x-cshtml'],\r\n    loader: function () { return import('./razor.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'redis',\r\n    extensions: ['.redis'],\r\n    aliases: ['redis'],\r\n    loader: function () { return import('./redis.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'redshift',\r\n    extensions: [],\r\n    aliases: ['Redshift', 'redshift'],\r\n    loader: function () { return import('./redshift.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'restructuredtext',\r\n    extensions: ['.rst'],\r\n    aliases: ['reStructuredText', 'restructuredtext'],\r\n    loader: function () { return import('./restructuredtext.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'ruby',\r\n    extensions: ['.rb', '.rbx', '.rjs', '.gemspec', '.pp'],\r\n    filenames: ['rakefile'],\r\n    aliases: ['Ruby', 'rb'],\r\n    loader: function () { return import('./ruby.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'rust',\r\n    extensions: ['.rs', '.rlib'],\r\n    aliases: ['Rust', 'rust'],\r\n    loader: function () { return import('./rust.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sb',\r\n    extensions: ['.sb'],\r\n    aliases: ['Small Basic', 'sb'],\r\n    loader: function () { return import('./sb.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'scheme',\r\n    extensions: ['.scm', '.ss', '.sch', '.rkt'],\r\n    aliases: ['scheme', 'Scheme'],\r\n    loader: function () { return import('./scheme.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'scss',\r\n    extensions: ['.scss'],\r\n    aliases: ['Sass', 'sass', 'scss'],\r\n    mimetypes: ['text/x-scss', 'text/scss'],\r\n    loader: function () { return import('./scss.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n*  Copyright (c) Microsoft Corporation. All rights reserved.\r\n*  Licensed under the MIT License. See License.txt in the project root for license information.\r\n*--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'shell',\r\n    extensions: ['.sh', '.bash'],\r\n    aliases: ['Shell', 'sh'],\r\n    loader: function () { return import('./shell.js'); },\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sol',\r\n    extensions: ['.sol'],\r\n    aliases: ['sol', 'solidity', 'Solidity'],\r\n    loader: function () { return import('./solidity.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'aes',\r\n    extensions: ['.aes'],\r\n    aliases: ['aes', 'sophia', 'Sophia'],\r\n    loader: function () { return import('./sophia.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'sql',\r\n    extensions: ['.sql'],\r\n    aliases: ['SQL'],\r\n    loader: function () { return import('./sql.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'st',\r\n    extensions: ['.st', '.iecst', '.iecplc', '.lc3lib'],\r\n    aliases: ['StructuredText', 'scl', 'stl'],\r\n    loader: function () { return import('./st.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'swift',\r\n    aliases: ['Swift', 'swift'],\r\n    extensions: ['.swift'],\r\n    mimetypes: ['text/swift'],\r\n    loader: function () { return import('./swift.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'tcl',\r\n    extensions: ['.tcl'],\r\n    aliases: ['tcl', 'Tcl', 'tcltk', 'TclTk', 'tcl/tk', 'Tcl/Tk'],\r\n    loader: function () { return import('./tcl.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'twig',\r\n    extensions: ['.twig'],\r\n    aliases: ['Twig', 'twig'],\r\n    mimetypes: ['text/x-twig'],\r\n    loader: function () { return import('./twig.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'typescript',\r\n    extensions: ['.ts', '.tsx'],\r\n    aliases: ['TypeScript', 'ts', 'typescript'],\r\n    mimetypes: ['text/typescript'],\r\n    loader: function () { return import('./typescript.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'vb',\r\n    extensions: ['.vb'],\r\n    aliases: ['Visual Basic', 'vb'],\r\n    loader: function () { return import('./vb.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'xml',\r\n    extensions: ['.xml', '.dtd', '.ascx', '.csproj', '.config', '.wxi', '.wxl', '.wxs', '.xaml', '.svg', '.svgz', '.opf', '.xsl'],\r\n    firstLine: '(\\\\<\\\\?xml.*)|(\\\\<svg)|(\\\\<\\\\!doctype\\\\s+svg)',\r\n    aliases: ['XML', 'xml'],\r\n    mimetypes: ['text/xml', 'application/xml', 'application/xaml+xml', 'application/xml-dtd'],\r\n    loader: function () { return import('./xml.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'yaml',\r\n    extensions: ['.yaml', '.yml'],\r\n    aliases: ['YAML', 'yaml', 'YML', 'yml'],\r\n    mimetypes: ['application/x-yaml'],\r\n    loader: function () { return import('./yaml.js'); }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './bracketMatching.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { editorBracketMatchBackground, editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nvar overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', { dark: '#A0A0A0', light: '#A0A0A0', hc: '#A0A0A0' }, nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\r\nvar JumpToBracketAction = /** @class */ (function (_super) {\r\n    __extends(JumpToBracketAction, _super);\r\n    function JumpToBracketAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.jumpToBracket',\r\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\r\n            alias: 'Go to Bracket',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 88 /* US_BACKSLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    JumpToBracketAction.prototype.run = function (accessor, editor) {\r\n        var controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.jumpToBracket();\r\n    };\r\n    return JumpToBracketAction;\r\n}(EditorAction));\r\nvar SelectToBracketAction = /** @class */ (function (_super) {\r\n    __extends(SelectToBracketAction, _super);\r\n    function SelectToBracketAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.selectToBracket',\r\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\r\n            alias: 'Select to Bracket',\r\n            precondition: undefined,\r\n            description: {\r\n                description: \"Select to Bracket\",\r\n                args: [{\r\n                        name: 'args',\r\n                        schema: {\r\n                            type: 'object',\r\n                            properties: {\r\n                                'selectBrackets': {\r\n                                    type: 'boolean',\r\n                                    default: true\r\n                                }\r\n                            },\r\n                        }\r\n                    }]\r\n            }\r\n        }) || this;\r\n    }\r\n    SelectToBracketAction.prototype.run = function (accessor, editor, args) {\r\n        var controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var selectBrackets = true;\r\n        if (args && args.selectBrackets === false) {\r\n            selectBrackets = false;\r\n        }\r\n        controller.selectToBracket(selectBrackets);\r\n    };\r\n    return SelectToBracketAction;\r\n}(EditorAction));\r\nvar BracketsData = /** @class */ (function () {\r\n    function BracketsData(position, brackets, options) {\r\n        this.position = position;\r\n        this.brackets = brackets;\r\n        this.options = options;\r\n    }\r\n    return BracketsData;\r\n}());\r\nvar BracketMatchingController = /** @class */ (function (_super) {\r\n    __extends(BracketMatchingController, _super);\r\n    function BracketMatchingController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._lastBracketsData = [];\r\n        _this._lastVersionId = 0;\r\n        _this._decorations = [];\r\n        _this._updateBracketsSoon = _this._register(new RunOnceScheduler(function () { return _this._updateBrackets(); }, 50));\r\n        _this._matchBrackets = _this._editor.getOption(53 /* matchBrackets */);\r\n        _this._updateBracketsSoon.schedule();\r\n        _this._register(editor.onDidChangeCursorPosition(function (e) {\r\n            if (_this._matchBrackets === 'never') {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModelContent(function (e) {\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._lastBracketsData = [];\r\n            _this._decorations = [];\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeModelLanguageConfiguration(function (e) {\r\n            _this._lastBracketsData = [];\r\n            _this._updateBracketsSoon.schedule();\r\n        }));\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(53 /* matchBrackets */)) {\r\n                _this._matchBrackets = _this._editor.getOption(53 /* matchBrackets */);\r\n                _this._decorations = _this._editor.deltaDecorations(_this._decorations, []);\r\n                _this._lastBracketsData = [];\r\n                _this._lastVersionId = 0;\r\n                _this._updateBracketsSoon.schedule();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    BracketMatchingController.get = function (editor) {\r\n        return editor.getContribution(BracketMatchingController.ID);\r\n    };\r\n    BracketMatchingController.prototype.jumpToBracket = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var newSelections = this._editor.getSelections().map(function (selection) {\r\n            var position = selection.getStartPosition();\r\n            // find matching brackets if position is on a bracket\r\n            var brackets = model.matchBracket(position);\r\n            var newCursorPosition = null;\r\n            if (brackets) {\r\n                if (brackets[0].containsPosition(position)) {\r\n                    newCursorPosition = brackets[1].getStartPosition();\r\n                }\r\n                else if (brackets[1].containsPosition(position)) {\r\n                    newCursorPosition = brackets[0].getStartPosition();\r\n                }\r\n            }\r\n            else {\r\n                // find the enclosing brackets if the position isn't on a matching bracket\r\n                var enclosingBrackets = model.findEnclosingBrackets(position);\r\n                if (enclosingBrackets) {\r\n                    newCursorPosition = enclosingBrackets[0].getStartPosition();\r\n                }\r\n                else {\r\n                    // no enclosing brackets, try the very first next bracket\r\n                    var nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        newCursorPosition = nextBracket.range.getStartPosition();\r\n                    }\r\n                }\r\n            }\r\n            if (newCursorPosition) {\r\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\r\n            }\r\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        });\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealRange(newSelections[0]);\r\n    };\r\n    BracketMatchingController.prototype.selectToBracket = function (selectBrackets) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var newSelections = [];\r\n        this._editor.getSelections().forEach(function (selection) {\r\n            var position = selection.getStartPosition();\r\n            var brackets = model.matchBracket(position);\r\n            if (!brackets) {\r\n                brackets = model.findEnclosingBrackets(position);\r\n                if (!brackets) {\r\n                    var nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        brackets = model.matchBracket(nextBracket.range.getStartPosition());\r\n                    }\r\n                }\r\n            }\r\n            var selectFrom = null;\r\n            var selectTo = null;\r\n            if (brackets) {\r\n                brackets.sort(Range.compareRangesUsingStarts);\r\n                var open_1 = brackets[0], close_1 = brackets[1];\r\n                selectFrom = selectBrackets ? open_1.getStartPosition() : open_1.getEndPosition();\r\n                selectTo = selectBrackets ? close_1.getEndPosition() : close_1.getStartPosition();\r\n            }\r\n            if (selectFrom && selectTo) {\r\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\r\n            }\r\n        });\r\n        if (newSelections.length > 0) {\r\n            this._editor.setSelections(newSelections);\r\n            this._editor.revealRange(newSelections[0]);\r\n        }\r\n    };\r\n    BracketMatchingController.prototype._updateBrackets = function () {\r\n        if (this._matchBrackets === 'never') {\r\n            return;\r\n        }\r\n        this._recomputeBrackets();\r\n        var newDecorations = [], newDecorationsLen = 0;\r\n        for (var _i = 0, _a = this._lastBracketsData; _i < _a.length; _i++) {\r\n            var bracketData = _a[_i];\r\n            var brackets = bracketData.brackets;\r\n            if (brackets) {\r\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\r\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\r\n            }\r\n        }\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, newDecorations);\r\n    };\r\n    BracketMatchingController.prototype._recomputeBrackets = function () {\r\n        if (!this._editor.hasModel()) {\r\n            // no model => no brackets!\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        if (selections.length > 100) {\r\n            // no bracket matching for high numbers of selections\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var versionId = model.getVersionId();\r\n        var previousData = [];\r\n        if (this._lastVersionId === versionId) {\r\n            // use the previous data only if the model is at the same version id\r\n            previousData = this._lastBracketsData;\r\n        }\r\n        var positions = [], positionsLen = 0;\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                // will bracket match a cursor only if the selection is collapsed\r\n                positions[positionsLen++] = selection.getStartPosition();\r\n            }\r\n        }\r\n        // sort positions for `previousData` cache hits\r\n        if (positions.length > 1) {\r\n            positions.sort(Position.compare);\r\n        }\r\n        var newData = [], newDataLen = 0;\r\n        var previousIndex = 0, previousLen = previousData.length;\r\n        for (var i = 0, len = positions.length; i < len; i++) {\r\n            var position = positions[i];\r\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\r\n                previousIndex++;\r\n            }\r\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\r\n                newData[newDataLen++] = previousData[previousIndex];\r\n            }\r\n            else {\r\n                var brackets = model.matchBracket(position);\r\n                var options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\r\n                if (!brackets && this._matchBrackets === 'always') {\r\n                    brackets = model.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\r\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\r\n                }\r\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\r\n            }\r\n        }\r\n        this._lastBracketsData = newData;\r\n        this._lastVersionId = versionId;\r\n    };\r\n    BracketMatchingController.ID = 'editor.contrib.bracketMatchingController';\r\n    BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'bracket-match',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerBracketMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'bracket-match'\r\n    });\r\n    return BracketMatchingController;\r\n}(Disposable));\r\nexport { BracketMatchingController };\r\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController);\r\nregisterEditorAction(SelectToBracketAction);\r\nregisterEditorAction(JumpToBracketAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var bracketMatchBackground = theme.getColor(editorBracketMatchBackground);\r\n    if (bracketMatchBackground) {\r\n        collector.addRule(\".monaco-editor .bracket-match { background-color: \" + bracketMatchBackground + \"; }\");\r\n    }\r\n    var bracketMatchBorder = theme.getColor(editorBracketMatchBorder);\r\n    if (bracketMatchBorder) {\r\n        collector.addRule(\".monaco-editor .bracket-match { border: 1px solid \" + bracketMatchBorder + \"; }\");\r\n    }\r\n});\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '5_infile_nav',\r\n    command: {\r\n        id: 'editor.action.jumpToBracket',\r\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\r\n    },\r\n    order: 2\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nvar MoveCaretCommand = /** @class */ (function () {\r\n    function MoveCaretCommand(selection, isMovingLeft) {\r\n        this._selection = selection;\r\n        this._isMovingLeft = isMovingLeft;\r\n        this._cutStartIndex = -1;\r\n        this._cutEndIndex = -1;\r\n        this._moved = false;\r\n        this._selectionId = null;\r\n    }\r\n    MoveCaretCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._selectionId = builder.trackSelection(s);\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            return;\r\n        }\r\n        if (this._isMovingLeft && s.startColumn === 0) {\r\n            return;\r\n        }\r\n        else if (!this._isMovingLeft && s.endColumn === model.getLineMaxColumn(s.startLineNumber)) {\r\n            return;\r\n        }\r\n        var lineNumber = s.selectionStartLineNumber;\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var left;\r\n        var middle;\r\n        var right;\r\n        if (this._isMovingLeft) {\r\n            left = lineContent.substring(0, s.startColumn - 2);\r\n            middle = lineContent.substring(s.startColumn - 1, s.endColumn - 1);\r\n            right = lineContent.substring(s.startColumn - 2, s.startColumn - 1) + lineContent.substring(s.endColumn - 1);\r\n        }\r\n        else {\r\n            left = lineContent.substring(0, s.startColumn - 1) + lineContent.substring(s.endColumn - 1, s.endColumn);\r\n            middle = lineContent.substring(s.startColumn - 1, s.endColumn - 1);\r\n            right = lineContent.substring(s.endColumn);\r\n        }\r\n        var newLineContent = left + middle + right;\r\n        builder.addEditOperation(new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber)), null);\r\n        builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), newLineContent);\r\n        this._cutStartIndex = s.startColumn + (this._isMovingLeft ? -1 : 1);\r\n        this._cutEndIndex = this._cutStartIndex + s.endColumn - s.startColumn;\r\n        this._moved = true;\r\n    };\r\n    MoveCaretCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moved) {\r\n            result = result.setStartPosition(result.startLineNumber, this._cutStartIndex);\r\n            result = result.setEndPosition(result.startLineNumber, this._cutEndIndex);\r\n        }\r\n        return result;\r\n    };\r\n    return MoveCaretCommand;\r\n}());\r\nexport { MoveCaretCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MoveCaretCommand } from './moveCaretCommand.js';\r\nvar MoveCaretAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretAction, _super);\r\n    function MoveCaretAction(left, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.left = left;\r\n        return _this;\r\n    }\r\n    MoveCaretAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new MoveCaretCommand(selection, this.left));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return MoveCaretAction;\r\n}(EditorAction));\r\nvar MoveCaretLeftAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretLeftAction, _super);\r\n    function MoveCaretLeftAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.moveCarretLeftAction',\r\n            label: nls.localize('caret.moveLeft', \"Move Caret Left\"),\r\n            alias: 'Move Caret Left',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return MoveCaretLeftAction;\r\n}(MoveCaretAction));\r\nvar MoveCaretRightAction = /** @class */ (function (_super) {\r\n    __extends(MoveCaretRightAction, _super);\r\n    function MoveCaretRightAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.moveCarretRightAction',\r\n            label: nls.localize('caret.moveRight', \"Move Caret Right\"),\r\n            alias: 'Move Caret Right',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return MoveCaretRightAction;\r\n}(MoveCaretAction));\r\nregisterEditorAction(MoveCaretLeftAction);\r\nregisterEditorAction(MoveCaretRightAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand } from '../../common/commands/replaceCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MoveOperations } from '../../common/controller/cursorMoveOperations.js';\r\nvar TransposeLettersAction = /** @class */ (function (_super) {\r\n    __extends(TransposeLettersAction, _super);\r\n    function TransposeLettersAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transposeLetters',\r\n            label: nls.localize('transposeLetters.label', \"Transpose Letters\"),\r\n            alias: 'Transpose Letters',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: {\r\n                    primary: 256 /* WinCtrl */ | 50 /* KEY_T */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TransposeLettersAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            var lineNumber = selection.startLineNumber;\r\n            var column = selection.startColumn;\r\n            var lastColumn = model.getLineMaxColumn(lineNumber);\r\n            if (lineNumber === 1 && (column === 1 || (column === 2 && lastColumn === 2))) {\r\n                // at beginning of file, nothing to do\r\n                continue;\r\n            }\r\n            // handle special case: when at end of line, transpose left two chars\r\n            // otherwise, transpose left and right chars\r\n            var endPosition = (column === lastColumn) ?\r\n                selection.getPosition() :\r\n                MoveOperations.rightPosition(model, selection.getPosition().lineNumber, selection.getPosition().column);\r\n            var middlePosition = MoveOperations.leftPosition(model, endPosition.lineNumber, endPosition.column);\r\n            var beginPosition = MoveOperations.leftPosition(model, middlePosition.lineNumber, middlePosition.column);\r\n            var leftChar = model.getValueInRange(Range.fromPositions(beginPosition, middlePosition));\r\n            var rightChar = model.getValueInRange(Range.fromPositions(middlePosition, endPosition));\r\n            var replaceRange = Range.fromPositions(beginPosition, endPosition);\r\n            commands.push(new ReplaceCommand(replaceRange, rightChar + leftChar));\r\n        }\r\n        if (commands.length > 0) {\r\n            editor.pushUndoStop();\r\n            editor.executeCommands(this.id, commands);\r\n            editor.pushUndoStop();\r\n        }\r\n    };\r\n    return TransposeLettersAction;\r\n}(EditorAction));\r\nregisterEditorAction(TransposeLettersAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './clipboard.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { CopyOptions } from '../../browser/controller/textAreaInput.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nvar CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\r\nvar supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\r\nvar supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\r\n// IE and Edge have trouble with setting html content in clipboard\r\nvar supportsCopyWithSyntaxHighlighting = (supportsCopy && !browser.isEdgeOrIE);\r\n// Chrome incorrectly returns true for document.queryCommandSupported('paste')\r\n// when the paste feature is available but the calling script has insufficient\r\n// privileges to actually perform the action\r\nvar supportsPaste = (platform.isNative || (!browser.isChrome && document.queryCommandSupported('paste')));\r\nvar ExecCommandAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandAction, _super);\r\n    function ExecCommandAction(browserCommand, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.browserCommand = browserCommand;\r\n        return _this;\r\n    }\r\n    ExecCommandAction.prototype.runCommand = function (accessor, args) {\r\n        var focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\r\n            focusedEditor.trigger('keyboard', this.id, args);\r\n            return;\r\n        }\r\n        document.execCommand(this.browserCommand);\r\n    };\r\n    ExecCommandAction.prototype.run = function (accessor, editor) {\r\n        editor.focus();\r\n        document.execCommand(this.browserCommand);\r\n    };\r\n    return ExecCommandAction;\r\n}(EditorAction));\r\nvar ExecCommandCutAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCutAction, _super);\r\n    function ExecCommandCutAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */, secondary: [1024 /* Shift */ | 20 /* Delete */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind cut keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'cut', {\r\n            id: 'editor.action.clipboardCutAction',\r\n            label: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\r\n            alias: 'Cut',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 1\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    ExecCommandCutAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(25 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        _super.prototype.run.call(this, accessor, editor);\r\n    };\r\n    return ExecCommandCutAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandCopyAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCopyAction, _super);\r\n    function ExecCommandCopyAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */, secondary: [2048 /* CtrlCmd */ | 19 /* Insert */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind copy keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'copy', {\r\n            id: 'editor.action.clipboardCopyAction',\r\n            label: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\r\n            alias: 'Copy',\r\n            precondition: undefined,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 2\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    ExecCommandCopyAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(25 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        _super.prototype.run.call(this, accessor, editor);\r\n    };\r\n    return ExecCommandCopyAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandPasteAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandPasteAction, _super);\r\n    function ExecCommandPasteAction() {\r\n        var _this = this;\r\n        var kbOpts = {\r\n            kbExpr: EditorContextKeys.textInputFocus,\r\n            primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */,\r\n            win: { primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */, secondary: [1024 /* Shift */ | 19 /* Insert */] },\r\n            weight: 100 /* EditorContrib */\r\n        };\r\n        // Do not bind paste keybindings in the browser,\r\n        // since browsers do that for us and it avoids security prompts\r\n        if (!platform.isNative) {\r\n            kbOpts = undefined;\r\n        }\r\n        _this = _super.call(this, 'paste', {\r\n            id: 'editor.action.clipboardPasteAction',\r\n            label: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\r\n            alias: 'Paste',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: kbOpts,\r\n            contextMenuOpts: {\r\n                group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n                order: 3\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '2_ccp',\r\n                title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n        return _this;\r\n    }\r\n    return ExecCommandPasteAction;\r\n}(ExecCommandAction));\r\nvar ExecCommandCopyWithSyntaxHighlightingAction = /** @class */ (function (_super) {\r\n    __extends(ExecCommandCopyWithSyntaxHighlightingAction, _super);\r\n    function ExecCommandCopyWithSyntaxHighlightingAction() {\r\n        return _super.call(this, 'copy', {\r\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\r\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\r\n            alias: 'Copy With Syntax Highlighting',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ExecCommandCopyWithSyntaxHighlightingAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var emptySelectionClipboard = editor.getOption(25 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\r\n        _super.prototype.run.call(this, accessor, editor);\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\r\n    };\r\n    return ExecCommandCopyWithSyntaxHighlightingAction;\r\n}(ExecCommandAction));\r\nif (supportsCut) {\r\n    registerEditorAction(ExecCommandCutAction);\r\n}\r\nif (supportsCopy) {\r\n    registerEditorAction(ExecCommandCopyAction);\r\n}\r\nif (supportsPaste) {\r\n    registerEditorAction(ExecCommandPasteAction);\r\n}\r\nif (supportsCopyWithSyntaxHighlighting) {\r\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar Lazy = /** @class */ (function () {\r\n    function Lazy(executor) {\r\n        this.executor = executor;\r\n        this._didRun = false;\r\n    }\r\n    /**\r\n     * Get the wrapped value.\r\n     *\r\n     * This will force evaluation of the lazy value if it has not been resolved yet. Lazy values are only\r\n     * resolved once. `getValue` will re-throw exceptions that are hit while resolving the value\r\n     */\r\n    Lazy.prototype.getValue = function () {\r\n        if (!this._didRun) {\r\n            try {\r\n                this._value = this.executor();\r\n            }\r\n            catch (err) {\r\n                this._error = err;\r\n            }\r\n            finally {\r\n                this._didRun = true;\r\n            }\r\n        }\r\n        if (this._error) {\r\n            throw this._error;\r\n        }\r\n        return this._value;\r\n    };\r\n    Object.defineProperty(Lazy.prototype, \"rawValue\", {\r\n        /**\r\n         * Get the wrapped value without forcing evaluation.\r\n         */\r\n        get: function () { return this._value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Lazy;\r\n}());\r\nexport { Lazy };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { startsWith } from '../../../base/common/strings.js';\r\nvar CodeActionKind = /** @class */ (function () {\r\n    function CodeActionKind(value) {\r\n        this.value = value;\r\n    }\r\n    CodeActionKind.prototype.equals = function (other) {\r\n        return this.value === other.value;\r\n    };\r\n    CodeActionKind.prototype.contains = function (other) {\r\n        return this.equals(other) || this.value === '' || startsWith(other.value, this.value + CodeActionKind.sep);\r\n    };\r\n    CodeActionKind.prototype.intersects = function (other) {\r\n        return this.contains(other) || other.contains(this);\r\n    };\r\n    CodeActionKind.prototype.append = function (part) {\r\n        return new CodeActionKind(this.value + CodeActionKind.sep + part);\r\n    };\r\n    CodeActionKind.sep = '.';\r\n    CodeActionKind.None = new CodeActionKind('@@none@@'); // Special code action that contains nothing\r\n    CodeActionKind.Empty = new CodeActionKind('');\r\n    CodeActionKind.QuickFix = new CodeActionKind('quickfix');\r\n    CodeActionKind.Refactor = new CodeActionKind('refactor');\r\n    CodeActionKind.Source = new CodeActionKind('source');\r\n    CodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\r\n    CodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\r\n    return CodeActionKind;\r\n}());\r\nexport { CodeActionKind };\r\nexport function mayIncludeActionsOfKind(filter, providedKind) {\r\n    // A provided kind may be a subset or superset of our filtered kind.\r\n    if (filter.include && !filter.include.intersects(providedKind)) {\r\n        return false;\r\n    }\r\n    if (filter.excludes) {\r\n        if (filter.excludes.some(function (exclude) { return excludesAction(providedKind, exclude, filter.include); })) {\r\n            return false;\r\n        }\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport function filtersAction(filter, action) {\r\n    var actionKind = action.kind ? new CodeActionKind(action.kind) : undefined;\r\n    // Filter out actions by kind\r\n    if (filter.include) {\r\n        if (!actionKind || !filter.include.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.excludes) {\r\n        if (actionKind && filter.excludes.some(function (exclude) { return excludesAction(actionKind, exclude, filter.include); })) {\r\n            return false;\r\n        }\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions) {\r\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.onlyIncludePreferredActions) {\r\n        if (!action.isPreferred) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction excludesAction(providedKind, exclude, include) {\r\n    if (!exclude.contains(providedKind)) {\r\n        return false;\r\n    }\r\n    if (include && exclude.contains(include)) {\r\n        // The include is more specific, don't filter out\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nvar CodeActionCommandArgs = /** @class */ (function () {\r\n    function CodeActionCommandArgs(kind, apply, preferred) {\r\n        this.kind = kind;\r\n        this.apply = apply;\r\n        this.preferred = preferred;\r\n    }\r\n    CodeActionCommandArgs.fromUser = function (arg, defaults) {\r\n        if (!arg || typeof arg !== 'object') {\r\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\r\n        }\r\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\r\n    };\r\n    CodeActionCommandArgs.getApplyFromUser = function (arg, defaultAutoApply) {\r\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\r\n            case 'first': return \"first\" /* First */;\r\n            case 'never': return \"never\" /* Never */;\r\n            case 'ifsingle': return \"ifSingle\" /* IfSingle */;\r\n            default: return defaultAutoApply;\r\n        }\r\n    };\r\n    CodeActionCommandArgs.getKindFromUser = function (arg, defaultKind) {\r\n        return typeof arg.kind === 'string'\r\n            ? new CodeActionKind(arg.kind)\r\n            : defaultKind;\r\n    };\r\n    CodeActionCommandArgs.getPreferredUser = function (arg) {\r\n        return typeof arg.preferred === 'boolean'\r\n            ? arg.preferred\r\n            : false;\r\n    };\r\n    return CodeActionCommandArgs;\r\n}());\r\nexport { CodeActionCommandArgs };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { equals, flatten, isNonEmptyArray, mergeSort } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, isPromiseCanceledError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CodeActionKind, filtersAction, mayIncludeActionsOfKind } from './types.js';\r\nexport var codeActionCommandId = 'editor.action.codeAction';\r\nexport var refactorCommandId = 'editor.action.refactor';\r\nexport var sourceActionCommandId = 'editor.action.sourceAction';\r\nexport var organizeImportsCommandId = 'editor.action.organizeImports';\r\nexport var fixAllCommandId = 'editor.action.fixAll';\r\nvar ManagedCodeActionSet = /** @class */ (function (_super) {\r\n    __extends(ManagedCodeActionSet, _super);\r\n    function ManagedCodeActionSet(actions, disposables) {\r\n        var _this = _super.call(this) || this;\r\n        _this._register(disposables);\r\n        _this.allActions = mergeSort(__spreadArrays(actions), ManagedCodeActionSet.codeActionsComparator);\r\n        _this.validActions = _this.allActions.filter(function (action) { return !action.disabled; });\r\n        return _this;\r\n    }\r\n    ManagedCodeActionSet.codeActionsComparator = function (a, b) {\r\n        if (isNonEmptyArray(a.diagnostics)) {\r\n            if (isNonEmptyArray(b.diagnostics)) {\r\n                return a.diagnostics[0].message.localeCompare(b.diagnostics[0].message);\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        else if (isNonEmptyArray(b.diagnostics)) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0; // both have no diagnostics\r\n        }\r\n    };\r\n    Object.defineProperty(ManagedCodeActionSet.prototype, \"hasAutoFix\", {\r\n        get: function () {\r\n            return this.validActions.some(function (fix) { return !!fix.kind && CodeActionKind.QuickFix.contains(new CodeActionKind(fix.kind)) && !!fix.isPreferred; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ManagedCodeActionSet;\r\n}(Disposable));\r\nexport function getCodeActions(model, rangeOrSelection, trigger, token) {\r\n    var _this = this;\r\n    var _a;\r\n    var filter = trigger.filter || {};\r\n    var codeActionContext = {\r\n        only: (_a = filter.include) === null || _a === void 0 ? void 0 : _a.value,\r\n        trigger: trigger.type,\r\n    };\r\n    var cts = new TextModelCancellationTokenSource(model, token);\r\n    var providers = getCodeActionProviders(model, filter);\r\n    var disposables = new DisposableStore();\r\n    var promises = providers.map(function (provider) { return __awaiter(_this, void 0, void 0, function () {\r\n        var providedCodeActions, err_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 2, , 3]);\r\n                    return [4 /*yield*/, provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token)];\r\n                case 1:\r\n                    providedCodeActions = _a.sent();\r\n                    if (cts.token.isCancellationRequested || !providedCodeActions) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    disposables.add(providedCodeActions);\r\n                    return [2 /*return*/, providedCodeActions.actions.filter(function (action) { return action && filtersAction(filter, action); })];\r\n                case 2:\r\n                    err_1 = _a.sent();\r\n                    if (isPromiseCanceledError(err_1)) {\r\n                        throw err_1;\r\n                    }\r\n                    onUnexpectedExternalError(err_1);\r\n                    return [2 /*return*/, []];\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    }); });\r\n    var listener = modes.CodeActionProviderRegistry.onDidChange(function () {\r\n        var newProviders = modes.CodeActionProviderRegistry.all(model);\r\n        if (!equals(newProviders, providers)) {\r\n            cts.cancel();\r\n        }\r\n    });\r\n    return Promise.all(promises)\r\n        .then(flatten)\r\n        .then(function (actions) { return new ManagedCodeActionSet(actions, disposables); })\r\n        .finally(function () {\r\n        listener.dispose();\r\n        cts.dispose();\r\n    });\r\n}\r\nfunction getCodeActionProviders(model, filter) {\r\n    return modes.CodeActionProviderRegistry.all(model)\r\n        // Don't include providers that we know will not return code actions of interest\r\n        .filter(function (provider) {\r\n        if (!provider.providedCodeActionKinds) {\r\n            // We don't know what type of actions this provider will return.\r\n            return true;\r\n        }\r\n        return provider.providedCodeActionKinds.some(function (kind) { return mayIncludeActionsOfKind(filter, new CodeActionKind(kind)); });\r\n    });\r\n}\r\nregisterLanguageCommand('_executeCodeActionProvider', function (accessor, args) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var resource, rangeOrSelection, kind, model, validatedRangeOrSelection, codeActionSet;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    resource = args.resource, rangeOrSelection = args.rangeOrSelection, kind = args.kind;\r\n                    if (!(resource instanceof URI)) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    model = accessor.get(IModelService).getModel(resource);\r\n                    if (!model) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\r\n                        ? Selection.liftSelection(rangeOrSelection)\r\n                        : Range.isIRange(rangeOrSelection)\r\n                            ? model.validateRange(rangeOrSelection)\r\n                            : undefined;\r\n                    if (!validatedRangeOrSelection) {\r\n                        throw illegalArgument();\r\n                    }\r\n                    return [4 /*yield*/, getCodeActions(model, validatedRangeOrSelection, { type: 2 /* Manual */, filter: { includeSourceActions: true, include: kind && kind.value ? new CodeActionKind(kind.value) : undefined } }, CancellationToken.None)];\r\n                case 1:\r\n                    codeActionSet = _a.sent();\r\n                    setTimeout(function () { return codeActionSet.dispose(); }, 100);\r\n                    return [2 /*return*/, codeActionSet.validActions];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './messageController.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant, HIGH_CONTRAST } from '../../../platform/theme/common/themeService.js';\r\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nvar MessageController = /** @class */ (function (_super) {\r\n    __extends(MessageController, _super);\r\n    function MessageController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.closeTimeout = 3000; // close after 3s\r\n        _this._messageWidget = _this._register(new MutableDisposable());\r\n        _this._messageListeners = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidAttemptReadOnlyEdit(function () { return _this._onDidAttemptReadOnlyEdit(); }));\r\n        return _this;\r\n    }\r\n    MessageController.get = function (editor) {\r\n        return editor.getContribution(MessageController.ID);\r\n    };\r\n    MessageController.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._visible.reset();\r\n    };\r\n    MessageController.prototype.showMessage = function (message, position) {\r\n        var _this = this;\r\n        alert(message);\r\n        this._visible.set(true);\r\n        this._messageWidget.clear();\r\n        this._messageListeners.clear();\r\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\r\n        // close on blur, cursor, model change, dispose\r\n        this._messageListeners.add(this._editor.onDidBlurEditorText(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidDispose(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeModel(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(new TimeoutTimer(function () { return _this.closeMessage(); }, this.closeTimeout));\r\n        // close on mouse move\r\n        var bounds;\r\n        this._messageListeners.add(this._editor.onMouseMove(function (e) {\r\n            // outside the text area\r\n            if (!e.target.position) {\r\n                return;\r\n            }\r\n            if (!bounds) {\r\n                // define bounding box around position and first mouse occurance\r\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\r\n            }\r\n            else if (!bounds.containsPosition(e.target.position)) {\r\n                // check if position is still in bounds\r\n                _this.closeMessage();\r\n            }\r\n        }));\r\n    };\r\n    MessageController.prototype.closeMessage = function () {\r\n        this._visible.reset();\r\n        this._messageListeners.clear();\r\n        if (this._messageWidget.value) {\r\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\r\n        }\r\n    };\r\n    MessageController.prototype._onDidAttemptReadOnlyEdit = function () {\r\n        if (this._editor.hasModel()) {\r\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\r\n        }\r\n    };\r\n    MessageController.ID = 'editor.contrib.messageController';\r\n    MessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false);\r\n    MessageController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], MessageController);\r\n    return MessageController;\r\n}(Disposable));\r\nexport { MessageController };\r\nvar MessageCommand = EditorCommand.bindToContribution(MessageController.get);\r\nregisterEditorCommand(new MessageCommand({\r\n    id: 'leaveEditorMessage',\r\n    precondition: MessageController.MESSAGE_VISIBLE,\r\n    handler: function (c) { return c.closeMessage(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        primary: 9 /* Escape */\r\n    }\r\n}));\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(editor, _a, text) {\r\n        var lineNumber = _a.lineNumber, column = _a.column;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._editor = editor;\r\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\r\n        this._position = { lineNumber: lineNumber, column: column - 1 };\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.classList.add('monaco-editor-overlaymessage');\r\n        var message = document.createElement('div');\r\n        message.classList.add('message');\r\n        message.textContent = text;\r\n        this._domNode.appendChild(message);\r\n        var anchor = document.createElement('div');\r\n        anchor.classList.add('anchor');\r\n        this._domNode.appendChild(anchor);\r\n        this._editor.addContentWidget(this);\r\n        this._domNode.classList.add('fadeIn');\r\n    }\r\n    MessageWidget.fadeOut = function (messageWidget) {\r\n        var handle;\r\n        var dispose = function () {\r\n            messageWidget.dispose();\r\n            clearTimeout(handle);\r\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\r\n        };\r\n        handle = setTimeout(dispose, 110);\r\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\r\n        messageWidget.getDomNode().classList.add('fadeOut');\r\n        return { dispose: dispose };\r\n    };\r\n    MessageWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    MessageWidget.prototype.getId = function () {\r\n        return 'messageoverlay';\r\n    };\r\n    MessageWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    MessageWidget.prototype.getPosition = function () {\r\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\r\n    };\r\n    return MessageWidget;\r\n}());\r\nregisterEditorContribution(MessageController.ID, MessageController);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(inputValidationInfoBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(inputValidationInfoBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(inputValidationInfoForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport './lightBulbWidget.css';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorLightBulbForeground, editorLightBulbAutoFixForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Gesture } from '../../../base/browser/touch.js';\r\nvar LightBulbState;\r\n(function (LightBulbState) {\r\n    LightBulbState.Hidden = { type: 0 /* Hidden */ };\r\n    var Showing = /** @class */ (function () {\r\n        function Showing(actions, trigger, editorPosition, widgetPosition) {\r\n            this.actions = actions;\r\n            this.trigger = trigger;\r\n            this.editorPosition = editorPosition;\r\n            this.widgetPosition = widgetPosition;\r\n            this.type = 1 /* Showing */;\r\n        }\r\n        return Showing;\r\n    }());\r\n    LightBulbState.Showing = Showing;\r\n})(LightBulbState || (LightBulbState = {}));\r\nvar LightBulbWidget = /** @class */ (function (_super) {\r\n    __extends(LightBulbWidget, _super);\r\n    function LightBulbWidget(_editor, _quickFixActionId, _preferredFixActionId, _keybindingService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._quickFixActionId = _quickFixActionId;\r\n        _this._preferredFixActionId = _preferredFixActionId;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._onClick = _this._register(new Emitter());\r\n        _this.onClick = _this._onClick.event;\r\n        _this._state = LightBulbState.Hidden;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'codicon codicon-lightbulb';\r\n        _this._editor.addContentWidget(_this);\r\n        _this._register(_this._editor.onDidChangeModelContent(function (_) {\r\n            // cancel when the line in question has been removed\r\n            var editorModel = _this._editor.getModel();\r\n            if (_this.state.type !== 1 /* Showing */ || !editorModel || _this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        Gesture.ignoreTarget(_this._domNode);\r\n        _this._register(dom.addStandardDisposableGenericMouseDownListner(_this._domNode, function (e) {\r\n            if (_this.state.type !== 1 /* Showing */) {\r\n                return;\r\n            }\r\n            // Make sure that focus / cursor location is not lost when clicking widget icon\r\n            _this._editor.focus();\r\n            e.preventDefault();\r\n            // a bit of extra work to make sure the menu\r\n            // doesn't cover the line-text\r\n            var _a = dom.getDomNodePagePosition(_this._domNode), top = _a.top, height = _a.height;\r\n            var lineHeight = _this._editor.getOption(49 /* lineHeight */);\r\n            var pad = Math.floor(lineHeight / 3);\r\n            if (_this.state.widgetPosition.position !== null && _this.state.widgetPosition.position.lineNumber < _this.state.editorPosition.lineNumber) {\r\n                pad += lineHeight;\r\n            }\r\n            _this._onClick.fire({\r\n                x: e.posx,\r\n                y: top + height + pad,\r\n                actions: _this.state.actions,\r\n                trigger: _this.state.trigger,\r\n            });\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'mouseenter', function (e) {\r\n            if ((e.buttons & 1) !== 1) {\r\n                return;\r\n            }\r\n            // mouse enters lightbulb while the primary/left button\r\n            // is being pressed -> hide the lightbulb and block future\r\n            // showings until mouse is released\r\n            _this.hide();\r\n            var monitor = new GlobalMouseMoveMonitor();\r\n            monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, function () { }, function () {\r\n                monitor.dispose();\r\n            });\r\n        }));\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            // hide when told to do so\r\n            if (e.hasChanged(47 /* lightbulb */) && !_this._editor.getOption(47 /* lightbulb */).enabled) {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        _this._updateLightBulbTitle();\r\n        _this._register(_this._keybindingService.onDidUpdateKeybindings(_this._updateLightBulbTitle, _this));\r\n        return _this;\r\n    }\r\n    LightBulbWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    LightBulbWidget.prototype.getId = function () {\r\n        return 'LightBulbWidget';\r\n    };\r\n    LightBulbWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    LightBulbWidget.prototype.getPosition = function () {\r\n        return this._state.type === 1 /* Showing */ ? this._state.widgetPosition : null;\r\n    };\r\n    LightBulbWidget.prototype.update = function (actions, trigger, atPosition) {\r\n        var _this = this;\r\n        if (actions.validActions.length <= 0) {\r\n            return this.hide();\r\n        }\r\n        var options = this._editor.getOptions();\r\n        if (!options.get(47 /* lightbulb */).enabled) {\r\n            return this.hide();\r\n        }\r\n        var lineNumber = atPosition.lineNumber, column = atPosition.column;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return this.hide();\r\n        }\r\n        var tabSize = model.getOptions().tabSize;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        var lineHasSpace = fontInfo.spaceWidth * indent > 22;\r\n        var isFolded = function (lineNumber) {\r\n            return lineNumber > 2 && _this._editor.getTopForLineNumber(lineNumber) === _this._editor.getTopForLineNumber(lineNumber - 1);\r\n        };\r\n        var effectiveLineNumber = lineNumber;\r\n        if (!lineHasSpace) {\r\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\r\n                effectiveLineNumber -= 1;\r\n            }\r\n            else if (!isFolded(lineNumber + 1)) {\r\n                effectiveLineNumber += 1;\r\n            }\r\n            else if (column * fontInfo.spaceWidth < 22) {\r\n                // cannot show lightbulb above/below and showing\r\n                // it inline would overlay the cursor...\r\n                return this.hide();\r\n            }\r\n        }\r\n        this.state = new LightBulbState.Showing(actions, trigger, atPosition, {\r\n            position: { lineNumber: effectiveLineNumber, column: 1 },\r\n            preference: LightBulbWidget._posPref\r\n        });\r\n        dom.toggleClass(this._domNode, 'codicon-lightbulb-autofix', actions.hasAutoFix);\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    LightBulbWidget.prototype.hide = function () {\r\n        this.state = LightBulbState.Hidden;\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    Object.defineProperty(LightBulbWidget.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (value) {\r\n            this._state = value;\r\n            this._updateLightBulbTitle();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LightBulbWidget.prototype._updateLightBulbTitle = function () {\r\n        if (this.state.type === 1 /* Showing */ && this.state.actions.hasAutoFix) {\r\n            var preferredKb = this._keybindingService.lookupKeybinding(this._preferredFixActionId);\r\n            if (preferredKb) {\r\n                this.title = nls.localize('prefferedQuickFixWithKb', \"Show Fixes. Preferred Fix Available ({0})\", preferredKb.getLabel());\r\n                return;\r\n            }\r\n        }\r\n        var kb = this._keybindingService.lookupKeybinding(this._quickFixActionId);\r\n        if (kb) {\r\n            this.title = nls.localize('quickFixWithKb', \"Show Fixes ({0})\", kb.getLabel());\r\n        }\r\n        else {\r\n            this.title = nls.localize('quickFix', \"Show Fixes\");\r\n        }\r\n    };\r\n    Object.defineProperty(LightBulbWidget.prototype, \"title\", {\r\n        set: function (value) {\r\n            this._domNode.title = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LightBulbWidget._posPref = [0 /* EXACT */];\r\n    LightBulbWidget = __decorate([\r\n        __param(3, IKeybindingService)\r\n    ], LightBulbWidget);\r\n    return LightBulbWidget;\r\n}(Disposable));\r\nexport { LightBulbWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    // Lightbulb Icon\r\n    var editorLightBulbForegroundColor = theme.getColor(editorLightBulbForeground);\r\n    if (editorLightBulbForegroundColor) {\r\n        collector.addRule(\"\\n\\t\\t.monaco-editor .contentWidgets .codicon-lightbulb {\\n\\t\\t\\tcolor: \" + editorLightBulbForegroundColor + \";\\n\\t\\t}\");\r\n    }\r\n    // Lightbulb Auto Fix Icon\r\n    var editorLightBulbAutoFixForegroundColor = theme.getColor(editorLightBulbAutoFixForeground);\r\n    if (editorLightBulbAutoFixForegroundColor) {\r\n        collector.addRule(\"\\n\\t\\t.monaco-editor .contentWidgets .codicon-lightbulb-autofix {\\n\\t\\t\\tcolor: \" + editorLightBulbAutoFixForegroundColor + \";\\n\\t\\t}\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { getDomNodePagePosition } from '../../../base/browser/dom.js';\r\nimport { Separator } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { canceled } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\r\nimport { CodeActionCommandArgs, CodeActionKind } from './types.js';\r\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nvar CodeActionAction = /** @class */ (function (_super) {\r\n    __extends(CodeActionAction, _super);\r\n    function CodeActionAction(action, callback) {\r\n        var _this = _super.call(this, action.command ? action.command.id : action.title, action.title, undefined, !action.disabled, callback) || this;\r\n        _this.action = action;\r\n        return _this;\r\n    }\r\n    return CodeActionAction;\r\n}(Action));\r\nvar CodeActionMenu = /** @class */ (function (_super) {\r\n    __extends(CodeActionMenu, _super);\r\n    function CodeActionMenu(_editor, _delegate, _contextMenuService, keybindingService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._delegate = _delegate;\r\n        _this._contextMenuService = _contextMenuService;\r\n        _this._visible = false;\r\n        _this._showingActions = _this._register(new MutableDisposable());\r\n        _this._keybindingResolver = new CodeActionKeybindingResolver({\r\n            getKeybindings: function () { return keybindingService.getKeybindings(); }\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(CodeActionMenu.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._visible;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CodeActionMenu.prototype.show = function (trigger, codeActions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var actionsToShow, menuActions, anchor, resolver;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                actionsToShow = options.includeDisabledActions ? codeActions.allActions : codeActions.validActions;\r\n                if (!actionsToShow.length) {\r\n                    this._visible = false;\r\n                    return [2 /*return*/];\r\n                }\r\n                if (!this._editor.getDomNode()) {\r\n                    // cancel when editor went off-dom\r\n                    this._visible = false;\r\n                    throw canceled();\r\n                }\r\n                this._visible = true;\r\n                this._showingActions.value = codeActions;\r\n                menuActions = this.getMenuActions(trigger, actionsToShow);\r\n                anchor = Position.isIPosition(at) ? this._toCoords(at) : at || { x: 0, y: 0 };\r\n                resolver = this._keybindingResolver.getResolver();\r\n                this._contextMenuService.showContextMenu({\r\n                    getAnchor: function () { return anchor; },\r\n                    getActions: function () { return menuActions; },\r\n                    onHide: function () {\r\n                        _this._visible = false;\r\n                        _this._editor.focus();\r\n                    },\r\n                    autoSelectFirstItem: true,\r\n                    getKeyBinding: function (action) { return action instanceof CodeActionAction ? resolver(action.action) : undefined; },\r\n                });\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    CodeActionMenu.prototype.getMenuActions = function (trigger, actionsToShow) {\r\n        var _this = this;\r\n        var _a, _b;\r\n        var toCodeActionAction = function (action) { return new CodeActionAction(action, function () { return _this._delegate.onSelectCodeAction(action); }); };\r\n        var result = actionsToShow\r\n            .map(toCodeActionAction);\r\n        var model = this._editor.getModel();\r\n        if (model && result.length) {\r\n            for (var _i = 0, _c = CodeActionProviderRegistry.all(model); _i < _c.length; _i++) {\r\n                var provider = _c[_i];\r\n                if (provider._getAdditionalMenuItems) {\r\n                    var items = provider._getAdditionalMenuItems({ trigger: trigger.type, only: (_b = (_a = trigger.filter) === null || _a === void 0 ? void 0 : _a.include) === null || _b === void 0 ? void 0 : _b.value }, actionsToShow);\r\n                    if (items.length) {\r\n                        result.push.apply(result, __spreadArrays([new Separator()], items.map(function (command) { return toCodeActionAction({\r\n                            title: command.title,\r\n                            command: command,\r\n                        }); })));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    CodeActionMenu.prototype._toCoords = function (position) {\r\n        if (!this._editor.hasModel()) {\r\n            return { x: 0, y: 0 };\r\n        }\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n        this._editor.render();\r\n        // Translate to absolute editor position\r\n        var cursorCoords = this._editor.getScrolledVisiblePosition(position);\r\n        var editorCoords = getDomNodePagePosition(this._editor.getDomNode());\r\n        var x = editorCoords.left + cursorCoords.left;\r\n        var y = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n        return { x: x, y: y };\r\n    };\r\n    CodeActionMenu = __decorate([\r\n        __param(2, IContextMenuService),\r\n        __param(3, IKeybindingService)\r\n    ], CodeActionMenu);\r\n    return CodeActionMenu;\r\n}(Disposable));\r\nexport { CodeActionMenu };\r\nvar CodeActionKeybindingResolver = /** @class */ (function () {\r\n    function CodeActionKeybindingResolver(_keybindingProvider) {\r\n        this._keybindingProvider = _keybindingProvider;\r\n    }\r\n    CodeActionKeybindingResolver.prototype.getResolver = function () {\r\n        var _this = this;\r\n        // Lazy since we may not actually ever read the value\r\n        var allCodeActionBindings = new Lazy(function () {\r\n            return _this._keybindingProvider.getKeybindings()\r\n                .filter(function (item) { return CodeActionKeybindingResolver.codeActionCommands.indexOf(item.command) >= 0; })\r\n                .filter(function (item) { return item.resolvedKeybinding; })\r\n                .map(function (item) {\r\n                // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\r\n                var commandArgs = item.commandArgs;\r\n                if (item.command === organizeImportsCommandId) {\r\n                    commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\r\n                }\r\n                else if (item.command === fixAllCommandId) {\r\n                    commandArgs = { kind: CodeActionKind.SourceFixAll.value };\r\n                }\r\n                return __assign({ resolvedKeybinding: item.resolvedKeybinding }, CodeActionCommandArgs.fromUser(commandArgs, {\r\n                    kind: CodeActionKind.None,\r\n                    apply: \"never\" /* Never */\r\n                }));\r\n            });\r\n        });\r\n        return function (action) {\r\n            if (action.kind) {\r\n                var binding = _this.bestKeybindingForCodeAction(action, allCodeActionBindings.getValue());\r\n                return binding === null || binding === void 0 ? void 0 : binding.resolvedKeybinding;\r\n            }\r\n            return undefined;\r\n        };\r\n    };\r\n    CodeActionKeybindingResolver.prototype.bestKeybindingForCodeAction = function (action, candidates) {\r\n        if (!action.kind) {\r\n            return undefined;\r\n        }\r\n        var kind = new CodeActionKind(action.kind);\r\n        return candidates\r\n            .filter(function (candidate) { return candidate.kind.contains(kind); })\r\n            .filter(function (candidate) {\r\n            if (candidate.preferred) {\r\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\r\n                return action.isPreferred;\r\n            }\r\n            return true;\r\n        })\r\n            .reduceRight(function (currentBest, candidate) {\r\n            if (!currentBest) {\r\n                return candidate;\r\n            }\r\n            // Select the more specific binding\r\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\r\n        }, undefined);\r\n    };\r\n    CodeActionKeybindingResolver.codeActionCommands = [\r\n        refactorCommandId,\r\n        codeActionCommandId,\r\n        sourceActionCommandId,\r\n        organizeImportsCommandId,\r\n        fixAllCommandId\r\n    ];\r\n    return CodeActionKeybindingResolver;\r\n}());\r\nexport { CodeActionKeybindingResolver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { find } from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { CodeActionMenu } from './codeActionMenu.js';\r\nimport { LightBulbWidget } from './lightBulbWidget.js';\r\nvar CodeActionUi = /** @class */ (function (_super) {\r\n    __extends(CodeActionUi, _super);\r\n    function CodeActionUi(_editor, quickFixActionId, preferredFixActionId, delegate, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this.delegate = delegate;\r\n        _this._activeCodeActions = _this._register(new MutableDisposable());\r\n        _this._codeActionWidget = new Lazy(function () {\r\n            return _this._register(instantiationService.createInstance(CodeActionMenu, _this._editor, {\r\n                onSelectCodeAction: function (action) { return __awaiter(_this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        this.delegate.applyCodeAction(action, /* retrigger */ true);\r\n                        return [2 /*return*/];\r\n                    });\r\n                }); }\r\n            }));\r\n        });\r\n        _this._lightBulbWidget = new Lazy(function () {\r\n            var widget = _this._register(instantiationService.createInstance(LightBulbWidget, _this._editor, quickFixActionId, preferredFixActionId));\r\n            _this._register(widget.onClick(function (e) { return _this.showCodeActionList(e.trigger, e.actions, e, { includeDisabledActions: false }); }));\r\n            return widget;\r\n        });\r\n        return _this;\r\n    }\r\n    CodeActionUi.prototype.update = function (newState) {\r\n        var _a, _b, _c;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var actions, e_1, validActionToApply, invalidAction, includeDisabledActions;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        if (newState.type !== 1 /* Triggered */) {\r\n                            (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _d.label = 1;\r\n                    case 1:\r\n                        _d.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, newState.actions];\r\n                    case 2:\r\n                        actions = _d.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _d.sent();\r\n                        onUnexpectedError(e_1);\r\n                        return [2 /*return*/];\r\n                    case 4:\r\n                        this._lightBulbWidget.getValue().update(actions, newState.trigger, newState.position);\r\n                        if (!(newState.trigger.type === 2 /* Manual */)) return [3 /*break*/, 11];\r\n                        if (!((_b = newState.trigger.filter) === null || _b === void 0 ? void 0 : _b.include)) return [3 /*break*/, 10];\r\n                        validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\r\n                        if (!validActionToApply) return [3 /*break*/, 9];\r\n                        _d.label = 5;\r\n                    case 5:\r\n                        _d.trys.push([5, , 7, 8]);\r\n                        return [4 /*yield*/, this.delegate.applyCodeAction(validActionToApply, false)];\r\n                    case 6:\r\n                        _d.sent();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        actions.dispose();\r\n                        return [7 /*endfinally*/];\r\n                    case 8: return [2 /*return*/];\r\n                    case 9:\r\n                        // Check to see if there is an action that we would have applied were it not invalid\r\n                        if (newState.trigger.context) {\r\n                            invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\r\n                            if (invalidAction && invalidAction.disabled) {\r\n                                MessageController.get(this._editor).showMessage(invalidAction.disabled, newState.trigger.context.position);\r\n                                actions.dispose();\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        _d.label = 10;\r\n                    case 10:\r\n                        includeDisabledActions = !!((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include);\r\n                        if (newState.trigger.context) {\r\n                            if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\r\n                                MessageController.get(this._editor).showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\r\n                                this._activeCodeActions.value = actions;\r\n                                actions.dispose();\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        this._activeCodeActions.value = actions;\r\n                        this._codeActionWidget.getValue().show(newState.trigger, actions, newState.position, { includeDisabledActions: includeDisabledActions });\r\n                        return [3 /*break*/, 12];\r\n                    case 11:\r\n                        // auto magically triggered\r\n                        if (this._codeActionWidget.getValue().isVisible) {\r\n                            // TODO: Figure out if we should update the showing menu?\r\n                            actions.dispose();\r\n                        }\r\n                        else {\r\n                            this._activeCodeActions.value = actions;\r\n                        }\r\n                        _d.label = 12;\r\n                    case 12: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    CodeActionUi.prototype.getInvalidActionThatWouldHaveBeenApplied = function (trigger, actions) {\r\n        if (!actions.allActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length === 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.allActions.length === 1)) {\r\n            return find(actions.allActions, function (action) { return action.disabled; });\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionUi.prototype.tryGetValidActionToApply = function (trigger, actions) {\r\n        if (!actions.validActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length > 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.validActions.length === 1)) {\r\n            return actions.validActions[0];\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionUi.prototype.showCodeActionList = function (trigger, actions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this._codeActionWidget.getValue().show(trigger, actions, at, options);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    CodeActionUi = __decorate([\r\n        __param(4, IInstantiationService)\r\n    ], CodeActionUi);\r\n    return CodeActionUi;\r\n}(Disposable));\r\nexport { CodeActionUi };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createCancelablePromise, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { getCodeActions } from './codeAction.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport var SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\r\nvar CodeActionOracle = /** @class */ (function (_super) {\r\n    __extends(CodeActionOracle, _super);\r\n    function CodeActionOracle(_editor, _markerService, _signalChange, _delay) {\r\n        if (_delay === void 0) { _delay = 250; }\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._markerService = _markerService;\r\n        _this._signalChange = _signalChange;\r\n        _this._delay = _delay;\r\n        _this._autoTriggerTimer = _this._register(new TimeoutTimer());\r\n        _this._register(_this._markerService.onMarkerChanged(function (e) { return _this._onMarkerChanges(e); }));\r\n        _this._register(_this._editor.onDidChangeCursorPosition(function () { return _this._onCursorChange(); }));\r\n        return _this;\r\n    }\r\n    CodeActionOracle.prototype.trigger = function (trigger) {\r\n        var selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\r\n        return this._createEventAndSignalChange(trigger, selection);\r\n    };\r\n    CodeActionOracle.prototype._onMarkerChanges = function (resources) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (resources.some(function (resource) { return isEqual(resource, model.uri); })) {\r\n            this._autoTriggerTimer.cancelAndSet(function () {\r\n                _this.trigger({ type: 1 /* Auto */ });\r\n            }, this._delay);\r\n        }\r\n    };\r\n    CodeActionOracle.prototype._onCursorChange = function () {\r\n        var _this = this;\r\n        this._autoTriggerTimer.cancelAndSet(function () {\r\n            _this.trigger({ type: 1 /* Auto */ });\r\n        }, this._delay);\r\n    };\r\n    CodeActionOracle.prototype._getRangeOfMarker = function (selection) {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        for (var _i = 0, _a = this._markerService.read({ resource: model.uri }); _i < _a.length; _i++) {\r\n            var marker = _a[_i];\r\n            var markerRange = model.validateRange(marker);\r\n            if (Range.intersectRanges(markerRange, selection)) {\r\n                return Range.lift(markerRange);\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    CodeActionOracle.prototype._getRangeOfSelectionUnlessWhitespaceEnclosed = function (trigger) {\r\n        if (!this._editor.hasModel()) {\r\n            return undefined;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var selection = this._editor.getSelection();\r\n        if (selection.isEmpty() && trigger.type === 1 /* Auto */) {\r\n            var _a = selection.getPosition(), lineNumber = _a.lineNumber, column = _a.column;\r\n            var line = model.getLineContent(lineNumber);\r\n            if (line.length === 0) {\r\n                // empty line\r\n                return undefined;\r\n            }\r\n            else if (column === 1) {\r\n                // look only right\r\n                if (/\\s/.test(line[0])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else if (column === model.getLineMaxColumn(lineNumber)) {\r\n                // look only left\r\n                if (/\\s/.test(line[line.length - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else {\r\n                // look left and right\r\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n        }\r\n        return selection;\r\n    };\r\n    CodeActionOracle.prototype._createEventAndSignalChange = function (trigger, selection) {\r\n        var model = this._editor.getModel();\r\n        if (!selection || !model) {\r\n            // cancel\r\n            this._signalChange(undefined);\r\n            return undefined;\r\n        }\r\n        var markerRange = this._getRangeOfMarker(selection);\r\n        var position = markerRange ? markerRange.getStartPosition() : selection.getStartPosition();\r\n        var e = {\r\n            trigger: trigger,\r\n            selection: selection,\r\n            position: position\r\n        };\r\n        this._signalChange(e);\r\n        return e;\r\n    };\r\n    return CodeActionOracle;\r\n}(Disposable));\r\nexport var CodeActionsState;\r\n(function (CodeActionsState) {\r\n    CodeActionsState.Empty = { type: 0 /* Empty */ };\r\n    var Triggered = /** @class */ (function () {\r\n        function Triggered(trigger, rangeOrSelection, position, actions) {\r\n            this.trigger = trigger;\r\n            this.rangeOrSelection = rangeOrSelection;\r\n            this.position = position;\r\n            this.actions = actions;\r\n            this.type = 1 /* Triggered */;\r\n        }\r\n        return Triggered;\r\n    }());\r\n    CodeActionsState.Triggered = Triggered;\r\n})(CodeActionsState || (CodeActionsState = {}));\r\nvar CodeActionModel = /** @class */ (function (_super) {\r\n    __extends(CodeActionModel, _super);\r\n    function CodeActionModel(_editor, _markerService, contextKeyService, _progressService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._markerService = _markerService;\r\n        _this._progressService = _progressService;\r\n        _this._codeActionOracle = _this._register(new MutableDisposable());\r\n        _this._state = CodeActionsState.Empty;\r\n        _this._onDidChangeState = _this._register(new Emitter());\r\n        _this.onDidChangeState = _this._onDidChangeState.event;\r\n        _this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeModel(function () { return _this._update(); }));\r\n        _this._register(_this._editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        _this._register(CodeActionProviderRegistry.onDidChange(function () { return _this._update(); }));\r\n        _this._update();\r\n        return _this;\r\n    }\r\n    CodeActionModel.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.setState(CodeActionsState.Empty, true);\r\n    };\r\n    CodeActionModel.prototype._update = function () {\r\n        var _this = this;\r\n        this._codeActionOracle.value = undefined;\r\n        this.setState(CodeActionsState.Empty);\r\n        var model = this._editor.getModel();\r\n        if (model\r\n            && CodeActionProviderRegistry.has(model)\r\n            && !this._editor.getOption(68 /* readOnly */)) {\r\n            var supportedActions = [];\r\n            for (var _i = 0, _a = CodeActionProviderRegistry.all(model); _i < _a.length; _i++) {\r\n                var provider = _a[_i];\r\n                if (Array.isArray(provider.providedCodeActionKinds)) {\r\n                    supportedActions.push.apply(supportedActions, provider.providedCodeActionKinds);\r\n                }\r\n            }\r\n            this._supportedCodeActions.set(supportedActions.join(' '));\r\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, function (trigger) {\r\n                if (!trigger) {\r\n                    _this.setState(CodeActionsState.Empty);\r\n                    return;\r\n                }\r\n                var actions = createCancelablePromise(function (token) { return getCodeActions(model, trigger.selection, trigger.trigger, token); });\r\n                if (_this._progressService && trigger.trigger.type === 2 /* Manual */) {\r\n                    _this._progressService.showWhile(actions, 250);\r\n                }\r\n                _this.setState(new CodeActionsState.Triggered(trigger.trigger, trigger.selection, trigger.position, actions));\r\n            }, undefined);\r\n            this._codeActionOracle.value.trigger({ type: 1 /* Auto */ });\r\n        }\r\n        else {\r\n            this._supportedCodeActions.reset();\r\n        }\r\n    };\r\n    CodeActionModel.prototype.trigger = function (trigger) {\r\n        if (this._codeActionOracle.value) {\r\n            this._codeActionOracle.value.trigger(trigger);\r\n        }\r\n    };\r\n    CodeActionModel.prototype.setState = function (newState, skipNotify) {\r\n        if (newState === this._state) {\r\n            return;\r\n        }\r\n        // Cancel old request\r\n        if (this._state.type === 1 /* Triggered */) {\r\n            this._state.actions.cancel();\r\n        }\r\n        this._state = newState;\r\n        if (!skipNotify) {\r\n            this._onDidChangeState.fire(newState);\r\n        }\r\n    };\r\n    return CodeActionModel;\r\n}(Disposable));\r\nexport { CodeActionModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\r\nimport { CodeActionUi } from './codeActionUi.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { CodeActionModel, SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\r\nimport { CodeActionCommandArgs, CodeActionKind } from './types.js';\r\nfunction contextKeyForSupportedActions(kind) {\r\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\r\n}\r\nvar argsSchema = {\r\n    type: 'object',\r\n    required: ['kind'],\r\n    defaultSnippets: [{ body: { kind: '' } }],\r\n    properties: {\r\n        'kind': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\r\n        },\r\n        'apply': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\r\n            default: \"ifSingle\" /* IfSingle */,\r\n            enum: [\"first\" /* First */, \"ifSingle\" /* IfSingle */, \"never\" /* Never */],\r\n            enumDescriptions: [\r\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\r\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\r\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\r\n            ]\r\n        },\r\n        'preferred': {\r\n            type: 'boolean',\r\n            default: false,\r\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\r\n        }\r\n    }\r\n};\r\nvar QuickFixController = /** @class */ (function (_super) {\r\n    __extends(QuickFixController, _super);\r\n    function QuickFixController(editor, markerService, contextKeyService, progressService, _instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._instantiationService = _instantiationService;\r\n        _this._editor = editor;\r\n        _this._model = _this._register(new CodeActionModel(_this._editor, markerService, contextKeyService, progressService));\r\n        _this._register(_this._model.onDidChangeState(function (newState) { return _this.update(newState); }));\r\n        _this._ui = new Lazy(function () {\r\n            return _this._register(new CodeActionUi(editor, QuickFixAction.Id, AutoFixAction.Id, {\r\n                applyCodeAction: function (action, retrigger) { return __awaiter(_this, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                _a.trys.push([0, , 2, 3]);\r\n                                return [4 /*yield*/, this._applyCodeAction(action)];\r\n                            case 1:\r\n                                _a.sent();\r\n                                return [3 /*break*/, 3];\r\n                            case 2:\r\n                                if (retrigger) {\r\n                                    this._trigger({ type: 1 /* Auto */, filter: {} });\r\n                                }\r\n                                return [7 /*endfinally*/];\r\n                            case 3: return [2 /*return*/];\r\n                        }\r\n                    });\r\n                }); }\r\n            }, _this._instantiationService));\r\n        });\r\n        return _this;\r\n    }\r\n    QuickFixController.get = function (editor) {\r\n        return editor.getContribution(QuickFixController.ID);\r\n    };\r\n    QuickFixController.prototype.update = function (newState) {\r\n        this._ui.getValue().update(newState);\r\n    };\r\n    QuickFixController.prototype.showCodeActions = function (trigger, actions, at) {\r\n        return this._ui.getValue().showCodeActionList(trigger, actions, at, { includeDisabledActions: false });\r\n    };\r\n    QuickFixController.prototype.manualTriggerAtCurrentPosition = function (notAvailableMessage, filter, autoApply) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        MessageController.get(this._editor).closeMessage();\r\n        var triggerPosition = this._editor.getPosition();\r\n        this._trigger({ type: 2 /* Manual */, filter: filter, autoApply: autoApply, context: { notAvailableMessage: notAvailableMessage, position: triggerPosition } });\r\n    };\r\n    QuickFixController.prototype._trigger = function (trigger) {\r\n        return this._model.trigger(trigger);\r\n    };\r\n    QuickFixController.prototype._applyCodeAction = function (action) {\r\n        return this._instantiationService.invokeFunction(applyCodeAction, action, this._editor);\r\n    };\r\n    QuickFixController.ID = 'editor.contrib.quickFixController';\r\n    QuickFixController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IEditorProgressService),\r\n        __param(4, IInstantiationService)\r\n    ], QuickFixController);\r\n    return QuickFixController;\r\n}(Disposable));\r\nexport { QuickFixController };\r\nexport function applyCodeAction(accessor, action, editor) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var bulkEditService, commandService, telemetryService, notificationService, err_1, message;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    bulkEditService = accessor.get(IBulkEditService);\r\n                    commandService = accessor.get(ICommandService);\r\n                    telemetryService = accessor.get(ITelemetryService);\r\n                    notificationService = accessor.get(INotificationService);\r\n                    telemetryService.publicLog2('codeAction.applyCodeAction', {\r\n                        codeActionTitle: action.title,\r\n                        codeActionKind: action.kind,\r\n                        codeActionIsPreferred: !!action.isPreferred,\r\n                    });\r\n                    if (!action.edit) return [3 /*break*/, 2];\r\n                    return [4 /*yield*/, bulkEditService.apply(action.edit, { editor: editor })];\r\n                case 1:\r\n                    _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!action.command) return [3 /*break*/, 6];\r\n                    _a.label = 3;\r\n                case 3:\r\n                    _a.trys.push([3, 5, , 6]);\r\n                    return [4 /*yield*/, commandService.executeCommand.apply(commandService, __spreadArrays([action.command.id], (action.command.arguments || [])))];\r\n                case 4:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 6];\r\n                case 5:\r\n                    err_1 = _a.sent();\r\n                    message = asMessage(err_1);\r\n                    notificationService.error(typeof message === 'string'\r\n                        ? message\r\n                        : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\r\n                    return [3 /*break*/, 6];\r\n                case 6: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction asMessage(err) {\r\n    if (typeof err === 'string') {\r\n        return err;\r\n    }\r\n    else if (err instanceof Error && typeof err.message === 'string') {\r\n        return err.message;\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply) {\r\n    if (editor.hasModel()) {\r\n        var controller = QuickFixController.get(editor);\r\n        if (controller) {\r\n            controller.manualTriggerAtCurrentPosition(notAvailableMessage, filter, autoApply);\r\n        }\r\n    }\r\n}\r\nvar QuickFixAction = /** @class */ (function (_super) {\r\n    __extends(QuickFixAction, _super);\r\n    function QuickFixAction() {\r\n        return _super.call(this, {\r\n            id: QuickFixAction.Id,\r\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\r\n            alias: 'Quick Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickFixAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined);\r\n    };\r\n    QuickFixAction.Id = 'editor.action.quickFix';\r\n    return QuickFixAction;\r\n}(EditorAction));\r\nexport { QuickFixAction };\r\nvar CodeActionCommand = /** @class */ (function (_super) {\r\n    __extends(CodeActionCommand, _super);\r\n    function CodeActionCommand() {\r\n        return _super.call(this, {\r\n            id: codeActionCommandId,\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            description: {\r\n                description: 'Trigger a code action',\r\n                args: [{ name: 'args', schema: argsSchema, }]\r\n            }\r\n        }) || this;\r\n    }\r\n    CodeActionCommand.prototype.runEditorCommand = function (_accessor, editor, userArgs) {\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Empty,\r\n            apply: \"ifSingle\" /* IfSingle */,\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\r\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\r\n            include: args.kind,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return CodeActionCommand;\r\n}(EditorCommand));\r\nexport { CodeActionCommand };\r\nvar RefactorAction = /** @class */ (function (_super) {\r\n    __extends(RefactorAction, _super);\r\n    function RefactorAction() {\r\n        return _super.call(this, {\r\n            id: refactorCommandId,\r\n            label: nls.localize('refactor.label', \"Refactor...\"),\r\n            alias: 'Refactor...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 48 /* KEY_R */,\r\n                mac: {\r\n                    primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 48 /* KEY_R */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\r\n            },\r\n            description: {\r\n                description: 'Refactor...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        }) || this;\r\n    }\r\n    RefactorAction.prototype.run = function (_accessor, editor, userArgs) {\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Refactor,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\r\n                : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\r\n            include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return RefactorAction;\r\n}(EditorAction));\r\nexport { RefactorAction };\r\nvar SourceAction = /** @class */ (function (_super) {\r\n    __extends(SourceAction, _super);\r\n    function SourceAction() {\r\n        return _super.call(this, {\r\n            id: sourceActionCommandId,\r\n            label: nls.localize('source.label', \"Source Action...\"),\r\n            alias: 'Source Action...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2.1,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\r\n            },\r\n            description: {\r\n                description: 'Source Action...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        }) || this;\r\n    }\r\n    SourceAction.prototype.run = function (_accessor, editor, userArgs) {\r\n        var args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Source,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\r\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\r\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    };\r\n    return SourceAction;\r\n}(EditorAction));\r\nexport { SourceAction };\r\nvar OrganizeImportsAction = /** @class */ (function (_super) {\r\n    __extends(OrganizeImportsAction, _super);\r\n    function OrganizeImportsAction() {\r\n        return _super.call(this, {\r\n            id: organizeImportsCommandId,\r\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\r\n            alias: 'Organize Imports',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 45 /* KEY_O */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n        }) || this;\r\n    }\r\n    OrganizeImportsAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    return OrganizeImportsAction;\r\n}(EditorAction));\r\nexport { OrganizeImportsAction };\r\nvar FixAllAction = /** @class */ (function (_super) {\r\n    __extends(FixAllAction, _super);\r\n    function FixAllAction() {\r\n        return _super.call(this, {\r\n            id: fixAllCommandId,\r\n            label: nls.localize('fixAll.label', \"Fix All\"),\r\n            alias: 'Fix All',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\r\n        }) || this;\r\n    }\r\n    FixAllAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    return FixAllAction;\r\n}(EditorAction));\r\nexport { FixAllAction };\r\nvar AutoFixAction = /** @class */ (function (_super) {\r\n    __extends(AutoFixAction, _super);\r\n    function AutoFixAction() {\r\n        return _super.call(this, {\r\n            id: AutoFixAction.Id,\r\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\r\n            alias: 'Auto Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 84 /* US_DOT */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    AutoFixAction.prototype.run = function (_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\r\n            include: CodeActionKind.QuickFix,\r\n            onlyIncludePreferredActions: true\r\n        }, \"ifSingle\" /* IfSingle */);\r\n    };\r\n    AutoFixAction.Id = 'editor.action.autoFix';\r\n    return AutoFixAction;\r\n}(EditorAction));\r\nexport { AutoFixAction };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CodeActionCommand, OrganizeImportsAction, QuickFixAction, QuickFixController, RefactorAction, SourceAction, AutoFixAction, FixAllAction } from './codeActionCommands.js';\r\nregisterEditorContribution(QuickFixController.ID, QuickFixController);\r\nregisterEditorAction(QuickFixAction);\r\nregisterEditorAction(RefactorAction);\r\nregisterEditorAction(SourceAction);\r\nregisterEditorAction(OrganizeImportsAction);\r\nregisterEditorAction(AutoFixAction);\r\nregisterEditorAction(FixAllAction);\r\nregisterEditorCommand(new CodeActionCommand());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { mergeSort } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { CodeLensProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nvar CodeLensModel = /** @class */ (function () {\r\n    function CodeLensModel() {\r\n        this.lenses = [];\r\n        this._disposables = new DisposableStore();\r\n    }\r\n    CodeLensModel.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n    };\r\n    CodeLensModel.prototype.add = function (list, provider) {\r\n        this._disposables.add(list);\r\n        for (var _i = 0, _a = list.lenses; _i < _a.length; _i++) {\r\n            var symbol = _a[_i];\r\n            this.lenses.push({ symbol: symbol, provider: provider });\r\n        }\r\n    };\r\n    return CodeLensModel;\r\n}());\r\nexport { CodeLensModel };\r\nexport function getCodeLensData(model, token) {\r\n    var provider = CodeLensProviderRegistry.ordered(model);\r\n    var providerRanks = new Map();\r\n    var result = new CodeLensModel();\r\n    var promises = provider.map(function (provider, i) {\r\n        providerRanks.set(provider, i);\r\n        return Promise.resolve(provider.provideCodeLenses(model, token))\r\n            .then(function (list) { return list && result.add(list, provider); })\r\n            .catch(onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function () {\r\n        result.lenses = mergeSort(result.lenses, function (a, b) {\r\n            // sort by lineNumber, provider-rank, and column\r\n            if (a.symbol.range.startLineNumber < b.symbol.range.startLineNumber) {\r\n                return -1;\r\n            }\r\n            else if (a.symbol.range.startLineNumber > b.symbol.range.startLineNumber) {\r\n                return 1;\r\n            }\r\n            else if (providerRanks.get(a.provider) < providerRanks.get(b.provider)) {\r\n                return -1;\r\n            }\r\n            else if (providerRanks.get(a.provider) > providerRanks.get(b.provider)) {\r\n                return 1;\r\n            }\r\n            else if (a.symbol.range.startColumn < b.symbol.range.startColumn) {\r\n                return -1;\r\n            }\r\n            else if (a.symbol.range.startColumn > b.symbol.range.startColumn) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        });\r\n        return result;\r\n    });\r\n}\r\nregisterLanguageCommand('_executeCodeLensProvider', function (accessor, args) {\r\n    var resource = args.resource, itemResolveCount = args.itemResolveCount;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var result = [];\r\n    var disposables = new DisposableStore();\r\n    return getCodeLensData(model, CancellationToken.None).then(function (value) {\r\n        disposables.add(value);\r\n        var resolve = [];\r\n        var _loop_1 = function (item) {\r\n            if (typeof itemResolveCount === 'undefined' || Boolean(item.symbol.command)) {\r\n                result.push(item.symbol);\r\n            }\r\n            else if (itemResolveCount-- > 0 && item.provider.resolveCodeLens) {\r\n                resolve.push(Promise.resolve(item.provider.resolveCodeLens(model, item.symbol, CancellationToken.None)).then(function (symbol) { return result.push(symbol || item.symbol); }));\r\n            }\r\n        };\r\n        for (var _i = 0, _a = value.lenses; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            _loop_1(item);\r\n        }\r\n        return Promise.all(resolve);\r\n    }).then(function () {\r\n        return result;\r\n    }).finally(function () {\r\n        // make sure to return results, then (on next tick)\r\n        // dispose the results\r\n        setTimeout(function () { return disposables.dispose(); }, 100);\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar escapeCodiconsRegex = /(\\\\)?\\$\\([a-z0-9\\-]+?(?:~[a-z0-9\\-]*?)?\\)/gi;\r\nexport function escapeCodicons(text) {\r\n    return text.replace(escapeCodiconsRegex, function (match, escaped) { return escaped ? match : \"\\\\\" + match; });\r\n}\r\nvar markdownEscapedCodiconsRegex = /\\\\\\$\\([a-z0-9\\-]+?(?:~[a-z0-9\\-]*?)?\\)/gi;\r\nexport function markdownEscapeEscapedCodicons(text) {\r\n    // Need to add an extra \\ for escaping in markdown\r\n    return text.replace(markdownEscapedCodiconsRegex, function (match) { return \"\\\\\" + match; });\r\n}\r\nvar renderCodiconsRegex = /(\\\\)?\\$\\((([a-z0-9\\-]+?)(?:~([a-z0-9\\-]*?))?)\\)/gi;\r\nexport function renderCodicons(text) {\r\n    return text.replace(renderCodiconsRegex, function (_, escaped, codicon, name, animation) {\r\n        return escaped\r\n            ? \"$(\" + codicon + \")\"\r\n            : \"<span class=\\\"codicon codicon-\" + name + (animation ? \" codicon-animation-\" + animation : '') + \"\\\"></span>\";\r\n    });\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './codelensWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { renderCodicons } from '../../../base/common/codicons.js';\r\nimport { escape } from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { editorCodeLensForeground } from '../../common/view/editorColorRegistry.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar CodeLensViewZone = /** @class */ (function () {\r\n    function CodeLensViewZone(afterLineNumber, onHeight) {\r\n        this.afterLineNumber = afterLineNumber;\r\n        this._onHeight = onHeight;\r\n        this.heightInLines = 1;\r\n        this.suppressMouseDown = true;\r\n        this.domNode = document.createElement('div');\r\n    }\r\n    CodeLensViewZone.prototype.onComputedHeight = function (height) {\r\n        if (this._lastHeight === undefined) {\r\n            this._lastHeight = height;\r\n        }\r\n        else if (this._lastHeight !== height) {\r\n            this._lastHeight = height;\r\n            this._onHeight();\r\n        }\r\n    };\r\n    return CodeLensViewZone;\r\n}());\r\nvar CodeLensContentWidget = /** @class */ (function () {\r\n    function CodeLensContentWidget(editor, className, line) {\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = false;\r\n        this.suppressMouseDown = true;\r\n        this._commands = new Map();\r\n        this._isEmpty = true;\r\n        this._editor = editor;\r\n        this._id = \"codelens.widget-\" + (CodeLensContentWidget._idPool++);\r\n        this.updatePosition(line);\r\n        this._domNode = document.createElement('span');\r\n        this._domNode.className = \"codelens-decoration \" + className;\r\n    }\r\n    CodeLensContentWidget.prototype.withCommands = function (lenses, animate) {\r\n        this._commands.clear();\r\n        var innerHtml = '';\r\n        var hasSymbol = false;\r\n        for (var i = 0; i < lenses.length; i++) {\r\n            var lens = lenses[i];\r\n            if (!lens) {\r\n                continue;\r\n            }\r\n            hasSymbol = true;\r\n            if (lens.command) {\r\n                var title = renderCodicons(escape(lens.command.title));\r\n                if (lens.command.id) {\r\n                    innerHtml += \"<a id=\" + i + \">\" + title + \"</a>\";\r\n                    this._commands.set(String(i), lens.command);\r\n                }\r\n                else {\r\n                    innerHtml += \"<span>\" + title + \"</span>\";\r\n                }\r\n                if (i + 1 < lenses.length) {\r\n                    innerHtml += '<span>&#160;|&#160;</span>';\r\n                }\r\n            }\r\n        }\r\n        if (!hasSymbol) {\r\n            // symbols but no commands\r\n            this._domNode.innerHTML = '<span>no commands</span>';\r\n        }\r\n        else {\r\n            // symbols and commands\r\n            if (!innerHtml) {\r\n                innerHtml = '&#160;';\r\n            }\r\n            this._domNode.innerHTML = innerHtml;\r\n            if (this._isEmpty && animate) {\r\n                dom.addClass(this._domNode, 'fadein');\r\n            }\r\n            this._isEmpty = false;\r\n        }\r\n    };\r\n    CodeLensContentWidget.prototype.getCommand = function (link) {\r\n        return link.parentElement === this._domNode\r\n            ? this._commands.get(link.id)\r\n            : undefined;\r\n    };\r\n    CodeLensContentWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    CodeLensContentWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    CodeLensContentWidget.prototype.updatePosition = function (line) {\r\n        var column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\r\n        this._widgetPosition = {\r\n            position: { lineNumber: line, column: column },\r\n            preference: [1 /* ABOVE */]\r\n        };\r\n    };\r\n    CodeLensContentWidget.prototype.getPosition = function () {\r\n        return this._widgetPosition || null;\r\n    };\r\n    CodeLensContentWidget._idPool = 0;\r\n    return CodeLensContentWidget;\r\n}());\r\nvar CodeLensHelper = /** @class */ (function () {\r\n    function CodeLensHelper() {\r\n        this._removeDecorations = [];\r\n        this._addDecorations = [];\r\n        this._addDecorationsCallbacks = [];\r\n    }\r\n    CodeLensHelper.prototype.addDecoration = function (decoration, callback) {\r\n        this._addDecorations.push(decoration);\r\n        this._addDecorationsCallbacks.push(callback);\r\n    };\r\n    CodeLensHelper.prototype.removeDecoration = function (decorationId) {\r\n        this._removeDecorations.push(decorationId);\r\n    };\r\n    CodeLensHelper.prototype.commit = function (changeAccessor) {\r\n        var resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\r\n        for (var i = 0, len = resultingDecorations.length; i < len; i++) {\r\n            this._addDecorationsCallbacks[i](resultingDecorations[i]);\r\n        }\r\n    };\r\n    return CodeLensHelper;\r\n}());\r\nexport { CodeLensHelper };\r\nvar CodeLensWidget = /** @class */ (function () {\r\n    function CodeLensWidget(data, editor, className, helper, viewZoneChangeAccessor, updateCallback) {\r\n        var _this = this;\r\n        this._isDisposed = false;\r\n        this._editor = editor;\r\n        this._className = className;\r\n        this._data = data;\r\n        // create combined range, track all ranges with decorations,\r\n        // check if there is already something to render\r\n        this._decorationIds = [];\r\n        var range;\r\n        var lenses = [];\r\n        this._data.forEach(function (codeLensData, i) {\r\n            if (codeLensData.symbol.command) {\r\n                lenses.push(codeLensData.symbol);\r\n            }\r\n            helper.addDecoration({\r\n                range: codeLensData.symbol.range,\r\n                options: ModelDecorationOptions.EMPTY\r\n            }, function (id) { return _this._decorationIds[i] = id; });\r\n            // the range contains all lenses on this line\r\n            if (!range) {\r\n                range = Range.lift(codeLensData.symbol.range);\r\n            }\r\n            else {\r\n                range = Range.plusRange(range, codeLensData.symbol.range);\r\n            }\r\n        });\r\n        this._viewZone = new CodeLensViewZone(range.startLineNumber - 1, updateCallback);\r\n        this._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\r\n        if (lenses.length > 0) {\r\n            this._createContentWidgetIfNecessary();\r\n            this._contentWidget.withCommands(lenses, false);\r\n        }\r\n    }\r\n    CodeLensWidget.prototype._createContentWidgetIfNecessary = function () {\r\n        if (!this._contentWidget) {\r\n            this._contentWidget = new CodeLensContentWidget(this._editor, this._className, this._viewZone.afterLineNumber + 1);\r\n            this._editor.addContentWidget(this._contentWidget);\r\n        }\r\n    };\r\n    CodeLensWidget.prototype.dispose = function (helper, viewZoneChangeAccessor) {\r\n        this._decorationIds.forEach(helper.removeDecoration, helper);\r\n        this._decorationIds = [];\r\n        if (viewZoneChangeAccessor) {\r\n            viewZoneChangeAccessor.removeZone(this._viewZoneId);\r\n        }\r\n        if (this._contentWidget) {\r\n            this._editor.removeContentWidget(this._contentWidget);\r\n            this._contentWidget = undefined;\r\n        }\r\n        this._isDisposed = true;\r\n    };\r\n    CodeLensWidget.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    CodeLensWidget.prototype.isValid = function () {\r\n        var _this = this;\r\n        return this._decorationIds.some(function (id, i) {\r\n            var range = _this._editor.getModel().getDecorationRange(id);\r\n            var symbol = _this._data[i].symbol;\r\n            return !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\r\n        });\r\n    };\r\n    CodeLensWidget.prototype.updateCodeLensSymbols = function (data, helper) {\r\n        var _this = this;\r\n        this._decorationIds.forEach(helper.removeDecoration, helper);\r\n        this._decorationIds = [];\r\n        this._data = data;\r\n        this._data.forEach(function (codeLensData, i) {\r\n            helper.addDecoration({\r\n                range: codeLensData.symbol.range,\r\n                options: ModelDecorationOptions.EMPTY\r\n            }, function (id) { return _this._decorationIds[i] = id; });\r\n        });\r\n    };\r\n    CodeLensWidget.prototype.computeIfNecessary = function (model) {\r\n        if (!this._viewZone.domNode.hasAttribute('monaco-visible-view-zone')) {\r\n            return null;\r\n        }\r\n        // Read editor current state\r\n        for (var i = 0; i < this._decorationIds.length; i++) {\r\n            var range = model.getDecorationRange(this._decorationIds[i]);\r\n            if (range) {\r\n                this._data[i].symbol.range = range;\r\n            }\r\n        }\r\n        return this._data;\r\n    };\r\n    CodeLensWidget.prototype.updateCommands = function (symbols) {\r\n        this._createContentWidgetIfNecessary();\r\n        this._contentWidget.withCommands(symbols, true);\r\n        for (var i = 0; i < this._data.length; i++) {\r\n            var resolved = symbols[i];\r\n            if (resolved) {\r\n                var symbol = this._data[i].symbol;\r\n                symbol.command = resolved.command || symbol.command;\r\n            }\r\n        }\r\n    };\r\n    CodeLensWidget.prototype.getCommand = function (link) {\r\n        var _a;\r\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.getCommand(link);\r\n    };\r\n    CodeLensWidget.prototype.getLineNumber = function () {\r\n        var range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\r\n        if (range) {\r\n            return range.startLineNumber;\r\n        }\r\n        return -1;\r\n    };\r\n    CodeLensWidget.prototype.update = function (viewZoneChangeAccessor) {\r\n        if (this.isValid()) {\r\n            var range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\r\n            if (range) {\r\n                this._viewZone.afterLineNumber = range.startLineNumber - 1;\r\n                viewZoneChangeAccessor.layoutZone(this._viewZoneId);\r\n                if (this._contentWidget) {\r\n                    this._contentWidget.updatePosition(range.startLineNumber);\r\n                    this._editor.layoutContentWidget(this._contentWidget);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return CodeLensWidget;\r\n}());\r\nexport { CodeLensWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var codeLensForeground = theme.getColor(editorCodeLensForeground);\r\n    if (codeLensForeground) {\r\n        collector.addRule(\".monaco-editor .codelens-decoration { color: \" + codeLensForeground + \"; }\");\r\n        collector.addRule(\".monaco-editor .codelens-decoration .codicon { color: \" + codeLensForeground + \"; }\");\r\n    }\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .codelens-decoration > a:hover { color: \" + activeLinkForeground + \" !important; }\");\r\n        collector.addRule(\".monaco-editor .codelens-decoration > a:hover .codicon { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { CodeLensModel } from './codelens.js';\r\nimport { LRUCache, values } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { runWhenIdle } from '../../../base/common/async.js';\r\nimport { once } from '../../../base/common/functional.js';\r\nexport var ICodeLensCache = createDecorator('ICodeLensCache');\r\nvar CacheItem = /** @class */ (function () {\r\n    function CacheItem(lineCount, data) {\r\n        this.lineCount = lineCount;\r\n        this.data = data;\r\n    }\r\n    return CacheItem;\r\n}());\r\nvar CodeLensCache = /** @class */ (function () {\r\n    function CodeLensCache(storageService) {\r\n        var _this = this;\r\n        this._fakeProvider = new /** @class */ (function () {\r\n            function class_1() {\r\n            }\r\n            class_1.prototype.provideCodeLenses = function () {\r\n                throw new Error('not supported');\r\n            };\r\n            return class_1;\r\n        }());\r\n        this._cache = new LRUCache(20, 0.75);\r\n        // remove old data\r\n        var oldkey = 'codelens/cache';\r\n        runWhenIdle(function () { return storageService.remove(oldkey, 1 /* WORKSPACE */); });\r\n        // restore lens data on start\r\n        var key = 'codelens/cache2';\r\n        var raw = storageService.get(key, 1 /* WORKSPACE */, '{}');\r\n        this._deserialize(raw);\r\n        // store lens data on shutdown\r\n        once(storageService.onWillSaveState)(function (e) {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                storageService.store(key, _this._serialize(), 1 /* WORKSPACE */);\r\n            }\r\n        });\r\n    }\r\n    CodeLensCache.prototype.put = function (model, data) {\r\n        // create a copy of the model that is without command-ids\r\n        // but with comand-labels\r\n        var copyItems = data.lenses.map(function (item) {\r\n            var _a;\r\n            return {\r\n                range: item.symbol.range,\r\n                command: item.symbol.command && { id: '', title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title },\r\n            };\r\n        });\r\n        var copyModel = new CodeLensModel();\r\n        copyModel.add({ lenses: copyItems, dispose: function () { } }, this._fakeProvider);\r\n        var item = new CacheItem(model.getLineCount(), copyModel);\r\n        this._cache.set(model.uri.toString(), item);\r\n    };\r\n    CodeLensCache.prototype.get = function (model) {\r\n        var item = this._cache.get(model.uri.toString());\r\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\r\n    };\r\n    CodeLensCache.prototype.delete = function (model) {\r\n        this._cache.delete(model.uri.toString());\r\n    };\r\n    // --- persistence\r\n    CodeLensCache.prototype._serialize = function () {\r\n        var data = Object.create(null);\r\n        this._cache.forEach(function (value, key) {\r\n            var lines = new Set();\r\n            for (var _i = 0, _a = value.data.lenses; _i < _a.length; _i++) {\r\n                var d = _a[_i];\r\n                lines.add(d.symbol.range.startLineNumber);\r\n            }\r\n            data[key] = {\r\n                lineCount: value.lineCount,\r\n                lines: values(lines)\r\n            };\r\n        });\r\n        return JSON.stringify(data);\r\n    };\r\n    CodeLensCache.prototype._deserialize = function (raw) {\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            for (var key in data) {\r\n                var element = data[key];\r\n                var lenses = [];\r\n                for (var _i = 0, _a = element.lines; _i < _a.length; _i++) {\r\n                    var line = _a[_i];\r\n                    lenses.push({ range: new Range(line, 1, line, 11) });\r\n                }\r\n                var model = new CodeLensModel();\r\n                model.add({ lenses: lenses, dispose: function () { } }, this._fakeProvider);\r\n                this._cache.set(key, new CacheItem(element.lineCount, model));\r\n            }\r\n        }\r\n        catch (_b) {\r\n            // ignore...\r\n        }\r\n    };\r\n    CodeLensCache = __decorate([\r\n        __param(0, IStorageService)\r\n    ], CodeLensCache);\r\n    return CodeLensCache;\r\n}());\r\nexport { CodeLensCache };\r\nregisterSingleton(ICodeLensCache, CodeLensCache);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { RunOnceScheduler, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { toDisposable, DisposableStore, dispose } from '../../../base/common/lifecycle.js';\r\nimport { StableEditorScrollState } from '../../browser/core/editorState.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CodeLensProviderRegistry } from '../../common/modes.js';\r\nimport { getCodeLensData } from './codelens.js';\r\nimport { CodeLensWidget, CodeLensHelper } from './codelensWidget.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { ICodeLensCache } from './codeLensCache.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nvar CodeLensContribution = /** @class */ (function () {\r\n    function CodeLensContribution(_editor, _commandService, _notificationService, _codeLensCache) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._commandService = _commandService;\r\n        this._notificationService = _notificationService;\r\n        this._codeLensCache = _codeLensCache;\r\n        this._globalToDispose = new DisposableStore();\r\n        this._localToDispose = new DisposableStore();\r\n        this._lenses = [];\r\n        this._oldCodeLensModels = new DisposableStore();\r\n        this._modelChangeCounter = 0;\r\n        this._isEnabled = this._editor.getOption(11 /* codeLens */);\r\n        this._globalToDispose.add(this._editor.onDidChangeModel(function () { return _this._onModelChange(); }));\r\n        this._globalToDispose.add(this._editor.onDidChangeModelLanguage(function () { return _this._onModelChange(); }));\r\n        this._globalToDispose.add(this._editor.onDidChangeConfiguration(function () {\r\n            var prevIsEnabled = _this._isEnabled;\r\n            _this._isEnabled = _this._editor.getOption(11 /* codeLens */);\r\n            if (prevIsEnabled !== _this._isEnabled) {\r\n                _this._onModelChange();\r\n            }\r\n        }));\r\n        this._globalToDispose.add(CodeLensProviderRegistry.onDidChange(this._onModelChange, this));\r\n        this._globalToDispose.add(this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */)) {\r\n                _this._updateLensStyle();\r\n            }\r\n        }));\r\n        this._onModelChange();\r\n        this._styleClassName = hash(this._editor.getId()).toString(16);\r\n        this._styleElement = dom.createStyleSheet(dom.isInShadowDOM(this._editor.getContainerDomNode())\r\n            ? this._editor.getContainerDomNode()\r\n            : undefined);\r\n        this._updateLensStyle();\r\n    }\r\n    CodeLensContribution.prototype.dispose = function () {\r\n        this._localDispose();\r\n        this._globalToDispose.dispose();\r\n        this._oldCodeLensModels.dispose();\r\n        dispose(this._currentCodeLensModel);\r\n    };\r\n    CodeLensContribution.prototype._updateLensStyle = function () {\r\n        var options = this._editor.getOptions();\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var lineHeight = options.get(49 /* lineHeight */);\r\n        var height = Math.round(lineHeight * 1.1);\r\n        var fontSize = Math.round(fontInfo.fontSize * 0.9);\r\n        var newStyle = \"\\n\\t\\t.monaco-editor .codelens-decoration.\" + this._styleClassName + \" { height: \" + height + \"px; line-height: \" + lineHeight + \"px; font-size: \" + fontSize + \"px; padding-right: \" + Math.round(fontInfo.fontSize * 0.45) + \"px;}\\n\\t\\t.monaco-editor .codelens-decoration.\" + this._styleClassName + \" > a > .codicon { line-height: \" + lineHeight + \"px; font-size: \" + fontSize + \"px; }\\n\\t\\t\";\r\n        this._styleElement.innerHTML = newStyle;\r\n    };\r\n    CodeLensContribution.prototype._localDispose = function () {\r\n        if (this._currentFindCodeLensSymbolsPromise) {\r\n            this._currentFindCodeLensSymbolsPromise.cancel();\r\n            this._currentFindCodeLensSymbolsPromise = undefined;\r\n            this._modelChangeCounter++;\r\n        }\r\n        if (this._currentResolveCodeLensSymbolsPromise) {\r\n            this._currentResolveCodeLensSymbolsPromise.cancel();\r\n            this._currentResolveCodeLensSymbolsPromise = undefined;\r\n        }\r\n        this._localToDispose.clear();\r\n        this._oldCodeLensModels.clear();\r\n        dispose(this._currentCodeLensModel);\r\n    };\r\n    CodeLensContribution.prototype._onModelChange = function () {\r\n        var _this = this;\r\n        this._localDispose();\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        var cachedLenses = this._codeLensCache.get(model);\r\n        if (cachedLenses) {\r\n            this._renderCodeLensSymbols(cachedLenses);\r\n        }\r\n        if (!CodeLensProviderRegistry.has(model)) {\r\n            // no provider -> return but check with\r\n            // cached lenses. they expire after 30 seconds\r\n            if (cachedLenses) {\r\n                this._localToDispose.add(disposableTimeout(function () {\r\n                    var cachedLensesNow = _this._codeLensCache.get(model);\r\n                    if (cachedLenses === cachedLensesNow) {\r\n                        _this._codeLensCache.delete(model);\r\n                        _this._onModelChange();\r\n                    }\r\n                }, 30 * 1000));\r\n            }\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = CodeLensProviderRegistry.all(model); _i < _a.length; _i++) {\r\n            var provider = _a[_i];\r\n            if (typeof provider.onDidChange === 'function') {\r\n                var registration = provider.onDidChange(function () { return scheduler.schedule(); });\r\n                this._localToDispose.add(registration);\r\n            }\r\n        }\r\n        var detectVisibleLenses = this._detectVisibleLenses = new RunOnceScheduler(function () { return _this._onViewportChanged(); }, 250);\r\n        var scheduler = new RunOnceScheduler(function () {\r\n            var counterValue = ++_this._modelChangeCounter;\r\n            if (_this._currentFindCodeLensSymbolsPromise) {\r\n                _this._currentFindCodeLensSymbolsPromise.cancel();\r\n            }\r\n            _this._currentFindCodeLensSymbolsPromise = createCancelablePromise(function (token) { return getCodeLensData(model, token); });\r\n            _this._currentFindCodeLensSymbolsPromise.then(function (result) {\r\n                if (counterValue === _this._modelChangeCounter) { // only the last one wins\r\n                    if (_this._currentCodeLensModel) {\r\n                        _this._oldCodeLensModels.add(_this._currentCodeLensModel);\r\n                    }\r\n                    _this._currentCodeLensModel = result;\r\n                    // cache model to reduce flicker\r\n                    _this._codeLensCache.put(model, result);\r\n                    // render lenses\r\n                    _this._renderCodeLensSymbols(result);\r\n                    detectVisibleLenses.schedule();\r\n                }\r\n            }, onUnexpectedError);\r\n        }, 250);\r\n        this._localToDispose.add(scheduler);\r\n        this._localToDispose.add(detectVisibleLenses);\r\n        this._localToDispose.add(this._editor.onDidChangeModelContent(function () {\r\n            _this._editor.changeDecorations(function (decorationsAccessor) {\r\n                _this._editor.changeViewZones(function (viewZonesAccessor) {\r\n                    var toDispose = [];\r\n                    var lastLensLineNumber = -1;\r\n                    _this._lenses.forEach(function (lens) {\r\n                        if (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\r\n                            // invalid -> lens collapsed, attach range doesn't exist anymore\r\n                            // line_number -> lenses should never be on the same line\r\n                            toDispose.push(lens);\r\n                        }\r\n                        else {\r\n                            lens.update(viewZonesAccessor);\r\n                            lastLensLineNumber = lens.getLineNumber();\r\n                        }\r\n                    });\r\n                    var helper = new CodeLensHelper();\r\n                    toDispose.forEach(function (l) {\r\n                        l.dispose(helper, viewZonesAccessor);\r\n                        _this._lenses.splice(_this._lenses.indexOf(l), 1);\r\n                    });\r\n                    helper.commit(decorationsAccessor);\r\n                });\r\n            });\r\n            // Compute new `visible` code lenses\r\n            detectVisibleLenses.schedule();\r\n            // Ask for all references again\r\n            scheduler.schedule();\r\n        }));\r\n        this._localToDispose.add(this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged && _this._lenses.length > 0) {\r\n                detectVisibleLenses.schedule();\r\n            }\r\n        }));\r\n        this._localToDispose.add(this._editor.onDidLayoutChange(function () {\r\n            detectVisibleLenses.schedule();\r\n        }));\r\n        this._localToDispose.add(toDisposable(function () {\r\n            if (_this._editor.getModel()) {\r\n                var scrollState = StableEditorScrollState.capture(_this._editor);\r\n                _this._editor.changeDecorations(function (decorationsAccessor) {\r\n                    _this._editor.changeViewZones(function (viewZonesAccessor) {\r\n                        _this._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\r\n                    });\r\n                });\r\n                scrollState.restore(_this._editor);\r\n            }\r\n            else {\r\n                // No accessors available\r\n                _this._disposeAllLenses(undefined, undefined);\r\n            }\r\n        }));\r\n        this._localToDispose.add(this._editor.onMouseUp(function (e) {\r\n            var _a;\r\n            if (e.target.type !== 9 /* CONTENT_WIDGET */) {\r\n                return;\r\n            }\r\n            var target = e.target.element;\r\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'SPAN') {\r\n                target = target.parentElement;\r\n            }\r\n            if ((target === null || target === void 0 ? void 0 : target.tagName) === 'A') {\r\n                for (var _i = 0, _b = _this._lenses; _i < _b.length; _i++) {\r\n                    var lens = _b[_i];\r\n                    var command = lens.getCommand(target);\r\n                    if (command) {\r\n                        (_a = _this._commandService).executeCommand.apply(_a, __spreadArrays([command.id], (command.arguments || []))).catch(function (err) { return _this._notificationService.error(err); });\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n        scheduler.schedule();\r\n    };\r\n    CodeLensContribution.prototype._disposeAllLenses = function (decChangeAccessor, viewZoneChangeAccessor) {\r\n        var helper = new CodeLensHelper();\r\n        for (var _i = 0, _a = this._lenses; _i < _a.length; _i++) {\r\n            var lens = _a[_i];\r\n            lens.dispose(helper, viewZoneChangeAccessor);\r\n        }\r\n        if (decChangeAccessor) {\r\n            helper.commit(decChangeAccessor);\r\n        }\r\n        this._lenses = [];\r\n    };\r\n    CodeLensContribution.prototype._renderCodeLensSymbols = function (symbols) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var maxLineNumber = this._editor.getModel().getLineCount();\r\n        var groups = [];\r\n        var lastGroup;\r\n        for (var _i = 0, _a = symbols.lenses; _i < _a.length; _i++) {\r\n            var symbol = _a[_i];\r\n            var line = symbol.symbol.range.startLineNumber;\r\n            if (line < 1 || line > maxLineNumber) {\r\n                // invalid code lens\r\n                continue;\r\n            }\r\n            else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\r\n                // on same line as previous\r\n                lastGroup.push(symbol);\r\n            }\r\n            else {\r\n                // on later line as previous\r\n                lastGroup = [symbol];\r\n                groups.push(lastGroup);\r\n            }\r\n        }\r\n        var scrollState = StableEditorScrollState.capture(this._editor);\r\n        this._editor.changeDecorations(function (decorationsAccessor) {\r\n            _this._editor.changeViewZones(function (viewZoneAccessor) {\r\n                var helper = new CodeLensHelper();\r\n                var codeLensIndex = 0;\r\n                var groupsIndex = 0;\r\n                while (groupsIndex < groups.length && codeLensIndex < _this._lenses.length) {\r\n                    var symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\r\n                    var codeLensLineNumber = _this._lenses[codeLensIndex].getLineNumber();\r\n                    if (codeLensLineNumber < symbolsLineNumber) {\r\n                        _this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\r\n                        _this._lenses.splice(codeLensIndex, 1);\r\n                    }\r\n                    else if (codeLensLineNumber === symbolsLineNumber) {\r\n                        _this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\r\n                        groupsIndex++;\r\n                        codeLensIndex++;\r\n                    }\r\n                    else {\r\n                        _this._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], _this._editor, _this._styleClassName, helper, viewZoneAccessor, function () { return _this._detectVisibleLenses && _this._detectVisibleLenses.schedule(); }));\r\n                        codeLensIndex++;\r\n                        groupsIndex++;\r\n                    }\r\n                }\r\n                // Delete extra code lenses\r\n                while (codeLensIndex < _this._lenses.length) {\r\n                    _this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\r\n                    _this._lenses.splice(codeLensIndex, 1);\r\n                }\r\n                // Create extra symbols\r\n                while (groupsIndex < groups.length) {\r\n                    _this._lenses.push(new CodeLensWidget(groups[groupsIndex], _this._editor, _this._styleClassName, helper, viewZoneAccessor, function () { return _this._detectVisibleLenses && _this._detectVisibleLenses.schedule(); }));\r\n                    groupsIndex++;\r\n                }\r\n                helper.commit(decorationsAccessor);\r\n            });\r\n        });\r\n        scrollState.restore(this._editor);\r\n    };\r\n    CodeLensContribution.prototype._onViewportChanged = function () {\r\n        var _this = this;\r\n        if (this._currentResolveCodeLensSymbolsPromise) {\r\n            this._currentResolveCodeLensSymbolsPromise.cancel();\r\n            this._currentResolveCodeLensSymbolsPromise = undefined;\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        var toResolve = [];\r\n        var lenses = [];\r\n        this._lenses.forEach(function (lens) {\r\n            var request = lens.computeIfNecessary(model);\r\n            if (request) {\r\n                toResolve.push(request);\r\n                lenses.push(lens);\r\n            }\r\n        });\r\n        if (toResolve.length === 0) {\r\n            return;\r\n        }\r\n        var resolvePromise = createCancelablePromise(function (token) {\r\n            var promises = toResolve.map(function (request, i) {\r\n                var resolvedSymbols = new Array(request.length);\r\n                var promises = request.map(function (request, i) {\r\n                    if (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\r\n                        return Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(function (symbol) {\r\n                            resolvedSymbols[i] = symbol;\r\n                        }, onUnexpectedExternalError);\r\n                    }\r\n                    else {\r\n                        resolvedSymbols[i] = request.symbol;\r\n                        return Promise.resolve(undefined);\r\n                    }\r\n                });\r\n                return Promise.all(promises).then(function () {\r\n                    if (!token.isCancellationRequested && !lenses[i].isDisposed()) {\r\n                        lenses[i].updateCommands(resolvedSymbols);\r\n                    }\r\n                });\r\n            });\r\n            return Promise.all(promises);\r\n        });\r\n        this._currentResolveCodeLensSymbolsPromise = resolvePromise;\r\n        this._currentResolveCodeLensSymbolsPromise.then(function () {\r\n            if (_this._currentCodeLensModel) { // update the cached state with new resolved items\r\n                _this._codeLensCache.put(model, _this._currentCodeLensModel);\r\n            }\r\n            _this._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\r\n            if (resolvePromise === _this._currentResolveCodeLensSymbolsPromise) {\r\n                _this._currentResolveCodeLensSymbolsPromise = undefined;\r\n            }\r\n        }, function (err) {\r\n            onUnexpectedError(err); // can also be cancellation!\r\n            if (resolvePromise === _this._currentResolveCodeLensSymbolsPromise) {\r\n                _this._currentResolveCodeLensSymbolsPromise = undefined;\r\n            }\r\n        });\r\n    };\r\n    CodeLensContribution.ID = 'css.editor.codeLens';\r\n    CodeLensContribution = __decorate([\r\n        __param(1, ICommandService),\r\n        __param(2, INotificationService),\r\n        __param(3, ICodeLensCache)\r\n    ], CodeLensContribution);\r\n    return CodeLensContribution;\r\n}());\r\nexport { CodeLensContribution };\r\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { registerLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nexport function getColors(model, token) {\r\n    var colors = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideDocumentColors(model, token)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            for (var _i = 0, result_1 = result; _i < result_1.length; _i++) {\r\n                var colorInfo = result_1[_i];\r\n                colors.push({ colorInfo: colorInfo, provider: provider });\r\n            }\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return colors; });\r\n}\r\nexport function getColorPresentations(model, colorInfo, provider, token) {\r\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\r\n}\r\nregisterLanguageCommand('_executeDocumentColorProvider', function (accessor, args) {\r\n    var resource = args.resource;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument();\r\n    }\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var rawCIs = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideDocumentColors(model, CancellationToken.None)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            for (var _i = 0, result_2 = result; _i < result_2.length; _i++) {\r\n                var ci = result_2[_i];\r\n                rawCIs.push({ range: ci.range, color: [ci.color.red, ci.color.green, ci.color.blue, ci.color.alpha] });\r\n            }\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return rawCIs; });\r\n});\r\nregisterLanguageCommand('_executeColorPresentationProvider', function (accessor, args) {\r\n    var resource = args.resource, color = args.color, range = args.range;\r\n    if (!(resource instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\r\n        throw illegalArgument();\r\n    }\r\n    var red = color[0], green = color[1], blue = color[2], alpha = color[3];\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    var colorInfo = {\r\n        range: range,\r\n        color: { red: red, green: green, blue: blue, alpha: alpha }\r\n    };\r\n    var presentations = [];\r\n    var providers = ColorProviderRegistry.ordered(model).reverse();\r\n    var promises = providers.map(function (provider) { return Promise.resolve(provider.provideColorPresentations(model, colorInfo, CancellationToken.None)).then(function (result) {\r\n        if (Array.isArray(result)) {\r\n            presentations.push.apply(presentations, result);\r\n        }\r\n    }); });\r\n    return Promise.all(promises).then(function () { return presentations; });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { TimeoutTimer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { RGBA } from '../../../base/common/color.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { getColors } from './color.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nvar MAX_DECORATORS = 500;\r\nvar ColorDetector = /** @class */ (function (_super) {\r\n    __extends(ColorDetector, _super);\r\n    function ColorDetector(_editor, _codeEditorService, _configurationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._codeEditorService = _codeEditorService;\r\n        _this._configurationService = _configurationService;\r\n        _this._localToDispose = _this._register(new DisposableStore());\r\n        _this._decorationsIds = [];\r\n        _this._colorDatas = new Map();\r\n        _this._colorDecoratorIds = [];\r\n        _this._decorationsTypes = new Set();\r\n        _this._register(_editor.onDidChangeModel(function (e) {\r\n            _this._isEnabled = _this.isEnabled();\r\n            _this.onModelChanged();\r\n        }));\r\n        _this._register(_editor.onDidChangeModelLanguage(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(ColorProviderRegistry.onDidChange(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(_editor.onDidChangeConfiguration(function (e) {\r\n            var prevIsEnabled = _this._isEnabled;\r\n            _this._isEnabled = _this.isEnabled();\r\n            if (prevIsEnabled !== _this._isEnabled) {\r\n                if (_this._isEnabled) {\r\n                    _this.onModelChanged();\r\n                }\r\n                else {\r\n                    _this.removeAllDecorations();\r\n                }\r\n            }\r\n        }));\r\n        _this._timeoutTimer = null;\r\n        _this._computePromise = null;\r\n        _this._isEnabled = _this.isEnabled();\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    ColorDetector.prototype.isEnabled = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return false;\r\n        }\r\n        var languageId = model.getLanguageIdentifier();\r\n        // handle deprecated settings. [languageId].colorDecorators.enable\r\n        var deprecatedConfig = this._configurationService.getValue(languageId.language);\r\n        if (deprecatedConfig) {\r\n            var colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\r\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\r\n                return colorDecorators['enable'];\r\n            }\r\n        }\r\n        return this._editor.getOption(12 /* colorDecorators */);\r\n    };\r\n    ColorDetector.get = function (editor) {\r\n        return editor.getContribution(this.ID);\r\n    };\r\n    ColorDetector.prototype.dispose = function () {\r\n        this.stop();\r\n        this.removeAllDecorations();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ColorDetector.prototype.onModelChanged = function () {\r\n        var _this = this;\r\n        this.stop();\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!model || !ColorProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        this._localToDispose.add(this._editor.onDidChangeModelContent(function (e) {\r\n            if (!_this._timeoutTimer) {\r\n                _this._timeoutTimer = new TimeoutTimer();\r\n                _this._timeoutTimer.cancelAndSet(function () {\r\n                    _this._timeoutTimer = null;\r\n                    _this.beginCompute();\r\n                }, ColorDetector.RECOMPUTE_TIME);\r\n            }\r\n        }));\r\n        this.beginCompute();\r\n    };\r\n    ColorDetector.prototype.beginCompute = function () {\r\n        var _this = this;\r\n        this._computePromise = createCancelablePromise(function (token) {\r\n            var model = _this._editor.getModel();\r\n            if (!model) {\r\n                return Promise.resolve([]);\r\n            }\r\n            return getColors(model, token);\r\n        });\r\n        this._computePromise.then(function (colorInfos) {\r\n            _this.updateDecorations(colorInfos);\r\n            _this.updateColorDecorators(colorInfos);\r\n            _this._computePromise = null;\r\n        }, onUnexpectedError);\r\n    };\r\n    ColorDetector.prototype.stop = function () {\r\n        if (this._timeoutTimer) {\r\n            this._timeoutTimer.cancel();\r\n            this._timeoutTimer = null;\r\n        }\r\n        if (this._computePromise) {\r\n            this._computePromise.cancel();\r\n            this._computePromise = null;\r\n        }\r\n        this._localToDispose.clear();\r\n    };\r\n    ColorDetector.prototype.updateDecorations = function (colorDatas) {\r\n        var _this = this;\r\n        var decorations = colorDatas.map(function (c) { return ({\r\n            range: {\r\n                startLineNumber: c.colorInfo.range.startLineNumber,\r\n                startColumn: c.colorInfo.range.startColumn,\r\n                endLineNumber: c.colorInfo.range.endLineNumber,\r\n                endColumn: c.colorInfo.range.endColumn\r\n            },\r\n            options: ModelDecorationOptions.EMPTY\r\n        }); });\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, decorations);\r\n        this._colorDatas = new Map();\r\n        this._decorationsIds.forEach(function (id, i) { return _this._colorDatas.set(id, colorDatas[i]); });\r\n    };\r\n    ColorDetector.prototype.updateColorDecorators = function (colorData) {\r\n        var _this = this;\r\n        var decorations = [];\r\n        var newDecorationsTypes = {};\r\n        for (var i = 0; i < colorData.length && decorations.length < MAX_DECORATORS; i++) {\r\n            var _a = colorData[i].colorInfo.color, red = _a.red, green = _a.green, blue = _a.blue, alpha = _a.alpha;\r\n            var rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n            var subKey = hash(rgba).toString(16);\r\n            var color = \"rgba(\" + rgba.r + \", \" + rgba.g + \", \" + rgba.b + \", \" + rgba.a + \")\";\r\n            var key = 'colorBox-' + subKey;\r\n            if (!this._decorationsTypes.has(key) && !newDecorationsTypes[key]) {\r\n                this._codeEditorService.registerDecorationType(key, {\r\n                    before: {\r\n                        contentText: ' ',\r\n                        border: 'solid 0.1em #000',\r\n                        margin: '0.1em 0.2em 0 0.2em',\r\n                        width: '0.8em',\r\n                        height: '0.8em',\r\n                        backgroundColor: color\r\n                    },\r\n                    dark: {\r\n                        before: {\r\n                            border: 'solid 0.1em #eee'\r\n                        }\r\n                    }\r\n                }, undefined, this._editor);\r\n            }\r\n            newDecorationsTypes[key] = true;\r\n            decorations.push({\r\n                range: {\r\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\r\n                    startColumn: colorData[i].colorInfo.range.startColumn,\r\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\r\n                    endColumn: colorData[i].colorInfo.range.endColumn\r\n                },\r\n                options: this._codeEditorService.resolveDecorationOptions(key, true)\r\n            });\r\n        }\r\n        this._decorationsTypes.forEach(function (subType) {\r\n            if (!newDecorationsTypes[subType]) {\r\n                _this._codeEditorService.removeDecorationType(subType);\r\n            }\r\n        });\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, decorations);\r\n    };\r\n    ColorDetector.prototype.removeAllDecorations = function () {\r\n        var _this = this;\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, []);\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, []);\r\n        this._decorationsTypes.forEach(function (subType) {\r\n            _this._codeEditorService.removeDecorationType(subType);\r\n        });\r\n    };\r\n    ColorDetector.prototype.getColorData = function (position) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return null;\r\n        }\r\n        var decorations = model\r\n            .getDecorationsInRange(Range.fromPositions(position, position))\r\n            .filter(function (d) { return _this._colorDatas.has(d.id); });\r\n        if (decorations.length === 0) {\r\n            return null;\r\n        }\r\n        return this._colorDatas.get(decorations[0].id);\r\n    };\r\n    ColorDetector.ID = 'editor.contrib.colorDetector';\r\n    ColorDetector.RECOMPUTE_TIME = 1000; // ms\r\n    ColorDetector = __decorate([\r\n        __param(1, ICodeEditorService),\r\n        __param(2, IConfigurationService)\r\n    ], ColorDetector);\r\n    return ColorDetector;\r\n}(Disposable));\r\nexport { ColorDetector };\r\nregisterEditorContribution(ColorDetector.ID, ColorDetector);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nvar BlockCommentCommand = /** @class */ (function () {\r\n    function BlockCommentCommand(selection, insertSpace) {\r\n        this._selection = selection;\r\n        this._insertSpace = insertSpace;\r\n        this._usedEndToken = null;\r\n    }\r\n    BlockCommentCommand._haystackHasNeedleAtOffset = function (haystack, needle, offset) {\r\n        if (offset < 0) {\r\n            return false;\r\n        }\r\n        var needleLength = needle.length;\r\n        var haystackLength = haystack.length;\r\n        if (offset + needleLength > haystackLength) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < needleLength; i++) {\r\n            var codeA = haystack.charCodeAt(offset + i);\r\n            var codeB = needle.charCodeAt(i);\r\n            if (codeA === codeB) {\r\n                continue;\r\n            }\r\n            if (codeA >= 65 /* A */ && codeA <= 90 /* Z */ && codeA + 32 === codeB) {\r\n                // codeA is upper-case variant of codeB\r\n                continue;\r\n            }\r\n            if (codeB >= 65 /* A */ && codeB <= 90 /* Z */ && codeB + 32 === codeA) {\r\n                // codeB is upper-case variant of codeA\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    BlockCommentCommand.prototype._createOperationsForBlockComment = function (selection, startToken, endToken, insertSpace, model, builder) {\r\n        var startLineNumber = selection.startLineNumber;\r\n        var startColumn = selection.startColumn;\r\n        var endLineNumber = selection.endLineNumber;\r\n        var endColumn = selection.endColumn;\r\n        var startLineText = model.getLineContent(startLineNumber);\r\n        var endLineText = model.getLineContent(endLineNumber);\r\n        var startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\r\n        var endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            if (startLineNumber === endLineNumber) {\r\n                var lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\r\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n            else {\r\n                var startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\r\n                var endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\r\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        var ops;\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            // Consider spaces as part of the comment tokens\r\n            if (insertSpace && startTokenIndex + startToken.length < startLineText.length && startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n                // Pretend the start token contains a trailing space\r\n                startToken = startToken + ' ';\r\n            }\r\n            if (insertSpace && endTokenIndex > 0 && endLineText.charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n                // Pretend the end token contains a leading space\r\n                endToken = ' ' + endToken;\r\n                endTokenIndex -= 1;\r\n            }\r\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        else {\r\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken, this._insertSpace);\r\n            this._usedEndToken = ops.length === 1 ? endToken : null;\r\n        }\r\n        for (var _i = 0, ops_1 = ops; _i < ops_1.length; _i++) {\r\n            var op = ops_1[_i];\r\n            builder.addTrackedEditOperation(op.range, op.text);\r\n        }\r\n    };\r\n    BlockCommentCommand._createRemoveBlockCommentOperations = function (r, startToken, endToken) {\r\n        var res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Remove block comment start\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\r\n            // Remove block comment end\r\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        else {\r\n            // Remove both continuously\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        return res;\r\n    };\r\n    BlockCommentCommand._createAddBlockCommentOperations = function (r, startToken, endToken, insertSpace) {\r\n        var res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Insert block comment start\r\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + (insertSpace ? ' ' : '')));\r\n            // Insert block comment end\r\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), (insertSpace ? ' ' : '') + endToken));\r\n        }\r\n        else {\r\n            // Insert both continuously\r\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\r\n        }\r\n        return res;\r\n    };\r\n    BlockCommentCommand.prototype.getEditOperations = function (model, builder) {\r\n        var startLineNumber = this._selection.startLineNumber;\r\n        var startColumn = this._selection.startColumn;\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, this._insertSpace, model, builder);\r\n    };\r\n    BlockCommentCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        if (inverseEditOperations.length === 2) {\r\n            var startTokenEditOperation = inverseEditOperations[0];\r\n            var endTokenEditOperation = inverseEditOperations[1];\r\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\r\n        }\r\n        else {\r\n            var srcRange = inverseEditOperations[0].range;\r\n            var deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\r\n        }\r\n    };\r\n    return BlockCommentCommand;\r\n}());\r\nexport { BlockCommentCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nvar LineCommentCommand = /** @class */ (function () {\r\n    function LineCommentCommand(selection, tabSize, type, insertSpace) {\r\n        this._selection = selection;\r\n        this._tabSize = tabSize;\r\n        this._type = type;\r\n        this._insertSpace = insertSpace;\r\n        this._selectionId = null;\r\n        this._deltaColumn = 0;\r\n        this._moveEndPositionDown = false;\r\n    }\r\n    /**\r\n     * Do an initial pass over the lines and gather info about the line comment string.\r\n     * Returns null if any of the lines doesn't support a line comment string.\r\n     */\r\n    LineCommentCommand._gatherPreflightCommentStrings = function (model, startLineNumber, endLineNumber) {\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        var commentStr = (config ? config.lineCommentToken : null);\r\n        if (!commentStr) {\r\n            // Mode does not support line comments\r\n            return null;\r\n        }\r\n        var lines = [];\r\n        for (var i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\r\n            lines[i] = {\r\n                ignore: false,\r\n                commentStr: commentStr,\r\n                commentStrOffset: 0,\r\n                commentStrLength: commentStr.length\r\n            };\r\n        }\r\n        return lines;\r\n    };\r\n    /**\r\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\r\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\r\n     */\r\n    LineCommentCommand._analyzeLines = function (type, insertSpace, model, lines, startLineNumber) {\r\n        var onlyWhitespaceLines = true;\r\n        var shouldRemoveComments;\r\n        if (type === 0 /* Toggle */) {\r\n            shouldRemoveComments = true;\r\n        }\r\n        else if (type === 1 /* ForceAdd */) {\r\n            shouldRemoveComments = false;\r\n        }\r\n        else {\r\n            shouldRemoveComments = true;\r\n        }\r\n        for (var i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n            var lineData = lines[i];\r\n            var lineNumber = startLineNumber + i;\r\n            var lineContent = model.getLineContent(lineNumber);\r\n            var lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\r\n            if (lineContentStartOffset === -1) {\r\n                // Empty or whitespace only line\r\n                if (type === 0 /* Toggle */) {\r\n                    lineData.ignore = true;\r\n                }\r\n                else if (type === 1 /* ForceAdd */) {\r\n                    lineData.ignore = true;\r\n                }\r\n                else {\r\n                    lineData.ignore = true;\r\n                }\r\n                lineData.commentStrOffset = lineContent.length;\r\n                continue;\r\n            }\r\n            onlyWhitespaceLines = false;\r\n            lineData.ignore = false;\r\n            lineData.commentStrOffset = lineContentStartOffset;\r\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\r\n                if (type === 0 /* Toggle */) {\r\n                    // Every line so far has been a line comment, but this one is not\r\n                    shouldRemoveComments = false;\r\n                }\r\n                else if (type === 1 /* ForceAdd */) {\r\n                    // Will not happen\r\n                }\r\n                else {\r\n                    lineData.ignore = true;\r\n                }\r\n            }\r\n            if (shouldRemoveComments && insertSpace) {\r\n                // Remove a following space if present\r\n                var commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\r\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* Space */) {\r\n                    lineData.commentStrLength += 1;\r\n                }\r\n            }\r\n        }\r\n        if (type === 0 /* Toggle */ && onlyWhitespaceLines) {\r\n            // For only whitespace lines, we insert comments\r\n            shouldRemoveComments = false;\r\n            // Also, no longer ignore them\r\n            for (var i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n                lines[i].ignore = false;\r\n            }\r\n        }\r\n        return {\r\n            supported: true,\r\n            shouldRemoveComments: shouldRemoveComments,\r\n            lines: lines\r\n        };\r\n    };\r\n    /**\r\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\r\n     */\r\n    LineCommentCommand._gatherPreflightData = function (type, insertSpace, model, startLineNumber, endLineNumber) {\r\n        var lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber);\r\n        if (lines === null) {\r\n            return {\r\n                supported: false\r\n            };\r\n        }\r\n        return LineCommentCommand._analyzeLines(type, insertSpace, model, lines, startLineNumber);\r\n    };\r\n    /**\r\n     * Given a successful analysis, execute either insert line comments, either remove line comments\r\n     */\r\n    LineCommentCommand.prototype._executeLineComments = function (model, builder, data, s) {\r\n        var ops;\r\n        if (data.shouldRemoveComments) {\r\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        else {\r\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._tabSize);\r\n            ops = this._createAddLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        var cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            builder.addEditOperation(ops[i].range, ops[i].text);\r\n            if (ops[i].range.isEmpty() && ops[i].range.getStartPosition().equals(cursorPosition)) {\r\n                var lineContent = model.getLineContent(cursorPosition.lineNumber);\r\n                if (lineContent.length + 1 === cursorPosition.column) {\r\n                    this._deltaColumn = (ops[i].text || '').length;\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    };\r\n    LineCommentCommand.prototype._attemptRemoveBlockComment = function (model, s, startToken, endToken) {\r\n        var startLineNumber = s.startLineNumber;\r\n        var endLineNumber = s.endLineNumber;\r\n        var startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\r\n        var startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\r\n        var endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\r\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            endLineNumber = startLineNumber;\r\n        }\r\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\r\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\r\n            startLineNumber = endLineNumber;\r\n        }\r\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\r\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\r\n            if (startTokenIndex !== -1) {\r\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            }\r\n        }\r\n        // We have to adjust to possible inner white space.\r\n        // For Space after startToken, add Space to startToken - range math will work out.\r\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n            startToken += ' ';\r\n        }\r\n        // For Space before endToken, add Space before endToken and shift index one left.\r\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n            endToken = ' ' + endToken;\r\n            endTokenIndex -= 1;\r\n        }\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * Given an unsuccessful analysis, delegate to the block comment command\r\n     */\r\n    LineCommentCommand.prototype._executeBlockComment = function (model, builder, s) {\r\n        model.tokenizeIfCheap(s.startLineNumber);\r\n        var languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\r\n        var config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        var startToken = config.blockCommentStartToken;\r\n        var endToken = config.blockCommentEndToken;\r\n        var ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\r\n        if (!ops) {\r\n            if (s.isEmpty()) {\r\n                var lineContent = model.getLineContent(s.startLineNumber);\r\n                var firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\r\n                if (firstNonWhitespaceIndex === -1) {\r\n                    // Line is empty or contains only whitespace\r\n                    firstNonWhitespaceIndex = lineContent.length;\r\n                }\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken, this._insertSpace);\r\n            }\r\n            else {\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken, this._insertSpace);\r\n            }\r\n            if (ops.length === 1) {\r\n                // Leave cursor after token and Space\r\n                this._deltaColumn = startToken.length + 1;\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        for (var _i = 0, ops_1 = ops; _i < ops_1.length; _i++) {\r\n            var op = ops_1[_i];\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n    };\r\n    LineCommentCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._moveEndPositionDown = false;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var data = LineCommentCommand._gatherPreflightData(this._type, this._insertSpace, model, s.startLineNumber, s.endLineNumber);\r\n        if (data.supported) {\r\n            return this._executeLineComments(model, builder, data, s);\r\n        }\r\n        return this._executeBlockComment(model, builder, s);\r\n    };\r\n    LineCommentCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\r\n    };\r\n    /**\r\n     * Generate edit operations in the remove line comment case\r\n     */\r\n    LineCommentCommand._createRemoveLineCommentsOperations = function (lines, startLineNumber) {\r\n        var res = [];\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            var lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\r\n        }\r\n        return res;\r\n    };\r\n    /**\r\n     * Generate edit operations in the add line comment case\r\n     */\r\n    LineCommentCommand.prototype._createAddLineCommentsOperations = function (lines, startLineNumber) {\r\n        var res = [];\r\n        var afterCommentStr = this._insertSpace ? ' ' : '';\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            var lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + afterCommentStr));\r\n        }\r\n        return res;\r\n    };\r\n    LineCommentCommand.nextVisibleColumn = function (currentVisibleColumn, tabSize, isTab, columnSize) {\r\n        if (isTab) {\r\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\r\n        }\r\n        return currentVisibleColumn + columnSize;\r\n    };\r\n    /**\r\n     * Adjust insertion points to have them vertically aligned in the add line comment case\r\n     */\r\n    LineCommentCommand._normalizeInsertionPoint = function (model, lines, startLineNumber, tabSize) {\r\n        var minVisibleColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        var j;\r\n        var lenJ;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            var lineContent = model.getLineContent(startLineNumber + i);\r\n            var currentVisibleColumn = 0;\r\n            for (var j_1 = 0, lenJ_1 = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j_1 < lenJ_1; j_1++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j_1) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn < minVisibleColumn) {\r\n                minVisibleColumn = currentVisibleColumn;\r\n            }\r\n        }\r\n        minVisibleColumn = Math.floor(minVisibleColumn / tabSize) * tabSize;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            var lineContent = model.getLineContent(startLineNumber + i);\r\n            var currentVisibleColumn = 0;\r\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn > minVisibleColumn) {\r\n                lines[i].commentStrOffset = j - 1;\r\n            }\r\n            else {\r\n                lines[i].commentStrOffset = j;\r\n            }\r\n        }\r\n    };\r\n    return LineCommentCommand;\r\n}());\r\nexport { LineCommentCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nimport { LineCommentCommand } from './lineCommentCommand.js';\r\nvar CommentLineAction = /** @class */ (function (_super) {\r\n    __extends(CommentLineAction, _super);\r\n    function CommentLineAction(type, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._type = type;\r\n        return _this;\r\n    }\r\n    CommentLineAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        var modelOptions = model.getOptions();\r\n        var commentsOptions = editor.getOption(13 /* comments */);\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new LineCommentCommand(selection, modelOptions.tabSize, this._type, commentsOptions.insertSpace));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return CommentLineAction;\r\n}(EditorAction));\r\nvar ToggleCommentLineAction = /** @class */ (function (_super) {\r\n    __extends(ToggleCommentLineAction, _super);\r\n    function ToggleCommentLineAction() {\r\n        return _super.call(this, 0 /* Toggle */, {\r\n            id: 'editor.action.commentLine',\r\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\r\n            alias: 'Toggle Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    return ToggleCommentLineAction;\r\n}(CommentLineAction));\r\nvar AddLineCommentAction = /** @class */ (function (_super) {\r\n    __extends(AddLineCommentAction, _super);\r\n    function AddLineCommentAction() {\r\n        return _super.call(this, 1 /* ForceAdd */, {\r\n            id: 'editor.action.addCommentLine',\r\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\r\n            alias: 'Add Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 33 /* KEY_C */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return AddLineCommentAction;\r\n}(CommentLineAction));\r\nvar RemoveLineCommentAction = /** @class */ (function (_super) {\r\n    __extends(RemoveLineCommentAction, _super);\r\n    function RemoveLineCommentAction() {\r\n        return _super.call(this, 2 /* ForceRemove */, {\r\n            id: 'editor.action.removeCommentLine',\r\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\r\n            alias: 'Remove Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 51 /* KEY_U */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return RemoveLineCommentAction;\r\n}(CommentLineAction));\r\nvar BlockCommentAction = /** @class */ (function (_super) {\r\n    __extends(BlockCommentAction, _super);\r\n    function BlockCommentAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.blockComment',\r\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\r\n            alias: 'Toggle Block Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 31 /* KEY_A */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 31 /* KEY_A */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    BlockCommentAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commentsOptions = editor.getOption(13 /* comments */);\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_2 = selections; _i < selections_2.length; _i++) {\r\n            var selection = selections_2[_i];\r\n            commands.push(new BlockCommentCommand(selection, commentsOptions.insertSpace));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return BlockCommentAction;\r\n}(EditorAction));\r\nregisterEditorAction(ToggleCommentLineAction);\r\nregisterEditorAction(AddLineCommentAction);\r\nregisterEditorAction(RemoveLineCommentAction);\r\nregisterEditorAction(BlockCommentAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { SubmenuAction } from './ui/menu/menu.js';\r\nvar ContextSubMenu = /** @class */ (function (_super) {\r\n    __extends(ContextSubMenu, _super);\r\n    function ContextSubMenu(label, entries) {\r\n        var _this = _super.call(this, label, entries, 'contextsubmenu') || this;\r\n        _this.entries = entries;\r\n        return _this;\r\n    }\r\n    return ContextSubMenu;\r\n}(SubmenuAction));\r\nexport { ContextSubMenu };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionViewItem, Separator } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IMenuService, SubmenuItemAction } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { ContextSubMenu } from '../../../base/browser/contextmenu.js';\r\nvar ContextMenuController = /** @class */ (function () {\r\n    function ContextMenuController(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService) {\r\n        var _this = this;\r\n        this._contextMenuService = _contextMenuService;\r\n        this._contextViewService = _contextViewService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._keybindingService = _keybindingService;\r\n        this._menuService = _menuService;\r\n        this._toDispose = new DisposableStore();\r\n        this._contextMenuIsBeingShownCount = 0;\r\n        this._editor = editor;\r\n        this._toDispose.add(this._editor.onContextMenu(function (e) { return _this._onContextMenu(e); }));\r\n        this._toDispose.add(this._editor.onMouseWheel(function (e) {\r\n            if (_this._contextMenuIsBeingShownCount > 0) {\r\n                _this._contextViewService.hideContextView();\r\n            }\r\n        }));\r\n        this._toDispose.add(this._editor.onKeyDown(function (e) {\r\n            if (e.keyCode === 58 /* ContextMenu */) {\r\n                // Chrome is funny like that\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                _this.showContextMenu();\r\n            }\r\n        }));\r\n    }\r\n    ContextMenuController.get = function (editor) {\r\n        return editor.getContribution(ContextMenuController.ID);\r\n    };\r\n    ContextMenuController.prototype._onContextMenu = function (e) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._editor.getOption(14 /* contextmenu */)) {\r\n            this._editor.focus();\r\n            // Ensure the cursor is at the position of the mouse click\r\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (e.target.type === 12 /* OVERLAY_WIDGET */) {\r\n            return; // allow native menu on widgets to support right click on input field for example in find\r\n        }\r\n        e.event.preventDefault();\r\n        if (e.target.type !== 6 /* CONTENT_TEXT */ && e.target.type !== 7 /* CONTENT_EMPTY */ && e.target.type !== 1 /* TEXTAREA */) {\r\n            return; // only support mouse click into text or native context menu key for now\r\n        }\r\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\r\n        this._editor.focus();\r\n        // Ensure the cursor is at the position of the mouse click\r\n        if (e.target.position) {\r\n            var hasSelectionAtPosition = false;\r\n            for (var _i = 0, _a = this._editor.getSelections(); _i < _a.length; _i++) {\r\n                var selection = _a[_i];\r\n                if (selection.containsPosition(e.target.position)) {\r\n                    hasSelectionAtPosition = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!hasSelectionAtPosition) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n        }\r\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\r\n        var anchor = null;\r\n        if (e.target.type !== 1 /* TEXTAREA */) {\r\n            anchor = { x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 };\r\n        }\r\n        // Show the context menu\r\n        this.showContextMenu(anchor);\r\n    };\r\n    ContextMenuController.prototype.showContextMenu = function (anchor) {\r\n        if (!this._editor.getOption(14 /* contextmenu */)) {\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._contextMenuService) {\r\n            this._editor.focus();\r\n            return; // We need the context menu service to function\r\n        }\r\n        // Find actions available for menu\r\n        var menuActions = this._getMenuActions(this._editor.getModel(), 7 /* EditorContext */);\r\n        // Show menu if we have actions to show\r\n        if (menuActions.length > 0) {\r\n            this._doShowContextMenu(menuActions, anchor);\r\n        }\r\n    };\r\n    ContextMenuController.prototype._getMenuActions = function (model, menuId) {\r\n        var result = [];\r\n        // get menu groups\r\n        var menu = this._menuService.createMenu(menuId, this._contextKeyService);\r\n        var groups = menu.getActions({ arg: model.uri });\r\n        menu.dispose();\r\n        // translate them into other actions\r\n        for (var _i = 0, groups_1 = groups; _i < groups_1.length; _i++) {\r\n            var group = groups_1[_i];\r\n            var actions = group[1];\r\n            var addedItems = 0;\r\n            for (var _a = 0, actions_1 = actions; _a < actions_1.length; _a++) {\r\n                var action = actions_1[_a];\r\n                if (action instanceof SubmenuItemAction) {\r\n                    var subActions = this._getMenuActions(model, action.item.submenu);\r\n                    if (subActions.length > 0) {\r\n                        result.push(new ContextSubMenu(action.label, subActions));\r\n                        addedItems++;\r\n                    }\r\n                }\r\n                else {\r\n                    result.push(action);\r\n                    addedItems++;\r\n                }\r\n            }\r\n            if (addedItems) {\r\n                result.push(new Separator());\r\n            }\r\n        }\r\n        if (result.length) {\r\n            result.pop(); // remove last separator\r\n        }\r\n        return result;\r\n    };\r\n    ContextMenuController.prototype._doShowContextMenu = function (actions, anchor) {\r\n        var _this = this;\r\n        if (anchor === void 0) { anchor = null; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // Disable hover\r\n        var oldHoverSetting = this._editor.getOption(44 /* hover */);\r\n        this._editor.updateOptions({\r\n            hover: {\r\n                enabled: false\r\n            }\r\n        });\r\n        if (!anchor) {\r\n            // Ensure selection is visible\r\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* Immediate */);\r\n            this._editor.render();\r\n            var cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\r\n            // Translate to absolute editor position\r\n            var editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\r\n            var posx = editorCoords.left + cursorCoords.left;\r\n            var posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n            anchor = { x: posx, y: posy };\r\n        }\r\n        // Show menu\r\n        this._contextMenuIsBeingShownCount++;\r\n        this._contextMenuService.showContextMenu({\r\n            getAnchor: function () { return anchor; },\r\n            getActions: function () { return actions; },\r\n            getActionViewItem: function (action) {\r\n                var keybinding = _this._keybindingFor(action);\r\n                if (keybinding) {\r\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\r\n                }\r\n                var customActionViewItem = action;\r\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\r\n                    return customActionViewItem.getActionViewItem();\r\n                }\r\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\r\n            },\r\n            getKeyBinding: function (action) {\r\n                return _this._keybindingFor(action);\r\n            },\r\n            onHide: function (wasCancelled) {\r\n                _this._contextMenuIsBeingShownCount--;\r\n                _this._editor.focus();\r\n                _this._editor.updateOptions({\r\n                    hover: oldHoverSetting\r\n                });\r\n            }\r\n        });\r\n    };\r\n    ContextMenuController.prototype._keybindingFor = function (action) {\r\n        return this._keybindingService.lookupKeybinding(action.id);\r\n    };\r\n    ContextMenuController.prototype.dispose = function () {\r\n        if (this._contextMenuIsBeingShownCount > 0) {\r\n            this._contextViewService.hideContextView();\r\n        }\r\n        this._toDispose.dispose();\r\n    };\r\n    ContextMenuController.ID = 'editor.contrib.contextmenu';\r\n    ContextMenuController = __decorate([\r\n        __param(1, IContextMenuService),\r\n        __param(2, IContextViewService),\r\n        __param(3, IContextKeyService),\r\n        __param(4, IKeybindingService),\r\n        __param(5, IMenuService)\r\n    ], ContextMenuController);\r\n    return ContextMenuController;\r\n}());\r\nexport { ContextMenuController };\r\nvar ShowContextMenu = /** @class */ (function (_super) {\r\n    __extends(ShowContextMenu, _super);\r\n    function ShowContextMenu() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showContextMenu',\r\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\r\n            alias: 'Show Editor Context Menu',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 1024 /* Shift */ | 68 /* F10 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowContextMenu.prototype.run = function (accessor, editor) {\r\n        var contribution = ContextMenuController.get(editor);\r\n        contribution.showContextMenu();\r\n    };\r\n    return ShowContextMenu;\r\n}(EditorAction));\r\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController);\r\nregisterEditorAction(ShowContextMenu);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nvar CursorState = /** @class */ (function () {\r\n    function CursorState(selections) {\r\n        this.selections = selections;\r\n    }\r\n    CursorState.prototype.equals = function (other) {\r\n        var thisLen = this.selections.length;\r\n        var otherLen = other.selections.length;\r\n        if (thisLen !== otherLen) {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < thisLen; i++) {\r\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return CursorState;\r\n}());\r\nvar StackElement = /** @class */ (function () {\r\n    function StackElement(cursorState, scrollTop, scrollLeft) {\r\n        this.cursorState = cursorState;\r\n        this.scrollTop = scrollTop;\r\n        this.scrollLeft = scrollLeft;\r\n    }\r\n    return StackElement;\r\n}());\r\nvar CursorUndoRedoController = /** @class */ (function (_super) {\r\n    __extends(CursorUndoRedoController, _super);\r\n    function CursorUndoRedoController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._isCursorUndoRedo = false;\r\n        _this._undoStack = [];\r\n        _this._redoStack = [];\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeModelContent(function (e) {\r\n            _this._undoStack = [];\r\n            _this._redoStack = [];\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this._isCursorUndoRedo) {\r\n                return;\r\n            }\r\n            if (!e.oldSelections) {\r\n                return;\r\n            }\r\n            if (e.oldModelVersionId !== e.modelVersionId) {\r\n                return;\r\n            }\r\n            var prevState = new CursorState(e.oldSelections);\r\n            var isEqualToLastUndoStack = (_this._undoStack.length > 0 && _this._undoStack[_this._undoStack.length - 1].cursorState.equals(prevState));\r\n            if (!isEqualToLastUndoStack) {\r\n                _this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\r\n                _this._redoStack = [];\r\n                if (_this._undoStack.length > 50) {\r\n                    // keep the cursor undo stack bounded\r\n                    _this._undoStack.shift();\r\n                }\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    CursorUndoRedoController.get = function (editor) {\r\n        return editor.getContribution(CursorUndoRedoController.ID);\r\n    };\r\n    CursorUndoRedoController.prototype.cursorUndo = function () {\r\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._undoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype.cursorRedo = function () {\r\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._redoStack.pop());\r\n    };\r\n    CursorUndoRedoController.prototype._applyState = function (stackElement) {\r\n        this._isCursorUndoRedo = true;\r\n        this._editor.setSelections(stackElement.cursorState.selections);\r\n        this._editor.setScrollPosition({\r\n            scrollTop: stackElement.scrollTop,\r\n            scrollLeft: stackElement.scrollLeft\r\n        });\r\n        this._isCursorUndoRedo = false;\r\n    };\r\n    CursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\r\n    return CursorUndoRedoController;\r\n}(Disposable));\r\nexport { CursorUndoRedoController };\r\nvar CursorUndo = /** @class */ (function (_super) {\r\n    __extends(CursorUndo, _super);\r\n    function CursorUndo() {\r\n        return _super.call(this, {\r\n            id: 'cursorUndo',\r\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\r\n            alias: 'Cursor Undo',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 51 /* KEY_U */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorUndo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorUndo();\r\n    };\r\n    return CursorUndo;\r\n}(EditorAction));\r\nexport { CursorUndo };\r\nvar CursorRedo = /** @class */ (function (_super) {\r\n    __extends(CursorRedo, _super);\r\n    function CursorRedo() {\r\n        return _super.call(this, {\r\n            id: 'cursorRedo',\r\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\r\n            alias: 'Cursor Redo',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    CursorRedo.prototype.run = function (accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorRedo();\r\n    };\r\n    return CursorRedo;\r\n}(EditorAction));\r\nexport { CursorRedo };\r\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\r\nregisterEditorAction(CursorUndo);\r\nregisterEditorAction(CursorRedo);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar DragAndDropCommand = /** @class */ (function () {\r\n    function DragAndDropCommand(selection, targetPosition, copy) {\r\n        this.selection = selection;\r\n        this.targetPosition = targetPosition;\r\n        this.copy = copy;\r\n        this.targetSelection = null;\r\n    }\r\n    DragAndDropCommand.prototype.getEditOperations = function (model, builder) {\r\n        var text = model.getValueInRange(this.selection);\r\n        if (!this.copy) {\r\n            builder.addEditOperation(this.selection, null);\r\n        }\r\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\r\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\r\n        )) {\r\n            this.targetSelection = this.selection;\r\n            return;\r\n        }\r\n        if (this.copy) {\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\r\n            // Drag the selection downwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\r\n            // Drag the selection upwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        // The target position is at the same line as the selection's end position.\r\n        if (this.selection.endColumn <= this.targetPosition.column) {\r\n            // The target position is after the selection's end position\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column :\r\n                this.selection.endColumn);\r\n        }\r\n        else {\r\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\r\n        }\r\n    };\r\n    DragAndDropCommand.prototype.computeCursorState = function (model, helper) {\r\n        return this.targetSelection;\r\n    };\r\n    return DragAndDropCommand;\r\n}());\r\nexport { DragAndDropCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './dnd.css';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { isMacintosh } from '../../../base/common/platform.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nfunction hasTriggerModifier(e) {\r\n    if (isMacintosh) {\r\n        return e.altKey;\r\n    }\r\n    else {\r\n        return e.ctrlKey;\r\n    }\r\n}\r\nvar DragAndDropController = /** @class */ (function (_super) {\r\n    __extends(DragAndDropController, _super);\r\n    function DragAndDropController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this._onEditorMouseDown(e); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this._onEditorMouseUp(e); }));\r\n        _this._register(_this._editor.onMouseDrag(function (e) { return _this._onEditorMouseDrag(e); }));\r\n        _this._register(_this._editor.onMouseDrop(function (e) { return _this._onEditorMouseDrop(e); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(e); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(e); }));\r\n        _this._register(_this._editor.onDidBlurEditorWidget(function () { return _this.onEditorBlur(); }));\r\n        _this._dndDecorationIds = [];\r\n        _this._mouseDown = false;\r\n        _this._modifierPressed = false;\r\n        _this._dragSelection = null;\r\n        return _this;\r\n    }\r\n    DragAndDropController.prototype.onEditorBlur = function () {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n    };\r\n    DragAndDropController.prototype.onEditorKeyDown = function (e) {\r\n        if (!this._editor.getOption(24 /* dragAndDrop */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = true;\r\n        }\r\n        if (this._mouseDown && hasTriggerModifier(e)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n    };\r\n    DragAndDropController.prototype.onEditorKeyUp = function (e) {\r\n        if (!this._editor.getOption(24 /* dragAndDrop */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = false;\r\n        }\r\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDown = function (mouseEvent) {\r\n        this._mouseDown = true;\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseUp = function (mouseEvent) {\r\n        this._mouseDown = false;\r\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDrag = function (mouseEvent) {\r\n        var target = mouseEvent.target;\r\n        if (this._dragSelection === null) {\r\n            var selections = this._editor.getSelections() || [];\r\n            var possibleSelections = selections.filter(function (selection) { return target.position && selection.containsPosition(target.position); });\r\n            if (possibleSelections.length === 1) {\r\n                this._dragSelection = possibleSelections[0];\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n        }\r\n        if (hasTriggerModifier(mouseEvent.event)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n        else {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n        if (target.position) {\r\n            if (this._dragSelection.containsPosition(target.position)) {\r\n                this._removeDecoration();\r\n            }\r\n            else {\r\n                this.showAt(target.position);\r\n            }\r\n        }\r\n    };\r\n    DragAndDropController.prototype._onEditorMouseDrop = function (mouseEvent) {\r\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\r\n            var newCursorPosition_1 = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\r\n            if (this._dragSelection === null) {\r\n                var newSelections = null;\r\n                if (mouseEvent.event.shiftKey) {\r\n                    var primarySelection = this._editor.getSelection();\r\n                    if (primarySelection) {\r\n                        var selectionStartLineNumber = primarySelection.selectionStartLineNumber, selectionStartColumn = primarySelection.selectionStartColumn;\r\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition_1.lineNumber, newCursorPosition_1.column)];\r\n                    }\r\n                }\r\n                else {\r\n                    newSelections = (this._editor.getSelections() || []).map(function (selection) {\r\n                        if (selection.containsPosition(newCursorPosition_1)) {\r\n                            return new Selection(newCursorPosition_1.lineNumber, newCursorPosition_1.column, newCursorPosition_1.lineNumber, newCursorPosition_1.column);\r\n                        }\r\n                        else {\r\n                            return selection;\r\n                        }\r\n                    });\r\n                }\r\n                // Use `mouse` as the source instead of `api`.\r\n                this._editor.setSelections(newSelections || [], 'mouse');\r\n            }\r\n            else if (!this._dragSelection.containsPosition(newCursorPosition_1) ||\r\n                ((hasTriggerModifier(mouseEvent.event) ||\r\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition_1) || this._dragSelection.getStartPosition().equals(newCursorPosition_1)) // we allow users to paste content beside the selection\r\n                )) {\r\n                this._editor.pushUndoStop();\r\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition_1, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\r\n                this._editor.pushUndoStop();\r\n            }\r\n        }\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n    };\r\n    DragAndDropController.prototype.showAt = function (position) {\r\n        var newDecorations = [{\r\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\r\n                options: DragAndDropController._DECORATION_OPTIONS\r\n            }];\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, newDecorations);\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n    };\r\n    DragAndDropController.prototype._removeDecoration = function () {\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, []);\r\n    };\r\n    DragAndDropController.prototype._hitContent = function (target) {\r\n        return target.type === 6 /* CONTENT_TEXT */ ||\r\n            target.type === 7 /* CONTENT_EMPTY */;\r\n    };\r\n    DragAndDropController.prototype._hitMargin = function (target) {\r\n        return target.type === 2 /* GUTTER_GLYPH_MARGIN */ ||\r\n            target.type === 3 /* GUTTER_LINE_NUMBERS */ ||\r\n            target.type === 4 /* GUTTER_LINE_DECORATIONS */;\r\n    };\r\n    DragAndDropController.prototype.dispose = function () {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    DragAndDropController.ID = 'editor.contrib.dragAndDrop';\r\n    DragAndDropController.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* Alt */ : 5 /* Ctrl */;\r\n    DragAndDropController._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n        className: 'dnd-target'\r\n    });\r\n    return DragAndDropController;\r\n}(Disposable));\r\nexport { DragAndDropController };\r\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { OverviewRulerLane, MinimapPosition } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { overviewRulerFindMatchForeground, minimapFindMatch } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nvar FindDecorations = /** @class */ (function () {\r\n    function FindDecorations(editor) {\r\n        this._editor = editor;\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n        this._startPosition = this._editor.getPosition();\r\n    }\r\n    FindDecorations.prototype.dispose = function () {\r\n        this._editor.deltaDecorations(this._allDecorations(), []);\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    };\r\n    FindDecorations.prototype.reset = function () {\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationId = null;\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    };\r\n    FindDecorations.prototype.getCount = function () {\r\n        return this._decorations.length;\r\n    };\r\n    FindDecorations.prototype.getFindScope = function () {\r\n        if (this._findScopeDecorationId) {\r\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationId);\r\n        }\r\n        return null;\r\n    };\r\n    FindDecorations.prototype.getStartPosition = function () {\r\n        return this._startPosition;\r\n    };\r\n    FindDecorations.prototype.setStartPosition = function (newStartPosition) {\r\n        this._startPosition = newStartPosition;\r\n        this.setCurrentFindMatch(null);\r\n    };\r\n    FindDecorations.prototype._getDecorationIndex = function (decorationId) {\r\n        var index = this._decorations.indexOf(decorationId);\r\n        if (index >= 0) {\r\n            return index + 1;\r\n        }\r\n        return 1;\r\n    };\r\n    FindDecorations.prototype.getCurrentMatchesPosition = function (desiredRange) {\r\n        var candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\r\n        for (var _i = 0, candidates_1 = candidates; _i < candidates_1.length; _i++) {\r\n            var candidate = candidates_1[_i];\r\n            var candidateOpts = candidate.options;\r\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\r\n                return this._getDecorationIndex(candidate.id);\r\n            }\r\n        }\r\n        return 1;\r\n    };\r\n    FindDecorations.prototype.setCurrentFindMatch = function (nextMatch) {\r\n        var _this = this;\r\n        var newCurrentDecorationId = null;\r\n        var matchPosition = 0;\r\n        if (nextMatch) {\r\n            for (var i = 0, len = this._decorations.length; i < len; i++) {\r\n                var range = this._editor.getModel().getDecorationRange(this._decorations[i]);\r\n                if (nextMatch.equalsRange(range)) {\r\n                    newCurrentDecorationId = this._decorations[i];\r\n                    matchPosition = (i + 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\r\n            this._editor.changeDecorations(function (changeAccessor) {\r\n                if (_this._highlightedDecorationId !== null) {\r\n                    changeAccessor.changeDecorationOptions(_this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\r\n                    _this._highlightedDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    _this._highlightedDecorationId = newCurrentDecorationId;\r\n                    changeAccessor.changeDecorationOptions(_this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\r\n                }\r\n                if (_this._rangeHighlightDecorationId !== null) {\r\n                    changeAccessor.removeDecoration(_this._rangeHighlightDecorationId);\r\n                    _this._rangeHighlightDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    var rng = _this._editor.getModel().getDecorationRange(newCurrentDecorationId);\r\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\r\n                        var lineBeforeEnd = rng.endLineNumber - 1;\r\n                        var lineBeforeEndMaxColumn = _this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\r\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\r\n                    }\r\n                    _this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\r\n                }\r\n            });\r\n        }\r\n        return matchPosition;\r\n    };\r\n    FindDecorations.prototype.set = function (findMatches, findScope) {\r\n        var _this = this;\r\n        this._editor.changeDecorations(function (accessor) {\r\n            var findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\r\n            var newOverviewRulerApproximateDecorations = [];\r\n            if (findMatches.length > 1000) {\r\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\r\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\r\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\r\n                // approximate a distance in lines where matches should be merged\r\n                var lineCount = _this._editor.getModel().getLineCount();\r\n                var height = _this._editor.getLayoutInfo().height;\r\n                var approxPixelsPerLine = height / lineCount;\r\n                var mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\r\n                // merge decorations as much as possible\r\n                var prevStartLineNumber = findMatches[0].range.startLineNumber;\r\n                var prevEndLineNumber = findMatches[0].range.endLineNumber;\r\n                for (var i = 1, len = findMatches.length; i < len; i++) {\r\n                    var range = findMatches[i].range;\r\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\r\n                        if (range.endLineNumber > prevEndLineNumber) {\r\n                            prevEndLineNumber = range.endLineNumber;\r\n                        }\r\n                    }\r\n                    else {\r\n                        newOverviewRulerApproximateDecorations.push({\r\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                        });\r\n                        prevStartLineNumber = range.startLineNumber;\r\n                        prevEndLineNumber = range.endLineNumber;\r\n                    }\r\n                }\r\n                newOverviewRulerApproximateDecorations.push({\r\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                });\r\n            }\r\n            // Find matches\r\n            var newFindMatchesDecorations = new Array(findMatches.length);\r\n            for (var i = 0, len = findMatches.length; i < len; i++) {\r\n                newFindMatchesDecorations[i] = {\r\n                    range: findMatches[i].range,\r\n                    options: findMatchesOptions\r\n                };\r\n            }\r\n            _this._decorations = accessor.deltaDecorations(_this._decorations, newFindMatchesDecorations);\r\n            // Overview ruler approximate decorations\r\n            _this._overviewRulerApproximateDecorations = accessor.deltaDecorations(_this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\r\n            // Range highlight\r\n            if (_this._rangeHighlightDecorationId) {\r\n                accessor.removeDecoration(_this._rangeHighlightDecorationId);\r\n                _this._rangeHighlightDecorationId = null;\r\n            }\r\n            // Find scope\r\n            if (_this._findScopeDecorationId) {\r\n                accessor.removeDecoration(_this._findScopeDecorationId);\r\n                _this._findScopeDecorationId = null;\r\n            }\r\n            if (findScope) {\r\n                _this._findScopeDecorationId = accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION);\r\n            }\r\n        });\r\n    };\r\n    FindDecorations.prototype.matchBeforePosition = function (position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (var i = this._decorations.length - 1; i >= 0; i--) {\r\n            var decorationId = this._decorations[i];\r\n            var r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.endLineNumber > position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.endLineNumber < position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.endColumn > position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\r\n    };\r\n    FindDecorations.prototype.matchAfterPosition = function (position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (var i = 0, len = this._decorations.length; i < len; i++) {\r\n            var decorationId = this._decorations[i];\r\n            var r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.startLineNumber < position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.startLineNumber > position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.startColumn < position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\r\n    };\r\n    FindDecorations.prototype._allDecorations = function () {\r\n        var result = [];\r\n        result = result.concat(this._decorations);\r\n        result = result.concat(this._overviewRulerApproximateDecorations);\r\n        if (this._findScopeDecorationId) {\r\n            result.push(this._findScopeDecorationId);\r\n        }\r\n        if (this._rangeHighlightDecorationId) {\r\n            result.push(this._rangeHighlightDecorationId);\r\n        }\r\n        return result;\r\n    };\r\n    FindDecorations._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        zIndex: 13,\r\n        className: 'currentFindMatch',\r\n        showIfCollapsed: true,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        },\r\n        minimap: {\r\n            color: themeColorFromId(minimapFindMatch),\r\n            position: MinimapPosition.Inline\r\n        }\r\n    });\r\n    FindDecorations._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'findMatch',\r\n        showIfCollapsed: true,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        },\r\n        minimap: {\r\n            color: themeColorFromId(minimapFindMatch),\r\n            position: MinimapPosition.Inline\r\n        }\r\n    });\r\n    FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'findMatch',\r\n        showIfCollapsed: true\r\n    });\r\n    FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerFindMatchForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    FindDecorations._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'rangeHighlight',\r\n        isWholeLine: true\r\n    });\r\n    FindDecorations._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\r\n        className: 'findScope',\r\n        isWholeLine: true\r\n    });\r\n    return FindDecorations;\r\n}());\r\nexport { FindDecorations };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nvar ReplaceAllCommand = /** @class */ (function () {\r\n    function ReplaceAllCommand(editorSelection, ranges, replaceStrings) {\r\n        this._editorSelection = editorSelection;\r\n        this._ranges = ranges;\r\n        this._replaceStrings = replaceStrings;\r\n        this._trackedEditorSelectionId = null;\r\n    }\r\n    ReplaceAllCommand.prototype.getEditOperations = function (model, builder) {\r\n        if (this._ranges.length > 0) {\r\n            // Collect all edit operations\r\n            var ops = [];\r\n            for (var i = 0; i < this._ranges.length; i++) {\r\n                ops.push({\r\n                    range: this._ranges[i],\r\n                    text: this._replaceStrings[i]\r\n                });\r\n            }\r\n            // Sort them in ascending order by range starts\r\n            ops.sort(function (o1, o2) {\r\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\r\n            });\r\n            // Merge operations that touch each other\r\n            var resultOps = [];\r\n            var previousOp = ops[0];\r\n            for (var i = 1; i < ops.length; i++) {\r\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\r\n                    // These operations are one after another and can be merged\r\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\r\n                    previousOp.text = previousOp.text + ops[i].text;\r\n                }\r\n                else {\r\n                    resultOps.push(previousOp);\r\n                    previousOp = ops[i];\r\n                }\r\n            }\r\n            resultOps.push(previousOp);\r\n            for (var _i = 0, resultOps_1 = resultOps; _i < resultOps_1.length; _i++) {\r\n                var op = resultOps_1[_i];\r\n                builder.addEditOperation(op.range, op.text);\r\n            }\r\n        }\r\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\r\n    };\r\n    ReplaceAllCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\r\n    };\r\n    return ReplaceAllCommand;\r\n}());\r\nexport { ReplaceAllCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from './strings.js';\r\nexport function buildReplaceStringWithCasePreserved(matches, pattern) {\r\n    if (matches && (matches[0] !== '')) {\r\n        var containsHyphens = validateSpecificSpecialCharacter(matches, pattern, '-');\r\n        var containsUnderscores = validateSpecificSpecialCharacter(matches, pattern, '_');\r\n        if (containsHyphens && !containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '-');\r\n        }\r\n        else if (!containsHyphens && containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '_');\r\n        }\r\n        if (matches[0].toUpperCase() === matches[0]) {\r\n            return pattern.toUpperCase();\r\n        }\r\n        else if (matches[0].toLowerCase() === matches[0]) {\r\n            return pattern.toLowerCase();\r\n        }\r\n        else if (strings.containsUppercaseCharacter(matches[0][0])) {\r\n            return pattern[0].toUpperCase() + pattern.substr(1);\r\n        }\r\n        else {\r\n            // we don't understand its pattern yet.\r\n            return pattern;\r\n        }\r\n    }\r\n    else {\r\n        return pattern;\r\n    }\r\n}\r\nfunction validateSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    var doesContainSpecialCharacter = matches[0].indexOf(specialCharacter) !== -1 && pattern.indexOf(specialCharacter) !== -1;\r\n    return doesContainSpecialCharacter && matches[0].split(specialCharacter).length === pattern.split(specialCharacter).length;\r\n}\r\nfunction buildReplaceStringForSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    var splitPatternAtSpecialCharacter = pattern.split(specialCharacter);\r\n    var splitMatchAtSpecialCharacter = matches[0].split(specialCharacter);\r\n    var replaceString = '';\r\n    splitPatternAtSpecialCharacter.forEach(function (splitValue, index) {\r\n        replaceString += buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]], splitValue) + specialCharacter;\r\n    });\r\n    return replaceString.slice(0, -1);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { buildReplaceStringWithCasePreserved } from '../../../base/common/search.js';\r\n/**\r\n * Assigned when the replace pattern is entirely static.\r\n */\r\nvar StaticValueReplacePattern = /** @class */ (function () {\r\n    function StaticValueReplacePattern(staticValue) {\r\n        this.staticValue = staticValue;\r\n        this.kind = 0 /* StaticValue */;\r\n    }\r\n    return StaticValueReplacePattern;\r\n}());\r\n/**\r\n * Assigned when the replace pattern has replacemend patterns.\r\n */\r\nvar DynamicPiecesReplacePattern = /** @class */ (function () {\r\n    function DynamicPiecesReplacePattern(pieces) {\r\n        this.pieces = pieces;\r\n        this.kind = 1 /* DynamicPieces */;\r\n    }\r\n    return DynamicPiecesReplacePattern;\r\n}());\r\nvar ReplacePattern = /** @class */ (function () {\r\n    function ReplacePattern(pieces) {\r\n        if (!pieces || pieces.length === 0) {\r\n            this._state = new StaticValueReplacePattern('');\r\n        }\r\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\r\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\r\n        }\r\n        else {\r\n            this._state = new DynamicPiecesReplacePattern(pieces);\r\n        }\r\n    }\r\n    ReplacePattern.fromStaticValue = function (value) {\r\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\r\n    };\r\n    Object.defineProperty(ReplacePattern.prototype, \"hasReplacementPatterns\", {\r\n        get: function () {\r\n            return (this._state.kind === 1 /* DynamicPieces */);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReplacePattern.prototype.buildReplaceString = function (matches, preserveCase) {\r\n        if (this._state.kind === 0 /* StaticValue */) {\r\n            if (preserveCase) {\r\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\r\n            }\r\n            else {\r\n                return this._state.staticValue;\r\n            }\r\n        }\r\n        var result = '';\r\n        for (var i = 0, len = this._state.pieces.length; i < len; i++) {\r\n            var piece = this._state.pieces[i];\r\n            if (piece.staticValue !== null) {\r\n                // static value ReplacePiece\r\n                result += piece.staticValue;\r\n                continue;\r\n            }\r\n            // match index ReplacePiece\r\n            result += ReplacePattern._substitute(piece.matchIndex, matches);\r\n        }\r\n        return result;\r\n    };\r\n    ReplacePattern._substitute = function (matchIndex, matches) {\r\n        if (matches === null) {\r\n            return '';\r\n        }\r\n        if (matchIndex === 0) {\r\n            return matches[0];\r\n        }\r\n        var remainder = '';\r\n        while (matchIndex > 0) {\r\n            if (matchIndex < matches.length) {\r\n                // A match can be undefined\r\n                var match = (matches[matchIndex] || '');\r\n                return match + remainder;\r\n            }\r\n            remainder = String(matchIndex % 10) + remainder;\r\n            matchIndex = Math.floor(matchIndex / 10);\r\n        }\r\n        return '$' + remainder;\r\n    };\r\n    return ReplacePattern;\r\n}());\r\nexport { ReplacePattern };\r\n/**\r\n * A replace piece can either be a static string or an index to a specific match.\r\n */\r\nvar ReplacePiece = /** @class */ (function () {\r\n    function ReplacePiece(staticValue, matchIndex) {\r\n        this.staticValue = staticValue;\r\n        this.matchIndex = matchIndex;\r\n    }\r\n    ReplacePiece.staticValue = function (value) {\r\n        return new ReplacePiece(value, -1);\r\n    };\r\n    ReplacePiece.matchIndex = function (index) {\r\n        return new ReplacePiece(null, index);\r\n    };\r\n    return ReplacePiece;\r\n}());\r\nexport { ReplacePiece };\r\nvar ReplacePieceBuilder = /** @class */ (function () {\r\n    function ReplacePieceBuilder(source) {\r\n        this._source = source;\r\n        this._lastCharIndex = 0;\r\n        this._result = [];\r\n        this._resultLen = 0;\r\n        this._currentStaticPiece = '';\r\n    }\r\n    ReplacePieceBuilder.prototype.emitUnchanged = function (toCharIndex) {\r\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype.emitStatic = function (value, toCharIndex) {\r\n        this._emitStatic(value);\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype._emitStatic = function (value) {\r\n        if (value.length === 0) {\r\n            return;\r\n        }\r\n        this._currentStaticPiece += value;\r\n    };\r\n    ReplacePieceBuilder.prototype.emitMatchIndex = function (index, toCharIndex) {\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        this._result[this._resultLen++] = ReplacePiece.matchIndex(index);\r\n        this._lastCharIndex = toCharIndex;\r\n    };\r\n    ReplacePieceBuilder.prototype.finalize = function () {\r\n        this.emitUnchanged(this._source.length);\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        return new ReplacePattern(this._result);\r\n    };\r\n    return ReplacePieceBuilder;\r\n}());\r\n/**\r\n * \\n\t\t\t=> inserts a LF\r\n * \\t\t\t\t=> inserts a TAB\r\n * \\\\\t\t\t=> inserts a \"\\\".\r\n * $$\t\t\t=> inserts a \"$\".\r\n * $& and $0\t=> inserts the matched substring.\r\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\r\n * everything else stays untouched\r\n *\r\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\r\n */\r\nexport function parseReplaceString(replaceString) {\r\n    if (!replaceString || replaceString.length === 0) {\r\n        return new ReplacePattern(null);\r\n    }\r\n    var result = new ReplacePieceBuilder(replaceString);\r\n    for (var i = 0, len = replaceString.length; i < len; i++) {\r\n        var chCode = replaceString.charCodeAt(i);\r\n        if (chCode === 92 /* Backslash */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a \\\r\n                break;\r\n            }\r\n            var nextChCode = replaceString.charCodeAt(i);\r\n            // let replaceWithCharacter: string | null = null;\r\n            switch (nextChCode) {\r\n                case 92 /* Backslash */:\r\n                    // \\\\ => inserts a \"\\\"\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\\\', i + 1);\r\n                    break;\r\n                case 110 /* n */:\r\n                    // \\n => inserts a LF\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\n', i + 1);\r\n                    break;\r\n                case 116 /* t */:\r\n                    // \\t => inserts a TAB\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\t', i + 1);\r\n                    break;\r\n            }\r\n            continue;\r\n        }\r\n        if (chCode === 36 /* DollarSign */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a $\r\n                break;\r\n            }\r\n            var nextChCode = replaceString.charCodeAt(i);\r\n            if (nextChCode === 36 /* DollarSign */) {\r\n                // $$ => inserts a \"$\"\r\n                result.emitUnchanged(i - 1);\r\n                result.emitStatic('$', i + 1);\r\n                continue;\r\n            }\r\n            if (nextChCode === 48 /* Digit0 */ || nextChCode === 38 /* Ampersand */) {\r\n                // $& and $0 => inserts the matched substring.\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(0, i + 1);\r\n                continue;\r\n            }\r\n            if (49 /* Digit1 */ <= nextChCode && nextChCode <= 57 /* Digit9 */) {\r\n                // $n\r\n                var matchIndex = nextChCode - 48 /* Digit0 */;\r\n                // peek next char to probe for $nn\r\n                if (i + 1 < len) {\r\n                    var nextNextChCode = replaceString.charCodeAt(i + 1);\r\n                    if (48 /* Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* Digit9 */) {\r\n                        // $nn\r\n                        // move to next char\r\n                        i++;\r\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* Digit0 */);\r\n                        result.emitUnchanged(i - 2);\r\n                        result.emitMatchIndex(matchIndex, i + 1);\r\n                        continue;\r\n                    }\r\n                }\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(matchIndex, i + 1);\r\n                continue;\r\n            }\r\n        }\r\n    }\r\n    return result.finalize();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../common/commands/replaceCommand.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { SearchParams } from '../../common/model/textModelSearch.js';\r\nimport { FindDecorations } from './findDecorations.js';\r\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\r\nimport { ReplacePattern, parseReplaceString } from './replacePattern.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nexport var CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\r\n// Keep ContextKey use of 'Focussed' to not break when clauses\r\nexport var CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\r\nexport var CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\r\nexport var ToggleCaseSensitiveKeybinding = {\r\n    primary: 512 /* Alt */ | 33 /* KEY_C */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 33 /* KEY_C */ }\r\n};\r\nexport var ToggleWholeWordKeybinding = {\r\n    primary: 512 /* Alt */ | 53 /* KEY_W */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 53 /* KEY_W */ }\r\n};\r\nexport var ToggleRegexKeybinding = {\r\n    primary: 512 /* Alt */ | 48 /* KEY_R */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 48 /* KEY_R */ }\r\n};\r\nexport var ToggleSearchScopeKeybinding = {\r\n    primary: 512 /* Alt */ | 42 /* KEY_L */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 42 /* KEY_L */ }\r\n};\r\nexport var FIND_IDS = {\r\n    StartFindAction: 'actions.find',\r\n    StartFindWithSelection: 'actions.findWithSelection',\r\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\r\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\r\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\r\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\r\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\r\n    CloseFindWidgetCommand: 'closeFindWidget',\r\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\r\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\r\n    ToggleRegexCommand: 'toggleFindRegex',\r\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\r\n    TogglePreserveCaseCommand: 'togglePreserveCase',\r\n    ReplaceOneAction: 'editor.action.replaceOne',\r\n    ReplaceAllAction: 'editor.action.replaceAll',\r\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\r\n};\r\nexport var MATCHES_LIMIT = 19999;\r\nvar RESEARCH_DELAY = 240;\r\nvar FindModelBoundToEditorModel = /** @class */ (function () {\r\n    function FindModelBoundToEditorModel(editor, state) {\r\n        var _this = this;\r\n        this._toDispose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._state = state;\r\n        this._isDisposed = false;\r\n        this._startSearchingTimer = new TimeoutTimer();\r\n        this._decorations = new FindDecorations(editor);\r\n        this._toDispose.add(this._decorations);\r\n        this._updateDecorationsScheduler = new RunOnceScheduler(function () { return _this.research(false); }, 100);\r\n        this._toDispose.add(this._updateDecorationsScheduler);\r\n        this._toDispose.add(this._editor.onDidChangeCursorPosition(function (e) {\r\n            if (e.reason === 3 /* Explicit */\r\n                || e.reason === 5 /* Undo */\r\n                || e.reason === 6 /* Redo */) {\r\n                _this._decorations.setStartPosition(_this._editor.getPosition());\r\n            }\r\n        }));\r\n        this._ignoreModelContentChanged = false;\r\n        this._toDispose.add(this._editor.onDidChangeModelContent(function (e) {\r\n            if (_this._ignoreModelContentChanged) {\r\n                return;\r\n            }\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                _this._decorations.reset();\r\n            }\r\n            _this._decorations.setStartPosition(_this._editor.getPosition());\r\n            _this._updateDecorationsScheduler.schedule();\r\n        }));\r\n        this._toDispose.add(this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        this.research(false, this._state.searchScope);\r\n    }\r\n    FindModelBoundToEditorModel.prototype.dispose = function () {\r\n        this._isDisposed = true;\r\n        dispose(this._startSearchingTimer);\r\n        this._toDispose.dispose();\r\n    };\r\n    FindModelBoundToEditorModel.prototype._onStateChanged = function (e) {\r\n        var _this = this;\r\n        if (this._isDisposed) {\r\n            // The find model is disposed during a find state changed event\r\n            return;\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            // The find model will be disposed momentarily\r\n            return;\r\n        }\r\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\r\n            var model = this._editor.getModel();\r\n            if (model.isTooLargeForSyncing()) {\r\n                this._startSearchingTimer.cancel();\r\n                this._startSearchingTimer.setIfNotSet(function () {\r\n                    if (e.searchScope) {\r\n                        _this.research(e.moveCursor, _this._state.searchScope);\r\n                    }\r\n                    else {\r\n                        _this.research(e.moveCursor);\r\n                    }\r\n                }, RESEARCH_DELAY);\r\n            }\r\n            else {\r\n                if (e.searchScope) {\r\n                    this.research(e.moveCursor, this._state.searchScope);\r\n                }\r\n                else {\r\n                    this.research(e.moveCursor);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel._getSearchRange = function (model, findScope) {\r\n        // If we have set now or before a find scope, use it for computing the search range\r\n        if (findScope) {\r\n            return findScope;\r\n        }\r\n        return model.getFullModelRange();\r\n    };\r\n    FindModelBoundToEditorModel.prototype.research = function (moveCursor, newFindScope) {\r\n        var findScope = null;\r\n        if (typeof newFindScope !== 'undefined') {\r\n            findScope = newFindScope;\r\n        }\r\n        else {\r\n            findScope = this._decorations.getFindScope();\r\n        }\r\n        if (findScope !== null) {\r\n            if (findScope.startLineNumber !== findScope.endLineNumber) {\r\n                if (findScope.endColumn === 1) {\r\n                    findScope = new Range(findScope.startLineNumber, 1, findScope.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(findScope.endLineNumber - 1));\r\n                }\r\n                else {\r\n                    // multiline find scope => expand to line starts / ends\r\n                    findScope = new Range(findScope.startLineNumber, 1, findScope.endLineNumber, this._editor.getModel().getLineMaxColumn(findScope.endLineNumber));\r\n                }\r\n            }\r\n        }\r\n        var findMatches = this._findMatches(findScope, false, MATCHES_LIMIT);\r\n        this._decorations.set(findMatches, findScope);\r\n        this._state.changeMatchInfo(this._decorations.getCurrentMatchesPosition(this._editor.getSelection()), this._decorations.getCount(), undefined);\r\n        if (moveCursor) {\r\n            this._moveToNextMatch(this._decorations.getStartPosition());\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._hasMatches = function () {\r\n        return (this._state.matchesCount > 0);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._cannotFind = function () {\r\n        if (!this._hasMatches()) {\r\n            var findScope = this._decorations.getFindScope();\r\n            if (findScope) {\r\n                // Reveal the selection so user is reminded that 'selection find' is on.\r\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* Smooth */);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    FindModelBoundToEditorModel.prototype._setCurrentFindMatch = function (match) {\r\n        var matchesPosition = this._decorations.setCurrentFindMatch(match);\r\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\r\n        this._editor.setSelection(match);\r\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* Smooth */);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._prevSearchPosition = function (before) {\r\n        var isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        var lineNumber = before.lineNumber, column = before.column;\r\n        var model = this._editor.getModel();\r\n        if (isUsingLineStops || column === 1) {\r\n            if (lineNumber === 1) {\r\n                lineNumber = model.getLineCount();\r\n            }\r\n            else {\r\n                lineNumber--;\r\n            }\r\n            column = model.getLineMaxColumn(lineNumber);\r\n        }\r\n        else {\r\n            column--;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._moveToPrevMatch = function (before, isRecursed) {\r\n        if (isRecursed === void 0) { isRecursed = false; }\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            var prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\r\n                before = this._prevSearchPosition(before);\r\n                prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            }\r\n            if (prevMatchRange) {\r\n                this._setCurrentFindMatch(prevMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        if (this._cannotFind()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(before)) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (before.isBefore(searchRange.getStartPosition())) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        var lineNumber = before.lineNumber, column = before.column;\r\n        var model = this._editor.getModel();\r\n        var position = new Position(lineNumber, column);\r\n        var prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._prevSearchPosition(position);\r\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        }\r\n        if (!prevMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\r\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\r\n        }\r\n        this._setCurrentFindMatch(prevMatch.range);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.moveToPrevMatch = function () {\r\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\r\n    };\r\n    FindModelBoundToEditorModel.prototype._nextSearchPosition = function (after) {\r\n        var isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        var lineNumber = after.lineNumber, column = after.column;\r\n        var model = this._editor.getModel();\r\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\r\n            if (lineNumber === model.getLineCount()) {\r\n                lineNumber = 1;\r\n            }\r\n            else {\r\n                lineNumber++;\r\n            }\r\n            column = 1;\r\n        }\r\n        else {\r\n            column++;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._moveToNextMatch = function (after) {\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            var nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\r\n                // Looks like we're stuck at this position, unacceptable!\r\n                after = this._nextSearchPosition(after);\r\n                nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            }\r\n            if (nextMatchRange) {\r\n                this._setCurrentFindMatch(nextMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        var nextMatch = this._getNextMatch(after, false, true);\r\n        if (nextMatch) {\r\n            this._setCurrentFindMatch(nextMatch.range);\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._getNextMatch = function (after, captureMatches, forceMove, isRecursed) {\r\n        if (isRecursed === void 0) { isRecursed = false; }\r\n        if (this._cannotFind()) {\r\n            return null;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(after)) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (after.isBefore(searchRange.getStartPosition())) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        var lineNumber = after.lineNumber, column = after.column;\r\n        var model = this._editor.getModel();\r\n        var position = new Position(lineNumber, column);\r\n        var nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, captureMatches);\r\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._nextSearchPosition(position);\r\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, captureMatches);\r\n        }\r\n        if (!nextMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return null;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\r\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\r\n        }\r\n        return nextMatch;\r\n    };\r\n    FindModelBoundToEditorModel.prototype.moveToNextMatch = function () {\r\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\r\n    };\r\n    FindModelBoundToEditorModel.prototype._getReplacePattern = function () {\r\n        if (this._state.isRegex) {\r\n            return parseReplaceString(this._state.replaceString);\r\n        }\r\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.replace = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var replacePattern = this._getReplacePattern();\r\n        var selection = this._editor.getSelection();\r\n        var nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\r\n        if (nextMatch) {\r\n            if (selection.equalsRange(nextMatch.range)) {\r\n                // selection sits on a find match => replace it!\r\n                var replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\r\n                var command = new ReplaceCommand(selection, replaceString);\r\n                this._executeEditorCommand('replace', command);\r\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\r\n                this.research(true);\r\n            }\r\n            else {\r\n                this._decorations.setStartPosition(this._editor.getPosition());\r\n                this._setCurrentFindMatch(nextMatch.range);\r\n            }\r\n        }\r\n    };\r\n    FindModelBoundToEditorModel.prototype._findMatches = function (findScope, captureMatches, limitResultCount) {\r\n        var searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        return this._editor.getModel().findMatches(this._state.searchString, searchRange, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, captureMatches, limitResultCount);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.replaceAll = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        if (findScope === null && this._state.matchesCount >= MATCHES_LIMIT) {\r\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\r\n            this._largeReplaceAll();\r\n        }\r\n        else {\r\n            this._regularReplaceAll(findScope);\r\n        }\r\n        this.research(false);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._largeReplaceAll = function () {\r\n        var searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null);\r\n        var searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return;\r\n        }\r\n        var searchRegex = searchData.regex;\r\n        if (!searchRegex.multiline) {\r\n            var mod = 'mu';\r\n            if (searchRegex.ignoreCase) {\r\n                mod += 'i';\r\n            }\r\n            if (searchRegex.global) {\r\n                mod += 'g';\r\n            }\r\n            searchRegex = new RegExp(searchRegex.source, mod);\r\n        }\r\n        var model = this._editor.getModel();\r\n        var modelText = model.getValue(1 /* LF */);\r\n        var fullModelRange = model.getFullModelRange();\r\n        var replacePattern = this._getReplacePattern();\r\n        var resultText;\r\n        var preserveCase = this._state.preserveCase;\r\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\r\n            resultText = modelText.replace(searchRegex, function () {\r\n                return replacePattern.buildReplaceString(arguments, preserveCase);\r\n            });\r\n        }\r\n        else {\r\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\r\n        }\r\n        var command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\r\n        this._executeEditorCommand('replaceAll', command);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._regularReplaceAll = function (findScope) {\r\n        var replacePattern = this._getReplacePattern();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        var matches = this._findMatches(findScope, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var replaceStrings = [];\r\n        for (var i = 0, len = matches.length; i < len; i++) {\r\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\r\n        }\r\n        var command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(function (m) { return m.range; }), replaceStrings);\r\n        this._executeEditorCommand('replaceAll', command);\r\n    };\r\n    FindModelBoundToEditorModel.prototype.selectAllMatches = function () {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        var findScope = this._decorations.getFindScope();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        var matches = this._findMatches(findScope, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var selections = matches.map(function (m) { return new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn); });\r\n        // If one of the ranges is the editor selection, then maintain it as primary\r\n        var editorSelection = this._editor.getSelection();\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var sel = selections[i];\r\n            if (sel.equalsRange(editorSelection)) {\r\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\r\n                break;\r\n            }\r\n        }\r\n        this._editor.setSelections(selections);\r\n    };\r\n    FindModelBoundToEditorModel.prototype._executeEditorCommand = function (source, command) {\r\n        try {\r\n            this._ignoreModelContentChanged = true;\r\n            this._editor.pushUndoStop();\r\n            this._editor.executeCommand(source, command);\r\n            this._editor.pushUndoStop();\r\n        }\r\n        finally {\r\n            this._ignoreModelContentChanged = false;\r\n        }\r\n    };\r\n    return FindModelBoundToEditorModel;\r\n}());\r\nexport { FindModelBoundToEditorModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './checkbox.css';\r\nimport * as DOM from '../../dom.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport * as objects from '../../../common/objects.js';\r\nvar defaultOpts = {\r\n    inputActiveOptionBorder: Color.fromHex('#007ACC00'),\r\n    inputActiveOptionBackground: Color.fromHex('#0E639C50')\r\n};\r\nvar Checkbox = /** @class */ (function (_super) {\r\n    __extends(Checkbox, _super);\r\n    function Checkbox(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onChange = _this._register(new Emitter());\r\n        _this.onChange = _this._onChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._opts = objects.deepClone(opts);\r\n        objects.mixin(_this._opts, defaultOpts, false);\r\n        _this._checked = _this._opts.isChecked;\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.title = _this._opts.title;\r\n        _this.domNode.className = 'monaco-custom-checkbox codicon ' + (_this._opts.actionClassName || '') + ' ' + (_this._checked ? 'checked' : 'unchecked');\r\n        _this.domNode.tabIndex = 0;\r\n        _this.domNode.setAttribute('role', 'checkbox');\r\n        _this.domNode.setAttribute('aria-checked', String(_this._checked));\r\n        _this.domNode.setAttribute('aria-label', _this._opts.title);\r\n        _this.applyStyles();\r\n        _this.onclick(_this.domNode, function (ev) {\r\n            _this.checked = !_this._checked;\r\n            _this._onChange.fire(false);\r\n            ev.preventDefault();\r\n        });\r\n        _this.ignoreGesture(_this.domNode);\r\n        _this.onkeydown(_this.domNode, function (keyboardEvent) {\r\n            if (keyboardEvent.keyCode === 10 /* Space */ || keyboardEvent.keyCode === 3 /* Enter */) {\r\n                _this.checked = !_this._checked;\r\n                _this._onChange.fire(true);\r\n                keyboardEvent.preventDefault();\r\n                return;\r\n            }\r\n            _this._onKeyDown.fire(keyboardEvent);\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Checkbox.prototype, \"enabled\", {\r\n        get: function () {\r\n            return this.domNode.getAttribute('aria-disabled') !== 'true';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Checkbox.prototype.focus = function () {\r\n        this.domNode.focus();\r\n    };\r\n    Object.defineProperty(Checkbox.prototype, \"checked\", {\r\n        get: function () {\r\n            return this._checked;\r\n        },\r\n        set: function (newIsChecked) {\r\n            this._checked = newIsChecked;\r\n            this.domNode.setAttribute('aria-checked', String(this._checked));\r\n            if (this._checked) {\r\n                this.domNode.classList.add('checked');\r\n            }\r\n            else {\r\n                this.domNode.classList.remove('checked');\r\n            }\r\n            this.applyStyles();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Checkbox.prototype.width = function () {\r\n        return 2 /*marginleft*/ + 2 /*border*/ + 2 /*padding*/ + 16 /* icon width */;\r\n    };\r\n    Checkbox.prototype.style = function (styles) {\r\n        if (styles.inputActiveOptionBorder) {\r\n            this._opts.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        }\r\n        if (styles.inputActiveOptionBackground) {\r\n            this._opts.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        }\r\n        this.applyStyles();\r\n    };\r\n    Checkbox.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            this.domNode.style.borderColor = this._checked && this._opts.inputActiveOptionBorder ? this._opts.inputActiveOptionBorder.toString() : 'transparent';\r\n            this.domNode.style.backgroundColor = this._checked && this._opts.inputActiveOptionBackground ? this._opts.inputActiveOptionBackground.toString() : 'transparent';\r\n        }\r\n    };\r\n    Checkbox.prototype.enable = function () {\r\n        this.domNode.tabIndex = 0;\r\n        this.domNode.setAttribute('aria-disabled', String(false));\r\n    };\r\n    Checkbox.prototype.disable = function () {\r\n        DOM.removeTabIndexAndUpdateFocus(this.domNode);\r\n        this.domNode.setAttribute('aria-disabled', String(true));\r\n    };\r\n    return Checkbox;\r\n}(Widget));\r\nexport { Checkbox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nimport * as nls from '../../../../nls.js';\r\nvar NLS_CASE_SENSITIVE_CHECKBOX_LABEL = nls.localize('caseDescription', \"Match Case\");\r\nvar NLS_WHOLE_WORD_CHECKBOX_LABEL = nls.localize('wordsDescription', \"Match Whole Word\");\r\nvar NLS_REGEX_CHECKBOX_LABEL = nls.localize('regexDescription', \"Use Regular Expression\");\r\nvar CaseSensitiveCheckbox = /** @class */ (function (_super) {\r\n    __extends(CaseSensitiveCheckbox, _super);\r\n    function CaseSensitiveCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-case-sensitive',\r\n            title: NLS_CASE_SENSITIVE_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return CaseSensitiveCheckbox;\r\n}(Checkbox));\r\nexport { CaseSensitiveCheckbox };\r\nvar WholeWordsCheckbox = /** @class */ (function (_super) {\r\n    __extends(WholeWordsCheckbox, _super);\r\n    function WholeWordsCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-whole-word',\r\n            title: NLS_WHOLE_WORD_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return WholeWordsCheckbox;\r\n}(Checkbox));\r\nexport { WholeWordsCheckbox };\r\nvar RegexCheckbox = /** @class */ (function (_super) {\r\n    __extends(RegexCheckbox, _super);\r\n    function RegexCheckbox(opts) {\r\n        return _super.call(this, {\r\n            actionClassName: 'codicon-regex',\r\n            title: NLS_REGEX_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return RegexCheckbox;\r\n}(Checkbox));\r\nexport { RegexCheckbox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CaseSensitiveCheckbox, RegexCheckbox, WholeWordsCheckbox } from '../../../base/browser/ui/findinput/findInputCheckboxes.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { FIND_IDS } from './findModel.js';\r\nimport { contrastBorder, editorWidgetBackground, inputActiveOptionBorder, inputActiveOptionBackground, widgetShadow, editorWidgetForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar FindOptionsWidget = /** @class */ (function (_super) {\r\n    __extends(FindOptionsWidget, _super);\r\n    function FindOptionsWidget(editor, state, keybindingService, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._hideSoon = _this._register(new RunOnceScheduler(function () { return _this._hide(); }, 2000));\r\n        _this._isVisible = false;\r\n        _this._editor = editor;\r\n        _this._state = state;\r\n        _this._keybindingService = keybindingService;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'findOptionsWidget';\r\n        _this._domNode.style.display = 'none';\r\n        _this._domNode.style.top = '10px';\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        var inputActiveOptionBorderColor = themeService.getTheme().getColor(inputActiveOptionBorder);\r\n        var inputActiveOptionBackgroundColor = themeService.getTheme().getColor(inputActiveOptionBackground);\r\n        _this.caseSensitive = _this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            isChecked: _this._state.matchCase,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.caseSensitive.domNode);\r\n        _this._register(_this.caseSensitive.onChange(function () {\r\n            _this._state.change({\r\n                matchCase: _this.caseSensitive.checked\r\n            }, false);\r\n        }));\r\n        _this.wholeWords = _this._register(new WholeWordsCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            isChecked: _this._state.wholeWord,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.wholeWords.domNode);\r\n        _this._register(_this.wholeWords.onChange(function () {\r\n            _this._state.change({\r\n                wholeWord: _this.wholeWords.checked\r\n            }, false);\r\n        }));\r\n        _this.regex = _this._register(new RegexCheckbox({\r\n            appendTitle: _this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            isChecked: _this._state.isRegex,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        _this._domNode.appendChild(_this.regex.domNode);\r\n        _this._register(_this.regex.onChange(function () {\r\n            _this._state.change({\r\n                isRegex: _this.regex.checked\r\n            }, false);\r\n        }));\r\n        _this._editor.addOverlayWidget(_this);\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) {\r\n            var somethingChanged = false;\r\n            if (e.isRegex) {\r\n                _this.regex.checked = _this._state.isRegex;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.wholeWord) {\r\n                _this.wholeWords.checked = _this._state.wholeWord;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.matchCase) {\r\n                _this.caseSensitive.checked = _this._state.matchCase;\r\n                somethingChanged = true;\r\n            }\r\n            if (!_this._state.isRevealed && somethingChanged) {\r\n                _this._revealTemporarily();\r\n            }\r\n        }));\r\n        _this._register(dom.addDisposableNonBubblingMouseOutListener(_this._domNode, function (e) { return _this._onMouseOut(); }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'mouseover', function (e) { return _this._onMouseOver(); }));\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._register(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        return _this;\r\n    }\r\n    FindOptionsWidget.prototype._keybindingLabelFor = function (actionId) {\r\n        var kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return \" (\" + kb.getLabel() + \")\";\r\n    };\r\n    FindOptionsWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ----- IOverlayWidget API\r\n    FindOptionsWidget.prototype.getId = function () {\r\n        return FindOptionsWidget.ID;\r\n    };\r\n    FindOptionsWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    FindOptionsWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: 0 /* TOP_RIGHT_CORNER */\r\n        };\r\n    };\r\n    FindOptionsWidget.prototype.highlightFindOptions = function () {\r\n        this._revealTemporarily();\r\n    };\r\n    FindOptionsWidget.prototype._revealTemporarily = function () {\r\n        this._show();\r\n        this._hideSoon.schedule();\r\n    };\r\n    FindOptionsWidget.prototype._onMouseOut = function () {\r\n        this._hideSoon.schedule();\r\n    };\r\n    FindOptionsWidget.prototype._onMouseOver = function () {\r\n        this._hideSoon.cancel();\r\n    };\r\n    FindOptionsWidget.prototype._show = function () {\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        this._domNode.style.display = 'block';\r\n    };\r\n    FindOptionsWidget.prototype._hide = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        this._domNode.style.display = 'none';\r\n    };\r\n    FindOptionsWidget.prototype._applyTheme = function (theme) {\r\n        var inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground)\r\n        };\r\n        this.caseSensitive.style(inputStyles);\r\n        this.wholeWords.style(inputStyles);\r\n        this.regex.style(inputStyles);\r\n    };\r\n    FindOptionsWidget.ID = 'editor.contrib.findOptionsWidget';\r\n    return FindOptionsWidget;\r\n}(Widget));\r\nexport { FindOptionsWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    if (widgetBackground) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { background-color: \" + widgetBackground + \"; }\");\r\n    }\r\n    var widgetForeground = theme.getColor(editorWidgetForeground);\r\n    if (widgetForeground) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { color: \" + widgetForeground + \"; }\");\r\n    }\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .findOptionsWidget { border: 2px solid \" + hcBorder + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nfunction effectiveOptionValue(override, value) {\r\n    if (override === 1 /* True */) {\r\n        return true;\r\n    }\r\n    if (override === 2 /* False */) {\r\n        return false;\r\n    }\r\n    return value;\r\n}\r\nvar FindReplaceState = /** @class */ (function (_super) {\r\n    __extends(FindReplaceState, _super);\r\n    function FindReplaceState() {\r\n        var _this = _super.call(this) || this;\r\n        _this._onFindReplaceStateChange = _this._register(new Emitter());\r\n        _this.onFindReplaceStateChange = _this._onFindReplaceStateChange.event;\r\n        _this._searchString = '';\r\n        _this._replaceString = '';\r\n        _this._isRevealed = false;\r\n        _this._isReplaceRevealed = false;\r\n        _this._isRegex = false;\r\n        _this._isRegexOverride = 0 /* NotSet */;\r\n        _this._wholeWord = false;\r\n        _this._wholeWordOverride = 0 /* NotSet */;\r\n        _this._matchCase = false;\r\n        _this._matchCaseOverride = 0 /* NotSet */;\r\n        _this._preserveCase = false;\r\n        _this._preserveCaseOverride = 0 /* NotSet */;\r\n        _this._searchScope = null;\r\n        _this._matchesPosition = 0;\r\n        _this._matchesCount = 0;\r\n        _this._currentMatch = null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FindReplaceState.prototype, \"searchString\", {\r\n        get: function () { return this._searchString; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"replaceString\", {\r\n        get: function () { return this._replaceString; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isRevealed\", {\r\n        get: function () { return this._isRevealed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isReplaceRevealed\", {\r\n        get: function () { return this._isReplaceRevealed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"isRegex\", {\r\n        get: function () { return effectiveOptionValue(this._isRegexOverride, this._isRegex); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"wholeWord\", {\r\n        get: function () { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchCase\", {\r\n        get: function () { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"preserveCase\", {\r\n        get: function () { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualIsRegex\", {\r\n        get: function () { return this._isRegex; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualWholeWord\", {\r\n        get: function () { return this._wholeWord; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualMatchCase\", {\r\n        get: function () { return this._matchCase; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"actualPreserveCase\", {\r\n        get: function () { return this._preserveCase; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"searchScope\", {\r\n        get: function () { return this._searchScope; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchesPosition\", {\r\n        get: function () { return this._matchesPosition; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"matchesCount\", {\r\n        get: function () { return this._matchesCount; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FindReplaceState.prototype, \"currentMatch\", {\r\n        get: function () { return this._currentMatch; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FindReplaceState.prototype.changeMatchInfo = function (matchesPosition, matchesCount, currentMatch) {\r\n        var changeEvent = {\r\n            moveCursor: false,\r\n            updateHistory: false,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false\r\n        };\r\n        var somethingChanged = false;\r\n        if (matchesCount === 0) {\r\n            matchesPosition = 0;\r\n        }\r\n        if (matchesPosition > matchesCount) {\r\n            matchesPosition = matchesCount;\r\n        }\r\n        if (this._matchesPosition !== matchesPosition) {\r\n            this._matchesPosition = matchesPosition;\r\n            changeEvent.matchesPosition = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (this._matchesCount !== matchesCount) {\r\n            this._matchesCount = matchesCount;\r\n            changeEvent.matchesCount = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (typeof currentMatch !== 'undefined') {\r\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\r\n                this._currentMatch = currentMatch;\r\n                changeEvent.currentMatch = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    };\r\n    FindReplaceState.prototype.change = function (newState, moveCursor, updateHistory) {\r\n        if (updateHistory === void 0) { updateHistory = true; }\r\n        var changeEvent = {\r\n            moveCursor: moveCursor,\r\n            updateHistory: updateHistory,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false\r\n        };\r\n        var somethingChanged = false;\r\n        var oldEffectiveIsRegex = this.isRegex;\r\n        var oldEffectiveWholeWords = this.wholeWord;\r\n        var oldEffectiveMatchCase = this.matchCase;\r\n        var oldEffectivePreserveCase = this.preserveCase;\r\n        if (typeof newState.searchString !== 'undefined') {\r\n            if (this._searchString !== newState.searchString) {\r\n                this._searchString = newState.searchString;\r\n                changeEvent.searchString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.replaceString !== 'undefined') {\r\n            if (this._replaceString !== newState.replaceString) {\r\n                this._replaceString = newState.replaceString;\r\n                changeEvent.replaceString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRevealed !== 'undefined') {\r\n            if (this._isRevealed !== newState.isRevealed) {\r\n                this._isRevealed = newState.isRevealed;\r\n                changeEvent.isRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\r\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\r\n                this._isReplaceRevealed = newState.isReplaceRevealed;\r\n                changeEvent.isReplaceRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRegex !== 'undefined') {\r\n            this._isRegex = newState.isRegex;\r\n        }\r\n        if (typeof newState.wholeWord !== 'undefined') {\r\n            this._wholeWord = newState.wholeWord;\r\n        }\r\n        if (typeof newState.matchCase !== 'undefined') {\r\n            this._matchCase = newState.matchCase;\r\n        }\r\n        if (typeof newState.preserveCase !== 'undefined') {\r\n            this._preserveCase = newState.preserveCase;\r\n        }\r\n        if (typeof newState.searchScope !== 'undefined') {\r\n            if (!Range.equalsRange(this._searchScope, newState.searchScope)) {\r\n                this._searchScope = newState.searchScope;\r\n                changeEvent.searchScope = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\r\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* NotSet */);\r\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* NotSet */);\r\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* NotSet */);\r\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* NotSet */);\r\n        if (oldEffectiveIsRegex !== this.isRegex) {\r\n            somethingChanged = true;\r\n            changeEvent.isRegex = true;\r\n        }\r\n        if (oldEffectiveWholeWords !== this.wholeWord) {\r\n            somethingChanged = true;\r\n            changeEvent.wholeWord = true;\r\n        }\r\n        if (oldEffectiveMatchCase !== this.matchCase) {\r\n            somethingChanged = true;\r\n            changeEvent.matchCase = true;\r\n        }\r\n        if (oldEffectivePreserveCase !== this.preserveCase) {\r\n            somethingChanged = true;\r\n            changeEvent.preserveCase = true;\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    };\r\n    return FindReplaceState;\r\n}(Disposable));\r\nexport { FindReplaceState };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as DOM from './dom.js';\r\nexport function renderText(text, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    element.textContent = text;\r\n    return element;\r\n}\r\nexport function renderFormattedText(formattedText, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    _renderFormattedText(element, parseFormattedText(formattedText), options.actionHandler);\r\n    return element;\r\n}\r\nexport function createElement(options) {\r\n    var tagName = options.inline ? 'span' : 'div';\r\n    var element = document.createElement(tagName);\r\n    if (options.className) {\r\n        element.className = options.className;\r\n    }\r\n    return element;\r\n}\r\nvar StringStream = /** @class */ (function () {\r\n    function StringStream(source) {\r\n        this.source = source;\r\n        this.index = 0;\r\n    }\r\n    StringStream.prototype.eos = function () {\r\n        return this.index >= this.source.length;\r\n    };\r\n    StringStream.prototype.next = function () {\r\n        var next = this.peek();\r\n        this.advance();\r\n        return next;\r\n    };\r\n    StringStream.prototype.peek = function () {\r\n        return this.source[this.index];\r\n    };\r\n    StringStream.prototype.advance = function () {\r\n        this.index++;\r\n    };\r\n    return StringStream;\r\n}());\r\nfunction _renderFormattedText(element, treeNode, actionHandler) {\r\n    var child;\r\n    if (treeNode.type === 2 /* Text */) {\r\n        child = document.createTextNode(treeNode.content || '');\r\n    }\r\n    else if (treeNode.type === 3 /* Bold */) {\r\n        child = document.createElement('b');\r\n    }\r\n    else if (treeNode.type === 4 /* Italics */) {\r\n        child = document.createElement('i');\r\n    }\r\n    else if (treeNode.type === 5 /* Action */ && actionHandler) {\r\n        var a = document.createElement('a');\r\n        a.href = '#';\r\n        actionHandler.disposeables.add(DOM.addStandardDisposableListener(a, 'click', function (event) {\r\n            actionHandler.callback(String(treeNode.index), event);\r\n        }));\r\n        child = a;\r\n    }\r\n    else if (treeNode.type === 7 /* NewLine */) {\r\n        child = document.createElement('br');\r\n    }\r\n    else if (treeNode.type === 1 /* Root */) {\r\n        child = element;\r\n    }\r\n    if (child && element !== child) {\r\n        element.appendChild(child);\r\n    }\r\n    if (child && Array.isArray(treeNode.children)) {\r\n        treeNode.children.forEach(function (nodeChild) {\r\n            _renderFormattedText(child, nodeChild, actionHandler);\r\n        });\r\n    }\r\n}\r\nfunction parseFormattedText(content) {\r\n    var root = {\r\n        type: 1 /* Root */,\r\n        children: []\r\n    };\r\n    var actionViewItemIndex = 0;\r\n    var current = root;\r\n    var stack = [];\r\n    var stream = new StringStream(content);\r\n    while (!stream.eos()) {\r\n        var next = stream.next();\r\n        var isEscapedFormatType = (next === '\\\\' && formatTagType(stream.peek()) !== 0 /* Invalid */);\r\n        if (isEscapedFormatType) {\r\n            next = stream.next(); // unread the backslash if it escapes a format tag type\r\n        }\r\n        if (!isEscapedFormatType && isFormatTag(next) && next === stream.peek()) {\r\n            stream.advance();\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            var type = formatTagType(next);\r\n            if (current.type === type || (current.type === 5 /* Action */ && type === 6 /* ActionClose */)) {\r\n                current = stack.pop();\r\n            }\r\n            else {\r\n                var newCurrent = {\r\n                    type: type,\r\n                    children: []\r\n                };\r\n                if (type === 5 /* Action */) {\r\n                    newCurrent.index = actionViewItemIndex;\r\n                    actionViewItemIndex++;\r\n                }\r\n                current.children.push(newCurrent);\r\n                stack.push(current);\r\n                current = newCurrent;\r\n            }\r\n        }\r\n        else if (next === '\\n') {\r\n            if (current.type === 2 /* Text */) {\r\n                current = stack.pop();\r\n            }\r\n            current.children.push({\r\n                type: 7 /* NewLine */\r\n            });\r\n        }\r\n        else {\r\n            if (current.type !== 2 /* Text */) {\r\n                var textCurrent = {\r\n                    type: 2 /* Text */,\r\n                    content: next\r\n                };\r\n                current.children.push(textCurrent);\r\n                stack.push(current);\r\n                current = textCurrent;\r\n            }\r\n            else {\r\n                current.content += next;\r\n            }\r\n        }\r\n    }\r\n    if (current.type === 2 /* Text */) {\r\n        current = stack.pop();\r\n    }\r\n    if (stack.length) {\r\n        // incorrectly formatted string literal\r\n    }\r\n    return root;\r\n}\r\nfunction isFormatTag(char) {\r\n    return formatTagType(char) !== 0 /* Invalid */;\r\n}\r\nfunction formatTagType(char) {\r\n    switch (char) {\r\n        case '*':\r\n            return 3 /* Bold */;\r\n        case '_':\r\n            return 4 /* Italics */;\r\n        case '[':\r\n            return 5 /* Action */;\r\n        case ']':\r\n            return 6 /* ActionClose */;\r\n        default:\r\n            return 0 /* Invalid */;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ArrayNavigator } from './iterator.js';\r\nvar HistoryNavigator = /** @class */ (function () {\r\n    function HistoryNavigator(history, limit) {\r\n        if (history === void 0) { history = []; }\r\n        if (limit === void 0) { limit = 10; }\r\n        this._initialize(history);\r\n        this._limit = limit;\r\n        this._onChange();\r\n    }\r\n    HistoryNavigator.prototype.add = function (t) {\r\n        this._history.delete(t);\r\n        this._history.add(t);\r\n        this._onChange();\r\n    };\r\n    HistoryNavigator.prototype.next = function () {\r\n        return this._navigator.next();\r\n    };\r\n    HistoryNavigator.prototype.previous = function () {\r\n        return this._navigator.previous();\r\n    };\r\n    HistoryNavigator.prototype.current = function () {\r\n        return this._navigator.current();\r\n    };\r\n    HistoryNavigator.prototype.parent = function () {\r\n        return null;\r\n    };\r\n    HistoryNavigator.prototype.first = function () {\r\n        return this._navigator.first();\r\n    };\r\n    HistoryNavigator.prototype.last = function () {\r\n        return this._navigator.last();\r\n    };\r\n    HistoryNavigator.prototype.has = function (t) {\r\n        return this._history.has(t);\r\n    };\r\n    HistoryNavigator.prototype._onChange = function () {\r\n        this._reduceToLimit();\r\n        var elements = this._elements;\r\n        this._navigator = new ArrayNavigator(elements, 0, elements.length, elements.length);\r\n    };\r\n    HistoryNavigator.prototype._reduceToLimit = function () {\r\n        var data = this._elements;\r\n        if (data.length > this._limit) {\r\n            this._initialize(data.slice(data.length - this._limit));\r\n        }\r\n    };\r\n    HistoryNavigator.prototype._initialize = function (history) {\r\n        this._history = new Set();\r\n        for (var _i = 0, history_1 = history; _i < history_1.length; _i++) {\r\n            var entry = history_1[_i];\r\n            this._history.add(entry);\r\n        }\r\n    };\r\n    Object.defineProperty(HistoryNavigator.prototype, \"_elements\", {\r\n        get: function () {\r\n            var elements = [];\r\n            this._history.forEach(function (e) { return elements.push(e); });\r\n            return elements;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return HistoryNavigator;\r\n}());\r\nexport { HistoryNavigator };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './inputBox.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as Bal from '../../browser.js';\r\nimport * as dom from '../../dom.js';\r\nimport { renderFormattedText, renderText } from '../../formattedTextRenderer.js';\r\nimport * as aria from '../aria/aria.js';\r\nimport { ActionBar } from '../actionbar/actionbar.js';\r\nimport { Event, Emitter } from '../../../common/event.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { HistoryNavigator } from '../../../common/history.js';\r\nimport { ScrollableElement } from '../scrollbar/scrollableElement.js';\r\nimport { domEvent } from '../../event.js';\r\nvar $ = dom.$;\r\nvar defaultOpts = {\r\n    inputBackground: Color.fromHex('#3C3C3C'),\r\n    inputForeground: Color.fromHex('#CCCCCC'),\r\n    inputValidationInfoBorder: Color.fromHex('#55AAFF'),\r\n    inputValidationInfoBackground: Color.fromHex('#063B49'),\r\n    inputValidationWarningBorder: Color.fromHex('#B89500'),\r\n    inputValidationWarningBackground: Color.fromHex('#352A05'),\r\n    inputValidationErrorBorder: Color.fromHex('#BE1100'),\r\n    inputValidationErrorBackground: Color.fromHex('#5A1D1D')\r\n};\r\nvar InputBox = /** @class */ (function (_super) {\r\n    __extends(InputBox, _super);\r\n    function InputBox(container, contextViewProvider, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.state = 'idle';\r\n        _this.maxHeight = Number.POSITIVE_INFINITY;\r\n        _this._onDidChange = _this._register(new Emitter());\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onDidHeightChange = _this._register(new Emitter());\r\n        _this.onDidHeightChange = _this._onDidHeightChange.event;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.options = options || Object.create(null);\r\n        mixin(_this.options, defaultOpts, false);\r\n        _this.message = null;\r\n        _this.placeholder = _this.options.placeholder || '';\r\n        _this.ariaLabel = _this.options.ariaLabel || '';\r\n        _this.inputBackground = _this.options.inputBackground;\r\n        _this.inputForeground = _this.options.inputForeground;\r\n        _this.inputBorder = _this.options.inputBorder;\r\n        _this.inputValidationInfoBorder = _this.options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = _this.options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = _this.options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = _this.options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = _this.options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = _this.options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = _this.options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = _this.options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = _this.options.inputValidationErrorForeground;\r\n        if (_this.options.validationOptions) {\r\n            _this.validation = _this.options.validationOptions.validation;\r\n        }\r\n        _this.element = dom.append(container, $('.monaco-inputbox.idle'));\r\n        var tagName = _this.options.flexibleHeight ? 'textarea' : 'input';\r\n        var wrapper = dom.append(_this.element, $('.wrapper'));\r\n        _this.input = dom.append(wrapper, $(tagName + '.input.empty'));\r\n        _this.input.setAttribute('autocorrect', 'off');\r\n        _this.input.setAttribute('autocapitalize', 'off');\r\n        _this.input.setAttribute('spellcheck', 'false');\r\n        _this.onfocus(_this.input, function () { return dom.addClass(_this.element, 'synthetic-focus'); });\r\n        _this.onblur(_this.input, function () { return dom.removeClass(_this.element, 'synthetic-focus'); });\r\n        if (_this.options.flexibleHeight) {\r\n            _this.maxHeight = typeof _this.options.flexibleMaxHeight === 'number' ? _this.options.flexibleMaxHeight : Number.POSITIVE_INFINITY;\r\n            _this.mirror = dom.append(wrapper, $('div.mirror'));\r\n            _this.mirror.innerHTML = '&#160;';\r\n            _this.scrollableElement = new ScrollableElement(_this.element, { vertical: 1 /* Auto */ });\r\n            if (_this.options.flexibleWidth) {\r\n                _this.input.setAttribute('wrap', 'off');\r\n                _this.mirror.style.whiteSpace = 'pre';\r\n                _this.mirror.style.wordWrap = 'initial';\r\n            }\r\n            dom.append(container, _this.scrollableElement.getDomNode());\r\n            _this._register(_this.scrollableElement);\r\n            // from ScrollableElement to DOM\r\n            _this._register(_this.scrollableElement.onScroll(function (e) { return _this.input.scrollTop = e.scrollTop; }));\r\n            var onSelectionChange = Event.filter(domEvent(document, 'selectionchange'), function () {\r\n                var selection = document.getSelection();\r\n                return (selection === null || selection === void 0 ? void 0 : selection.anchorNode) === wrapper;\r\n            });\r\n            // from DOM to ScrollableElement\r\n            _this._register(onSelectionChange(_this.updateScrollDimensions, _this));\r\n            _this._register(_this.onDidHeightChange(_this.updateScrollDimensions, _this));\r\n        }\r\n        else {\r\n            _this.input.type = _this.options.type || 'text';\r\n            _this.input.setAttribute('wrap', 'off');\r\n        }\r\n        if (_this.ariaLabel) {\r\n            _this.input.setAttribute('aria-label', _this.ariaLabel);\r\n        }\r\n        if (_this.placeholder) {\r\n            _this.setPlaceHolder(_this.placeholder);\r\n        }\r\n        _this.oninput(_this.input, function () { return _this.onValueChange(); });\r\n        _this.onblur(_this.input, function () { return _this.onBlur(); });\r\n        _this.onfocus(_this.input, function () { return _this.onFocus(); });\r\n        // Add placeholder shim for IE because IE decides to hide the placeholder on focus (we dont want that!)\r\n        if (_this.placeholder && Bal.isIE) {\r\n            _this.onclick(_this.input, function (e) {\r\n                dom.EventHelper.stop(e, true);\r\n                _this.input.focus();\r\n            });\r\n        }\r\n        _this.ignoreGesture(_this.input);\r\n        setTimeout(function () { return _this.updateMirror(); }, 0);\r\n        // Support actions\r\n        if (_this.options.actions) {\r\n            _this.actionbar = _this._register(new ActionBar(_this.element));\r\n            _this.actionbar.push(_this.options.actions, { icon: true, label: false });\r\n        }\r\n        _this.applyStyles();\r\n        return _this;\r\n    }\r\n    InputBox.prototype.onBlur = function () {\r\n        this._hideMessage();\r\n    };\r\n    InputBox.prototype.onFocus = function () {\r\n        this._showMessage();\r\n    };\r\n    InputBox.prototype.setPlaceHolder = function (placeHolder) {\r\n        this.placeholder = placeHolder;\r\n        this.input.setAttribute('placeholder', placeHolder);\r\n        this.input.title = placeHolder;\r\n    };\r\n    InputBox.prototype.setAriaLabel = function (label) {\r\n        this.ariaLabel = label;\r\n        if (label) {\r\n            this.input.setAttribute('aria-label', this.ariaLabel);\r\n        }\r\n        else {\r\n            this.input.removeAttribute('aria-label');\r\n        }\r\n    };\r\n    Object.defineProperty(InputBox.prototype, \"inputElement\", {\r\n        get: function () {\r\n            return this.input;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"value\", {\r\n        get: function () {\r\n            return this.input.value;\r\n        },\r\n        set: function (newValue) {\r\n            if (this.input.value !== newValue) {\r\n                this.input.value = newValue;\r\n                this.onValueChange();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"height\", {\r\n        get: function () {\r\n            return typeof this.cachedHeight === 'number' ? this.cachedHeight : dom.getTotalHeight(this.element);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InputBox.prototype.focus = function () {\r\n        this.input.focus();\r\n    };\r\n    InputBox.prototype.blur = function () {\r\n        this.input.blur();\r\n    };\r\n    InputBox.prototype.hasFocus = function () {\r\n        return document.activeElement === this.input;\r\n    };\r\n    InputBox.prototype.select = function (range) {\r\n        if (range === void 0) { range = null; }\r\n        this.input.select();\r\n        if (range) {\r\n            this.input.setSelectionRange(range.start, range.end);\r\n        }\r\n    };\r\n    InputBox.prototype.enable = function () {\r\n        this.input.removeAttribute('disabled');\r\n    };\r\n    InputBox.prototype.disable = function () {\r\n        this.blur();\r\n        this.input.disabled = true;\r\n        this._hideMessage();\r\n    };\r\n    Object.defineProperty(InputBox.prototype, \"width\", {\r\n        get: function () {\r\n            return dom.getTotalWidth(this.input);\r\n        },\r\n        set: function (width) {\r\n            if (this.options.flexibleHeight && this.options.flexibleWidth) {\r\n                // textarea with horizontal scrolling\r\n                var horizontalPadding = 0;\r\n                if (this.mirror) {\r\n                    var paddingLeft = parseFloat(this.mirror.style.paddingLeft || '') || 0;\r\n                    var paddingRight = parseFloat(this.mirror.style.paddingRight || '') || 0;\r\n                    horizontalPadding = paddingLeft + paddingRight;\r\n                }\r\n                this.input.style.width = (width - horizontalPadding) + 'px';\r\n            }\r\n            else {\r\n                this.input.style.width = width + 'px';\r\n            }\r\n            if (this.mirror) {\r\n                this.mirror.style.width = width + 'px';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InputBox.prototype, \"paddingRight\", {\r\n        set: function (paddingRight) {\r\n            if (this.options.flexibleHeight && this.options.flexibleWidth) {\r\n                this.input.style.width = \"calc(100% - \" + paddingRight + \"px)\";\r\n            }\r\n            else {\r\n                this.input.style.paddingRight = paddingRight + 'px';\r\n            }\r\n            if (this.mirror) {\r\n                this.mirror.style.paddingRight = paddingRight + 'px';\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InputBox.prototype.updateScrollDimensions = function () {\r\n        if (typeof this.cachedContentHeight !== 'number' || typeof this.cachedHeight !== 'number' || !this.scrollableElement) {\r\n            return;\r\n        }\r\n        var scrollHeight = this.cachedContentHeight;\r\n        var height = this.cachedHeight;\r\n        var scrollTop = this.input.scrollTop;\r\n        this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight, height: height });\r\n        this.scrollableElement.setScrollPosition({ scrollTop: scrollTop });\r\n    };\r\n    InputBox.prototype.showMessage = function (message, force) {\r\n        this.message = message;\r\n        dom.removeClass(this.element, 'idle');\r\n        dom.removeClass(this.element, 'info');\r\n        dom.removeClass(this.element, 'warning');\r\n        dom.removeClass(this.element, 'error');\r\n        dom.addClass(this.element, this.classForType(message.type));\r\n        var styles = this.stylesForType(this.message.type);\r\n        this.element.style.border = styles.border ? \"1px solid \" + styles.border : '';\r\n        // ARIA Support\r\n        var alertText;\r\n        if (message.type === 3 /* ERROR */) {\r\n            alertText = nls.localize('alertErrorMessage', \"Error: {0}\", message.content);\r\n        }\r\n        else if (message.type === 2 /* WARNING */) {\r\n            alertText = nls.localize('alertWarningMessage', \"Warning: {0}\", message.content);\r\n        }\r\n        else {\r\n            alertText = nls.localize('alertInfoMessage', \"Info: {0}\", message.content);\r\n        }\r\n        aria.alert(alertText);\r\n        if (this.hasFocus() || force) {\r\n            this._showMessage();\r\n        }\r\n    };\r\n    InputBox.prototype.hideMessage = function () {\r\n        this.message = null;\r\n        dom.removeClass(this.element, 'info');\r\n        dom.removeClass(this.element, 'warning');\r\n        dom.removeClass(this.element, 'error');\r\n        dom.addClass(this.element, 'idle');\r\n        this._hideMessage();\r\n        this.applyStyles();\r\n    };\r\n    InputBox.prototype.validate = function () {\r\n        var errorMsg = null;\r\n        if (this.validation) {\r\n            errorMsg = this.validation(this.value);\r\n            if (errorMsg) {\r\n                this.inputElement.setAttribute('aria-invalid', 'true');\r\n                this.showMessage(errorMsg);\r\n            }\r\n            else if (this.inputElement.hasAttribute('aria-invalid')) {\r\n                this.inputElement.removeAttribute('aria-invalid');\r\n                this.hideMessage();\r\n            }\r\n        }\r\n        return !errorMsg;\r\n    };\r\n    InputBox.prototype.stylesForType = function (type) {\r\n        switch (type) {\r\n            case 1 /* INFO */: return { border: this.inputValidationInfoBorder, background: this.inputValidationInfoBackground, foreground: this.inputValidationInfoForeground };\r\n            case 2 /* WARNING */: return { border: this.inputValidationWarningBorder, background: this.inputValidationWarningBackground, foreground: this.inputValidationWarningForeground };\r\n            default: return { border: this.inputValidationErrorBorder, background: this.inputValidationErrorBackground, foreground: this.inputValidationErrorForeground };\r\n        }\r\n    };\r\n    InputBox.prototype.classForType = function (type) {\r\n        switch (type) {\r\n            case 1 /* INFO */: return 'info';\r\n            case 2 /* WARNING */: return 'warning';\r\n            default: return 'error';\r\n        }\r\n    };\r\n    InputBox.prototype._showMessage = function () {\r\n        var _this = this;\r\n        if (!this.contextViewProvider || !this.message) {\r\n            return;\r\n        }\r\n        var div;\r\n        var layout = function () { return div.style.width = dom.getTotalWidth(_this.element) + 'px'; };\r\n        this.contextViewProvider.showContextView({\r\n            getAnchor: function () { return _this.element; },\r\n            anchorAlignment: 1 /* RIGHT */,\r\n            render: function (container) {\r\n                if (!_this.message) {\r\n                    return null;\r\n                }\r\n                div = dom.append(container, $('.monaco-inputbox-container'));\r\n                layout();\r\n                var renderOptions = {\r\n                    inline: true,\r\n                    className: 'monaco-inputbox-message'\r\n                };\r\n                var spanElement = (_this.message.formatContent\r\n                    ? renderFormattedText(_this.message.content, renderOptions)\r\n                    : renderText(_this.message.content, renderOptions));\r\n                dom.addClass(spanElement, _this.classForType(_this.message.type));\r\n                var styles = _this.stylesForType(_this.message.type);\r\n                spanElement.style.backgroundColor = styles.background ? styles.background.toString() : '';\r\n                spanElement.style.color = styles.foreground ? styles.foreground.toString() : '';\r\n                spanElement.style.border = styles.border ? \"1px solid \" + styles.border : '';\r\n                dom.append(div, spanElement);\r\n                return null;\r\n            },\r\n            onHide: function () {\r\n                _this.state = 'closed';\r\n            },\r\n            layout: layout\r\n        });\r\n        this.state = 'open';\r\n    };\r\n    InputBox.prototype._hideMessage = function () {\r\n        if (!this.contextViewProvider) {\r\n            return;\r\n        }\r\n        if (this.state === 'open') {\r\n            this.contextViewProvider.hideContextView();\r\n        }\r\n        this.state = 'idle';\r\n    };\r\n    InputBox.prototype.onValueChange = function () {\r\n        this._onDidChange.fire(this.value);\r\n        this.validate();\r\n        this.updateMirror();\r\n        dom.toggleClass(this.input, 'empty', !this.value);\r\n        if (this.state === 'open' && this.contextViewProvider) {\r\n            this.contextViewProvider.layout();\r\n        }\r\n    };\r\n    InputBox.prototype.updateMirror = function () {\r\n        if (!this.mirror) {\r\n            return;\r\n        }\r\n        var value = this.value;\r\n        var lastCharCode = value.charCodeAt(value.length - 1);\r\n        var suffix = lastCharCode === 10 ? ' ' : '';\r\n        var mirrorTextContent = value + suffix;\r\n        if (mirrorTextContent) {\r\n            this.mirror.textContent = value + suffix;\r\n        }\r\n        else {\r\n            this.mirror.innerHTML = '&#160;';\r\n        }\r\n        this.layout();\r\n    };\r\n    InputBox.prototype.style = function (styles) {\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    InputBox.prototype.applyStyles = function () {\r\n        var background = this.inputBackground ? this.inputBackground.toString() : '';\r\n        var foreground = this.inputForeground ? this.inputForeground.toString() : '';\r\n        var border = this.inputBorder ? this.inputBorder.toString() : '';\r\n        this.element.style.backgroundColor = background;\r\n        this.element.style.color = foreground;\r\n        this.input.style.backgroundColor = background;\r\n        this.input.style.color = foreground;\r\n        this.element.style.borderWidth = border ? '1px' : '';\r\n        this.element.style.borderStyle = border ? 'solid' : '';\r\n        this.element.style.borderColor = border;\r\n    };\r\n    InputBox.prototype.layout = function () {\r\n        if (!this.mirror) {\r\n            return;\r\n        }\r\n        var previousHeight = this.cachedContentHeight;\r\n        this.cachedContentHeight = dom.getTotalHeight(this.mirror);\r\n        if (previousHeight !== this.cachedContentHeight) {\r\n            this.cachedHeight = Math.min(this.cachedContentHeight, this.maxHeight);\r\n            this.input.style.height = this.cachedHeight + 'px';\r\n            this._onDidHeightChange.fire(this.cachedContentHeight);\r\n        }\r\n    };\r\n    InputBox.prototype.insertAtCursor = function (text) {\r\n        var inputElement = this.inputElement;\r\n        var start = inputElement.selectionStart;\r\n        var end = inputElement.selectionEnd;\r\n        var content = inputElement.value;\r\n        if (start !== null && end !== null) {\r\n            this.value = content.substr(0, start) + text + content.substr(end);\r\n            inputElement.setSelectionRange(start + 1, start + 1);\r\n            this.layout();\r\n        }\r\n    };\r\n    InputBox.prototype.dispose = function () {\r\n        this._hideMessage();\r\n        this.message = null;\r\n        if (this.actionbar) {\r\n            this.actionbar.dispose();\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return InputBox;\r\n}(Widget));\r\nexport { InputBox };\r\nvar HistoryInputBox = /** @class */ (function (_super) {\r\n    __extends(HistoryInputBox, _super);\r\n    function HistoryInputBox(container, contextViewProvider, options) {\r\n        var _this = _super.call(this, container, contextViewProvider, options) || this;\r\n        _this.history = new HistoryNavigator(options.history, 100);\r\n        return _this;\r\n    }\r\n    HistoryInputBox.prototype.addToHistory = function () {\r\n        if (this.value && this.value !== this.getCurrentValue()) {\r\n            this.history.add(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.showNextValue = function () {\r\n        if (!this.history.has(this.value)) {\r\n            this.addToHistory();\r\n        }\r\n        var next = this.getNextValue();\r\n        if (next) {\r\n            next = next === this.value ? this.getNextValue() : next;\r\n        }\r\n        if (next) {\r\n            this.value = next;\r\n            aria.status(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.showPreviousValue = function () {\r\n        if (!this.history.has(this.value)) {\r\n            this.addToHistory();\r\n        }\r\n        var previous = this.getPreviousValue();\r\n        if (previous) {\r\n            previous = previous === this.value ? this.getPreviousValue() : previous;\r\n        }\r\n        if (previous) {\r\n            this.value = previous;\r\n            aria.status(this.value);\r\n        }\r\n    };\r\n    HistoryInputBox.prototype.getCurrentValue = function () {\r\n        var currentValue = this.history.current();\r\n        if (!currentValue) {\r\n            currentValue = this.history.last();\r\n            this.history.next();\r\n        }\r\n        return currentValue;\r\n    };\r\n    HistoryInputBox.prototype.getPreviousValue = function () {\r\n        return this.history.previous() || this.history.first();\r\n    };\r\n    HistoryInputBox.prototype.getNextValue = function () {\r\n        return this.history.next() || this.history.last();\r\n    };\r\n    return HistoryInputBox;\r\n}(InputBox));\r\nexport { HistoryInputBox };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { CaseSensitiveCheckbox, WholeWordsCheckbox, RegexCheckbox } from './findInputCheckboxes.js';\r\nvar NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nvar FindInput = /** @class */ (function (_super) {\r\n    __extends(FindInput, _super);\r\n    function FindInput(parent, contextViewProvider, _showOptionButtons, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this._showOptionButtons = _showOptionButtons;\r\n        _this.fixFocusOnOptionClickEnabled = true;\r\n        _this._onDidOptionChange = _this._register(new Emitter());\r\n        _this.onDidOptionChange = _this._onDidOptionChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this.onMouseDown = _this._onMouseDown.event;\r\n        _this._onInput = _this._register(new Emitter());\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this._onCaseSensitiveKeyDown = _this._register(new Emitter());\r\n        _this.onCaseSensitiveKeyDown = _this._onCaseSensitiveKeyDown.event;\r\n        _this._onRegexKeyDown = _this._register(new Emitter());\r\n        _this.onRegexKeyDown = _this._onRegexKeyDown.event;\r\n        _this._lastHighlightFindOptions = 0;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.placeholder = options.placeholder || '';\r\n        _this.validation = options.validation;\r\n        _this.label = options.label || NLS_DEFAULT_LABEL;\r\n        _this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        _this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        _this.inputBackground = options.inputBackground;\r\n        _this.inputForeground = options.inputForeground;\r\n        _this.inputBorder = options.inputBorder;\r\n        _this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        var appendCaseSensitiveLabel = options.appendCaseSensitiveLabel || '';\r\n        var appendWholeWordsLabel = options.appendWholeWordsLabel || '';\r\n        var appendRegexLabel = options.appendRegexLabel || '';\r\n        var history = options.history || [];\r\n        var flexibleHeight = !!options.flexibleHeight;\r\n        var flexibleWidth = !!options.flexibleWidth;\r\n        var flexibleMaxHeight = options.flexibleMaxHeight;\r\n        _this.domNode = document.createElement('div');\r\n        dom.addClass(_this.domNode, 'monaco-findInput');\r\n        _this.inputBox = _this._register(new HistoryInputBox(_this.domNode, _this.contextViewProvider, {\r\n            placeholder: _this.placeholder || '',\r\n            ariaLabel: _this.label || '',\r\n            validationOptions: {\r\n                validation: _this.validation\r\n            },\r\n            inputBackground: _this.inputBackground,\r\n            inputForeground: _this.inputForeground,\r\n            inputBorder: _this.inputBorder,\r\n            inputValidationInfoBackground: _this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: _this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: _this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: _this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: _this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: _this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: _this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: _this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: _this.inputValidationErrorBorder,\r\n            history: history,\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: flexibleMaxHeight\r\n        }));\r\n        _this.regex = _this._register(new RegexCheckbox({\r\n            appendTitle: appendRegexLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.regex.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.regex.onKeyDown(function (e) {\r\n            _this._onRegexKeyDown.fire(e);\r\n        }));\r\n        _this.wholeWords = _this._register(new WholeWordsCheckbox({\r\n            appendTitle: appendWholeWordsLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.wholeWords.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this.caseSensitive = _this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: appendCaseSensitiveLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground\r\n        }));\r\n        _this._register(_this.caseSensitive.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.caseSensitive.onKeyDown(function (e) {\r\n            _this._onCaseSensitiveKeyDown.fire(e);\r\n        }));\r\n        if (_this._showOptionButtons) {\r\n            _this.inputBox.paddingRight = _this.caseSensitive.width() + _this.wholeWords.width() + _this.regex.width();\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        var indexes = [_this.caseSensitive.domNode, _this.wholeWords.domNode, _this.regex.domNode];\r\n        _this.onkeydown(_this.domNode, function (event) {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                var index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    var newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        var controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = _this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(_this.caseSensitive.domNode);\r\n        controls.appendChild(_this.wholeWords.domNode);\r\n        controls.appendChild(_this.regex.domNode);\r\n        _this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(_this.domNode);\r\n        }\r\n        _this.onkeydown(_this.inputBox.inputElement, function (e) { return _this._onKeyDown.fire(e); });\r\n        _this.onkeyup(_this.inputBox.inputElement, function (e) { return _this._onKeyUp.fire(e); });\r\n        _this.oninput(_this.inputBox.inputElement, function (e) { return _this._onInput.fire(); });\r\n        _this.onmousedown(_this.inputBox.inputElement, function (e) { return _this._onMouseDown.fire(e); });\r\n        return _this;\r\n    }\r\n    FindInput.prototype.enable = function () {\r\n        dom.removeClass(this.domNode, 'disabled');\r\n        this.inputBox.enable();\r\n        this.regex.enable();\r\n        this.wholeWords.enable();\r\n        this.caseSensitive.enable();\r\n    };\r\n    FindInput.prototype.disable = function () {\r\n        dom.addClass(this.domNode, 'disabled');\r\n        this.inputBox.disable();\r\n        this.regex.disable();\r\n        this.wholeWords.disable();\r\n        this.caseSensitive.disable();\r\n    };\r\n    FindInput.prototype.setFocusInputOnOptionClick = function (value) {\r\n        this.fixFocusOnOptionClickEnabled = value;\r\n    };\r\n    FindInput.prototype.setEnabled = function (enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    };\r\n    FindInput.prototype.getValue = function () {\r\n        return this.inputBox.value;\r\n    };\r\n    FindInput.prototype.setValue = function (value) {\r\n        if (this.inputBox.value !== value) {\r\n            this.inputBox.value = value;\r\n        }\r\n    };\r\n    FindInput.prototype.style = function (styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    FindInput.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            var checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.regex.style(checkBoxStyles);\r\n            this.wholeWords.style(checkBoxStyles);\r\n            this.caseSensitive.style(checkBoxStyles);\r\n            var inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    };\r\n    FindInput.prototype.select = function () {\r\n        this.inputBox.select();\r\n    };\r\n    FindInput.prototype.focus = function () {\r\n        this.inputBox.focus();\r\n    };\r\n    FindInput.prototype.getCaseSensitive = function () {\r\n        return this.caseSensitive.checked;\r\n    };\r\n    FindInput.prototype.setCaseSensitive = function (value) {\r\n        this.caseSensitive.checked = value;\r\n    };\r\n    FindInput.prototype.getWholeWords = function () {\r\n        return this.wholeWords.checked;\r\n    };\r\n    FindInput.prototype.setWholeWords = function (value) {\r\n        this.wholeWords.checked = value;\r\n    };\r\n    FindInput.prototype.getRegex = function () {\r\n        return this.regex.checked;\r\n    };\r\n    FindInput.prototype.setRegex = function (value) {\r\n        this.regex.checked = value;\r\n        this.validate();\r\n    };\r\n    FindInput.prototype.focusOnCaseSensitive = function () {\r\n        this.caseSensitive.focus();\r\n    };\r\n    FindInput.prototype.highlightFindOptions = function () {\r\n        dom.removeClass(this.domNode, 'highlight-' + (this._lastHighlightFindOptions));\r\n        this._lastHighlightFindOptions = 1 - this._lastHighlightFindOptions;\r\n        dom.addClass(this.domNode, 'highlight-' + (this._lastHighlightFindOptions));\r\n    };\r\n    FindInput.prototype.validate = function () {\r\n        this.inputBox.validate();\r\n    };\r\n    FindInput.prototype.clearMessage = function () {\r\n        this.inputBox.hideMessage();\r\n    };\r\n    return FindInput;\r\n}(Widget));\r\nexport { FindInput };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nvar NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nvar NLS_PRESERVE_CASE_LABEL = nls.localize('label.preserveCaseCheckbox', \"Preserve Case\");\r\nvar PreserveCaseCheckbox = /** @class */ (function (_super) {\r\n    __extends(PreserveCaseCheckbox, _super);\r\n    function PreserveCaseCheckbox(opts) {\r\n        return _super.call(this, {\r\n            // TODO: does this need its own icon?\r\n            actionClassName: 'codicon-preserve-case',\r\n            title: NLS_PRESERVE_CASE_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        }) || this;\r\n    }\r\n    return PreserveCaseCheckbox;\r\n}(Checkbox));\r\nexport { PreserveCaseCheckbox };\r\nvar ReplaceInput = /** @class */ (function (_super) {\r\n    __extends(ReplaceInput, _super);\r\n    function ReplaceInput(parent, contextViewProvider, _showOptionButtons, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this._showOptionButtons = _showOptionButtons;\r\n        _this.fixFocusOnOptionClickEnabled = true;\r\n        _this.cachedOptionsWidth = 0;\r\n        _this._onDidOptionChange = _this._register(new Emitter());\r\n        _this.onDidOptionChange = _this._onDidOptionChange.event;\r\n        _this._onKeyDown = _this._register(new Emitter());\r\n        _this.onKeyDown = _this._onKeyDown.event;\r\n        _this._onMouseDown = _this._register(new Emitter());\r\n        _this._onInput = _this._register(new Emitter());\r\n        _this._onKeyUp = _this._register(new Emitter());\r\n        _this._onPreserveCaseKeyDown = _this._register(new Emitter());\r\n        _this.onPreserveCaseKeyDown = _this._onPreserveCaseKeyDown.event;\r\n        _this.contextViewProvider = contextViewProvider;\r\n        _this.placeholder = options.placeholder || '';\r\n        _this.validation = options.validation;\r\n        _this.label = options.label || NLS_DEFAULT_LABEL;\r\n        _this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        _this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        _this.inputBackground = options.inputBackground;\r\n        _this.inputForeground = options.inputForeground;\r\n        _this.inputBorder = options.inputBorder;\r\n        _this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        _this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        _this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        _this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        _this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        _this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        _this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        _this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        _this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        var history = options.history || [];\r\n        var flexibleHeight = !!options.flexibleHeight;\r\n        var flexibleWidth = !!options.flexibleWidth;\r\n        var flexibleMaxHeight = options.flexibleMaxHeight;\r\n        _this.domNode = document.createElement('div');\r\n        dom.addClass(_this.domNode, 'monaco-findInput');\r\n        _this.inputBox = _this._register(new HistoryInputBox(_this.domNode, _this.contextViewProvider, {\r\n            ariaLabel: _this.label || '',\r\n            placeholder: _this.placeholder || '',\r\n            validationOptions: {\r\n                validation: _this.validation\r\n            },\r\n            inputBackground: _this.inputBackground,\r\n            inputForeground: _this.inputForeground,\r\n            inputBorder: _this.inputBorder,\r\n            inputValidationInfoBackground: _this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: _this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: _this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: _this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: _this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: _this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: _this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: _this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: _this.inputValidationErrorBorder,\r\n            history: history,\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: flexibleMaxHeight\r\n        }));\r\n        _this.preserveCase = _this._register(new PreserveCaseCheckbox({\r\n            appendTitle: '',\r\n            isChecked: false,\r\n            inputActiveOptionBorder: _this.inputActiveOptionBorder,\r\n            inputActiveOptionBackground: _this.inputActiveOptionBackground,\r\n        }));\r\n        _this._register(_this.preserveCase.onChange(function (viaKeyboard) {\r\n            _this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && _this.fixFocusOnOptionClickEnabled) {\r\n                _this.inputBox.focus();\r\n            }\r\n            _this.validate();\r\n        }));\r\n        _this._register(_this.preserveCase.onKeyDown(function (e) {\r\n            _this._onPreserveCaseKeyDown.fire(e);\r\n        }));\r\n        if (_this._showOptionButtons) {\r\n            _this.cachedOptionsWidth = _this.preserveCase.width();\r\n        }\r\n        else {\r\n            _this.cachedOptionsWidth = 0;\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        var indexes = [_this.preserveCase.domNode];\r\n        _this.onkeydown(_this.domNode, function (event) {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                var index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    var newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        var controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = _this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(_this.preserveCase.domNode);\r\n        _this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(_this.domNode);\r\n        }\r\n        _this.onkeydown(_this.inputBox.inputElement, function (e) { return _this._onKeyDown.fire(e); });\r\n        _this.onkeyup(_this.inputBox.inputElement, function (e) { return _this._onKeyUp.fire(e); });\r\n        _this.oninput(_this.inputBox.inputElement, function (e) { return _this._onInput.fire(); });\r\n        _this.onmousedown(_this.inputBox.inputElement, function (e) { return _this._onMouseDown.fire(e); });\r\n        return _this;\r\n    }\r\n    ReplaceInput.prototype.enable = function () {\r\n        dom.removeClass(this.domNode, 'disabled');\r\n        this.inputBox.enable();\r\n        this.preserveCase.enable();\r\n    };\r\n    ReplaceInput.prototype.disable = function () {\r\n        dom.addClass(this.domNode, 'disabled');\r\n        this.inputBox.disable();\r\n        this.preserveCase.disable();\r\n    };\r\n    ReplaceInput.prototype.setEnabled = function (enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    };\r\n    ReplaceInput.prototype.style = function (styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    };\r\n    ReplaceInput.prototype.applyStyles = function () {\r\n        if (this.domNode) {\r\n            var checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.preserveCase.style(checkBoxStyles);\r\n            var inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    };\r\n    ReplaceInput.prototype.select = function () {\r\n        this.inputBox.select();\r\n    };\r\n    ReplaceInput.prototype.focus = function () {\r\n        this.inputBox.focus();\r\n    };\r\n    ReplaceInput.prototype.getPreserveCase = function () {\r\n        return this.preserveCase.checked;\r\n    };\r\n    ReplaceInput.prototype.setPreserveCase = function (value) {\r\n        this.preserveCase.checked = value;\r\n    };\r\n    ReplaceInput.prototype.focusOnPreserve = function () {\r\n        this.preserveCase.focus();\r\n    };\r\n    ReplaceInput.prototype.validate = function () {\r\n        if (this.inputBox) {\r\n            this.inputBox.validate();\r\n        }\r\n    };\r\n    Object.defineProperty(ReplaceInput.prototype, \"width\", {\r\n        set: function (newWidth) {\r\n            this.inputBox.paddingRight = this.cachedOptionsWidth;\r\n            this.inputBox.width = newWidth;\r\n            this.domNode.style.width = newWidth + 'px';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReplaceInput.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ReplaceInput;\r\n}(Widget));\r\nexport { ReplaceInput };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IContextKeyService, ContextKeyExpr, RawContextKey } from '../contextkey/common/contextkey.js';\r\nimport { FindInput } from '../../base/browser/ui/findinput/findInput.js';\r\nimport { KeybindingsRegistry } from '../keybinding/common/keybindingsRegistry.js';\r\nimport { ReplaceInput } from '../../base/browser/ui/findinput/replaceInput.js';\r\nexport var HistoryNavigationWidgetContext = 'historyNavigationWidget';\r\nexport var HistoryNavigationEnablementContext = 'historyNavigationEnabled';\r\nfunction bindContextScopedWidget(contextKeyService, widget, contextKey) {\r\n    new RawContextKey(contextKey, widget).bindTo(contextKeyService);\r\n}\r\nfunction createWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    return contextKeyService.createScoped(widget.target);\r\n}\r\nfunction getContextScopedWidget(contextKeyService, contextKey) {\r\n    return contextKeyService.getContext(document.activeElement).getValue(contextKey);\r\n}\r\nexport function createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    var scopedContextKeyService = createWidgetScopedContextKeyService(contextKeyService, widget);\r\n    bindContextScopedWidget(scopedContextKeyService, widget, HistoryNavigationWidgetContext);\r\n    var historyNavigationEnablement = new RawContextKey(HistoryNavigationEnablementContext, true).bindTo(scopedContextKeyService);\r\n    return { scopedContextKeyService: scopedContextKeyService, historyNavigationEnablement: historyNavigationEnablement };\r\n}\r\nvar ContextScopedFindInput = /** @class */ (function (_super) {\r\n    __extends(ContextScopedFindInput, _super);\r\n    function ContextScopedFindInput(container, contextViewProvider, options, contextKeyService, showFindOptions) {\r\n        if (showFindOptions === void 0) { showFindOptions = false; }\r\n        var _this = _super.call(this, container, contextViewProvider, showFindOptions, options) || this;\r\n        _this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: _this.inputBox.element, historyNavigator: _this.inputBox }).scopedContextKeyService);\r\n        return _this;\r\n    }\r\n    ContextScopedFindInput = __decorate([\r\n        __param(3, IContextKeyService)\r\n    ], ContextScopedFindInput);\r\n    return ContextScopedFindInput;\r\n}(FindInput));\r\nexport { ContextScopedFindInput };\r\nvar ContextScopedReplaceInput = /** @class */ (function (_super) {\r\n    __extends(ContextScopedReplaceInput, _super);\r\n    function ContextScopedReplaceInput(container, contextViewProvider, options, contextKeyService, showReplaceOptions) {\r\n        if (showReplaceOptions === void 0) { showReplaceOptions = false; }\r\n        var _this = _super.call(this, container, contextViewProvider, showReplaceOptions, options) || this;\r\n        _this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: _this.inputBox.element, historyNavigator: _this.inputBox }).scopedContextKeyService);\r\n        return _this;\r\n    }\r\n    ContextScopedReplaceInput = __decorate([\r\n        __param(3, IContextKeyService)\r\n    ], ContextScopedReplaceInput);\r\n    return ContextScopedReplaceInput;\r\n}(ReplaceInput));\r\nexport { ContextScopedReplaceInput };\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showPrevious',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 16 /* UpArrow */,\r\n    secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n    handler: function (accessor, arg2) {\r\n        var widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            var historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showPreviousValue();\r\n        }\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showNext',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 18 /* DownArrow */,\r\n    secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n    handler: function (accessor, arg2) {\r\n        var widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            var historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showNextValue();\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './findWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { alert as alertFn } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Checkbox } from '../../../base/browser/ui/checkbox/checkbox.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\r\nimport { contrastBorder, editorFindMatch, editorFindMatchBorder, editorFindMatchHighlight, editorFindMatchHighlightBorder, editorFindRangeHighlight, editorFindRangeHighlightBorder, editorWidgetBackground, editorWidgetBorder, editorWidgetResizeBorder, errorForeground, inputActiveOptionBorder, inputActiveOptionBackground, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, widgetShadow, editorWidgetForeground, focusBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../platform/browser/contextScopedHistoryWidget.js';\r\nvar NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\r\nvar NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\r\nvar NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous match\");\r\nvar NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next match\");\r\nvar NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in selection\");\r\nvar NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\r\nvar NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\r\nvar NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\r\nvar NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\r\nvar NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\r\nvar NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace mode\");\r\nvar NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\r\nvar NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\r\nvar NLS_NO_RESULTS = nls.localize('label.noResults', \"No Results\");\r\nvar FIND_WIDGET_INITIAL_WIDTH = 419;\r\nvar PART_WIDTH = 275;\r\nvar FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\r\nvar MAX_MATCHES_COUNT_WIDTH = 69;\r\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\r\nvar FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\r\nvar ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\r\nvar ctrlKeyMod = (platform.isMacintosh ? 256 /* WinCtrl */ : 2048 /* CtrlCmd */);\r\nvar FindWidgetViewZone = /** @class */ (function () {\r\n    function FindWidgetViewZone(afterLineNumber) {\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\r\n        this.suppressMouseDown = false;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.className = 'dock-find-viewzone';\r\n    }\r\n    return FindWidgetViewZone;\r\n}());\r\nexport { FindWidgetViewZone };\r\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\r\n    var isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\r\n    var isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nvar FindWidget = /** @class */ (function (_super) {\r\n    __extends(FindWidget, _super);\r\n    function FindWidget(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._cachedHeight = null;\r\n        _this._codeEditor = codeEditor;\r\n        _this._controller = controller;\r\n        _this._state = state;\r\n        _this._contextViewProvider = contextViewProvider;\r\n        _this._keybindingService = keybindingService;\r\n        _this._contextKeyService = contextKeyService;\r\n        _this._storageService = storageService;\r\n        _this._notificationService = notificationService;\r\n        _this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* GLOBAL */);\r\n        _this._isVisible = false;\r\n        _this._isReplaceVisible = false;\r\n        _this._ignoreChangeEvent = false;\r\n        _this._updateHistoryDelayer = new Delayer(500);\r\n        _this._register(toDisposable(function () { return _this._updateHistoryDelayer.cancel(); }));\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        _this._buildDomNode();\r\n        _this._updateButtons();\r\n        _this._tryUpdateWidgetWidth();\r\n        _this._findInput.inputBox.layout();\r\n        _this._register(_this._codeEditor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(68 /* readOnly */)) {\r\n                if (_this._codeEditor.getOption(68 /* readOnly */)) {\r\n                    // Hide replace part if editor becomes read only\r\n                    _this._state.change({ isReplaceRevealed: false }, false);\r\n                }\r\n                _this._updateButtons();\r\n            }\r\n            if (e.hasChanged(107 /* layoutInfo */)) {\r\n                _this._tryUpdateWidgetWidth();\r\n            }\r\n            if (e.hasChanged(2 /* accessibilitySupport */)) {\r\n                _this.updateAccessibilitySupport();\r\n            }\r\n            if (e.hasChanged(28 /* find */)) {\r\n                var addExtraSpaceOnTop = _this._codeEditor.getOption(28 /* find */).addExtraSpaceOnTop;\r\n                if (addExtraSpaceOnTop && !_this._viewZone) {\r\n                    _this._viewZone = new FindWidgetViewZone(0);\r\n                    _this._showViewZone();\r\n                }\r\n                if (!addExtraSpaceOnTop && _this._viewZone) {\r\n                    _this._removeViewZone();\r\n                }\r\n            }\r\n        }));\r\n        _this.updateAccessibilitySupport();\r\n        _this._register(_this._codeEditor.onDidChangeCursorSelection(function () {\r\n            if (_this._isVisible) {\r\n                _this._updateToggleSelectionFindButton();\r\n            }\r\n        }));\r\n        _this._register(_this._codeEditor.onDidFocusEditorWidget(function () {\r\n            if (_this._isVisible) {\r\n                var globalBufferTerm = _this._controller.getGlobalBufferTerm();\r\n                if (globalBufferTerm && globalBufferTerm !== _this._state.searchString) {\r\n                    _this._state.change({ searchString: globalBufferTerm }, true);\r\n                    _this._findInput.select();\r\n                }\r\n            }\r\n        }));\r\n        _this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        _this._findFocusTracker = _this._register(dom.trackFocus(_this._findInput.inputBox.inputElement));\r\n        _this._register(_this._findFocusTracker.onDidFocus(function () {\r\n            _this._findInputFocused.set(true);\r\n            _this._updateSearchScope();\r\n        }));\r\n        _this._register(_this._findFocusTracker.onDidBlur(function () {\r\n            _this._findInputFocused.set(false);\r\n        }));\r\n        _this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        _this._replaceFocusTracker = _this._register(dom.trackFocus(_this._replaceInput.inputBox.inputElement));\r\n        _this._register(_this._replaceFocusTracker.onDidFocus(function () {\r\n            _this._replaceInputFocused.set(true);\r\n            _this._updateSearchScope();\r\n        }));\r\n        _this._register(_this._replaceFocusTracker.onDidBlur(function () {\r\n            _this._replaceInputFocused.set(false);\r\n        }));\r\n        _this._codeEditor.addOverlayWidget(_this);\r\n        if (_this._codeEditor.getOption(28 /* find */).addExtraSpaceOnTop) {\r\n            _this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\r\n        }\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._register(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this._register(_this._codeEditor.onDidChangeModel(function () {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            _this._viewZoneId = undefined;\r\n        }));\r\n        _this._register(_this._codeEditor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged) {\r\n                _this._layoutViewZone();\r\n                return;\r\n            }\r\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\r\n            setTimeout(function () {\r\n                _this._layoutViewZone();\r\n            }, 0);\r\n        }));\r\n        return _this;\r\n    }\r\n    // ----- IOverlayWidget API\r\n    FindWidget.prototype.getId = function () {\r\n        return FindWidget.ID;\r\n    };\r\n    FindWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    FindWidget.prototype.getPosition = function () {\r\n        if (this._isVisible) {\r\n            return {\r\n                preference: 0 /* TOP_RIGHT_CORNER */\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    // ----- React to state changes\r\n    FindWidget.prototype._onStateChanged = function (e) {\r\n        if (e.searchString) {\r\n            try {\r\n                this._ignoreChangeEvent = true;\r\n                this._findInput.setValue(this._state.searchString);\r\n            }\r\n            finally {\r\n                this._ignoreChangeEvent = false;\r\n            }\r\n            this._updateButtons();\r\n        }\r\n        if (e.replaceString) {\r\n            this._replaceInput.inputBox.value = this._state.replaceString;\r\n        }\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._reveal();\r\n            }\r\n            else {\r\n                this._hide(true);\r\n            }\r\n        }\r\n        if (e.isReplaceRevealed) {\r\n            if (this._state.isReplaceRevealed) {\r\n                if (!this._codeEditor.getOption(68 /* readOnly */) && !this._isReplaceVisible) {\r\n                    this._isReplaceVisible = true;\r\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                    this._updateButtons();\r\n                    this._replaceInput.inputBox.layout();\r\n                }\r\n            }\r\n            else {\r\n                if (this._isReplaceVisible) {\r\n                    this._isReplaceVisible = false;\r\n                    this._updateButtons();\r\n                }\r\n            }\r\n        }\r\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\r\n            if (this._tryUpdateHeight()) {\r\n                this._showViewZone();\r\n            }\r\n        }\r\n        if (e.isRegex) {\r\n            this._findInput.setRegex(this._state.isRegex);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._findInput.setWholeWords(this._state.wholeWord);\r\n        }\r\n        if (e.matchCase) {\r\n            this._findInput.setCaseSensitive(this._state.matchCase);\r\n        }\r\n        if (e.searchScope) {\r\n            if (this._state.searchScope) {\r\n                this._toggleSelectionFind.checked = true;\r\n            }\r\n            else {\r\n                this._toggleSelectionFind.checked = false;\r\n            }\r\n            this._updateToggleSelectionFindButton();\r\n        }\r\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\r\n            var showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\r\n            dom.toggleClass(this._domNode, 'no-results', showRedOutline);\r\n            this._updateMatchesCount();\r\n            this._updateButtons();\r\n        }\r\n        if (e.searchString || e.currentMatch) {\r\n            this._layoutViewZone();\r\n        }\r\n        if (e.updateHistory) {\r\n            this._delayedUpdateHistory();\r\n        }\r\n    };\r\n    FindWidget.prototype._delayedUpdateHistory = function () {\r\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this));\r\n    };\r\n    FindWidget.prototype._updateHistory = function () {\r\n        if (this._state.searchString) {\r\n            this._findInput.inputBox.addToHistory();\r\n        }\r\n        if (this._state.replaceString) {\r\n            this._replaceInput.inputBox.addToHistory();\r\n        }\r\n    };\r\n    FindWidget.prototype._updateMatchesCount = function () {\r\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\r\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\r\n        }\r\n        else {\r\n            this._matchesCount.title = '';\r\n        }\r\n        // remove previous content\r\n        if (this._matchesCount.firstChild) {\r\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\r\n        }\r\n        var label;\r\n        if (this._state.matchesCount > 0) {\r\n            var matchesCount = String(this._state.matchesCount);\r\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n                matchesCount += '+';\r\n            }\r\n            var matchesPosition = String(this._state.matchesPosition);\r\n            if (matchesPosition === '0') {\r\n                matchesPosition = '?';\r\n            }\r\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\r\n        }\r\n        else {\r\n            label = NLS_NO_RESULTS;\r\n        }\r\n        this._matchesCount.appendChild(document.createTextNode(label));\r\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString), true);\r\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\r\n    };\r\n    // ----- actions\r\n    FindWidget.prototype._getAriaLabel = function (label, currentMatch, searchString) {\r\n        if (label === NLS_NO_RESULTS) {\r\n            return searchString === ''\r\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\r\n                : nls.localize('ariaSearchNoResult', \"{0} found for {1}\", label, searchString);\r\n        }\r\n        return currentMatch\r\n            ? nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for {1} at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn)\r\n            : nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for {1}\", label, searchString);\r\n    };\r\n    /**\r\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\r\n     * If 'selection find' is OFF we enable the button only if there is a selection.\r\n     */\r\n    FindWidget.prototype._updateToggleSelectionFindButton = function () {\r\n        var selection = this._codeEditor.getSelection();\r\n        var isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\r\n        var isChecked = this._toggleSelectionFind.checked;\r\n        if (this._isVisible && (isChecked || isSelection)) {\r\n            this._toggleSelectionFind.enable();\r\n        }\r\n        else {\r\n            this._toggleSelectionFind.disable();\r\n        }\r\n    };\r\n    FindWidget.prototype._updateButtons = function () {\r\n        this._findInput.setEnabled(this._isVisible);\r\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\r\n        this._updateToggleSelectionFindButton();\r\n        this._closeBtn.setEnabled(this._isVisible);\r\n        var findInputIsNonEmpty = (this._state.searchString.length > 0);\r\n        var matchesCount = this._state.matchesCount ? true : false;\r\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\r\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount);\r\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        dom.toggleClass(this._domNode, 'replaceToggled', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-right', !this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-down', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        var canReplace = !this._codeEditor.getOption(68 /* readOnly */);\r\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\r\n    };\r\n    FindWidget.prototype._reveal = function () {\r\n        var _this = this;\r\n        if (!this._isVisible) {\r\n            this._isVisible = true;\r\n            var selection = this._codeEditor.getSelection();\r\n            switch (this._codeEditor.getOption(28 /* find */).autoFindInSelection) {\r\n                case 'always':\r\n                    this._toggleSelectionFind.checked = true;\r\n                    break;\r\n                case 'never':\r\n                    this._toggleSelectionFind.checked = false;\r\n                    break;\r\n                case 'multiline':\r\n                    var isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            this._tryUpdateWidgetWidth();\r\n            this._updateButtons();\r\n            setTimeout(function () {\r\n                dom.addClass(_this._domNode, 'visible');\r\n                _this._domNode.setAttribute('aria-hidden', 'false');\r\n            }, 0);\r\n            // validate query again as it's being dismissed when we hide the find widget.\r\n            setTimeout(function () {\r\n                _this._findInput.validate();\r\n            }, 200);\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            var adjustEditorScrollTop = true;\r\n            if (this._codeEditor.getOption(28 /* find */).seedSearchStringFromSelection && selection) {\r\n                var domNode = this._codeEditor.getDomNode();\r\n                if (domNode) {\r\n                    var editorCoords = dom.getDomNodePagePosition(domNode);\r\n                    var startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\r\n                    var startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\r\n                    var startTop = startCoords ? startCoords.top : 0;\r\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\r\n                        if (selection.endLineNumber > selection.startLineNumber) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        var leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\r\n                        if (startLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        var endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\r\n                        var endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\r\n                        if (endLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._showViewZone(adjustEditorScrollTop);\r\n        }\r\n    };\r\n    FindWidget.prototype._hide = function (focusTheEditor) {\r\n        if (this._isVisible) {\r\n            this._isVisible = false;\r\n            this._updateButtons();\r\n            dom.removeClass(this._domNode, 'visible');\r\n            this._domNode.setAttribute('aria-hidden', 'true');\r\n            this._findInput.clearMessage();\r\n            if (focusTheEditor) {\r\n                this._codeEditor.focus();\r\n            }\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            this._removeViewZone();\r\n        }\r\n    };\r\n    FindWidget.prototype._layoutViewZone = function () {\r\n        var _this = this;\r\n        var addExtraSpaceOnTop = this._codeEditor.getOption(28 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            this._removeViewZone();\r\n            return;\r\n        }\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        var viewZone = this._viewZone;\r\n        if (this._viewZoneId !== undefined || !viewZone) {\r\n            return;\r\n        }\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            viewZone.heightInPx = _this._getHeight();\r\n            _this._viewZoneId = accessor.addZone(viewZone);\r\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\r\n            _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + viewZone.heightInPx);\r\n        });\r\n    };\r\n    FindWidget.prototype._showViewZone = function (adjustScroll) {\r\n        var _this = this;\r\n        if (adjustScroll === void 0) { adjustScroll = true; }\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        var addExtraSpaceOnTop = this._codeEditor.getOption(28 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            return;\r\n        }\r\n        if (this._viewZone === undefined) {\r\n            this._viewZone = new FindWidgetViewZone(0);\r\n        }\r\n        var viewZone = this._viewZone;\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            if (_this._viewZoneId !== undefined) {\r\n                // the view zone already exists, we need to update the height\r\n                var newHeight = _this._getHeight();\r\n                if (newHeight === viewZone.heightInPx) {\r\n                    return;\r\n                }\r\n                var scrollAdjustment = newHeight - viewZone.heightInPx;\r\n                viewZone.heightInPx = newHeight;\r\n                accessor.layoutZone(_this._viewZoneId);\r\n                if (adjustScroll) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                var scrollAdjustment = _this._getHeight();\r\n                viewZone.heightInPx = scrollAdjustment;\r\n                _this._viewZoneId = accessor.addZone(viewZone);\r\n                if (adjustScroll) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    FindWidget.prototype._removeViewZone = function () {\r\n        var _this = this;\r\n        this._codeEditor.changeViewZones(function (accessor) {\r\n            if (_this._viewZoneId !== undefined) {\r\n                accessor.removeZone(_this._viewZoneId);\r\n                _this._viewZoneId = undefined;\r\n                if (_this._viewZone) {\r\n                    _this._codeEditor.setScrollTop(_this._codeEditor.getScrollTop() - _this._viewZone.heightInPx);\r\n                    _this._viewZone = undefined;\r\n                }\r\n            }\r\n        });\r\n    };\r\n    FindWidget.prototype._applyTheme = function (theme) {\r\n        var inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground),\r\n            inputBackground: theme.getColor(inputBackground),\r\n            inputForeground: theme.getColor(inputForeground),\r\n            inputBorder: theme.getColor(inputBorder),\r\n            inputValidationInfoBackground: theme.getColor(inputValidationInfoBackground),\r\n            inputValidationInfoForeground: theme.getColor(inputValidationInfoForeground),\r\n            inputValidationInfoBorder: theme.getColor(inputValidationInfoBorder),\r\n            inputValidationWarningBackground: theme.getColor(inputValidationWarningBackground),\r\n            inputValidationWarningForeground: theme.getColor(inputValidationWarningForeground),\r\n            inputValidationWarningBorder: theme.getColor(inputValidationWarningBorder),\r\n            inputValidationErrorBackground: theme.getColor(inputValidationErrorBackground),\r\n            inputValidationErrorForeground: theme.getColor(inputValidationErrorForeground),\r\n            inputValidationErrorBorder: theme.getColor(inputValidationErrorBorder),\r\n        };\r\n        this._findInput.style(inputStyles);\r\n        this._replaceInput.style(inputStyles);\r\n        this._toggleSelectionFind.style(inputStyles);\r\n    };\r\n    FindWidget.prototype._tryUpdateWidgetWidth = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        if (!dom.isInDOM(this._domNode)) {\r\n            // the widget is not in the DOM\r\n            return;\r\n        }\r\n        var layoutInfo = this._codeEditor.getLayoutInfo();\r\n        var editorContentWidth = layoutInfo.contentWidth;\r\n        if (editorContentWidth <= 0) {\r\n            // for example, diff view original editor\r\n            dom.addClass(this._domNode, 'hiddenEditor');\r\n            return;\r\n        }\r\n        else if (dom.hasClass(this._domNode, 'hiddenEditor')) {\r\n            dom.removeClass(this._domNode, 'hiddenEditor');\r\n        }\r\n        var editorWidth = layoutInfo.width;\r\n        var minimapWidth = layoutInfo.minimapWidth;\r\n        var collapsedFindWidget = false;\r\n        var reducedFindWidget = false;\r\n        var narrowFindWidget = false;\r\n        if (this._resized) {\r\n            var widgetWidth = dom.getTotalWidth(this._domNode);\r\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\r\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\r\n                this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\r\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                return;\r\n            }\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\r\n            reducedFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\r\n            narrowFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\r\n            collapsedFindWidget = true;\r\n        }\r\n        dom.toggleClass(this._domNode, 'collapsed-find-widget', collapsedFindWidget);\r\n        dom.toggleClass(this._domNode, 'narrow-find-widget', narrowFindWidget);\r\n        dom.toggleClass(this._domNode, 'reduced-find-widget', reducedFindWidget);\r\n        if (!narrowFindWidget && !collapsedFindWidget) {\r\n            // the minimal left offset of findwidget is 15px.\r\n            this._domNode.style.maxWidth = editorWidth - 28 - minimapWidth - 15 + \"px\";\r\n        }\r\n        if (this._resized) {\r\n            this._findInput.inputBox.layout();\r\n            var findInputWidth = this._findInput.inputBox.element.clientWidth;\r\n            if (findInputWidth > 0) {\r\n                this._replaceInput.width = findInputWidth;\r\n            }\r\n        }\r\n        else if (this._isReplaceVisible) {\r\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n        }\r\n    };\r\n    FindWidget.prototype._getHeight = function () {\r\n        var totalheight = 0;\r\n        // find input margin top\r\n        totalheight += 4;\r\n        // find input height\r\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\r\n        if (this._isReplaceVisible) {\r\n            // replace input margin\r\n            totalheight += 4;\r\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\r\n        }\r\n        // margin bottom\r\n        totalheight += 4;\r\n        return totalheight;\r\n    };\r\n    FindWidget.prototype._tryUpdateHeight = function () {\r\n        var totalHeight = this._getHeight();\r\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\r\n            return false;\r\n        }\r\n        this._cachedHeight = totalHeight;\r\n        this._domNode.style.height = totalHeight + \"px\";\r\n        return true;\r\n    };\r\n    // ----- Public\r\n    FindWidget.prototype.focusFindInput = function () {\r\n        this._findInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._findInput.focus();\r\n    };\r\n    FindWidget.prototype.focusReplaceInput = function () {\r\n        this._replaceInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._replaceInput.focus();\r\n    };\r\n    FindWidget.prototype.highlightFindOptions = function () {\r\n        this._findInput.highlightFindOptions();\r\n    };\r\n    FindWidget.prototype._updateSearchScope = function () {\r\n        if (!this._codeEditor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._toggleSelectionFind.checked) {\r\n            var selection = this._codeEditor.getSelection();\r\n            if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n            }\r\n            var currentMatch = this._state.currentMatch;\r\n            if (selection.startLineNumber !== selection.endLineNumber) {\r\n                if (!Range.equalsRange(selection, currentMatch)) {\r\n                    // Reseed find scope\r\n                    this._state.change({ searchScope: selection }, true);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FindWidget.prototype._onFindInputMouseDown = function (e) {\r\n        // on linux, middle key does pasting.\r\n        if (e.middleButton) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    FindWidget.prototype._onFindInputKeyDown = function (e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            this._findInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            if (this._isReplaceVisible) {\r\n                this._replaceInput.focus();\r\n            }\r\n            else {\r\n                this._findInput.focusOnCaseSensitive();\r\n            }\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n    };\r\n    FindWidget.prototype._onReplaceInputKeyDown = function (e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\r\n                // this is the first time when users press Ctrl + Enter to replace all\r\n                this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\r\n                this._ctrlEnterReplaceAllWarningPrompted = true;\r\n                this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* GLOBAL */);\r\n            }\r\n            this._replaceInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            this._findInput.focusOnCaseSensitive();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n            this._findInput.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n    };\r\n    // ----- sash\r\n    FindWidget.prototype.getHorizontalSashTop = function (_sash) {\r\n        return 0;\r\n    };\r\n    FindWidget.prototype.getHorizontalSashLeft = function (_sash) {\r\n        return 0;\r\n    };\r\n    FindWidget.prototype.getHorizontalSashWidth = function (_sash) {\r\n        return 500;\r\n    };\r\n    // ----- initialization\r\n    FindWidget.prototype._keybindingLabelFor = function (actionId) {\r\n        var kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return \" (\" + kb.getLabel() + \")\";\r\n    };\r\n    FindWidget.prototype._buildDomNode = function () {\r\n        var _this = this;\r\n        var flexibleHeight = true;\r\n        var flexibleWidth = true;\r\n        // Find input\r\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\r\n            width: FIND_INPUT_AREA_WIDTH,\r\n            label: NLS_FIND_INPUT_LABEL,\r\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\r\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            validation: function (value) {\r\n                if (value.length === 0 || !_this._findInput.getRegex()) {\r\n                    return null;\r\n                }\r\n                try {\r\n                    new RegExp(value);\r\n                    return null;\r\n                }\r\n                catch (e) {\r\n                    return { content: e.message };\r\n                }\r\n            },\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._findInput.setRegex(!!this._state.isRegex);\r\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\r\n        this._findInput.setWholeWords(!!this._state.wholeWord);\r\n        this._register(this._findInput.onKeyDown(function (e) { return _this._onFindInputKeyDown(e); }));\r\n        this._register(this._findInput.inputBox.onDidChange(function () {\r\n            if (_this._ignoreChangeEvent) {\r\n                return;\r\n            }\r\n            _this._state.change({ searchString: _this._findInput.getValue() }, true);\r\n        }));\r\n        this._register(this._findInput.onDidOptionChange(function () {\r\n            _this._state.change({\r\n                isRegex: _this._findInput.getRegex(),\r\n                wholeWord: _this._findInput.getWholeWords(),\r\n                matchCase: _this._findInput.getCaseSensitive()\r\n            }, true);\r\n        }));\r\n        this._register(this._findInput.onCaseSensitiveKeyDown(function (e) {\r\n            if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.onRegexKeyDown(function (e) {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.focusOnPreserve();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.inputBox.onDidHeightChange(function (e) {\r\n            if (_this._tryUpdateHeight()) {\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        if (platform.isLinux) {\r\n            this._register(this._findInput.onMouseDown(function (e) { return _this._onFindInputMouseDown(e); }));\r\n        }\r\n        this._matchesCount = document.createElement('div');\r\n        this._matchesCount.className = 'matchesCount';\r\n        this._updateMatchesCount();\r\n        // Previous button\r\n        this._prevBtn = this._register(new SimpleButton({\r\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\r\n            className: 'codicon codicon-arrow-up',\r\n            onTrigger: function () {\r\n                _this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        // Next button\r\n        this._nextBtn = this._register(new SimpleButton({\r\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\r\n            className: 'codicon codicon-arrow-down',\r\n            onTrigger: function () {\r\n                _this._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        var findPart = document.createElement('div');\r\n        findPart.className = 'find-part';\r\n        findPart.appendChild(this._findInput.domNode);\r\n        var actionsContainer = document.createElement('div');\r\n        actionsContainer.className = 'find-actions';\r\n        findPart.appendChild(actionsContainer);\r\n        actionsContainer.appendChild(this._matchesCount);\r\n        actionsContainer.appendChild(this._prevBtn.domNode);\r\n        actionsContainer.appendChild(this._nextBtn.domNode);\r\n        // Toggle selection button\r\n        this._toggleSelectionFind = this._register(new Checkbox({\r\n            actionClassName: 'codicon codicon-selection',\r\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\r\n            isChecked: false\r\n        }));\r\n        this._register(this._toggleSelectionFind.onChange(function () {\r\n            if (_this._toggleSelectionFind.checked) {\r\n                if (_this._codeEditor.hasModel()) {\r\n                    var selection = _this._codeEditor.getSelection();\r\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, _this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                    }\r\n                    if (!selection.isEmpty()) {\r\n                        _this._state.change({ searchScope: selection }, true);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                _this._state.change({ searchScope: null }, true);\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\r\n        // Close button\r\n        this._closeBtn = this._register(new SimpleButton({\r\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\r\n            className: 'codicon codicon-close',\r\n            onTrigger: function () {\r\n                _this._state.change({ isRevealed: false, searchScope: null }, false);\r\n            },\r\n            onKeyDown: function (e) {\r\n                if (e.equals(2 /* Tab */)) {\r\n                    if (_this._isReplaceVisible) {\r\n                        if (_this._replaceBtn.isEnabled()) {\r\n                            _this._replaceBtn.focus();\r\n                        }\r\n                        else {\r\n                            _this._codeEditor.focus();\r\n                        }\r\n                        e.preventDefault();\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._closeBtn.domNode);\r\n        // Replace input\r\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\r\n            label: NLS_REPLACE_INPUT_LABEL,\r\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\r\n            history: [],\r\n            flexibleHeight: flexibleHeight,\r\n            flexibleWidth: flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\r\n        this._register(this._replaceInput.onKeyDown(function (e) { return _this._onReplaceInputKeyDown(e); }));\r\n        this._register(this._replaceInput.inputBox.onDidChange(function () {\r\n            _this._state.change({ replaceString: _this._replaceInput.inputBox.value }, false);\r\n        }));\r\n        this._register(this._replaceInput.inputBox.onDidHeightChange(function (e) {\r\n            if (_this._isReplaceVisible && _this._tryUpdateHeight()) {\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        this._register(this._replaceInput.onDidOptionChange(function () {\r\n            _this._state.change({\r\n                preserveCase: _this._replaceInput.getPreserveCase()\r\n            }, true);\r\n        }));\r\n        this._register(this._replaceInput.onPreserveCaseKeyDown(function (e) {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (_this._prevBtn.isEnabled()) {\r\n                    _this._prevBtn.focus();\r\n                }\r\n                else if (_this._nextBtn.isEnabled()) {\r\n                    _this._nextBtn.focus();\r\n                }\r\n                else if (_this._toggleSelectionFind.enabled) {\r\n                    _this._toggleSelectionFind.focus();\r\n                }\r\n                else if (_this._closeBtn.isEnabled()) {\r\n                    _this._closeBtn.focus();\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        }));\r\n        // Replace one button\r\n        this._replaceBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\r\n            className: 'codicon codicon-replace',\r\n            onTrigger: function () {\r\n                _this._controller.replace();\r\n            },\r\n            onKeyDown: function (e) {\r\n                if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                    _this._closeBtn.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        // Replace all button\r\n        this._replaceAllBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\r\n            className: 'codicon codicon-replace-all',\r\n            onTrigger: function () {\r\n                _this._controller.replaceAll();\r\n            }\r\n        }));\r\n        var replacePart = document.createElement('div');\r\n        replacePart.className = 'replace-part';\r\n        replacePart.appendChild(this._replaceInput.domNode);\r\n        var replaceActionsContainer = document.createElement('div');\r\n        replaceActionsContainer.className = 'replace-actions';\r\n        replacePart.appendChild(replaceActionsContainer);\r\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\r\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\r\n        // Toggle replace button\r\n        this._toggleReplaceBtn = this._register(new SimpleButton({\r\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\r\n            className: 'codicon toggle left',\r\n            onTrigger: function () {\r\n                _this._state.change({ isReplaceRevealed: !_this._isReplaceVisible }, false);\r\n                if (_this._isReplaceVisible) {\r\n                    _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n                    _this._replaceInput.inputBox.layout();\r\n                }\r\n                _this._showViewZone();\r\n            }\r\n        }));\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-down', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.toggleClass('codicon-chevron-right', !this._isReplaceVisible);\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        // Widget\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = 'editor-widget find-widget';\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\r\n        this._domNode.style.width = FIND_WIDGET_INITIAL_WIDTH + \"px\";\r\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\r\n        this._domNode.appendChild(findPart);\r\n        this._domNode.appendChild(replacePart);\r\n        this._resizeSash = new Sash(this._domNode, this, { orientation: 0 /* VERTICAL */ });\r\n        this._resized = false;\r\n        var originalWidth = FIND_WIDGET_INITIAL_WIDTH;\r\n        this._register(this._resizeSash.onDidStart(function () {\r\n            originalWidth = dom.getTotalWidth(_this._domNode);\r\n        }));\r\n        this._register(this._resizeSash.onDidChange(function (evt) {\r\n            _this._resized = true;\r\n            var width = originalWidth + evt.startX - evt.currentX;\r\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // narrow down the find widget should be handled by CSS.\r\n                return;\r\n            }\r\n            var maxWidth = parseFloat(dom.getComputedStyle(_this._domNode).maxWidth) || 0;\r\n            if (width > maxWidth) {\r\n                return;\r\n            }\r\n            _this._domNode.style.width = width + \"px\";\r\n            if (_this._isReplaceVisible) {\r\n                _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n            }\r\n            _this._findInput.inputBox.layout();\r\n            _this._tryUpdateHeight();\r\n        }));\r\n        this._register(this._resizeSash.onDidReset(function () {\r\n            // users double click on the sash\r\n            var currentWidth = dom.getTotalWidth(_this._domNode);\r\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\r\n                return;\r\n            }\r\n            var width = FIND_WIDGET_INITIAL_WIDTH;\r\n            if (!_this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\r\n                // 1. never resized before, double click should maximizes it\r\n                // 2. users resized it already but its width is the same as default\r\n                var layoutInfo = _this._codeEditor.getLayoutInfo();\r\n                width = layoutInfo.width - 28 - layoutInfo.minimapWidth - 15;\r\n                _this._resized = true;\r\n            }\r\n            else {\r\n                /**\r\n                 * no op, the find widget should be shrinked to its default size.\r\n                 */\r\n            }\r\n            _this._domNode.style.width = width + \"px\";\r\n            if (_this._isReplaceVisible) {\r\n                _this._replaceInput.width = dom.getTotalWidth(_this._findInput.domNode);\r\n            }\r\n            _this._findInput.inputBox.layout();\r\n        }));\r\n    };\r\n    FindWidget.prototype.updateAccessibilitySupport = function () {\r\n        var value = this._codeEditor.getOption(2 /* accessibilitySupport */);\r\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* Enabled */);\r\n    };\r\n    FindWidget.ID = 'editor.contrib.findWidget';\r\n    return FindWidget;\r\n}(Widget));\r\nexport { FindWidget };\r\nvar SimpleButton = /** @class */ (function (_super) {\r\n    __extends(SimpleButton, _super);\r\n    function SimpleButton(opts) {\r\n        var _this = _super.call(this) || this;\r\n        _this._opts = opts;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.title = _this._opts.label;\r\n        _this._domNode.tabIndex = 0;\r\n        _this._domNode.className = 'button ' + _this._opts.className;\r\n        _this._domNode.setAttribute('role', 'button');\r\n        _this._domNode.setAttribute('aria-label', _this._opts.label);\r\n        _this.onclick(_this._domNode, function (e) {\r\n            _this._opts.onTrigger();\r\n            e.preventDefault();\r\n        });\r\n        _this.onkeydown(_this._domNode, function (e) {\r\n            if (e.equals(10 /* Space */) || e.equals(3 /* Enter */)) {\r\n                _this._opts.onTrigger();\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            if (_this._opts.onKeyDown) {\r\n                _this._opts.onKeyDown(e);\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SimpleButton.prototype, \"domNode\", {\r\n        get: function () {\r\n            return this._domNode;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SimpleButton.prototype.isEnabled = function () {\r\n        return (this._domNode.tabIndex >= 0);\r\n    };\r\n    SimpleButton.prototype.focus = function () {\r\n        this._domNode.focus();\r\n    };\r\n    SimpleButton.prototype.setEnabled = function (enabled) {\r\n        dom.toggleClass(this._domNode, 'disabled', !enabled);\r\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\r\n        this._domNode.tabIndex = enabled ? 0 : -1;\r\n    };\r\n    SimpleButton.prototype.setExpanded = function (expanded) {\r\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\r\n    };\r\n    SimpleButton.prototype.toggleClass = function (className, shouldHaveIt) {\r\n        dom.toggleClass(this._domNode, className, shouldHaveIt);\r\n    };\r\n    return SimpleButton;\r\n}(Widget));\r\nexport { SimpleButton };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var addBackgroundColorRule = function (selector, color) {\r\n        if (color) {\r\n            collector.addRule(\".monaco-editor \" + selector + \" { background-color: \" + color + \"; }\");\r\n        }\r\n    };\r\n    addBackgroundColorRule('.findMatch', theme.getColor(editorFindMatchHighlight));\r\n    addBackgroundColorRule('.currentFindMatch', theme.getColor(editorFindMatch));\r\n    addBackgroundColorRule('.findScope', theme.getColor(editorFindRangeHighlight));\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    addBackgroundColorRule('.find-widget', widgetBackground);\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .find-widget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\r\n    if (findMatchHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .findMatch { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + findMatchHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var findMatchBorder = theme.getColor(editorFindMatchBorder);\r\n    if (findMatchBorder) {\r\n        collector.addRule(\".monaco-editor .currentFindMatch { border: 2px solid \" + findMatchBorder + \"; padding: 1px; box-sizing: border-box; }\");\r\n    }\r\n    var findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\r\n    if (findRangeHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .findScope { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + findRangeHighlightBorder + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .find-widget { border: 1px solid \" + hcBorder + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .find-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var error = theme.getColor(errorForeground);\r\n    if (error) {\r\n        collector.addRule(\".monaco-editor .find-widget.no-results .matchesCount { color: \" + error + \"; }\");\r\n    }\r\n    var resizeBorderBackground = theme.getColor(editorWidgetResizeBorder);\r\n    if (resizeBorderBackground) {\r\n        collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + resizeBorderBackground + \"; width: 3px !important; margin-left: -4px;}\");\r\n    }\r\n    else {\r\n        var border = theme.getColor(editorWidgetBorder);\r\n        if (border) {\r\n            collector.addRule(\".monaco-editor .find-widget .monaco-sash { background-color: \" + border + \"; width: 3px !important; margin-left: -4px;}\");\r\n        }\r\n    }\r\n    // This rule is used to override the outline color for synthetic-focus find input.\r\n    var focusOutline = theme.getColor(focusBorder);\r\n    if (focusOutline) {\r\n        collector.addRule(\".monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: \" + focusOutline + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, FIND_IDS, FindModelBoundToEditorModel, ToggleCaseSensitiveKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding, CONTEXT_REPLACE_INPUT_FOCUSED } from './findModel.js';\r\nimport { FindOptionsWidget } from './findOptionsWidget.js';\r\nimport { FindReplaceState } from './findState.js';\r\nimport { FindWidget } from './findWidget.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IContextKeyService, ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nvar SEARCH_STRING_MAX_LENGTH = 524288;\r\nexport function getSelectionSearchString(editor) {\r\n    if (!editor.hasModel()) {\r\n        return null;\r\n    }\r\n    var selection = editor.getSelection();\r\n    // if selection spans multiple lines, default search string to empty\r\n    if (selection.startLineNumber === selection.endLineNumber) {\r\n        if (selection.isEmpty()) {\r\n            var wordAtPosition = editor.getModel().getWordAtPosition(selection.getStartPosition());\r\n            if (wordAtPosition) {\r\n                return wordAtPosition.word;\r\n            }\r\n        }\r\n        else {\r\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\r\n                return editor.getModel().getValueInRange(selection);\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nvar CommonFindController = /** @class */ (function (_super) {\r\n    __extends(CommonFindController, _super);\r\n    function CommonFindController(editor, contextKeyService, storageService, clipboardService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\r\n        _this._contextKeyService = contextKeyService;\r\n        _this._storageService = storageService;\r\n        _this._clipboardService = clipboardService;\r\n        _this._updateHistoryDelayer = new Delayer(500);\r\n        _this._state = _this._register(new FindReplaceState());\r\n        _this.loadQueryState();\r\n        _this._register(_this._state.onFindReplaceStateChange(function (e) { return _this._onStateChanged(e); }));\r\n        _this._model = null;\r\n        _this._register(_this._editor.onDidChangeModel(function () {\r\n            var shouldRestartFind = (_this._editor.getModel() && _this._state.isRevealed);\r\n            _this.disposeModel();\r\n            _this._state.change({\r\n                searchScope: null,\r\n                matchCase: _this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, false),\r\n                wholeWord: _this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, false),\r\n                isRegex: _this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, false),\r\n                preserveCase: _this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, false)\r\n            }, false);\r\n            if (shouldRestartFind) {\r\n                _this._start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: false && _this._editor.getOption(28 /* find */).seedSearchStringFromSelection,\r\n                    seedSearchStringFromGlobalClipboard: false,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: false,\r\n                    updateSearchScope: false\r\n                });\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    CommonFindController.get = function (editor) {\r\n        return editor.getContribution(CommonFindController.ID);\r\n    };\r\n    CommonFindController.prototype.dispose = function () {\r\n        this.disposeModel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    CommonFindController.prototype.disposeModel = function () {\r\n        if (this._model) {\r\n            this._model.dispose();\r\n            this._model = null;\r\n        }\r\n    };\r\n    CommonFindController.prototype._onStateChanged = function (e) {\r\n        this.saveQueryState(e);\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._findWidgetVisible.set(true);\r\n            }\r\n            else {\r\n                this._findWidgetVisible.reset();\r\n                this.disposeModel();\r\n            }\r\n        }\r\n        if (e.searchString) {\r\n            this.setGlobalBufferTerm(this._state.searchString);\r\n        }\r\n    };\r\n    CommonFindController.prototype.saveQueryState = function (e) {\r\n        if (e.isRegex) {\r\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.matchCase) {\r\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* WORKSPACE */);\r\n        }\r\n        if (e.preserveCase) {\r\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* WORKSPACE */);\r\n        }\r\n    };\r\n    CommonFindController.prototype.loadQueryState = function () {\r\n        this._state.change({\r\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, this._state.matchCase),\r\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, this._state.wholeWord),\r\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, this._state.isRegex),\r\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, this._state.preserveCase)\r\n        }, false);\r\n    };\r\n    CommonFindController.prototype.isFindInputFocused = function () {\r\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\r\n    };\r\n    CommonFindController.prototype.getState = function () {\r\n        return this._state;\r\n    };\r\n    CommonFindController.prototype.closeFindWidget = function () {\r\n        this._state.change({\r\n            isRevealed: false,\r\n            searchScope: null\r\n        }, false);\r\n        this._editor.focus();\r\n    };\r\n    CommonFindController.prototype.toggleCaseSensitive = function () {\r\n        this._state.change({ matchCase: !this._state.matchCase }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleWholeWords = function () {\r\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleRegex = function () {\r\n        this._state.change({ isRegex: !this._state.isRegex }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    };\r\n    CommonFindController.prototype.toggleSearchScope = function () {\r\n        if (this._state.searchScope) {\r\n            this._state.change({ searchScope: null }, true);\r\n        }\r\n        else {\r\n            if (this._editor.hasModel()) {\r\n                var selection = this._editor.getSelection();\r\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                }\r\n                if (!selection.isEmpty()) {\r\n                    this._state.change({ searchScope: selection }, true);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    CommonFindController.prototype.setSearchString = function (searchString) {\r\n        if (this._state.isRegex) {\r\n            searchString = strings.escapeRegExpCharacters(searchString);\r\n        }\r\n        this._state.change({ searchString: searchString }, false);\r\n    };\r\n    CommonFindController.prototype.highlightFindOptions = function () {\r\n        // overwritten in subclass\r\n    };\r\n    CommonFindController.prototype._start = function (opts) {\r\n        this.disposeModel();\r\n        if (!this._editor.hasModel()) {\r\n            // cannot do anything with an editor that doesn't have a model...\r\n            return;\r\n        }\r\n        var stateChanges = {\r\n            isRevealed: true\r\n        };\r\n        if (opts.seedSearchStringFromSelection) {\r\n            var selectionSearchString = getSelectionSearchString(this._editor);\r\n            if (selectionSearchString) {\r\n                if (this._state.isRegex) {\r\n                    stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\r\n                }\r\n                else {\r\n                    stateChanges.searchString = selectionSearchString;\r\n                }\r\n            }\r\n        }\r\n        if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\r\n            var selectionSearchString = this.getGlobalBufferTerm();\r\n            if (selectionSearchString) {\r\n                stateChanges.searchString = selectionSearchString;\r\n            }\r\n        }\r\n        // Overwrite isReplaceRevealed\r\n        if (opts.forceRevealReplace) {\r\n            stateChanges.isReplaceRevealed = true;\r\n        }\r\n        else if (!this._findWidgetVisible.get()) {\r\n            stateChanges.isReplaceRevealed = false;\r\n        }\r\n        if (opts.updateSearchScope) {\r\n            var currentSelection = this._editor.getSelection();\r\n            if (!currentSelection.isEmpty()) {\r\n                stateChanges.searchScope = currentSelection;\r\n            }\r\n        }\r\n        this._state.change(stateChanges, false);\r\n        if (!this._model) {\r\n            this._model = new FindModelBoundToEditorModel(this._editor, this._state);\r\n        }\r\n    };\r\n    CommonFindController.prototype.start = function (opts) {\r\n        this._start(opts);\r\n    };\r\n    CommonFindController.prototype.moveToNextMatch = function () {\r\n        if (this._model) {\r\n            this._model.moveToNextMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.moveToPrevMatch = function () {\r\n        if (this._model) {\r\n            this._model.moveToPrevMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.replace = function () {\r\n        if (this._model) {\r\n            this._model.replace();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.replaceAll = function () {\r\n        if (this._model) {\r\n            this._model.replaceAll();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.selectAllMatches = function () {\r\n        if (this._model) {\r\n            this._model.selectAllMatches();\r\n            this._editor.focus();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    CommonFindController.prototype.getGlobalBufferTerm = function () {\r\n        if (this._editor.getOption(28 /* find */).globalFindClipboard\r\n            && this._clipboardService\r\n            && this._editor.hasModel()\r\n            && !this._editor.getModel().isTooLargeForSyncing()) {\r\n            return this._clipboardService.readFindText();\r\n        }\r\n        return '';\r\n    };\r\n    CommonFindController.prototype.setGlobalBufferTerm = function (text) {\r\n        if (this._editor.getOption(28 /* find */).globalFindClipboard\r\n            && this._clipboardService\r\n            && this._editor.hasModel()\r\n            && !this._editor.getModel().isTooLargeForSyncing()) {\r\n            this._clipboardService.writeFindText(text);\r\n        }\r\n    };\r\n    CommonFindController.ID = 'editor.contrib.findController';\r\n    CommonFindController = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IStorageService),\r\n        __param(3, IClipboardService)\r\n    ], CommonFindController);\r\n    return CommonFindController;\r\n}(Disposable));\r\nexport { CommonFindController };\r\nvar FindController = /** @class */ (function (_super) {\r\n    __extends(FindController, _super);\r\n    function FindController(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, _notificationService, _storageService, clipboardService) {\r\n        var _this = _super.call(this, editor, _contextKeyService, _storageService, clipboardService) || this;\r\n        _this._contextViewService = _contextViewService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._themeService = _themeService;\r\n        _this._notificationService = _notificationService;\r\n        _this._widget = null;\r\n        _this._findOptionsWidget = null;\r\n        return _this;\r\n    }\r\n    FindController.prototype._start = function (opts) {\r\n        if (!this._widget) {\r\n            this._createFindWidget();\r\n        }\r\n        var selection = this._editor.getSelection();\r\n        var updateSearchScope = false;\r\n        switch (this._editor.getOption(28 /* find */).autoFindInSelection) {\r\n            case 'always':\r\n                updateSearchScope = true;\r\n                break;\r\n            case 'never':\r\n                updateSearchScope = false;\r\n                break;\r\n            case 'multiline':\r\n                var isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                updateSearchScope = isSelectionMultipleLine;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        opts.updateSearchScope = updateSearchScope;\r\n        _super.prototype._start.call(this, opts);\r\n        if (opts.shouldFocus === 2 /* FocusReplaceInput */) {\r\n            this._widget.focusReplaceInput();\r\n        }\r\n        else if (opts.shouldFocus === 1 /* FocusFindInput */) {\r\n            this._widget.focusFindInput();\r\n        }\r\n    };\r\n    FindController.prototype.highlightFindOptions = function () {\r\n        if (!this._widget) {\r\n            this._createFindWidget();\r\n        }\r\n        if (this._state.isRevealed) {\r\n            this._widget.highlightFindOptions();\r\n        }\r\n        else {\r\n            this._findOptionsWidget.highlightFindOptions();\r\n        }\r\n    };\r\n    FindController.prototype._createFindWidget = function () {\r\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\r\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService, this._themeService));\r\n    };\r\n    FindController = __decorate([\r\n        __param(1, IContextViewService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IKeybindingService),\r\n        __param(4, IThemeService),\r\n        __param(5, INotificationService),\r\n        __param(6, IStorageService),\r\n        __param(7, optional(IClipboardService))\r\n    ], FindController);\r\n    return FindController;\r\n}(CommonFindController));\r\nexport { FindController };\r\nvar StartFindAction = /** @class */ (function (_super) {\r\n    __extends(StartFindAction, _super);\r\n    function StartFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindAction,\r\n            label: nls.localize('startFindAction', \"Find\"),\r\n            alias: 'Find',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 36 /* KEY_F */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '3_find',\r\n                title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: editor.getOption(28 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: editor.getOption(28 /* find */).globalFindClipboard,\r\n                shouldFocus: 1 /* FocusFindInput */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n        }\r\n    };\r\n    return StartFindAction;\r\n}(EditorAction));\r\nexport { StartFindAction };\r\nvar StartFindWithSelectionAction = /** @class */ (function (_super) {\r\n    __extends(StartFindWithSelectionAction, _super);\r\n    function StartFindWithSelectionAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindWithSelection,\r\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\r\n            alias: 'Find With Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 0,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 35 /* KEY_E */,\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindWithSelectionAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: true,\r\n                seedSearchStringFromGlobalClipboard: false,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            controller.setGlobalBufferTerm(controller.getState().searchString);\r\n        }\r\n    };\r\n    return StartFindWithSelectionAction;\r\n}(EditorAction));\r\nexport { StartFindWithSelectionAction };\r\nvar MatchFindAction = /** @class */ (function (_super) {\r\n    __extends(MatchFindAction, _super);\r\n    function MatchFindAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MatchFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (controller && !this._run(controller)) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(28 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: true,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            this._run(controller);\r\n        }\r\n    };\r\n    return MatchFindAction;\r\n}(EditorAction));\r\nexport { MatchFindAction };\r\nvar NextMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(NextMatchFindAction, _super);\r\n    function NextMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextMatchFindAction,\r\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\r\n            alias: 'Find Next',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 61 /* F3 */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 37 /* KEY_G */, secondary: [61 /* F3 */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextMatchFindAction;\r\n}(MatchFindAction));\r\nexport { NextMatchFindAction };\r\nvar NextMatchFindAction2 = /** @class */ (function (_super) {\r\n    __extends(NextMatchFindAction2, _super);\r\n    function NextMatchFindAction2() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextMatchFindAction,\r\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\r\n            alias: 'Find Next',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                primary: 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextMatchFindAction2.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextMatchFindAction2;\r\n}(MatchFindAction));\r\nexport { NextMatchFindAction2 };\r\nvar PreviousMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(PreviousMatchFindAction, _super);\r\n    function PreviousMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousMatchFindAction,\r\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\r\n            alias: 'Find Previous',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 61 /* F3 */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 37 /* KEY_G */, secondary: [1024 /* Shift */ | 61 /* F3 */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousMatchFindAction;\r\n}(MatchFindAction));\r\nexport { PreviousMatchFindAction };\r\nvar PreviousMatchFindAction2 = /** @class */ (function (_super) {\r\n    __extends(PreviousMatchFindAction2, _super);\r\n    function PreviousMatchFindAction2() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousMatchFindAction,\r\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\r\n            alias: 'Find Previous',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                primary: 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousMatchFindAction2.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousMatchFindAction2;\r\n}(MatchFindAction));\r\nexport { PreviousMatchFindAction2 };\r\nvar SelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(SelectionMatchFindAction, _super);\r\n    function SelectionMatchFindAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SelectionMatchFindAction.prototype.run = function (accessor, editor) {\r\n        var controller = CommonFindController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var selectionSearchString = getSelectionSearchString(editor);\r\n        if (selectionSearchString) {\r\n            controller.setSearchString(selectionSearchString);\r\n        }\r\n        if (!this._run(controller)) {\r\n            controller.start({\r\n                forceRevealReplace: false,\r\n                seedSearchStringFromSelection: editor.getOption(28 /* find */).seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: false,\r\n                shouldFocus: 0 /* NoFocusChange */,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n            this._run(controller);\r\n        }\r\n    };\r\n    return SelectionMatchFindAction;\r\n}(EditorAction));\r\nexport { SelectionMatchFindAction };\r\nvar NextSelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(NextSelectionMatchFindAction, _super);\r\n    function NextSelectionMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.NextSelectionMatchFindAction,\r\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\r\n            alias: 'Find Next Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    NextSelectionMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToNextMatch();\r\n    };\r\n    return NextSelectionMatchFindAction;\r\n}(SelectionMatchFindAction));\r\nexport { NextSelectionMatchFindAction };\r\nvar PreviousSelectionMatchFindAction = /** @class */ (function (_super) {\r\n    __extends(PreviousSelectionMatchFindAction, _super);\r\n    function PreviousSelectionMatchFindAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\r\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\r\n            alias: 'Find Previous Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    PreviousSelectionMatchFindAction.prototype._run = function (controller) {\r\n        return controller.moveToPrevMatch();\r\n    };\r\n    return PreviousSelectionMatchFindAction;\r\n}(SelectionMatchFindAction));\r\nexport { PreviousSelectionMatchFindAction };\r\nvar StartFindReplaceAction = /** @class */ (function (_super) {\r\n    __extends(StartFindReplaceAction, _super);\r\n    function StartFindReplaceAction() {\r\n        return _super.call(this, {\r\n            id: FIND_IDS.StartFindReplaceAction,\r\n            label: nls.localize('startReplace', \"Replace\"),\r\n            alias: 'Replace',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 38 /* KEY_H */,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 36 /* KEY_F */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 17 /* MenubarEditMenu */,\r\n                group: '3_find',\r\n                title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    StartFindReplaceAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel() || editor.getOption(68 /* readOnly */)) {\r\n            return;\r\n        }\r\n        var controller = CommonFindController.get(editor);\r\n        var currentSelection = editor.getSelection();\r\n        var findInputFocused = controller.isFindInputFocused();\r\n        // we only seed search string from selection when the current selection is single line and not empty,\r\n        // + the find input is not focused\r\n        var seedSearchStringFromSelection = !currentSelection.isEmpty()\r\n            && currentSelection.startLineNumber === currentSelection.endLineNumber && editor.getOption(28 /* find */).seedSearchStringFromSelection\r\n            && !findInputFocused;\r\n        /*\r\n         * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\r\n\r\n         * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\r\n         * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\r\n         * findInputFocused false seedSearchStringFromSelection false FocusFindInput\r\n         */\r\n        var shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\r\n            2 /* FocusReplaceInput */ : 1 /* FocusFindInput */;\r\n        if (controller) {\r\n            controller.start({\r\n                forceRevealReplace: true,\r\n                seedSearchStringFromSelection: seedSearchStringFromSelection,\r\n                seedSearchStringFromGlobalClipboard: editor.getOption(28 /* find */).seedSearchStringFromSelection,\r\n                shouldFocus: shouldFocus,\r\n                shouldAnimate: true,\r\n                updateSearchScope: false\r\n            });\r\n        }\r\n    };\r\n    return StartFindReplaceAction;\r\n}(EditorAction));\r\nexport { StartFindReplaceAction };\r\nregisterEditorContribution(CommonFindController.ID, FindController);\r\nregisterEditorAction(StartFindAction);\r\nregisterEditorAction(StartFindWithSelectionAction);\r\nregisterEditorAction(NextMatchFindAction);\r\nregisterEditorAction(NextMatchFindAction2);\r\nregisterEditorAction(PreviousMatchFindAction);\r\nregisterEditorAction(PreviousMatchFindAction2);\r\nregisterEditorAction(NextSelectionMatchFindAction);\r\nregisterEditorAction(PreviousSelectionMatchFindAction);\r\nregisterEditorAction(StartFindReplaceAction);\r\nvar FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.CloseFindWidgetCommand,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.closeFindWidget(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleCaseSensitive(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleCaseSensitiveKeybinding.primary,\r\n        mac: ToggleCaseSensitiveKeybinding.mac,\r\n        win: ToggleCaseSensitiveKeybinding.win,\r\n        linux: ToggleCaseSensitiveKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleWholeWordCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleWholeWords(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleWholeWordKeybinding.primary,\r\n        mac: ToggleWholeWordKeybinding.mac,\r\n        win: ToggleWholeWordKeybinding.win,\r\n        linux: ToggleWholeWordKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleRegexCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleRegex(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleRegexKeybinding.primary,\r\n        mac: ToggleRegexKeybinding.mac,\r\n        win: ToggleRegexKeybinding.win,\r\n        linux: ToggleRegexKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleSearchScopeCommand,\r\n    precondition: undefined,\r\n    handler: function (x) { return x.toggleSearchScope(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleSearchScopeKeybinding.primary,\r\n        mac: ToggleSearchScopeKeybinding.mac,\r\n        win: ToggleSearchScopeKeybinding.win,\r\n        linux: ToggleSearchScopeKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replace(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 22 /* KEY_1 */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replace(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replaceAll(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.replaceAll(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: undefined,\r\n        mac: {\r\n            primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n        }\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.SelectAllMatchesAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.selectAllMatches(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var MAX_FOLDING_REGIONS = 0xFFFF;\r\nexport var MAX_LINE_NUMBER = 0xFFFFFF;\r\nvar MASK_INDENT = 0xFF000000;\r\nvar FoldingRegions = /** @class */ (function () {\r\n    function FoldingRegions(startIndexes, endIndexes, types) {\r\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\r\n            throw new Error('invalid startIndexes or endIndexes size');\r\n        }\r\n        this._startIndexes = startIndexes;\r\n        this._endIndexes = endIndexes;\r\n        this._collapseStates = new Uint32Array(Math.ceil(startIndexes.length / 32));\r\n        this._types = types;\r\n        this._parentsComputed = false;\r\n    }\r\n    FoldingRegions.prototype.ensureParentIndices = function () {\r\n        var _this = this;\r\n        if (!this._parentsComputed) {\r\n            this._parentsComputed = true;\r\n            var parentIndexes_1 = [];\r\n            var isInsideLast = function (startLineNumber, endLineNumber) {\r\n                var index = parentIndexes_1[parentIndexes_1.length - 1];\r\n                return _this.getStartLineNumber(index) <= startLineNumber && _this.getEndLineNumber(index) >= endLineNumber;\r\n            };\r\n            for (var i = 0, len = this._startIndexes.length; i < len; i++) {\r\n                var startLineNumber = this._startIndexes[i];\r\n                var endLineNumber = this._endIndexes[i];\r\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\r\n                }\r\n                while (parentIndexes_1.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\r\n                    parentIndexes_1.pop();\r\n                }\r\n                var parentIndex = parentIndexes_1.length > 0 ? parentIndexes_1[parentIndexes_1.length - 1] : -1;\r\n                parentIndexes_1.push(i);\r\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\r\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(FoldingRegions.prototype, \"length\", {\r\n        get: function () {\r\n            return this._startIndexes.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingRegions.prototype.getStartLineNumber = function (index) {\r\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\r\n    };\r\n    FoldingRegions.prototype.getEndLineNumber = function (index) {\r\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\r\n    };\r\n    FoldingRegions.prototype.getType = function (index) {\r\n        return this._types ? this._types[index] : undefined;\r\n    };\r\n    FoldingRegions.prototype.hasTypes = function () {\r\n        return !!this._types;\r\n    };\r\n    FoldingRegions.prototype.isCollapsed = function (index) {\r\n        var arrayIndex = (index / 32) | 0;\r\n        var bit = index % 32;\r\n        return (this._collapseStates[arrayIndex] & (1 << bit)) !== 0;\r\n    };\r\n    FoldingRegions.prototype.setCollapsed = function (index, newState) {\r\n        var arrayIndex = (index / 32) | 0;\r\n        var bit = index % 32;\r\n        var value = this._collapseStates[arrayIndex];\r\n        if (newState) {\r\n            this._collapseStates[arrayIndex] = value | (1 << bit);\r\n        }\r\n        else {\r\n            this._collapseStates[arrayIndex] = value & ~(1 << bit);\r\n        }\r\n    };\r\n    FoldingRegions.prototype.toRegion = function (index) {\r\n        return new FoldingRegion(this, index);\r\n    };\r\n    FoldingRegions.prototype.getParentIndex = function (index) {\r\n        this.ensureParentIndices();\r\n        var parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\r\n        if (parent === MAX_FOLDING_REGIONS) {\r\n            return -1;\r\n        }\r\n        return parent;\r\n    };\r\n    FoldingRegions.prototype.contains = function (index, line) {\r\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\r\n    };\r\n    FoldingRegions.prototype.findIndex = function (line) {\r\n        var low = 0, high = this._startIndexes.length;\r\n        if (high === 0) {\r\n            return -1; // no children\r\n        }\r\n        while (low < high) {\r\n            var mid = Math.floor((low + high) / 2);\r\n            if (line < this.getStartLineNumber(mid)) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        return low - 1;\r\n    };\r\n    FoldingRegions.prototype.findRange = function (line) {\r\n        var index = this.findIndex(line);\r\n        if (index >= 0) {\r\n            var endLineNumber = this.getEndLineNumber(index);\r\n            if (endLineNumber >= line) {\r\n                return index;\r\n            }\r\n            index = this.getParentIndex(index);\r\n            while (index !== -1) {\r\n                if (this.contains(index, line)) {\r\n                    return index;\r\n                }\r\n                index = this.getParentIndex(index);\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    FoldingRegions.prototype.toString = function () {\r\n        var res = [];\r\n        for (var i = 0; i < this.length; i++) {\r\n            res[i] = \"[\" + (this.isCollapsed(i) ? '+' : '-') + \"] \" + this.getStartLineNumber(i) + \"/\" + this.getEndLineNumber(i);\r\n        }\r\n        return res.join(', ');\r\n    };\r\n    return FoldingRegions;\r\n}());\r\nexport { FoldingRegions };\r\nvar FoldingRegion = /** @class */ (function () {\r\n    function FoldingRegion(ranges, index) {\r\n        this.ranges = ranges;\r\n        this.index = index;\r\n    }\r\n    Object.defineProperty(FoldingRegion.prototype, \"startLineNumber\", {\r\n        get: function () {\r\n            return this.ranges.getStartLineNumber(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"endLineNumber\", {\r\n        get: function () {\r\n            return this.ranges.getEndLineNumber(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"regionIndex\", {\r\n        get: function () {\r\n            return this.index;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"parentIndex\", {\r\n        get: function () {\r\n            return this.ranges.getParentIndex(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingRegion.prototype, \"isCollapsed\", {\r\n        get: function () {\r\n            return this.ranges.isCollapsed(this.index);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingRegion.prototype.containedBy = function (range) {\r\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\r\n    };\r\n    FoldingRegion.prototype.containsLine = function (lineNumber) {\r\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\r\n    };\r\n    return FoldingRegion;\r\n}());\r\nexport { FoldingRegion };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { FoldingRegions } from './foldingRanges.js';\r\nvar FoldingModel = /** @class */ (function () {\r\n    function FoldingModel(textModel, decorationProvider) {\r\n        this._updateEventEmitter = new Emitter();\r\n        this.onDidChange = this._updateEventEmitter.event;\r\n        this._textModel = textModel;\r\n        this._decorationProvider = decorationProvider;\r\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\r\n        this._editorDecorationIds = [];\r\n        this._isInitialized = false;\r\n    }\r\n    Object.defineProperty(FoldingModel.prototype, \"regions\", {\r\n        get: function () { return this._regions; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingModel.prototype, \"textModel\", {\r\n        get: function () { return this._textModel; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FoldingModel.prototype, \"isInitialized\", {\r\n        get: function () { return this._isInitialized; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FoldingModel.prototype.toggleCollapseState = function (regions) {\r\n        var _this = this;\r\n        if (!regions.length) {\r\n            return;\r\n        }\r\n        var processed = {};\r\n        this._decorationProvider.changeDecorations(function (accessor) {\r\n            for (var _i = 0, regions_1 = regions; _i < regions_1.length; _i++) {\r\n                var region = regions_1[_i];\r\n                var index = region.regionIndex;\r\n                var editorDecorationId = _this._editorDecorationIds[index];\r\n                if (editorDecorationId && !processed[editorDecorationId]) {\r\n                    processed[editorDecorationId] = true;\r\n                    var newCollapseState = !_this._regions.isCollapsed(index);\r\n                    _this._regions.setCollapsed(index, newCollapseState);\r\n                    accessor.changeDecorationOptions(editorDecorationId, _this._decorationProvider.getDecorationOption(newCollapseState));\r\n                }\r\n            }\r\n        });\r\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: regions });\r\n    };\r\n    FoldingModel.prototype.update = function (newRegions, blockedLineNumers) {\r\n        var _this = this;\r\n        if (blockedLineNumers === void 0) { blockedLineNumers = []; }\r\n        var newEditorDecorations = [];\r\n        var isBlocked = function (startLineNumber, endLineNumber) {\r\n            for (var _i = 0, blockedLineNumers_1 = blockedLineNumers; _i < blockedLineNumers_1.length; _i++) {\r\n                var blockedLineNumber = blockedLineNumers_1[_i];\r\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        var initRange = function (index, isCollapsed) {\r\n            var startLineNumber = newRegions.getStartLineNumber(index);\r\n            if (isCollapsed && isBlocked(startLineNumber, newRegions.getEndLineNumber(index))) {\r\n                isCollapsed = false;\r\n            }\r\n            newRegions.setCollapsed(index, isCollapsed);\r\n            var maxColumn = _this._textModel.getLineMaxColumn(startLineNumber);\r\n            var decorationRange = {\r\n                startLineNumber: startLineNumber,\r\n                startColumn: maxColumn,\r\n                endLineNumber: startLineNumber,\r\n                endColumn: maxColumn\r\n            };\r\n            newEditorDecorations.push({ range: decorationRange, options: _this._decorationProvider.getDecorationOption(isCollapsed) });\r\n        };\r\n        var i = 0;\r\n        var nextCollapsed = function () {\r\n            while (i < _this._regions.length) {\r\n                var isCollapsed = _this._regions.isCollapsed(i);\r\n                i++;\r\n                if (isCollapsed) {\r\n                    return i - 1;\r\n                }\r\n            }\r\n            return -1;\r\n        };\r\n        var k = 0;\r\n        var collapsedIndex = nextCollapsed();\r\n        while (collapsedIndex !== -1 && k < newRegions.length) {\r\n            // get the latest range\r\n            var decRange = this._textModel.getDecorationRange(this._editorDecorationIds[collapsedIndex]);\r\n            if (decRange) {\r\n                var collapsedStartLineNumber = decRange.startLineNumber;\r\n                if (this._textModel.getLineMaxColumn(collapsedStartLineNumber) === decRange.startColumn) { // test that the decoration is still at the end otherwise it got deleted\r\n                    while (k < newRegions.length) {\r\n                        var startLineNumber = newRegions.getStartLineNumber(k);\r\n                        if (collapsedStartLineNumber >= startLineNumber) {\r\n                            initRange(k, collapsedStartLineNumber === startLineNumber);\r\n                            k++;\r\n                        }\r\n                        else {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            collapsedIndex = nextCollapsed();\r\n        }\r\n        while (k < newRegions.length) {\r\n            initRange(k, false);\r\n            k++;\r\n        }\r\n        this._editorDecorationIds = this._decorationProvider.deltaDecorations(this._editorDecorationIds, newEditorDecorations);\r\n        this._regions = newRegions;\r\n        this._isInitialized = true;\r\n        this._updateEventEmitter.fire({ model: this });\r\n    };\r\n    /**\r\n     * Collapse state memento, for persistence only\r\n     */\r\n    FoldingModel.prototype.getMemento = function () {\r\n        var collapsedRanges = [];\r\n        for (var i = 0; i < this._regions.length; i++) {\r\n            if (this._regions.isCollapsed(i)) {\r\n                var range = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\r\n                if (range) {\r\n                    var startLineNumber = range.startLineNumber;\r\n                    var endLineNumber = range.endLineNumber + this._regions.getEndLineNumber(i) - this._regions.getStartLineNumber(i);\r\n                    collapsedRanges.push({ startLineNumber: startLineNumber, endLineNumber: endLineNumber });\r\n                }\r\n            }\r\n        }\r\n        if (collapsedRanges.length > 0) {\r\n            return collapsedRanges;\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Apply persisted state, for persistence only\r\n     */\r\n    FoldingModel.prototype.applyMemento = function (state) {\r\n        if (!Array.isArray(state)) {\r\n            return;\r\n        }\r\n        var toToogle = [];\r\n        for (var _i = 0, state_1 = state; _i < state_1.length; _i++) {\r\n            var range = state_1[_i];\r\n            var region = this.getRegionAtLine(range.startLineNumber);\r\n            if (region && !region.isCollapsed) {\r\n                toToogle.push(region);\r\n            }\r\n        }\r\n        this.toggleCollapseState(toToogle);\r\n    };\r\n    FoldingModel.prototype.dispose = function () {\r\n        this._decorationProvider.deltaDecorations(this._editorDecorationIds, []);\r\n    };\r\n    FoldingModel.prototype.getAllRegionsAtLine = function (lineNumber, filter) {\r\n        var result = [];\r\n        if (this._regions) {\r\n            var index = this._regions.findRange(lineNumber);\r\n            var level = 1;\r\n            while (index >= 0) {\r\n                var current = this._regions.toRegion(index);\r\n                if (!filter || filter(current, level)) {\r\n                    result.push(current);\r\n                }\r\n                level++;\r\n                index = current.parentIndex;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    FoldingModel.prototype.getRegionAtLine = function (lineNumber) {\r\n        if (this._regions) {\r\n            var index = this._regions.findRange(lineNumber);\r\n            if (index >= 0) {\r\n                return this._regions.toRegion(index);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    FoldingModel.prototype.getRegionsInside = function (region, filter) {\r\n        var result = [];\r\n        var index = region ? region.regionIndex + 1 : 0;\r\n        var endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\r\n        if (filter && filter.length === 2) {\r\n            var levelStack = [];\r\n            for (var i = index, len = this._regions.length; i < len; i++) {\r\n                var current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\r\n                        levelStack.pop();\r\n                    }\r\n                    levelStack.push(current);\r\n                    if (filter(current, levelStack.length)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (var i = index, len = this._regions.length; i < len; i++) {\r\n                var current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    if (!filter || filter(current)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return FoldingModel;\r\n}());\r\nexport { FoldingModel };\r\n/**\r\n * Collapse or expand the regions at the given locations\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\r\n    var toToggle = [];\r\n    var _loop_1 = function (lineNumber) {\r\n        var region = foldingModel.getRegionAtLine(lineNumber);\r\n        if (region) {\r\n            var doCollapse_1 = !region.isCollapsed;\r\n            toToggle.push(region);\r\n            if (levels > 1) {\r\n                var regionsInside = foldingModel.getRegionsInside(region, function (r, level) { return r.isCollapsed !== doCollapse_1 && level < levels; });\r\n                toToggle.push.apply(toToggle, regionsInside);\r\n            }\r\n        }\r\n    };\r\n    for (var _i = 0, lineNumbers_1 = lineNumbers; _i < lineNumbers_1.length; _i++) {\r\n        var lineNumber = lineNumbers_1[_i];\r\n        _loop_1(lineNumber);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all children.\r\n * @param doCollapse Wheter to collase or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels, lineNumbers) {\r\n    if (levels === void 0) { levels = Number.MAX_VALUE; }\r\n    var toToggle = [];\r\n    if (lineNumbers && lineNumbers.length > 0) {\r\n        for (var _i = 0, lineNumbers_2 = lineNumbers; _i < lineNumbers_2.length; _i++) {\r\n            var lineNumber = lineNumbers_2[_i];\r\n            var region = foldingModel.getRegionAtLine(lineNumber);\r\n            if (region) {\r\n                if (region.isCollapsed !== doCollapse) {\r\n                    toToggle.push(region);\r\n                }\r\n                if (levels > 1) {\r\n                    var regionsInside = foldingModel.getRegionsInside(region, function (r, level) { return r.isCollapsed !== doCollapse && level < levels; });\r\n                    toToggle.push.apply(toToggle, regionsInside);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        var regionsInside = foldingModel.getRegionsInside(null, function (r, level) { return r.isCollapsed !== doCollapse && level < levels; });\r\n        toToggle.push.apply(toToggle, regionsInside);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all parents.\r\n * @param doCollapse Wheter to collase or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand.\r\n */\r\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\r\n    var toToggle = [];\r\n    for (var _i = 0, lineNumbers_3 = lineNumbers; _i < lineNumbers_3.length; _i++) {\r\n        var lineNumber = lineNumbers_3[_i];\r\n        var regions = foldingModel.getAllRegionsAtLine(lineNumber, function (region, level) { return region.isCollapsed !== doCollapse && level <= levels; });\r\n        toToggle.push.apply(toToggle, regions);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\r\n * @param doCollapse Wheter to collase or expand\r\n * @param lineNumbers the location of the regions to collapse or expand.\r\n */\r\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\r\n    var toToggle = [];\r\n    for (var _i = 0, lineNumbers_4 = lineNumbers; _i < lineNumbers_4.length; _i++) {\r\n        var lineNumber = lineNumbers_4[_i];\r\n        var regions = foldingModel.getAllRegionsAtLine(lineNumber, function (region) { return region.isCollapsed !== doCollapse; });\r\n        if (regions.length > 0) {\r\n            toToggle.push(regions[0]);\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\r\n * @param foldLevel level. Level == 1 is the top level\r\n * @param doCollapse Wheter to collase or expand\r\n*/\r\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\r\n    var filter = function (region, level) { return level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(function (line) { return region.containsLine(line); }); };\r\n    var toToggle = foldingModel.getRegionsInside(null, filter);\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions for which the lines start with a given regex\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\r\n    var editorModel = foldingModel.textModel;\r\n    var regions = foldingModel.regions;\r\n    var toToggle = [];\r\n    for (var i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i)) {\r\n            var startLineNumber = regions.getStartLineNumber(i);\r\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\r\n                toToggle.push(regions.toRegion(i));\r\n            }\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions of the given type\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\r\n    var regions = foldingModel.regions;\r\n    var toToggle = [];\r\n    for (var i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\r\n            toToggle.push(regions.toRegion(i));\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nvar FoldingDecorationProvider = /** @class */ (function () {\r\n    function FoldingDecorationProvider(editor) {\r\n        this.editor = editor;\r\n        this.autoHideFoldingControls = true;\r\n        this.showFoldingHighlights = true;\r\n    }\r\n    FoldingDecorationProvider.prototype.getDecorationOption = function (isCollapsed) {\r\n        if (isCollapsed) {\r\n            return this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION;\r\n        }\r\n        else if (this.autoHideFoldingControls) {\r\n            return FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\r\n        }\r\n        else {\r\n            return FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\r\n        }\r\n    };\r\n    FoldingDecorationProvider.prototype.deltaDecorations = function (oldDecorations, newDecorations) {\r\n        return this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n    };\r\n    FoldingDecorationProvider.prototype.changeDecorations = function (callback) {\r\n        return this.editor.changeDecorations(callback);\r\n    };\r\n    FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        afterContentClassName: 'inline-folded',\r\n        linesDecorationsClassName: 'codicon codicon-chevron-right'\r\n    });\r\n    FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        afterContentClassName: 'inline-folded',\r\n        className: 'folded-background',\r\n        isWholeLine: true,\r\n        linesDecorationsClassName: 'codicon codicon-chevron-right'\r\n    });\r\n    FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        linesDecorationsClassName: 'codicon codicon-chevron-down'\r\n    });\r\n    FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        linesDecorationsClassName: 'codicon codicon-chevron-down alwaysShowFoldIcons'\r\n    });\r\n    return FoldingDecorationProvider;\r\n}());\r\nexport { FoldingDecorationProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { findFirstInSorted } from '../../../base/common/arrays.js';\r\nvar HiddenRangeModel = /** @class */ (function () {\r\n    function HiddenRangeModel(model) {\r\n        var _this = this;\r\n        this._updateEventEmitter = new Emitter();\r\n        this._foldingModel = model;\r\n        this._foldingModelListener = model.onDidChange(function (_) { return _this.updateHiddenRanges(); });\r\n        this._hiddenRanges = [];\r\n        if (model.regions.length) {\r\n            this.updateHiddenRanges();\r\n        }\r\n    }\r\n    Object.defineProperty(HiddenRangeModel.prototype, \"onDidChange\", {\r\n        get: function () { return this._updateEventEmitter.event; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HiddenRangeModel.prototype, \"hiddenRanges\", {\r\n        get: function () { return this._hiddenRanges; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HiddenRangeModel.prototype.updateHiddenRanges = function () {\r\n        var updateHiddenAreas = false;\r\n        var newHiddenAreas = [];\r\n        var i = 0; // index into hidden\r\n        var k = 0;\r\n        var lastCollapsedStart = Number.MAX_VALUE;\r\n        var lastCollapsedEnd = -1;\r\n        var ranges = this._foldingModel.regions;\r\n        for (; i < ranges.length; i++) {\r\n            if (!ranges.isCollapsed(i)) {\r\n                continue;\r\n            }\r\n            var startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\r\n            var endLineNumber = ranges.getEndLineNumber(i);\r\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\r\n                // ignore ranges contained in collapsed regions\r\n                continue;\r\n            }\r\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\r\n                // reuse the old ranges\r\n                newHiddenAreas.push(this._hiddenRanges[k]);\r\n                k++;\r\n            }\r\n            else {\r\n                updateHiddenAreas = true;\r\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\r\n            }\r\n            lastCollapsedStart = startLineNumber;\r\n            lastCollapsedEnd = endLineNumber;\r\n        }\r\n        if (updateHiddenAreas || k < this._hiddenRanges.length) {\r\n            this.applyHiddenRanges(newHiddenAreas);\r\n        }\r\n    };\r\n    HiddenRangeModel.prototype.applyMemento = function (state) {\r\n        if (!Array.isArray(state) || state.length === 0) {\r\n            return false;\r\n        }\r\n        var hiddenRanges = [];\r\n        for (var _i = 0, state_1 = state; _i < state_1.length; _i++) {\r\n            var r = state_1[_i];\r\n            if (!r.startLineNumber || !r.endLineNumber) {\r\n                return false;\r\n            }\r\n            hiddenRanges.push(new Range(r.startLineNumber + 1, 1, r.endLineNumber, 1));\r\n        }\r\n        this.applyHiddenRanges(hiddenRanges);\r\n        return true;\r\n    };\r\n    /**\r\n     * Collapse state memento, for persistence only, only used if folding model is not yet initialized\r\n     */\r\n    HiddenRangeModel.prototype.getMemento = function () {\r\n        return this._hiddenRanges.map(function (r) { return ({ startLineNumber: r.startLineNumber - 1, endLineNumber: r.endLineNumber }); });\r\n    };\r\n    HiddenRangeModel.prototype.applyHiddenRanges = function (newHiddenAreas) {\r\n        this._hiddenRanges = newHiddenAreas;\r\n        this._updateEventEmitter.fire(newHiddenAreas);\r\n    };\r\n    HiddenRangeModel.prototype.hasRanges = function () {\r\n        return this._hiddenRanges.length > 0;\r\n    };\r\n    HiddenRangeModel.prototype.isHidden = function (line) {\r\n        return findRange(this._hiddenRanges, line) !== null;\r\n    };\r\n    HiddenRangeModel.prototype.adjustSelections = function (selections) {\r\n        var _this = this;\r\n        var hasChanges = false;\r\n        var editorModel = this._foldingModel.textModel;\r\n        var lastRange = null;\r\n        var adjustLine = function (line) {\r\n            if (!lastRange || !isInside(line, lastRange)) {\r\n                lastRange = findRange(_this._hiddenRanges, line);\r\n            }\r\n            if (lastRange) {\r\n                return lastRange.startLineNumber - 1;\r\n            }\r\n            return null;\r\n        };\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            var adjustedStartLine = adjustLine(selection.startLineNumber);\r\n            if (adjustedStartLine) {\r\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\r\n                hasChanges = true;\r\n            }\r\n            var adjustedEndLine = adjustLine(selection.endLineNumber);\r\n            if (adjustedEndLine) {\r\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\r\n                hasChanges = true;\r\n            }\r\n            selections[i] = selection;\r\n        }\r\n        return hasChanges;\r\n    };\r\n    HiddenRangeModel.prototype.dispose = function () {\r\n        if (this.hiddenRanges.length > 0) {\r\n            this._hiddenRanges = [];\r\n            this._updateEventEmitter.fire(this._hiddenRanges);\r\n        }\r\n        if (this._foldingModelListener) {\r\n            this._foldingModelListener.dispose();\r\n            this._foldingModelListener = null;\r\n        }\r\n    };\r\n    return HiddenRangeModel;\r\n}());\r\nexport { HiddenRangeModel };\r\nfunction isInside(line, range) {\r\n    return line >= range.startLineNumber && line <= range.endLineNumber;\r\n}\r\nfunction findRange(ranges, line) {\r\n    var i = findFirstInSorted(ranges, function (r) { return line < r.startLineNumber; }) - 1;\r\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\r\n        return ranges[i];\r\n    }\r\n    return null;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nvar MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT = 5000;\r\nexport var ID_INDENT_PROVIDER = 'indent';\r\nvar IndentRangeProvider = /** @class */ (function () {\r\n    function IndentRangeProvider(editorModel) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INDENT_PROVIDER;\r\n    }\r\n    IndentRangeProvider.prototype.dispose = function () {\r\n    };\r\n    IndentRangeProvider.prototype.compute = function (cancelationToken) {\r\n        var foldingRules = LanguageConfigurationRegistry.getFoldingRules(this.editorModel.getLanguageIdentifier().id);\r\n        var offSide = foldingRules && !!foldingRules.offSide;\r\n        var markers = foldingRules && foldingRules.markers;\r\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers));\r\n    };\r\n    return IndentRangeProvider;\r\n}());\r\nexport { IndentRangeProvider };\r\n// public only for testing\r\nvar RangesCollector = /** @class */ (function () {\r\n    function RangesCollector(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._indentOccurrences = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    RangesCollector.prototype.insertFirst = function (startLineNumber, endLineNumber, indent) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        var index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._length++;\r\n        if (indent < 1000) {\r\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\r\n        }\r\n    };\r\n    RangesCollector.prototype.toIndentRanges = function (model) {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            // reverse and create arrays of the exact length\r\n            var startIndexes = new Uint32Array(this._length);\r\n            var endIndexes = new Uint32Array(this._length);\r\n            for (var i = this._length - 1, k = 0; i >= 0; i--, k++) {\r\n                startIndexes[k] = this._startIndexes[i];\r\n                endIndexes[k] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n        else {\r\n            var entries = 0;\r\n            var maxIndent = this._indentOccurrences.length;\r\n            for (var i = 0; i < this._indentOccurrences.length; i++) {\r\n                var n = this._indentOccurrences[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxIndent = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            var tabSize = model.getOptions().tabSize;\r\n            // reverse and create arrays of the exact length\r\n            var startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            for (var i = this._length - 1, k = 0; i >= 0; i--) {\r\n                var startIndex = this._startIndexes[i];\r\n                var lineContent = model.getLineContent(startIndex);\r\n                var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n                if (indent < maxIndent || (indent === maxIndent && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = startIndex;\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n    };\r\n    return RangesCollector;\r\n}());\r\nexport { RangesCollector };\r\nexport function computeRanges(model, offSide, markers, foldingRangesLimit) {\r\n    if (foldingRangesLimit === void 0) { foldingRangesLimit = MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT; }\r\n    var tabSize = model.getOptions().tabSize;\r\n    var result = new RangesCollector(foldingRangesLimit);\r\n    var pattern = undefined;\r\n    if (markers) {\r\n        pattern = new RegExp(\"(\" + markers.start.source + \")|(?:\" + markers.end.source + \")\");\r\n    }\r\n    var previousRegions = [];\r\n    var line = model.getLineCount() + 1;\r\n    previousRegions.push({ indent: -1, endAbove: line, line: line }); // sentinel, to make sure there's at least one entry\r\n    for (var line_1 = model.getLineCount(); line_1 > 0; line_1--) {\r\n        var lineContent = model.getLineContent(line_1);\r\n        var indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        var previous = previousRegions[previousRegions.length - 1];\r\n        if (indent === -1) {\r\n            if (offSide) {\r\n                // for offSide languages, empty lines are associated to the previous block\r\n                // note: the next block is already written to the results, so this only\r\n                // impacts the end position of the block before\r\n                previous.endAbove = line_1;\r\n            }\r\n            continue; // only whitespace\r\n        }\r\n        var m = void 0;\r\n        if (pattern && (m = lineContent.match(pattern))) {\r\n            // folding pattern match\r\n            if (m[1]) { // start pattern match\r\n                // discard all regions until the folding pattern\r\n                var i = previousRegions.length - 1;\r\n                while (i > 0 && previousRegions[i].indent !== -2) {\r\n                    i--;\r\n                }\r\n                if (i > 0) {\r\n                    previousRegions.length = i + 1;\r\n                    previous = previousRegions[i];\r\n                    // new folding range from pattern, includes the end line\r\n                    result.insertFirst(line_1, previous.line, indent);\r\n                    previous.line = line_1;\r\n                    previous.indent = indent;\r\n                    previous.endAbove = line_1;\r\n                    continue;\r\n                }\r\n                else {\r\n                    // no end marker found, treat line as a regular line\r\n                }\r\n            }\r\n            else { // end pattern match\r\n                previousRegions.push({ indent: -2, endAbove: line_1, line: line_1 });\r\n                continue;\r\n            }\r\n        }\r\n        if (previous.indent > indent) {\r\n            // discard all regions with larger indent\r\n            do {\r\n                previousRegions.pop();\r\n                previous = previousRegions[previousRegions.length - 1];\r\n            } while (previous.indent > indent);\r\n            // new folding range\r\n            var endLineNumber = previous.endAbove - 1;\r\n            if (endLineNumber - line_1 >= 1) { // needs at east size 1\r\n                result.insertFirst(line_1, endLineNumber, indent);\r\n            }\r\n        }\r\n        if (previous.indent === indent) {\r\n            previous.endAbove = line_1;\r\n        }\r\n        else { // previous.indent < indent\r\n            // new region with a bigger indent\r\n            previousRegions.push({ indent: indent, endAbove: line_1, line: line_1 });\r\n        }\r\n    }\r\n    return result.toIndentRanges(model);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { MAX_LINE_NUMBER, FoldingRegions } from './foldingRanges.js';\r\nvar MAX_FOLDING_REGIONS = 5000;\r\nvar foldingContext = {};\r\nexport var ID_SYNTAX_PROVIDER = 'syntax';\r\nvar SyntaxRangeProvider = /** @class */ (function () {\r\n    function SyntaxRangeProvider(editorModel, providers, limit) {\r\n        if (limit === void 0) { limit = MAX_FOLDING_REGIONS; }\r\n        this.editorModel = editorModel;\r\n        this.providers = providers;\r\n        this.limit = limit;\r\n        this.id = ID_SYNTAX_PROVIDER;\r\n    }\r\n    SyntaxRangeProvider.prototype.compute = function (cancellationToken) {\r\n        var _this = this;\r\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(function (ranges) {\r\n            if (ranges) {\r\n                var res = sanitizeRanges(ranges, _this.limit);\r\n                return res;\r\n            }\r\n            return null;\r\n        });\r\n    };\r\n    SyntaxRangeProvider.prototype.dispose = function () {\r\n    };\r\n    return SyntaxRangeProvider;\r\n}());\r\nexport { SyntaxRangeProvider };\r\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\r\n    var rangeData = null;\r\n    var promises = providers.map(function (provider, i) {\r\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(function (ranges) {\r\n            if (cancellationToken.isCancellationRequested) {\r\n                return;\r\n            }\r\n            if (Array.isArray(ranges)) {\r\n                if (!Array.isArray(rangeData)) {\r\n                    rangeData = [];\r\n                }\r\n                var nLines = model.getLineCount();\r\n                for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\r\n                    var r = ranges_1[_i];\r\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\r\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\r\n                    }\r\n                }\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function (_) {\r\n        return rangeData;\r\n    });\r\n}\r\nvar RangesCollector = /** @class */ (function () {\r\n    function RangesCollector(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._nestingLevels = [];\r\n        this._nestingLevelCounts = [];\r\n        this._types = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    RangesCollector.prototype.add = function (startLineNumber, endLineNumber, type, nestingLevel) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        var index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._nestingLevels[index] = nestingLevel;\r\n        this._types[index] = type;\r\n        this._length++;\r\n        if (nestingLevel < 30) {\r\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\r\n        }\r\n    };\r\n    RangesCollector.prototype.toIndentRanges = function () {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            var startIndexes = new Uint32Array(this._length);\r\n            var endIndexes = new Uint32Array(this._length);\r\n            for (var i = 0; i < this._length; i++) {\r\n                startIndexes[i] = this._startIndexes[i];\r\n                endIndexes[i] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\r\n        }\r\n        else {\r\n            var entries = 0;\r\n            var maxLevel = this._nestingLevelCounts.length;\r\n            for (var i = 0; i < this._nestingLevelCounts.length; i++) {\r\n                var n = this._nestingLevelCounts[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxLevel = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            var startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            var types = [];\r\n            for (var i = 0, k = 0; i < this._length; i++) {\r\n                var level = this._nestingLevels[i];\r\n                if (level < maxLevel || (level === maxLevel && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = this._startIndexes[i];\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    types[k] = this._types[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, types);\r\n        }\r\n    };\r\n    return RangesCollector;\r\n}());\r\nexport { RangesCollector };\r\nexport function sanitizeRanges(rangeData, limit) {\r\n    var sorted = rangeData.sort(function (d1, d2) {\r\n        var diff = d1.start - d2.start;\r\n        if (diff === 0) {\r\n            diff = d1.rank - d2.rank;\r\n        }\r\n        return diff;\r\n    });\r\n    var collector = new RangesCollector(limit);\r\n    var top = undefined;\r\n    var previous = [];\r\n    for (var _i = 0, sorted_1 = sorted; _i < sorted_1.length; _i++) {\r\n        var entry = sorted_1[_i];\r\n        if (!top) {\r\n            top = entry;\r\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n        }\r\n        else {\r\n            if (entry.start > top.start) {\r\n                if (entry.end <= top.end) {\r\n                    previous.push(top);\r\n                    top = entry;\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n                else {\r\n                    if (entry.start > top.end) {\r\n                        do {\r\n                            top = previous.pop();\r\n                        } while (top && entry.start > top.end);\r\n                        if (top) {\r\n                            previous.push(top);\r\n                        }\r\n                        top = entry;\r\n                    }\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return collector.toIndentRanges();\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { sanitizeRanges } from './syntaxRangeProvider.js';\r\nexport var ID_INIT_PROVIDER = 'init';\r\nvar InitializingRangeProvider = /** @class */ (function () {\r\n    function InitializingRangeProvider(editorModel, initialRanges, onTimeout, timeoutTime) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INIT_PROVIDER;\r\n        if (initialRanges.length) {\r\n            var toDecorationRange = function (range) {\r\n                return {\r\n                    range: {\r\n                        startLineNumber: range.startLineNumber,\r\n                        startColumn: 0,\r\n                        endLineNumber: range.endLineNumber,\r\n                        endColumn: editorModel.getLineLength(range.endLineNumber)\r\n                    },\r\n                    options: {\r\n                        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */\r\n                    }\r\n                };\r\n            };\r\n            this.decorationIds = editorModel.deltaDecorations([], initialRanges.map(toDecorationRange));\r\n            this.timeout = setTimeout(onTimeout, timeoutTime);\r\n        }\r\n    }\r\n    InitializingRangeProvider.prototype.dispose = function () {\r\n        if (this.decorationIds) {\r\n            this.editorModel.deltaDecorations(this.decorationIds, []);\r\n            this.decorationIds = undefined;\r\n        }\r\n        if (typeof this.timeout === 'number') {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = undefined;\r\n        }\r\n    };\r\n    InitializingRangeProvider.prototype.compute = function (cancelationToken) {\r\n        var foldingRangeData = [];\r\n        if (this.decorationIds) {\r\n            for (var _i = 0, _a = this.decorationIds; _i < _a.length; _i++) {\r\n                var id = _a[_i];\r\n                var range = this.editorModel.getDecorationRange(id);\r\n                if (range) {\r\n                    foldingRangeData.push({ start: range.startLineNumber, end: range.endLineNumber, rank: 1 });\r\n                }\r\n            }\r\n        }\r\n        return Promise.resolve(sanitizeRanges(foldingRangeData, Number.MAX_VALUE));\r\n    };\r\n    return InitializingRangeProvider;\r\n}());\r\nexport { InitializingRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './folding.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { RunOnceScheduler, Delayer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, registerInstantiatedEditorAction } from '../../browser/editorExtensions.js';\r\nimport { FoldingModel, setCollapseStateAtLevel, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateForMatchingLines, setCollapseStateForType, toggleCollapseState, setCollapseStateUp } from './foldingModel.js';\r\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { IndentRangeProvider } from './indentRangeProvider.js';\r\nimport { FoldingRangeProviderRegistry, FoldingRangeKind } from '../../common/modes.js';\r\nimport { SyntaxRangeProvider, ID_SYNTAX_PROVIDER } from './syntaxRangeProvider.js';\r\nimport { InitializingRangeProvider, ID_INIT_PROVIDER } from './intializingRangeProvider.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorSelectionBackground, transparent } from '../../../platform/theme/common/colorRegistry.js';\r\nvar CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\r\nvar FoldingController = /** @class */ (function (_super) {\r\n    __extends(FoldingController, _super);\r\n    function FoldingController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.contextKeyService = contextKeyService;\r\n        _this.localToDispose = _this._register(new DisposableStore());\r\n        _this.editor = editor;\r\n        var options = _this.editor.getOptions();\r\n        _this._isEnabled = options.get(30 /* folding */);\r\n        _this._useFoldingProviders = options.get(31 /* foldingStrategy */) !== 'indentation';\r\n        _this.foldingModel = null;\r\n        _this.hiddenRangeModel = null;\r\n        _this.rangeProvider = null;\r\n        _this.foldingRegionPromise = null;\r\n        _this.foldingStateMemento = null;\r\n        _this.foldingModelPromise = null;\r\n        _this.updateScheduler = null;\r\n        _this.cursorChangedScheduler = null;\r\n        _this.mouseDownInfo = null;\r\n        _this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\r\n        _this.foldingDecorationProvider.autoHideFoldingControls = options.get(84 /* showFoldingControls */) === 'mouseover';\r\n        _this.foldingDecorationProvider.showFoldingHighlights = options.get(32 /* foldingHighlight */);\r\n        _this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(_this.contextKeyService);\r\n        _this.foldingEnabled.set(_this._isEnabled);\r\n        _this._register(_this.editor.onDidChangeModel(function () { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(30 /* folding */)) {\r\n                var options_1 = _this.editor.getOptions();\r\n                _this._isEnabled = options_1.get(30 /* folding */);\r\n                _this.foldingEnabled.set(_this._isEnabled);\r\n                _this.onModelChanged();\r\n            }\r\n            if (e.hasChanged(84 /* showFoldingControls */) || e.hasChanged(32 /* foldingHighlight */)) {\r\n                var options_2 = _this.editor.getOptions();\r\n                _this.foldingDecorationProvider.autoHideFoldingControls = options_2.get(84 /* showFoldingControls */) === 'mouseover';\r\n                _this.foldingDecorationProvider.showFoldingHighlights = options_2.get(32 /* foldingHighlight */);\r\n                _this.onModelContentChanged();\r\n            }\r\n            if (e.hasChanged(31 /* foldingStrategy */)) {\r\n                var options_3 = _this.editor.getOptions();\r\n                _this._useFoldingProviders = options_3.get(31 /* foldingStrategy */) !== 'indentation';\r\n                _this.onFoldingStrategyChanged();\r\n            }\r\n        }));\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    FoldingController.get = function (editor) {\r\n        return editor.getContribution(FoldingController.ID);\r\n    };\r\n    /**\r\n     * Store view state.\r\n     */\r\n    FoldingController.prototype.saveViewState = function () {\r\n        var model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\r\n            return {};\r\n        }\r\n        if (this.foldingModel) { // disposed ?\r\n            var collapsedRegions = this.foldingModel.isInitialized ? this.foldingModel.getMemento() : this.hiddenRangeModel.getMemento();\r\n            var provider = this.rangeProvider ? this.rangeProvider.id : undefined;\r\n            return { collapsedRegions: collapsedRegions, lineCount: model.getLineCount(), provider: provider };\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Restore view state.\r\n     */\r\n    FoldingController.prototype.restoreViewState = function (state) {\r\n        var model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\r\n            return;\r\n        }\r\n        if (!state || !state.collapsedRegions || state.lineCount !== model.getLineCount()) {\r\n            return;\r\n        }\r\n        if (state.provider === ID_SYNTAX_PROVIDER || state.provider === ID_INIT_PROVIDER) {\r\n            this.foldingStateMemento = state;\r\n        }\r\n        var collapsedRegions = state.collapsedRegions;\r\n        // set the hidden ranges right away, before waiting for the folding model.\r\n        if (this.hiddenRangeModel.applyMemento(collapsedRegions)) {\r\n            var foldingModel = this.getFoldingModel();\r\n            if (foldingModel) {\r\n                foldingModel.then(function (foldingModel) {\r\n                    if (foldingModel) {\r\n                        foldingModel.applyMemento(collapsedRegions);\r\n                    }\r\n                }).then(undefined, onUnexpectedError);\r\n            }\r\n        }\r\n    };\r\n    FoldingController.prototype.onModelChanged = function () {\r\n        var _this = this;\r\n        this.localToDispose.clear();\r\n        var model = this.editor.getModel();\r\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\r\n            // huge files get no view model, so they cannot support hidden areas\r\n            return;\r\n        }\r\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\r\n        this.localToDispose.add(this.foldingModel);\r\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\r\n        this.localToDispose.add(this.hiddenRangeModel);\r\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(function (hr) { return _this.onHiddenRangesChanges(hr); }));\r\n        this.updateScheduler = new Delayer(200);\r\n        this.cursorChangedScheduler = new RunOnceScheduler(function () { return _this.revealCursor(); }, 200);\r\n        this.localToDispose.add(this.cursorChangedScheduler);\r\n        this.localToDispose.add(FoldingRangeProviderRegistry.onDidChange(function () { return _this.onFoldingStrategyChanged(); }));\r\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(function () { return _this.onFoldingStrategyChanged(); })); // covers model language changes as well\r\n        this.localToDispose.add(this.editor.onDidChangeModelContent(function () { return _this.onModelContentChanged(); }));\r\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(function () { return _this.onCursorPositionChanged(); }));\r\n        this.localToDispose.add(this.editor.onMouseDown(function (e) { return _this.onEditorMouseDown(e); }));\r\n        this.localToDispose.add(this.editor.onMouseUp(function (e) { return _this.onEditorMouseUp(e); }));\r\n        this.localToDispose.add({\r\n            dispose: function () {\r\n                if (_this.foldingRegionPromise) {\r\n                    _this.foldingRegionPromise.cancel();\r\n                    _this.foldingRegionPromise = null;\r\n                }\r\n                if (_this.updateScheduler) {\r\n                    _this.updateScheduler.cancel();\r\n                }\r\n                _this.updateScheduler = null;\r\n                _this.foldingModel = null;\r\n                _this.foldingModelPromise = null;\r\n                _this.hiddenRangeModel = null;\r\n                _this.cursorChangedScheduler = null;\r\n                _this.foldingStateMemento = null;\r\n                if (_this.rangeProvider) {\r\n                    _this.rangeProvider.dispose();\r\n                }\r\n                _this.rangeProvider = null;\r\n            }\r\n        });\r\n        this.onModelContentChanged();\r\n    };\r\n    FoldingController.prototype.onFoldingStrategyChanged = function () {\r\n        if (this.rangeProvider) {\r\n            this.rangeProvider.dispose();\r\n        }\r\n        this.rangeProvider = null;\r\n        this.onModelContentChanged();\r\n    };\r\n    FoldingController.prototype.getRangeProvider = function (editorModel) {\r\n        var _this = this;\r\n        if (this.rangeProvider) {\r\n            return this.rangeProvider;\r\n        }\r\n        this.rangeProvider = new IndentRangeProvider(editorModel); // fallback\r\n        if (this._useFoldingProviders && this.foldingModel) {\r\n            var foldingProviders = FoldingRangeProviderRegistry.ordered(this.foldingModel.textModel);\r\n            if (foldingProviders.length === 0 && this.foldingStateMemento && this.foldingStateMemento.collapsedRegions) {\r\n                var rangeProvider = this.rangeProvider = new InitializingRangeProvider(editorModel, this.foldingStateMemento.collapsedRegions, function () {\r\n                    // if after 30 the InitializingRangeProvider is still not replaced, force a refresh\r\n                    _this.foldingStateMemento = null;\r\n                    _this.onFoldingStrategyChanged();\r\n                }, 30000);\r\n                return rangeProvider; // keep memento in case there are still no foldingProviders on the next request.\r\n            }\r\n            else if (foldingProviders.length > 0) {\r\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, foldingProviders);\r\n            }\r\n        }\r\n        this.foldingStateMemento = null;\r\n        return this.rangeProvider;\r\n    };\r\n    FoldingController.prototype.getFoldingModel = function () {\r\n        return this.foldingModelPromise;\r\n    };\r\n    FoldingController.prototype.onModelContentChanged = function () {\r\n        var _this = this;\r\n        if (this.updateScheduler) {\r\n            if (this.foldingRegionPromise) {\r\n                this.foldingRegionPromise.cancel();\r\n                this.foldingRegionPromise = null;\r\n            }\r\n            this.foldingModelPromise = this.updateScheduler.trigger(function () {\r\n                var foldingModel = _this.foldingModel;\r\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\r\n                    return null;\r\n                }\r\n                var foldingRegionPromise = _this.foldingRegionPromise = createCancelablePromise(function (token) { return _this.getRangeProvider(foldingModel.textModel).compute(token); });\r\n                return foldingRegionPromise.then(function (foldingRanges) {\r\n                    if (foldingRanges && foldingRegionPromise === _this.foldingRegionPromise) { // new request or cancelled in the meantime?\r\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\r\n                        var selections = _this.editor.getSelections();\r\n                        var selectionLineNumbers = selections ? selections.map(function (s) { return s.startLineNumber; }) : [];\r\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\r\n                    }\r\n                    return foldingModel;\r\n                });\r\n            }).then(undefined, function (err) {\r\n                onUnexpectedError(err);\r\n                return null;\r\n            });\r\n        }\r\n    };\r\n    FoldingController.prototype.onHiddenRangesChanges = function (hiddenRanges) {\r\n        if (this.hiddenRangeModel && hiddenRanges.length) {\r\n            var selections = this.editor.getSelections();\r\n            if (selections) {\r\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\r\n                    this.editor.setSelections(selections);\r\n                }\r\n            }\r\n        }\r\n        this.editor.setHiddenAreas(hiddenRanges);\r\n    };\r\n    FoldingController.prototype.onCursorPositionChanged = function () {\r\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\r\n            this.cursorChangedScheduler.schedule();\r\n        }\r\n    };\r\n    FoldingController.prototype.revealCursor = function () {\r\n        var _this = this;\r\n        var foldingModel = this.getFoldingModel();\r\n        if (!foldingModel) {\r\n            return;\r\n        }\r\n        foldingModel.then(function (foldingModel) {\r\n            if (foldingModel) {\r\n                var selections = _this.editor.getSelections();\r\n                if (selections && selections.length > 0) {\r\n                    var toToggle = [];\r\n                    var _loop_1 = function (selection) {\r\n                        var lineNumber = selection.selectionStartLineNumber;\r\n                        if (_this.hiddenRangeModel && _this.hiddenRangeModel.isHidden(lineNumber)) {\r\n                            toToggle.push.apply(toToggle, foldingModel.getAllRegionsAtLine(lineNumber, function (r) { return r.isCollapsed && lineNumber > r.startLineNumber; }));\r\n                        }\r\n                    };\r\n                    for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n                        var selection = selections_1[_i];\r\n                        _loop_1(selection);\r\n                    }\r\n                    if (toToggle.length) {\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        _this.reveal(selections[0].getPosition());\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    FoldingController.prototype.onEditorMouseDown = function (e) {\r\n        this.mouseDownInfo = null;\r\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\r\n            return;\r\n        }\r\n        if (!e.event.leftButton && !e.event.middleButton) {\r\n            return;\r\n        }\r\n        var range = e.target.range;\r\n        var iconClicked = false;\r\n        switch (e.target.type) {\r\n            case 4 /* GUTTER_LINE_DECORATIONS */:\r\n                var data = e.target.detail;\r\n                var offsetLeftInGutter = e.target.element.offsetLeft;\r\n                var gutterOffsetX = data.offsetX - offsetLeftInGutter;\r\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\r\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\r\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\r\n                    return;\r\n                }\r\n                iconClicked = true;\r\n                break;\r\n            case 6 /* CONTENT_TEXT */: {\r\n                if (this.hiddenRangeModel.hasRanges()) {\r\n                    var model = this.editor.getModel();\r\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\r\n                        break;\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            default:\r\n                return;\r\n        }\r\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked: iconClicked };\r\n    };\r\n    FoldingController.prototype.onEditorMouseUp = function (e) {\r\n        var _this = this;\r\n        var foldingModel = this.getFoldingModel();\r\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\r\n            return;\r\n        }\r\n        var lineNumber = this.mouseDownInfo.lineNumber;\r\n        var iconClicked = this.mouseDownInfo.iconClicked;\r\n        var range = e.target.range;\r\n        if (!range || range.startLineNumber !== lineNumber) {\r\n            return;\r\n        }\r\n        if (iconClicked) {\r\n            if (e.target.type !== 4 /* GUTTER_LINE_DECORATIONS */) {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            var model = this.editor.getModel();\r\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\r\n                return;\r\n            }\r\n        }\r\n        foldingModel.then(function (foldingModel) {\r\n            if (foldingModel) {\r\n                var region = foldingModel.getRegionAtLine(lineNumber);\r\n                if (region && region.startLineNumber === lineNumber) {\r\n                    var isCollapsed = region.isCollapsed;\r\n                    if (iconClicked || isCollapsed) {\r\n                        var toToggle = [];\r\n                        var recursive = e.event.middleButton || e.event.shiftKey;\r\n                        if (recursive) {\r\n                            for (var _i = 0, _a = foldingModel.getRegionsInside(region); _i < _a.length; _i++) {\r\n                                var r = _a[_i];\r\n                                if (r.isCollapsed === isCollapsed) {\r\n                                    toToggle.push(r);\r\n                                }\r\n                            }\r\n                        }\r\n                        // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\r\n                        if (isCollapsed || !recursive || toToggle.length === 0) {\r\n                            toToggle.push(region);\r\n                        }\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        _this.reveal({ lineNumber: lineNumber, column: 1 });\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    FoldingController.prototype.reveal = function (position) {\r\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n    };\r\n    FoldingController.ID = 'editor.contrib.folding';\r\n    FoldingController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], FoldingController);\r\n    return FoldingController;\r\n}(Disposable));\r\nexport { FoldingController };\r\nvar FoldingAction = /** @class */ (function (_super) {\r\n    __extends(FoldingAction, _super);\r\n    function FoldingAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FoldingAction.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        var foldingController = FoldingController.get(editor);\r\n        if (!foldingController) {\r\n            return;\r\n        }\r\n        var foldingModelPromise = foldingController.getFoldingModel();\r\n        if (foldingModelPromise) {\r\n            this.reportTelemetry(accessor, editor);\r\n            return foldingModelPromise.then(function (foldingModel) {\r\n                if (foldingModel) {\r\n                    _this.invoke(foldingController, foldingModel, editor, args);\r\n                    var selection = editor.getSelection();\r\n                    if (selection) {\r\n                        foldingController.reveal(selection.getStartPosition());\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    FoldingAction.prototype.getSelectedLines = function (editor) {\r\n        var selections = editor.getSelections();\r\n        return selections ? selections.map(function (s) { return s.startLineNumber; }) : [];\r\n    };\r\n    FoldingAction.prototype.getLineNumbers = function (args, editor) {\r\n        if (args && args.selectionLines) {\r\n            return args.selectionLines.map(function (l) { return l + 1; }); // to 0-bases line numbers\r\n        }\r\n        return this.getSelectedLines(editor);\r\n    };\r\n    FoldingAction.prototype.run = function (_accessor, _editor) {\r\n    };\r\n    return FoldingAction;\r\n}(EditorAction));\r\nfunction foldingArgumentsConstraint(args) {\r\n    if (!types.isUndefined(args)) {\r\n        if (!types.isObject(args)) {\r\n            return false;\r\n        }\r\n        var foldingArgs = args;\r\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!types.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nvar UnfoldAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAction, _super);\r\n    function UnfoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfold',\r\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\r\n            alias: 'Unfold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 89 /* US_CLOSE_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Unfold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Unfold editor argument',\r\n                        description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t\\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\\n\\t\\t\\t\\t\\t\\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\\n\\t\\t\\t\\t\\t\\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\\n\\t\\t\\t\\t\\t\\t\",\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                    'default': 1\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                    'default': 'down'\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAction.prototype.invoke = function (_foldingController, foldingModel, editor, args) {\r\n        var levels = args && args.levels || 1;\r\n        var lineNumbers = this.getLineNumbers(args, editor);\r\n        if (args && args.direction === 'up') {\r\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\r\n        }\r\n        else {\r\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\r\n        }\r\n    };\r\n    return UnfoldAction;\r\n}(FoldingAction));\r\nvar UnFoldRecursivelyAction = /** @class */ (function (_super) {\r\n    __extends(UnFoldRecursivelyAction, _super);\r\n    function UnFoldRecursivelyAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldRecursively',\r\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\r\n            alias: 'Unfold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnFoldRecursivelyAction.prototype.invoke = function (_foldingController, foldingModel, editor, _args) {\r\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\r\n    };\r\n    return UnFoldRecursivelyAction;\r\n}(FoldingAction));\r\nvar FoldAction = /** @class */ (function (_super) {\r\n    __extends(FoldAction, _super);\r\n    function FoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.fold',\r\n            label: nls.localize('foldAction.label', \"Fold\"),\r\n            alias: 'Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 87 /* US_OPEN_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Fold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Fold editor argument',\r\n                        description: \"Property-value pairs that can be passed through this argument:\\n\\t\\t\\t\\t\\t\\t\\t* 'levels': Number of levels to fold.\\n\\t\\t\\t\\t\\t\\t\\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\\n\\t\\t\\t\\t\\t\\t\\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\\n\\t\\t\\t\\t\\t\\t\\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\\n\\t\\t\\t\\t\\t\\t\",\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAction.prototype.invoke = function (_foldingController, foldingModel, editor, args) {\r\n        var lineNumbers = this.getLineNumbers(args, editor);\r\n        var levels = args && args.levels;\r\n        var direction = args && args.direction;\r\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\r\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\r\n            setCollapseStateUp(foldingModel, true, lineNumbers);\r\n        }\r\n        else {\r\n            if (direction === 'up') {\r\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\r\n            }\r\n            else {\r\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\r\n            }\r\n        }\r\n    };\r\n    return FoldAction;\r\n}(FoldingAction));\r\nvar ToggleFoldAction = /** @class */ (function (_super) {\r\n    __extends(ToggleFoldAction, _super);\r\n    function ToggleFoldAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.toggleFold',\r\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\r\n            alias: 'Toggle Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 42 /* KEY_L */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ToggleFoldAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        var selectedLines = this.getSelectedLines(editor);\r\n        toggleCollapseState(foldingModel, 1, selectedLines);\r\n    };\r\n    return ToggleFoldAction;\r\n}(FoldingAction));\r\nvar FoldRecursivelyAction = /** @class */ (function (_super) {\r\n    __extends(FoldRecursivelyAction, _super);\r\n    function FoldRecursivelyAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldRecursively',\r\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\r\n            alias: 'Fold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldRecursivelyAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        var selectedLines = this.getSelectedLines(editor);\r\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\r\n    };\r\n    return FoldRecursivelyAction;\r\n}(FoldingAction));\r\nvar FoldAllBlockCommentsAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllBlockCommentsAction, _super);\r\n    function FoldAllBlockCommentsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAllBlockComments',\r\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\r\n            alias: 'Fold All Block Comments',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 85 /* US_SLASH */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllBlockCommentsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var comments = LanguageConfigurationRegistry.getComments(editorModel.getLanguageIdentifier().id);\r\n            if (comments && comments.blockCommentStartToken) {\r\n                var regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    };\r\n    return FoldAllBlockCommentsAction;\r\n}(FoldingAction));\r\nvar FoldAllRegionsAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllRegionsAction, _super);\r\n    function FoldAllRegionsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAllMarkerRegions',\r\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\r\n            alias: 'Fold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 29 /* KEY_8 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllRegionsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                var regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    };\r\n    return FoldAllRegionsAction;\r\n}(FoldingAction));\r\nvar UnfoldAllRegionsAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAllRegionsAction, _super);\r\n    function UnfoldAllRegionsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldAllMarkerRegions',\r\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\r\n            alias: 'Unfold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 30 /* KEY_9 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAllRegionsAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\r\n        }\r\n        else {\r\n            var editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            var foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                var regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\r\n            }\r\n        }\r\n    };\r\n    return UnfoldAllRegionsAction;\r\n}(FoldingAction));\r\nvar FoldAllAction = /** @class */ (function (_super) {\r\n    __extends(FoldAllAction, _super);\r\n    function FoldAllAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.foldAll',\r\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\r\n            alias: 'Fold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 21 /* KEY_0 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    FoldAllAction.prototype.invoke = function (_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, true);\r\n    };\r\n    return FoldAllAction;\r\n}(FoldingAction));\r\nvar UnfoldAllAction = /** @class */ (function (_super) {\r\n    __extends(UnfoldAllAction, _super);\r\n    function UnfoldAllAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.unfoldAll',\r\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\r\n            alias: 'Unfold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 40 /* KEY_J */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    UnfoldAllAction.prototype.invoke = function (_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, false);\r\n    };\r\n    return UnfoldAllAction;\r\n}(FoldingAction));\r\nvar FoldLevelAction = /** @class */ (function (_super) {\r\n    __extends(FoldLevelAction, _super);\r\n    function FoldLevelAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FoldLevelAction.prototype.getFoldingLevel = function () {\r\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\r\n    };\r\n    FoldLevelAction.prototype.invoke = function (_foldingController, foldingModel, editor) {\r\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\r\n    };\r\n    FoldLevelAction.ID_PREFIX = 'editor.foldLevel';\r\n    FoldLevelAction.ID = function (level) { return FoldLevelAction.ID_PREFIX + level; };\r\n    return FoldLevelAction;\r\n}(FoldingAction));\r\nregisterEditorContribution(FoldingController.ID, FoldingController);\r\nregisterEditorAction(UnfoldAction);\r\nregisterEditorAction(UnFoldRecursivelyAction);\r\nregisterEditorAction(FoldAction);\r\nregisterEditorAction(FoldRecursivelyAction);\r\nregisterEditorAction(FoldAllAction);\r\nregisterEditorAction(UnfoldAllAction);\r\nregisterEditorAction(FoldAllBlockCommentsAction);\r\nregisterEditorAction(FoldAllRegionsAction);\r\nregisterEditorAction(UnfoldAllRegionsAction);\r\nregisterEditorAction(ToggleFoldAction);\r\nfor (var i = 1; i <= 7; i++) {\r\n    registerInstantiatedEditorAction(new FoldLevelAction({\r\n        id: FoldLevelAction.ID(i),\r\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\r\n        alias: \"Fold Level \" + i,\r\n        precondition: CONTEXT_FOLDING_ENABLED,\r\n        kbOpts: {\r\n            kbExpr: EditorContextKeys.editorTextFocus,\r\n            primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | (21 /* KEY_0 */ + i)),\r\n            weight: 100 /* EditorContrib */\r\n        }\r\n    }));\r\n}\r\nexport var foldBackgroundBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hc: null }, nls.localize('editorSelectionBackground', \"Color of the editor selection.\"));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var foldBackground = theme.getColor(foldBackgroundBackground);\r\n    if (foldBackground) {\r\n        collector.addRule(\".monaco-editor .folded-background { background-color: \" + foldBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorZoom } from '../../common/config/editorZoom.js';\r\nvar EditorFontZoomIn = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomIn, _super);\r\n    function EditorFontZoomIn() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomIn',\r\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\r\n            alias: 'Editor Font Zoom In',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomIn.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\r\n    };\r\n    return EditorFontZoomIn;\r\n}(EditorAction));\r\nvar EditorFontZoomOut = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomOut, _super);\r\n    function EditorFontZoomOut() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomOut',\r\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\r\n            alias: 'Editor Font Zoom Out',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomOut.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\r\n    };\r\n    return EditorFontZoomOut;\r\n}(EditorAction));\r\nvar EditorFontZoomReset = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomReset, _super);\r\n    function EditorFontZoomReset() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomReset',\r\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\r\n            alias: 'Editor Font Zoom Reset',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomReset.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(0);\r\n    };\r\n    return EditorFontZoomReset;\r\n}(EditorAction));\r\nregisterEditorAction(EditorFontZoomIn);\r\nregisterEditorAction(EditorFontZoomOut);\r\nregisterEditorAction(EditorFontZoomReset);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar FormattingEdit = /** @class */ (function () {\r\n    function FormattingEdit() {\r\n    }\r\n    FormattingEdit._handleEolEdits = function (editor, edits) {\r\n        var newEol = undefined;\r\n        var singleEdits = [];\r\n        for (var _i = 0, edits_1 = edits; _i < edits_1.length; _i++) {\r\n            var edit = edits_1[_i];\r\n            if (typeof edit.eol === 'number') {\r\n                newEol = edit.eol;\r\n            }\r\n            if (edit.range && typeof edit.text === 'string') {\r\n                singleEdits.push(edit);\r\n            }\r\n        }\r\n        if (typeof newEol === 'number') {\r\n            if (editor.hasModel()) {\r\n                editor.getModel().pushEOL(newEol);\r\n            }\r\n        }\r\n        return singleEdits;\r\n    };\r\n    FormattingEdit._isFullModelReplaceEdit = function (editor, edit) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        var model = editor.getModel();\r\n        var editRange = model.validateRange(edit.range);\r\n        var fullModelRange = model.getFullModelRange();\r\n        return fullModelRange.equalsRange(editRange);\r\n    };\r\n    FormattingEdit.execute = function (editor, _edits) {\r\n        editor.pushUndoStop();\r\n        var edits = FormattingEdit._handleEolEdits(editor, _edits);\r\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\r\n            // We use replace semantics and hope that markers stay put...\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replace(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        else {\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replaceMove(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        editor.pushUndoStop();\r\n    };\r\n    return FormattingEdit;\r\n}());\r\nexport { FormattingEdit };\r\n","/**\r\n * **!Do not construct directly!**\r\n *\r\n * **!Only static methods because it gets serialized!**\r\n *\r\n * This represents the \"canonical\" version for an extension identifier. Extension ids\r\n * have to be case-insensitive (due to the marketplace), but we must ensure case\r\n * preservation because the extension API is already public at this time.\r\n *\r\n * For example, given an extension with the publisher `\"Hello\"` and the name `\"World\"`,\r\n * its canonical extension identifier is `\"Hello.World\"`. This extension could be\r\n * referenced in some other extension's dependencies using the string `\"hello.world\"`.\r\n *\r\n * To make matters more complicated, an extension can optionally have an UUID. When two\r\n * extensions have the same UUID, they are considered equal even if their identifier is different.\r\n */\r\nvar ExtensionIdentifier = /** @class */ (function () {\r\n    function ExtensionIdentifier(value) {\r\n        this.value = value;\r\n        this._lower = value.toLowerCase();\r\n    }\r\n    /**\r\n     * Gives the value by which to index (for equality).\r\n     */\r\n    ExtensionIdentifier.toKey = function (id) {\r\n        if (typeof id === 'string') {\r\n            return id.toLowerCase();\r\n        }\r\n        return id._lower;\r\n    };\r\n    return ExtensionIdentifier;\r\n}());\r\nexport { ExtensionIdentifier };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DocumentFormattingEditProviderRegistry, DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport function alertFormattingEdits(edits) {\r\n    edits = edits.filter(function (edit) { return edit.range; });\r\n    if (!edits.length) {\r\n        return;\r\n    }\r\n    var range = edits[0].range;\r\n    for (var i = 1; i < edits.length; i++) {\r\n        range = Range.plusRange(range, edits[i].range);\r\n    }\r\n    var startLineNumber = range.startLineNumber, endLineNumber = range.endLineNumber;\r\n    if (startLineNumber === endLineNumber) {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\r\n        }\r\n    }\r\n    else {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\r\n        }\r\n    }\r\n}\r\nexport function getRealAndSyntheticDocumentFormattersOrdered(model) {\r\n    var result = [];\r\n    var seen = new Set();\r\n    // (1) add all document formatter\r\n    var docFormatter = DocumentFormattingEditProviderRegistry.ordered(model);\r\n    for (var _i = 0, docFormatter_1 = docFormatter; _i < docFormatter_1.length; _i++) {\r\n        var formatter = docFormatter_1[_i];\r\n        result.push(formatter);\r\n        if (formatter.extensionId) {\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n    }\r\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\r\n    var rangeFormatter = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n    var _loop_1 = function (formatter) {\r\n        if (formatter.extensionId) {\r\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\r\n                return \"continue\";\r\n            }\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n        result.push({\r\n            displayName: formatter.displayName,\r\n            extensionId: formatter.extensionId,\r\n            provideDocumentFormattingEdits: function (model, options, token) {\r\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\r\n            }\r\n        });\r\n    };\r\n    for (var _a = 0, rangeFormatter_1 = rangeFormatter; _a < rangeFormatter_1.length; _a++) {\r\n        var formatter = rangeFormatter_1[_a];\r\n        _loop_1(formatter);\r\n    }\r\n    return result;\r\n}\r\nvar FormattingConflicts = /** @class */ (function () {\r\n    function FormattingConflicts() {\r\n    }\r\n    FormattingConflicts.select = function (formatter, document, mode) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var selector;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (formatter.length === 0) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selector = FormattingConflicts._selectors.iterator().next().value;\r\n                        if (!selector) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, selector(formatter, document, mode)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/, formatter[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FormattingConflicts._selectors = new LinkedList();\r\n    return FormattingConflicts;\r\n}());\r\nexport { FormattingConflicts };\r\nexport function formatDocumentRangeWithSelectedProvider(accessor, editorOrModel, range, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithProvider, selected, editorOrModel, range, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentRangeWithProvider(accessor, provider, editorOrModel, range, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range_1, initialSelection_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        alertFormattingEdits(edits);\r\n                        editorOrModel.pushUndoStop();\r\n                        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                    }\r\n                    else {\r\n                        range_1 = edits[0].range;\r\n                        initialSelection_1 = new Selection(range_1.startLineNumber, range_1.startColumn, range_1.endLineNumber, range_1.endColumn);\r\n                        model.pushEditOperations([initialSelection_1], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_1 = undoEdits; _i < undoEdits_1.length; _i++) {\r\n                                var range_2 = undoEdits_1[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_2, initialSelection_1)) {\r\n                                    return [new Selection(range_2.startLineNumber, range_2.startColumn, range_2.endLineNumber, range_2.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range, initialSelection_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        if (mode !== 2 /* Silent */) {\r\n                            alertFormattingEdits(edits);\r\n                            editorOrModel.pushUndoStop();\r\n                            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                        }\r\n                    }\r\n                    else {\r\n                        range = edits[0].range;\r\n                        initialSelection_2 = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n                        model.pushEditOperations([initialSelection_2], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_2 = undoEdits; _i < undoEdits_2.length; _i++) {\r\n                                var range_3 = undoEdits_2[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_3, initialSelection_2)) {\r\n                                    return [new Selection(range_3.startLineNumber, range_3.startColumn, range_3.endLineNumber, range_3.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, model, range, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_1, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    _i = 0, providers_1 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_1.length)) return [3 /*break*/, 5];\r\n                    provider = providers_1[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentFormattingEditsUntilResult(workerService, model, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_2, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    _i = 0, providers_2 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_2.length)) return [3 /*break*/, 5];\r\n                    provider = providers_2[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getOnTypeFormattingEdits(workerService, model, position, ch, options) {\r\n    var providers = OnTypeFormattingEditProviderRegistry.ordered(model);\r\n    if (providers.length === 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, CancellationToken.None)).catch(onUnexpectedExternalError).then(function (edits) {\r\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], range = args[1], options = args[2];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Range.isIRange(range));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentRangeFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, Range.lift(range), options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], options = args[1];\r\n    assertType(URI.isUri(resource));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], position = args[1], ch = args[2], options = args[3];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Position.isIPosition(position));\r\n    assertType(typeof ch === 'string');\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getOnTypeFormattingEdits(accessor.get(IEditorWorkerService), model, Position.lift(position), ch, options);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { getOnTypeFormattingEdits, alertFormattingEdits, formatDocumentRangeWithSelectedProvider, formatDocumentWithSelectedProvider } from './format.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar FormatOnType = /** @class */ (function () {\r\n    function FormatOnType(editor, _workerService) {\r\n        var _this = this;\r\n        this._workerService = _workerService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._editor = editor;\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(OnTypeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnType.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnType.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this._editor.getOption(39 /* formatOnType */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        // no support\r\n        var support = OnTypeFormattingEditProviderRegistry.ordered(model)[0];\r\n        if (!support || !support.autoFormatTriggerCharacters) {\r\n            return;\r\n        }\r\n        // register typing listeners that will trigger the format\r\n        var triggerChars = new CharacterSet();\r\n        for (var _i = 0, _a = support.autoFormatTriggerCharacters; _i < _a.length; _i++) {\r\n            var ch = _a[_i];\r\n            triggerChars.add(ch.charCodeAt(0));\r\n        }\r\n        this._callOnModel.add(this._editor.onDidType(function (text) {\r\n            var lastCharCode = text.charCodeAt(text.length - 1);\r\n            if (triggerChars.has(lastCharCode)) {\r\n                _this._trigger(String.fromCharCode(lastCharCode));\r\n            }\r\n        }));\r\n    };\r\n    FormatOnType.prototype._trigger = function (ch) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var position = this._editor.getPosition();\r\n        var canceled = false;\r\n        // install a listener that checks if edits happens before the\r\n        // position on which we format right now. If so, we won't\r\n        // apply the format edits\r\n        var unbind = this._editor.onDidChangeModelContent(function (e) {\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                // cancel only once\r\n                canceled = true;\r\n                unbind.dispose();\r\n                return;\r\n            }\r\n            for (var i = 0, len = e.changes.length; i < len; i++) {\r\n                var change = e.changes[i];\r\n                if (change.range.endLineNumber <= position.lineNumber) {\r\n                    // cancel only once\r\n                    canceled = true;\r\n                    unbind.dispose();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        getOnTypeFormattingEdits(this._workerService, model, position, ch, model.getFormattingOptions()).then(function (edits) {\r\n            unbind.dispose();\r\n            if (canceled) {\r\n                return;\r\n            }\r\n            if (isNonEmptyArray(edits)) {\r\n                FormattingEdit.execute(_this._editor, edits);\r\n                alertFormattingEdits(edits);\r\n            }\r\n        }, function (err) {\r\n            unbind.dispose();\r\n            throw err;\r\n        });\r\n    };\r\n    FormatOnType.ID = 'editor.contrib.autoFormat';\r\n    FormatOnType = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], FormatOnType);\r\n    return FormatOnType;\r\n}());\r\nvar FormatOnPaste = /** @class */ (function () {\r\n    function FormatOnPaste(editor, _instantiationService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._instantiationService = _instantiationService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(DocumentRangeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnPaste.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnPaste.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this.editor.getOption(38 /* formatOnPaste */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        // no formatter\r\n        if (!DocumentRangeFormattingEditProviderRegistry.has(this.editor.getModel())) {\r\n            return;\r\n        }\r\n        this._callOnModel.add(this.editor.onDidPaste(function (_a) {\r\n            var range = _a.range;\r\n            return _this._trigger(range);\r\n        }));\r\n    };\r\n    FormatOnPaste.prototype._trigger = function (range) {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this.editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        this._instantiationService.invokeFunction(formatDocumentRangeWithSelectedProvider, this.editor, range, 2 /* Silent */, CancellationToken.None).catch(onUnexpectedError);\r\n    };\r\n    FormatOnPaste.ID = 'editor.contrib.formatOnPaste';\r\n    FormatOnPaste = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], FormatOnPaste);\r\n    return FormatOnPaste;\r\n}());\r\nvar FormatDocumentAction = /** @class */ (function (_super) {\r\n    __extends(FormatDocumentAction, _super);\r\n    function FormatDocumentAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatDocument',\r\n            label: nls.localize('formatDocument.label', \"Format Document\"),\r\n            alias: 'Format Document',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentFormattingProvider),\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 36 /* KEY_F */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 39 /* KEY_I */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: EditorContextKeys.hasDocumentFormattingProvider,\r\n                group: '1_modification',\r\n                order: 1.3\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatDocumentAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) return [3 /*break*/, 2];\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatDocumentAction;\r\n}(EditorAction));\r\nvar FormatSelectionAction = /** @class */ (function (_super) {\r\n    __extends(FormatSelectionAction, _super);\r\n    function FormatSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatSelection',\r\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\r\n            alias: 'Format Selection',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 36 /* KEY_F */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: ContextKeyExpr.and(EditorContextKeys.hasDocumentSelectionFormattingProvider, EditorContextKeys.hasNonEmptySelection),\r\n                group: '1_modification',\r\n                order: 1.31\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatSelectionAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService, model, range;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        model = editor.getModel();\r\n                        range = editor.getSelection();\r\n                        if (range.isEmpty()) {\r\n                            range = new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber));\r\n                        }\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithSelectedProvider, editor, range, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatSelectionAction;\r\n}(EditorAction));\r\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\r\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\r\nregisterEditorAction(FormatDocumentAction);\r\nregisterEditorAction(FormatSelectionAction);\r\n// this is the old format action that does both (format document OR format selection)\r\n// and we keep it here such that existing keybinding configurations etc will still work\r\nCommandsRegistry.registerCommand('editor.action.format', function (accessor) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var editor, commandService;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n                if (!editor || !editor.hasModel()) {\r\n                    return [2 /*return*/];\r\n                }\r\n                commandService = accessor.get(ICommandService);\r\n                if (!editor.getSelection().isEmpty()) return [3 /*break*/, 2];\r\n                return [4 /*yield*/, commandService.executeCommand('editor.action.formatDocument')];\r\n            case 1:\r\n                _a.sent();\r\n                return [3 /*break*/, 4];\r\n            case 2: return [4 /*yield*/, commandService.executeCommand('editor.action.formatSelection')];\r\n            case 3:\r\n                _a.sent();\r\n                _a.label = 4;\r\n            case 4: return [2 /*return*/];\r\n        }\r\n    });\r\n}); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/peekViewWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { ZoneWidget } from '../zoneWidget/zoneWidget.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { registerColor, contrastBorder, activeContrastBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var IPeekViewService = createDecorator('IPeekViewService');\r\nregisterSingleton(IPeekViewService, /** @class */ (function () {\r\n    function class_1() {\r\n        this._widgets = new Map();\r\n    }\r\n    class_1.prototype.addExclusiveWidget = function (editor, widget) {\r\n        var _this = this;\r\n        var existing = this._widgets.get(editor);\r\n        if (existing) {\r\n            existing.listener.dispose();\r\n            existing.widget.dispose();\r\n        }\r\n        var remove = function () {\r\n            var data = _this._widgets.get(editor);\r\n            if (data && data.widget === widget) {\r\n                data.listener.dispose();\r\n                _this._widgets.delete(editor);\r\n            }\r\n        };\r\n        this._widgets.set(editor, { widget: widget, listener: widget.onDidClose(remove) });\r\n    };\r\n    return class_1;\r\n}()));\r\nexport var PeekContext;\r\n(function (PeekContext) {\r\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true);\r\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\r\n})(PeekContext || (PeekContext = {}));\r\nvar PeekContextController = /** @class */ (function () {\r\n    function PeekContextController(editor, contextKeyService) {\r\n        if (editor instanceof EmbeddedCodeEditorWidget) {\r\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\r\n        }\r\n    }\r\n    PeekContextController.prototype.dispose = function () { };\r\n    PeekContextController.ID = 'editor.contrib.referenceController';\r\n    PeekContextController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], PeekContextController);\r\n    return PeekContextController;\r\n}());\r\nregisterEditorContribution(PeekContextController.ID, PeekContextController);\r\nexport function getOuterEditor(accessor) {\r\n    var editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n    if (editor instanceof EmbeddedCodeEditorWidget) {\r\n        return editor.getParentEditor();\r\n    }\r\n    return editor;\r\n}\r\nvar defaultOptions = {\r\n    headerBackgroundColor: Color.white,\r\n    primaryHeadingColor: Color.fromHex('#333333'),\r\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\r\n};\r\nvar PeekViewWidget = /** @class */ (function (_super) {\r\n    __extends(PeekViewWidget, _super);\r\n    function PeekViewWidget(editor, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, editor, options) || this;\r\n        _this._onDidClose = new Emitter();\r\n        _this.onDidClose = _this._onDidClose.event;\r\n        objects.mixin(_this.options, defaultOptions, false);\r\n        return _this;\r\n    }\r\n    PeekViewWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._onDidClose.fire(this);\r\n    };\r\n    PeekViewWidget.prototype.style = function (styles) {\r\n        var options = this.options;\r\n        if (styles.headerBackgroundColor) {\r\n            options.headerBackgroundColor = styles.headerBackgroundColor;\r\n        }\r\n        if (styles.primaryHeadingColor) {\r\n            options.primaryHeadingColor = styles.primaryHeadingColor;\r\n        }\r\n        if (styles.secondaryHeadingColor) {\r\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\r\n        }\r\n        _super.prototype.style.call(this, styles);\r\n    };\r\n    PeekViewWidget.prototype._applyStyles = function () {\r\n        _super.prototype._applyStyles.call(this);\r\n        var options = this.options;\r\n        if (this._headElement && options.headerBackgroundColor) {\r\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\r\n        }\r\n        if (this._primaryHeading && options.primaryHeadingColor) {\r\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\r\n        }\r\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\r\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\r\n        }\r\n        if (this._bodyElement && options.frameColor) {\r\n            this._bodyElement.style.borderColor = options.frameColor.toString();\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._fillContainer = function (container) {\r\n        this.setCssClass('peekview-widget');\r\n        this._headElement = dom.$('.head');\r\n        this._bodyElement = dom.$('.body');\r\n        this._fillHead(this._headElement);\r\n        this._fillBody(this._bodyElement);\r\n        container.appendChild(this._headElement);\r\n        container.appendChild(this._bodyElement);\r\n    };\r\n    PeekViewWidget.prototype._fillHead = function (container) {\r\n        var _this = this;\r\n        var titleElement = dom.$('.peekview-title');\r\n        dom.append(this._headElement, titleElement);\r\n        dom.addStandardDisposableListener(titleElement, 'click', function (event) { return _this._onTitleClick(event); });\r\n        this._fillTitleIcon(titleElement);\r\n        this._primaryHeading = dom.$('span.filename');\r\n        this._secondaryHeading = dom.$('span.dirname');\r\n        this._metaHeading = dom.$('span.meta');\r\n        dom.append(titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\r\n        var actionsContainer = dom.$('.peekview-actions');\r\n        dom.append(this._headElement, actionsContainer);\r\n        var actionBarOptions = this._getActionBarOptions();\r\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\r\n        this._disposables.add(this._actionbarWidget);\r\n        this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), 'codicon-close', true, function () {\r\n            _this.dispose();\r\n            return Promise.resolve();\r\n        }), { label: false, icon: true });\r\n    };\r\n    PeekViewWidget.prototype._fillTitleIcon = function (container) {\r\n    };\r\n    PeekViewWidget.prototype._getActionBarOptions = function () {\r\n        return {};\r\n    };\r\n    PeekViewWidget.prototype._onTitleClick = function (event) {\r\n        // implement me\r\n    };\r\n    PeekViewWidget.prototype.setTitle = function (primaryHeading, secondaryHeading) {\r\n        if (this._primaryHeading && this._secondaryHeading) {\r\n            this._primaryHeading.innerHTML = strings.escape(primaryHeading);\r\n            this._primaryHeading.setAttribute('aria-label', primaryHeading);\r\n            if (secondaryHeading) {\r\n                this._secondaryHeading.innerHTML = strings.escape(secondaryHeading);\r\n            }\r\n            else {\r\n                dom.clearNode(this._secondaryHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype.setMetaTitle = function (value) {\r\n        if (this._metaHeading) {\r\n            if (value) {\r\n                this._metaHeading.innerHTML = strings.escape(value);\r\n                dom.show(this._metaHeading);\r\n            }\r\n            else {\r\n                dom.hide(this._metaHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\r\n        if (!this._isShowing && heightInPixel < 0) {\r\n            // Looks like the view zone got folded away!\r\n            this.dispose();\r\n            return;\r\n        }\r\n        var headHeight = Math.ceil(this.editor.getOption(49 /* lineHeight */) * 1.2);\r\n        var bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\r\n        this._doLayoutHead(headHeight, widthInPixel);\r\n        this._doLayoutBody(bodyHeight, widthInPixel);\r\n    };\r\n    PeekViewWidget.prototype._doLayoutHead = function (heightInPixel, widthInPixel) {\r\n        if (this._headElement) {\r\n            this._headElement.style.height = heightInPixel + \"px\";\r\n            this._headElement.style.lineHeight = this._headElement.style.height;\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        if (this._bodyElement) {\r\n            this._bodyElement.style.height = heightInPixel + \"px\";\r\n        }\r\n    };\r\n    return PeekViewWidget;\r\n}(ZoneWidget));\r\nexport { PeekViewWidget };\r\nexport var peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#1E1E1E', light: '#FFFFFF', hc: '#0C141F' }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\r\nexport var peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: '#FFFFFF', light: '#333333', hc: '#FFFFFF' }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\r\nexport var peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161e6', hc: '#FFFFFF99' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\r\nexport var peekViewBorder = registerColor('peekView.border', { dark: '#007acc', light: '#007acc', hc: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\r\nexport var peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hc: Color.black }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\r\nexport var peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hc: Color.white }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\r\nexport var peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hc: Color.white }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\r\nexport var peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hc: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\r\nexport var peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hc: Color.white }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\r\nexport var peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hc: Color.black }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\r\nexport var peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hc: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\r\nexport var peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hc: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\r\nexport var peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hc: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\r\nexport var peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { CodeEditorWidget } from './codeEditorWidget.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nvar EmbeddedCodeEditorWidget = /** @class */ (function (_super) {\r\n    __extends(EmbeddedCodeEditorWidget, _super);\r\n    function EmbeddedCodeEditorWidget(domElement, options, parentEditor, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\r\n        var _this = _super.call(this, domElement, parentEditor.getRawOptions(), {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) || this;\r\n        _this._parentEditor = parentEditor;\r\n        _this._overwriteOptions = options;\r\n        // Overwrite parent's options\r\n        _super.prototype.updateOptions.call(_this, _this._overwriteOptions);\r\n        _this._register(parentEditor.onDidChangeConfiguration(function (e) { return _this._onParentConfigurationChanged(e); }));\r\n        return _this;\r\n    }\r\n    EmbeddedCodeEditorWidget.prototype.getParentEditor = function () {\r\n        return this._parentEditor;\r\n    };\r\n    EmbeddedCodeEditorWidget.prototype._onParentConfigurationChanged = function (e) {\r\n        _super.prototype.updateOptions.call(this, this._parentEditor.getRawOptions());\r\n        _super.prototype.updateOptions.call(this, this._overwriteOptions);\r\n    };\r\n    EmbeddedCodeEditorWidget.prototype.updateOptions = function (newOptions) {\r\n        objects.mixin(this._overwriteOptions, newOptions, true);\r\n        _super.prototype.updateOptions.call(this, this._overwriteOptions);\r\n    };\r\n    EmbeddedCodeEditorWidget = __decorate([\r\n        __param(3, IInstantiationService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, ICommandService),\r\n        __param(6, IContextKeyService),\r\n        __param(7, IThemeService),\r\n        __param(8, INotificationService),\r\n        __param(9, IAccessibilityService)\r\n    ], EmbeddedCodeEditorWidget);\r\n    return EmbeddedCodeEditorWidget;\r\n}(CodeEditorWidget));\r\nexport { EmbeddedCodeEditorWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar IdGenerator = /** @class */ (function () {\r\n    function IdGenerator(prefix) {\r\n        this._prefix = prefix;\r\n        this._lastId = 0;\r\n    }\r\n    IdGenerator.prototype.nextId = function () {\r\n        return this._prefix + (++this._lastId);\r\n    };\r\n    return IdGenerator;\r\n}());\r\nexport { IdGenerator };\r\nexport var defaultGenerator = new IdGenerator('id#');\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './zoneWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { IdGenerator } from '../../../base/common/idGenerator.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nvar defaultColor = new Color(new RGBA(0, 122, 204));\r\nvar defaultOptions = {\r\n    showArrow: true,\r\n    showFrame: true,\r\n    className: '',\r\n    frameColor: defaultColor,\r\n    arrowColor: defaultColor,\r\n    keepEditorSelection: false\r\n};\r\nvar WIDGET_ID = 'vs.editor.contrib.zoneWidget';\r\nvar ViewZoneDelegate = /** @class */ (function () {\r\n    function ViewZoneDelegate(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight) {\r\n        this.id = ''; // A valid zone id should be greater than 0\r\n        this.domNode = domNode;\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.afterColumn = afterColumn;\r\n        this.heightInLines = heightInLines;\r\n        this._onDomNodeTop = onDomNodeTop;\r\n        this._onComputedHeight = onComputedHeight;\r\n    }\r\n    ViewZoneDelegate.prototype.onDomNodeTop = function (top) {\r\n        this._onDomNodeTop(top);\r\n    };\r\n    ViewZoneDelegate.prototype.onComputedHeight = function (height) {\r\n        this._onComputedHeight(height);\r\n    };\r\n    return ViewZoneDelegate;\r\n}());\r\nexport { ViewZoneDelegate };\r\nvar OverlayWidgetDelegate = /** @class */ (function () {\r\n    function OverlayWidgetDelegate(id, domNode) {\r\n        this._id = id;\r\n        this._domNode = domNode;\r\n    }\r\n    OverlayWidgetDelegate.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    OverlayWidgetDelegate.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    OverlayWidgetDelegate.prototype.getPosition = function () {\r\n        return null;\r\n    };\r\n    return OverlayWidgetDelegate;\r\n}());\r\nexport { OverlayWidgetDelegate };\r\nvar Arrow = /** @class */ (function () {\r\n    function Arrow(_editor) {\r\n        this._editor = _editor;\r\n        this._ruleName = Arrow._IdGenerator.nextId();\r\n        this._decorations = [];\r\n        this._color = null;\r\n        this._height = -1;\r\n        //\r\n    }\r\n    Arrow.prototype.dispose = function () {\r\n        this.hide();\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n    };\r\n    Object.defineProperty(Arrow.prototype, \"color\", {\r\n        set: function (value) {\r\n            if (this._color !== value) {\r\n                this._color = value;\r\n                this._updateStyle();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Arrow.prototype, \"height\", {\r\n        set: function (value) {\r\n            if (this._height !== value) {\r\n                this._height = value;\r\n                this._updateStyle();\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Arrow.prototype._updateStyle = function () {\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n        dom.createCSSRule(\".monaco-editor \" + this._ruleName, \"border-style: solid; border-color: transparent; border-bottom-color: \" + this._color + \"; border-width: \" + this._height + \"px; bottom: -\" + this._height + \"px; margin-left: -\" + this._height + \"px; \");\r\n    };\r\n    Arrow.prototype.show = function (where) {\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, [{ range: Range.fromPositions(where), options: { className: this._ruleName, stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ } }]);\r\n    };\r\n    Arrow.prototype.hide = function () {\r\n        this._editor.deltaDecorations(this._decorations, []);\r\n    };\r\n    Arrow._IdGenerator = new IdGenerator('.arrow-decoration-');\r\n    return Arrow;\r\n}());\r\nvar ZoneWidget = /** @class */ (function () {\r\n    function ZoneWidget(editor, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        this._arrow = null;\r\n        this._overlayWidget = null;\r\n        this._resizeSash = null;\r\n        this._positionMarkerId = [];\r\n        this._viewZone = null;\r\n        this._disposables = new DisposableStore();\r\n        this.container = null;\r\n        this._isShowing = false;\r\n        this.editor = editor;\r\n        this.options = objects.deepClone(options);\r\n        objects.mixin(this.options, defaultOptions, false);\r\n        this.domNode = document.createElement('div');\r\n        if (!this.options.isAccessible) {\r\n            this.domNode.setAttribute('aria-hidden', 'true');\r\n            this.domNode.setAttribute('role', 'presentation');\r\n        }\r\n        this._disposables.add(this.editor.onDidLayoutChange(function (info) {\r\n            var width = _this._getWidth(info);\r\n            _this.domNode.style.width = width + 'px';\r\n            _this.domNode.style.left = _this._getLeft(info) + 'px';\r\n            _this._onWidth(width);\r\n        }));\r\n    }\r\n    ZoneWidget.prototype.dispose = function () {\r\n        var _this = this;\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    accessor.removeZone(_this._viewZone.id);\r\n                }\r\n                _this._viewZone = null;\r\n            });\r\n        }\r\n        this.editor.deltaDecorations(this._positionMarkerId, []);\r\n        this._positionMarkerId = [];\r\n        this._disposables.dispose();\r\n    };\r\n    ZoneWidget.prototype.create = function () {\r\n        dom.addClass(this.domNode, 'zone-widget');\r\n        if (this.options.className) {\r\n            dom.addClass(this.domNode, this.options.className);\r\n        }\r\n        this.container = document.createElement('div');\r\n        dom.addClass(this.container, 'zone-widget-container');\r\n        this.domNode.appendChild(this.container);\r\n        if (this.options.showArrow) {\r\n            this._arrow = new Arrow(this.editor);\r\n            this._disposables.add(this._arrow);\r\n        }\r\n        this._fillContainer(this.container);\r\n        this._initSash();\r\n        this._applyStyles();\r\n    };\r\n    ZoneWidget.prototype.style = function (styles) {\r\n        if (styles.frameColor) {\r\n            this.options.frameColor = styles.frameColor;\r\n        }\r\n        if (styles.arrowColor) {\r\n            this.options.arrowColor = styles.arrowColor;\r\n        }\r\n        this._applyStyles();\r\n    };\r\n    ZoneWidget.prototype._applyStyles = function () {\r\n        if (this.container && this.options.frameColor) {\r\n            var frameColor = this.options.frameColor.toString();\r\n            this.container.style.borderTopColor = frameColor;\r\n            this.container.style.borderBottomColor = frameColor;\r\n        }\r\n        if (this._arrow && this.options.arrowColor) {\r\n            var arrowColor = this.options.arrowColor.toString();\r\n            this._arrow.color = arrowColor;\r\n        }\r\n    };\r\n    ZoneWidget.prototype._getWidth = function (info) {\r\n        return info.width - info.minimapWidth - info.verticalScrollbarWidth;\r\n    };\r\n    ZoneWidget.prototype._getLeft = function (info) {\r\n        // If minimap is to the left, we move beyond it\r\n        if (info.minimapWidth > 0 && info.minimapLeft === 0) {\r\n            return info.minimapWidth;\r\n        }\r\n        return 0;\r\n    };\r\n    ZoneWidget.prototype._onViewZoneTop = function (top) {\r\n        this.domNode.style.top = top + 'px';\r\n    };\r\n    ZoneWidget.prototype._onViewZoneHeight = function (height) {\r\n        this.domNode.style.height = height + \"px\";\r\n        if (this.container) {\r\n            var containerHeight = height - this._decoratingElementsHeight();\r\n            this.container.style.height = containerHeight + \"px\";\r\n            var layoutInfo = this.editor.getLayoutInfo();\r\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\r\n        }\r\n        if (this._resizeSash) {\r\n            this._resizeSash.layout();\r\n        }\r\n    };\r\n    Object.defineProperty(ZoneWidget.prototype, \"position\", {\r\n        get: function () {\r\n            var id = this._positionMarkerId[0];\r\n            if (!id) {\r\n                return undefined;\r\n            }\r\n            var model = this.editor.getModel();\r\n            if (!model) {\r\n                return undefined;\r\n            }\r\n            var range = model.getDecorationRange(id);\r\n            if (!range) {\r\n                return undefined;\r\n            }\r\n            return range.getStartPosition();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ZoneWidget.prototype.show = function (rangeOrPos, heightInLines) {\r\n        var range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\r\n        this._isShowing = true;\r\n        this._showImpl(range, heightInLines);\r\n        this._isShowing = false;\r\n        this._positionMarkerId = this.editor.deltaDecorations(this._positionMarkerId, [{ range: range, options: ModelDecorationOptions.EMPTY }]);\r\n    };\r\n    ZoneWidget.prototype.hide = function () {\r\n        var _this = this;\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    accessor.removeZone(_this._viewZone.id);\r\n                }\r\n            });\r\n            this._viewZone = null;\r\n        }\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._arrow) {\r\n            this._arrow.hide();\r\n        }\r\n    };\r\n    ZoneWidget.prototype._decoratingElementsHeight = function () {\r\n        var lineHeight = this.editor.getOption(49 /* lineHeight */);\r\n        var result = 0;\r\n        if (this.options.showArrow) {\r\n            var arrowHeight = Math.round(lineHeight / 3);\r\n            result += 2 * arrowHeight;\r\n        }\r\n        if (this.options.showFrame) {\r\n            var frameThickness = Math.round(lineHeight / 9);\r\n            result += 2 * frameThickness;\r\n        }\r\n        return result;\r\n    };\r\n    ZoneWidget.prototype._showImpl = function (where, heightInLines) {\r\n        var _this = this;\r\n        var position = where.getStartPosition();\r\n        var layoutInfo = this.editor.getLayoutInfo();\r\n        var width = this._getWidth(layoutInfo);\r\n        this.domNode.style.width = width + \"px\";\r\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\r\n        // Render the widget as zone (rendering) and widget (lifecycle)\r\n        var viewZoneDomNode = document.createElement('div');\r\n        viewZoneDomNode.style.overflow = 'hidden';\r\n        var lineHeight = this.editor.getOption(49 /* lineHeight */);\r\n        // adjust heightInLines to viewport\r\n        var maxHeightInLines = (this.editor.getLayoutInfo().height / lineHeight) * 0.8;\r\n        if (heightInLines >= maxHeightInLines) {\r\n            heightInLines = maxHeightInLines;\r\n        }\r\n        var arrowHeight = 0;\r\n        var frameThickness = 0;\r\n        // Render the arrow one 1/3 of an editor line height\r\n        if (this._arrow && this.options.showArrow) {\r\n            arrowHeight = Math.round(lineHeight / 3);\r\n            this._arrow.height = arrowHeight;\r\n            this._arrow.show(position);\r\n        }\r\n        // Render the frame as 1/9 of an editor line height\r\n        if (this.options.showFrame) {\r\n            frameThickness = Math.round(lineHeight / 9);\r\n        }\r\n        // insert zone widget\r\n        this.editor.changeViewZones(function (accessor) {\r\n            if (_this._viewZone) {\r\n                accessor.removeZone(_this._viewZone.id);\r\n            }\r\n            if (_this._overlayWidget) {\r\n                _this.editor.removeOverlayWidget(_this._overlayWidget);\r\n                _this._overlayWidget = null;\r\n            }\r\n            _this.domNode.style.top = '-1000px';\r\n            _this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, function (top) { return _this._onViewZoneTop(top); }, function (height) { return _this._onViewZoneHeight(height); });\r\n            _this._viewZone.id = accessor.addZone(_this._viewZone);\r\n            _this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + _this._viewZone.id, _this.domNode);\r\n            _this.editor.addOverlayWidget(_this._overlayWidget);\r\n        });\r\n        if (this.container && this.options.showFrame) {\r\n            var width_1 = this.options.frameWidth ? this.options.frameWidth : frameThickness;\r\n            this.container.style.borderTopWidth = width_1 + 'px';\r\n            this.container.style.borderBottomWidth = width_1 + 'px';\r\n        }\r\n        var containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\r\n        if (this.container) {\r\n            this.container.style.top = arrowHeight + 'px';\r\n            this.container.style.height = containerHeight + 'px';\r\n            this.container.style.overflow = 'hidden';\r\n        }\r\n        this._doLayout(containerHeight, width);\r\n        if (!this.options.keepEditorSelection) {\r\n            this.editor.setSelection(where);\r\n        }\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var revealLine = where.endLineNumber + 1;\r\n            if (revealLine <= model.getLineCount()) {\r\n                // reveal line below the zone widget\r\n                this.revealLine(revealLine, false);\r\n            }\r\n            else {\r\n                // reveal last line atop\r\n                this.revealLine(model.getLineCount(), true);\r\n            }\r\n        }\r\n    };\r\n    ZoneWidget.prototype.revealLine = function (lineNumber, isLastLine) {\r\n        if (isLastLine) {\r\n            this.editor.revealLineInCenter(lineNumber, 0 /* Smooth */);\r\n        }\r\n        else {\r\n            this.editor.revealLine(lineNumber, 0 /* Smooth */);\r\n        }\r\n    };\r\n    ZoneWidget.prototype.setCssClass = function (className, classToReplace) {\r\n        if (!this.container) {\r\n            return;\r\n        }\r\n        if (classToReplace) {\r\n            this.container.classList.remove(classToReplace);\r\n        }\r\n        dom.addClass(this.container, className);\r\n    };\r\n    ZoneWidget.prototype._onWidth = function (widthInPixel) {\r\n        // implement in subclass\r\n    };\r\n    ZoneWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\r\n        // implement in subclass\r\n    };\r\n    ZoneWidget.prototype._relayout = function (newHeightInLines) {\r\n        var _this = this;\r\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\r\n            this.editor.changeViewZones(function (accessor) {\r\n                if (_this._viewZone) {\r\n                    _this._viewZone.heightInLines = newHeightInLines;\r\n                    accessor.layoutZone(_this._viewZone.id);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    // --- sash\r\n    ZoneWidget.prototype._initSash = function () {\r\n        var _this = this;\r\n        if (this._resizeSash) {\r\n            return;\r\n        }\r\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* HORIZONTAL */ }));\r\n        if (!this.options.isResizeable) {\r\n            this._resizeSash.hide();\r\n            this._resizeSash.state = 0 /* Disabled */;\r\n        }\r\n        var data;\r\n        this._disposables.add(this._resizeSash.onDidStart(function (e) {\r\n            if (_this._viewZone) {\r\n                data = {\r\n                    startY: e.startY,\r\n                    heightInLines: _this._viewZone.heightInLines,\r\n                };\r\n            }\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidEnd(function () {\r\n            data = undefined;\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidChange(function (evt) {\r\n            if (data) {\r\n                var lineDelta = (evt.currentY - data.startY) / _this.editor.getOption(49 /* lineHeight */);\r\n                var roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\r\n                var newHeightInLines = data.heightInLines + roundedLineDelta;\r\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\r\n                    _this._relayout(newHeightInLines);\r\n                }\r\n            }\r\n        }));\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashLeft = function () {\r\n        return 0;\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashTop = function () {\r\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\r\n    };\r\n    ZoneWidget.prototype.getHorizontalSashWidth = function () {\r\n        var layoutInfo = this.editor.getLayoutInfo();\r\n        return layoutInfo.width - layoutInfo.minimapWidth;\r\n    };\r\n    return ZoneWidget;\r\n}());\r\nexport { ZoneWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { localize } from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { defaultGenerator } from '../../../base/common/idGenerator.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar OneReference = /** @class */ (function () {\r\n    function OneReference(isProviderFirst, parent, _range, _rangeCallback) {\r\n        this.isProviderFirst = isProviderFirst;\r\n        this.parent = parent;\r\n        this._range = _range;\r\n        this._rangeCallback = _rangeCallback;\r\n        this.id = defaultGenerator.nextId();\r\n    }\r\n    Object.defineProperty(OneReference.prototype, \"uri\", {\r\n        get: function () {\r\n            return this.parent.uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"range\", {\r\n        get: function () {\r\n            return this._range;\r\n        },\r\n        set: function (value) {\r\n            this._range = value;\r\n            this._rangeCallback(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return OneReference;\r\n}());\r\nexport { OneReference };\r\nvar FilePreview = /** @class */ (function () {\r\n    function FilePreview(_modelReference) {\r\n        this._modelReference = _modelReference;\r\n    }\r\n    FilePreview.prototype.dispose = function () {\r\n        this._modelReference.dispose();\r\n    };\r\n    FilePreview.prototype.preview = function (range, n) {\r\n        if (n === void 0) { n = 8; }\r\n        var model = this._modelReference.object.textEditorModel;\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        var startLineNumber = range.startLineNumber, startColumn = range.startColumn, endLineNumber = range.endLineNumber, endColumn = range.endColumn;\r\n        var word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\r\n        var beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\r\n        var afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\r\n        var inside = model.getValueInRange(range);\r\n        var after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\r\n        return {\r\n            value: before + inside + after,\r\n            highlight: { start: before.length, end: before.length + inside.length }\r\n        };\r\n    };\r\n    return FilePreview;\r\n}());\r\nexport { FilePreview };\r\nvar FileReferences = /** @class */ (function () {\r\n    function FileReferences(parent, uri) {\r\n        this.parent = parent;\r\n        this.uri = uri;\r\n        this.children = [];\r\n    }\r\n    FileReferences.prototype.dispose = function () {\r\n        dispose(this._preview);\r\n        this._preview = undefined;\r\n    };\r\n    Object.defineProperty(FileReferences.prototype, \"preview\", {\r\n        get: function () {\r\n            return this._preview;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"failure\", {\r\n        get: function () {\r\n            return this._loadFailure;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            var len = this.children.length;\r\n            if (len === 1) {\r\n                return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FileReferences.prototype.resolve = function (textModelResolverService) {\r\n        var _this = this;\r\n        if (this._resolved) {\r\n            return Promise.resolve(this);\r\n        }\r\n        return Promise.resolve(textModelResolverService.createModelReference(this.uri).then(function (modelReference) {\r\n            var model = modelReference.object;\r\n            if (!model) {\r\n                modelReference.dispose();\r\n                throw new Error();\r\n            }\r\n            _this._preview = new FilePreview(modelReference);\r\n            _this._resolved = true;\r\n            return _this;\r\n        }, function (err) {\r\n            // something wrong here\r\n            _this.children.length = 0;\r\n            _this._resolved = true;\r\n            _this._loadFailure = err;\r\n            return _this;\r\n        }));\r\n    };\r\n    return FileReferences;\r\n}());\r\nexport { FileReferences };\r\nvar ReferencesModel = /** @class */ (function () {\r\n    function ReferencesModel(links, title) {\r\n        var _this = this;\r\n        this._disposables = new DisposableStore();\r\n        this.groups = [];\r\n        this.references = [];\r\n        this._onDidChangeReferenceRange = new Emitter();\r\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\r\n        this._links = links;\r\n        this._title = title;\r\n        // grouping and sorting\r\n        var providersFirst = links[0];\r\n        links.sort(ReferencesModel._compareReferences);\r\n        var current;\r\n        for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n            var link = links_1[_i];\r\n            if (!current || current.uri.toString() !== link.uri.toString()) {\r\n                // new group\r\n                current = new FileReferences(this, link.uri);\r\n                this.groups.push(current);\r\n            }\r\n            // append, check for equality first!\r\n            if (current.children.length === 0 || !Range.equalsRange(link.range, current.children[current.children.length - 1].range)) {\r\n                var oneRef = new OneReference(providersFirst === link, current, link.targetSelectionRange || link.range, function (ref) { return _this._onDidChangeReferenceRange.fire(ref); });\r\n                this.references.push(oneRef);\r\n                current.children.push(oneRef);\r\n            }\r\n        }\r\n    }\r\n    ReferencesModel.prototype.dispose = function () {\r\n        dispose(this.groups);\r\n        this._disposables.dispose();\r\n        this._onDidChangeReferenceRange.dispose();\r\n        this.groups.length = 0;\r\n    };\r\n    ReferencesModel.prototype.clone = function () {\r\n        return new ReferencesModel(this._links, this._title);\r\n    };\r\n    Object.defineProperty(ReferencesModel.prototype, \"title\", {\r\n        get: function () {\r\n            return this._title;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"isEmpty\", {\r\n        get: function () {\r\n            return this.groups.length === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            if (this.isEmpty) {\r\n                return localize('aria.result.0', \"No results found\");\r\n            }\r\n            else if (this.references.length === 1) {\r\n                return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\r\n            }\r\n            else if (this.groups.length === 1) {\r\n                return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReferencesModel.prototype.nextOrPreviousReference = function (reference, next) {\r\n        var parent = reference.parent;\r\n        var idx = parent.children.indexOf(reference);\r\n        var childCount = parent.children.length;\r\n        var groupCount = parent.parent.groups.length;\r\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\r\n            // cycling within one file\r\n            if (next) {\r\n                idx = (idx + 1) % childCount;\r\n            }\r\n            else {\r\n                idx = (idx + childCount - 1) % childCount;\r\n            }\r\n            return parent.children[idx];\r\n        }\r\n        idx = parent.parent.groups.indexOf(parent);\r\n        if (next) {\r\n            idx = (idx + 1) % groupCount;\r\n            return parent.parent.groups[idx].children[0];\r\n        }\r\n        else {\r\n            idx = (idx + groupCount - 1) % groupCount;\r\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\r\n        }\r\n    };\r\n    ReferencesModel.prototype.nearestReference = function (resource, position) {\r\n        var nearest = this.references.map(function (ref, idx) {\r\n            return {\r\n                idx: idx,\r\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\r\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\r\n            };\r\n        }).sort(function (a, b) {\r\n            if (a.prefixLen > b.prefixLen) {\r\n                return -1;\r\n            }\r\n            else if (a.prefixLen < b.prefixLen) {\r\n                return 1;\r\n            }\r\n            else if (a.offsetDist < b.offsetDist) {\r\n                return -1;\r\n            }\r\n            else if (a.offsetDist > b.offsetDist) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        })[0];\r\n        if (nearest) {\r\n            return this.references[nearest.idx];\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.referenceAt = function (resource, position) {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.uri.toString() === resource.toString()) {\r\n                if (Range.containsPosition(ref.range, position)) {\r\n                    return ref;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.firstReference = function () {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.isProviderFirst) {\r\n                return ref;\r\n            }\r\n        }\r\n        return this.references[0];\r\n    };\r\n    ReferencesModel._compareReferences = function (a, b) {\r\n        return strings.compare(a.uri.toString(), b.uri.toString()) || Range.compareRangesUsingStarts(a.range, b.range);\r\n    };\r\n    return ReferencesModel;\r\n}());\r\nexport { ReferencesModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as objects from '../../../common/objects.js';\r\nimport { renderCodicons } from '../../../common/codicons.js';\r\nimport { escape } from '../../../common/strings.js';\r\nvar HighlightedLabel = /** @class */ (function () {\r\n    function HighlightedLabel(container, supportCodicons) {\r\n        this.supportCodicons = supportCodicons;\r\n        this.text = '';\r\n        this.title = '';\r\n        this.highlights = [];\r\n        this.didEverRender = false;\r\n        this.domNode = document.createElement('span');\r\n        this.domNode.className = 'monaco-highlighted-label';\r\n        container.appendChild(this.domNode);\r\n    }\r\n    Object.defineProperty(HighlightedLabel.prototype, \"element\", {\r\n        get: function () {\r\n            return this.domNode;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HighlightedLabel.prototype.set = function (text, highlights, title, escapeNewLines) {\r\n        if (highlights === void 0) { highlights = []; }\r\n        if (title === void 0) { title = ''; }\r\n        if (!text) {\r\n            text = '';\r\n        }\r\n        if (escapeNewLines) {\r\n            // adjusts highlights inplace\r\n            text = HighlightedLabel.escapeNewLines(text, highlights);\r\n        }\r\n        if (this.didEverRender && this.text === text && this.title === title && objects.equals(this.highlights, highlights)) {\r\n            return;\r\n        }\r\n        if (!Array.isArray(highlights)) {\r\n            highlights = [];\r\n        }\r\n        this.text = text;\r\n        this.title = title;\r\n        this.highlights = highlights;\r\n        this.render();\r\n    };\r\n    HighlightedLabel.prototype.render = function () {\r\n        var htmlContent = '';\r\n        var pos = 0;\r\n        for (var _i = 0, _a = this.highlights; _i < _a.length; _i++) {\r\n            var highlight = _a[_i];\r\n            if (highlight.end === highlight.start) {\r\n                continue;\r\n            }\r\n            if (pos < highlight.start) {\r\n                htmlContent += '<span>';\r\n                var substring_1 = this.text.substring(pos, highlight.start);\r\n                htmlContent += this.supportCodicons ? renderCodicons(escape(substring_1)) : escape(substring_1);\r\n                htmlContent += '</span>';\r\n                pos = highlight.end;\r\n            }\r\n            if (highlight.extraClasses) {\r\n                htmlContent += \"<span class=\\\"highlight \" + highlight.extraClasses + \"\\\">\";\r\n            }\r\n            else {\r\n                htmlContent += \"<span class=\\\"highlight\\\">\";\r\n            }\r\n            var substring = this.text.substring(highlight.start, highlight.end);\r\n            htmlContent += this.supportCodicons ? renderCodicons(escape(substring)) : escape(substring);\r\n            htmlContent += '</span>';\r\n            pos = highlight.end;\r\n        }\r\n        if (pos < this.text.length) {\r\n            htmlContent += '<span>';\r\n            var substring = this.text.substring(pos);\r\n            htmlContent += this.supportCodicons ? renderCodicons(escape(substring)) : escape(substring);\r\n            htmlContent += '</span>';\r\n        }\r\n        this.domNode.innerHTML = htmlContent;\r\n        if (this.title) {\r\n            this.domNode.title = this.title;\r\n        }\r\n        else {\r\n            this.domNode.removeAttribute('title');\r\n        }\r\n        this.didEverRender = true;\r\n    };\r\n    HighlightedLabel.escapeNewLines = function (text, highlights) {\r\n        var total = 0;\r\n        var extra = 0;\r\n        return text.replace(/\\r\\n|\\r|\\n/g, function (match, offset) {\r\n            extra = match === '\\r\\n' ? -1 : 0;\r\n            offset += total;\r\n            for (var _i = 0, highlights_1 = highlights; _i < highlights_1.length; _i++) {\r\n                var highlight = highlights_1[_i];\r\n                if (highlight.end <= offset) {\r\n                    continue;\r\n                }\r\n                if (highlight.start >= offset) {\r\n                    highlight.start += extra;\r\n                }\r\n                if (highlight.end >= offset) {\r\n                    highlight.end += extra;\r\n                }\r\n            }\r\n            total += extra;\r\n            return '\\u23CE';\r\n        });\r\n    };\r\n    return HighlightedLabel;\r\n}());\r\nexport { HighlightedLabel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './iconlabel.css';\r\nimport * as dom from '../../dom.js';\r\nimport { HighlightedLabel } from '../highlightedlabel/highlightedLabel.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Range } from '../../../common/range.js';\r\nimport { equals } from '../../../common/objects.js';\r\nvar FastLabelNode = /** @class */ (function () {\r\n    function FastLabelNode(_element) {\r\n        this._element = _element;\r\n    }\r\n    Object.defineProperty(FastLabelNode.prototype, \"element\", {\r\n        get: function () {\r\n            return this._element;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"textContent\", {\r\n        set: function (content) {\r\n            if (this.disposed || content === this._textContent) {\r\n                return;\r\n            }\r\n            this._textContent = content;\r\n            this._element.textContent = content;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"className\", {\r\n        set: function (className) {\r\n            if (this.disposed || className === this._className) {\r\n                return;\r\n            }\r\n            this._className = className;\r\n            this._element.className = className;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"title\", {\r\n        set: function (title) {\r\n            if (this.disposed || title === this._title) {\r\n                return;\r\n            }\r\n            this._title = title;\r\n            if (this._title) {\r\n                this._element.title = title;\r\n            }\r\n            else {\r\n                this._element.removeAttribute('title');\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FastLabelNode.prototype, \"empty\", {\r\n        set: function (empty) {\r\n            if (this.disposed || empty === this._empty) {\r\n                return;\r\n            }\r\n            this._empty = empty;\r\n            this._element.style.marginLeft = empty ? '0' : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FastLabelNode.prototype.dispose = function () {\r\n        this.disposed = true;\r\n    };\r\n    return FastLabelNode;\r\n}());\r\nvar IconLabel = /** @class */ (function (_super) {\r\n    __extends(IconLabel, _super);\r\n    function IconLabel(container, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.domNode = _this._register(new FastLabelNode(dom.append(container, dom.$('.monaco-icon-label'))));\r\n        var labelContainer = dom.append(_this.domNode.element, dom.$('.monaco-icon-label-container'));\r\n        var nameContainer = dom.append(labelContainer, dom.$('span.monaco-icon-name-container'));\r\n        _this.descriptionContainer = _this._register(new FastLabelNode(dom.append(labelContainer, dom.$('span.monaco-icon-description-container'))));\r\n        if (options === null || options === void 0 ? void 0 : options.supportHighlights) {\r\n            _this.nameNode = new LabelWithHighlights(nameContainer, !!options.supportCodicons);\r\n        }\r\n        else {\r\n            _this.nameNode = new Label(nameContainer);\r\n        }\r\n        if (options === null || options === void 0 ? void 0 : options.supportDescriptionHighlights) {\r\n            _this.descriptionNodeFactory = function () { return new HighlightedLabel(dom.append(_this.descriptionContainer.element, dom.$('span.label-description')), !!options.supportCodicons); };\r\n        }\r\n        else {\r\n            _this.descriptionNodeFactory = function () { return _this._register(new FastLabelNode(dom.append(_this.descriptionContainer.element, dom.$('span.label-description')))); };\r\n        }\r\n        return _this;\r\n    }\r\n    IconLabel.prototype.setLabel = function (label, description, options) {\r\n        var classes = ['monaco-icon-label'];\r\n        if (options) {\r\n            if (options.extraClasses) {\r\n                classes.push.apply(classes, options.extraClasses);\r\n            }\r\n            if (options.italic) {\r\n                classes.push('italic');\r\n            }\r\n        }\r\n        this.domNode.className = classes.join(' ');\r\n        this.domNode.title = (options === null || options === void 0 ? void 0 : options.title) || '';\r\n        this.nameNode.setLabel(label, options);\r\n        if (description || this.descriptionNode) {\r\n            if (!this.descriptionNode) {\r\n                this.descriptionNode = this.descriptionNodeFactory(); // description node is created lazily on demand\r\n            }\r\n            if (this.descriptionNode instanceof HighlightedLabel) {\r\n                this.descriptionNode.set(description || '', options ? options.descriptionMatches : undefined);\r\n                if (options === null || options === void 0 ? void 0 : options.descriptionTitle) {\r\n                    this.descriptionNode.element.title = options.descriptionTitle;\r\n                }\r\n                else {\r\n                    this.descriptionNode.element.removeAttribute('title');\r\n                }\r\n            }\r\n            else {\r\n                this.descriptionNode.textContent = description || '';\r\n                this.descriptionNode.title = (options === null || options === void 0 ? void 0 : options.descriptionTitle) || '';\r\n                this.descriptionNode.empty = !description;\r\n            }\r\n        }\r\n    };\r\n    return IconLabel;\r\n}(Disposable));\r\nexport { IconLabel };\r\nvar Label = /** @class */ (function () {\r\n    function Label(container) {\r\n        this.container = container;\r\n        this.label = undefined;\r\n        this.singleLabel = undefined;\r\n    }\r\n    Label.prototype.setLabel = function (label, options) {\r\n        if (this.label === label && equals(this.options, options)) {\r\n            return;\r\n        }\r\n        this.label = label;\r\n        this.options = options;\r\n        if (typeof label === 'string') {\r\n            if (!this.singleLabel) {\r\n                this.container.innerHTML = '';\r\n                dom.removeClass(this.container, 'multiple');\r\n                this.singleLabel = dom.append(this.container, dom.$('a.label-name', { id: options === null || options === void 0 ? void 0 : options.domId }));\r\n            }\r\n            this.singleLabel.textContent = label;\r\n        }\r\n        else {\r\n            this.container.innerHTML = '';\r\n            dom.addClass(this.container, 'multiple');\r\n            this.singleLabel = undefined;\r\n            for (var i = 0; i < label.length; i++) {\r\n                var l = label[i];\r\n                var id = (options === null || options === void 0 ? void 0 : options.domId) && (options === null || options === void 0 ? void 0 : options.domId) + \"_\" + i;\r\n                dom.append(this.container, dom.$('a.label-name', { id: id, 'data-icon-label-count': label.length, 'data-icon-label-index': i }, l));\r\n                if (i < label.length - 1) {\r\n                    dom.append(this.container, dom.$('span.label-separator', undefined, (options === null || options === void 0 ? void 0 : options.separator) || '/'));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Label;\r\n}());\r\nfunction splitMatches(labels, separator, matches) {\r\n    if (!matches) {\r\n        return undefined;\r\n    }\r\n    var labelStart = 0;\r\n    return labels.map(function (label) {\r\n        var labelRange = { start: labelStart, end: labelStart + label.length };\r\n        var result = matches\r\n            .map(function (match) { return Range.intersect(labelRange, match); })\r\n            .filter(function (range) { return !Range.isEmpty(range); })\r\n            .map(function (_a) {\r\n            var start = _a.start, end = _a.end;\r\n            return ({ start: start - labelStart, end: end - labelStart });\r\n        });\r\n        labelStart = labelRange.end + separator.length;\r\n        return result;\r\n    });\r\n}\r\nvar LabelWithHighlights = /** @class */ (function () {\r\n    function LabelWithHighlights(container, supportCodicons) {\r\n        this.container = container;\r\n        this.supportCodicons = supportCodicons;\r\n        this.label = undefined;\r\n        this.singleLabel = undefined;\r\n    }\r\n    LabelWithHighlights.prototype.setLabel = function (label, options) {\r\n        if (this.label === label && equals(this.options, options)) {\r\n            return;\r\n        }\r\n        this.label = label;\r\n        this.options = options;\r\n        if (typeof label === 'string') {\r\n            if (!this.singleLabel) {\r\n                this.container.innerHTML = '';\r\n                dom.removeClass(this.container, 'multiple');\r\n                this.singleLabel = new HighlightedLabel(dom.append(this.container, dom.$('a.label-name', { id: options === null || options === void 0 ? void 0 : options.domId })), this.supportCodicons);\r\n            }\r\n            this.singleLabel.set(label, options === null || options === void 0 ? void 0 : options.matches, options === null || options === void 0 ? void 0 : options.title, options === null || options === void 0 ? void 0 : options.labelEscapeNewLines);\r\n        }\r\n        else {\r\n            this.container.innerHTML = '';\r\n            dom.addClass(this.container, 'multiple');\r\n            this.singleLabel = undefined;\r\n            var separator = (options === null || options === void 0 ? void 0 : options.separator) || '/';\r\n            var matches = splitMatches(label, separator, options === null || options === void 0 ? void 0 : options.matches);\r\n            for (var i = 0; i < label.length; i++) {\r\n                var l = label[i];\r\n                var m = matches ? matches[i] : undefined;\r\n                var id = (options === null || options === void 0 ? void 0 : options.domId) && (options === null || options === void 0 ? void 0 : options.domId) + \"_\" + i;\r\n                var name_1 = dom.$('a.label-name', { id: id, 'data-icon-label-count': label.length, 'data-icon-label-index': i });\r\n                var highlightedLabel = new HighlightedLabel(dom.append(this.container, name_1), this.supportCodicons);\r\n                highlightedLabel.set(l, m, options === null || options === void 0 ? void 0 : options.title, options === null || options === void 0 ? void 0 : options.labelEscapeNewLines);\r\n                if (i < label.length - 1) {\r\n                    dom.append(name_1, dom.$('span.label-separator', undefined, separator));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return LabelWithHighlights;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './countBadge.css';\r\nimport { $, append } from '../../dom.js';\r\nimport { format } from '../../../common/strings.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nvar defaultOpts = {\r\n    badgeBackground: Color.fromHex('#4D4D4D'),\r\n    badgeForeground: Color.fromHex('#FFFFFF')\r\n};\r\nvar CountBadge = /** @class */ (function () {\r\n    function CountBadge(container, options) {\r\n        this.count = 0;\r\n        this.options = options || Object.create(null);\r\n        mixin(this.options, defaultOpts, false);\r\n        this.badgeBackground = this.options.badgeBackground;\r\n        this.badgeForeground = this.options.badgeForeground;\r\n        this.badgeBorder = this.options.badgeBorder;\r\n        this.element = append(container, $('.monaco-count-badge'));\r\n        this.countFormat = this.options.countFormat || '{0}';\r\n        this.titleFormat = this.options.titleFormat || '';\r\n        this.setCount(this.options.count || 0);\r\n    }\r\n    CountBadge.prototype.setCount = function (count) {\r\n        this.count = count;\r\n        this.render();\r\n    };\r\n    CountBadge.prototype.setTitleFormat = function (titleFormat) {\r\n        this.titleFormat = titleFormat;\r\n        this.render();\r\n    };\r\n    CountBadge.prototype.render = function () {\r\n        this.element.textContent = format(this.countFormat, this.count);\r\n        this.element.title = format(this.titleFormat, this.count);\r\n        this.applyStyles();\r\n    };\r\n    CountBadge.prototype.style = function (styles) {\r\n        this.badgeBackground = styles.badgeBackground;\r\n        this.badgeForeground = styles.badgeForeground;\r\n        this.badgeBorder = styles.badgeBorder;\r\n        this.applyStyles();\r\n    };\r\n    CountBadge.prototype.applyStyles = function () {\r\n        if (this.element) {\r\n            var background = this.badgeBackground ? this.badgeBackground.toString() : '';\r\n            var foreground = this.badgeForeground ? this.badgeForeground.toString() : '';\r\n            var border = this.badgeBorder ? this.badgeBorder.toString() : '';\r\n            this.element.style.backgroundColor = background;\r\n            this.element.style.color = foreground;\r\n            this.element.style.borderWidth = border ? '1px' : '';\r\n            this.element.style.borderStyle = border ? 'solid' : '';\r\n            this.element.style.borderColor = border;\r\n        }\r\n    };\r\n    return CountBadge;\r\n}());\r\nexport { CountBadge };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { URI } from './uri.js';\r\nimport { posix, normalize } from './path.js';\r\nimport { startsWithIgnoreCase, rtrim, startsWith } from './strings.js';\r\nimport { Schemas } from './network.js';\r\nimport { isLinux, isWindows } from './platform.js';\r\nimport { isEqual, basename, relativePath } from './resources.js';\r\n/**\r\n * @deprecated use LabelService instead\r\n */\r\nexport function getPathLabel(resource, userHomeProvider, rootProvider) {\r\n    if (typeof resource === 'string') {\r\n        resource = URI.file(resource);\r\n    }\r\n    // return early if we can resolve a relative path label from the root\r\n    if (rootProvider) {\r\n        var baseResource = rootProvider.getWorkspaceFolder(resource);\r\n        if (baseResource) {\r\n            var hasMultipleRoots = rootProvider.getWorkspace().folders.length > 1;\r\n            var pathLabel = void 0;\r\n            if (isEqual(baseResource.uri, resource)) {\r\n                pathLabel = ''; // no label if paths are identical\r\n            }\r\n            else {\r\n                pathLabel = relativePath(baseResource.uri, resource);\r\n            }\r\n            if (hasMultipleRoots) {\r\n                var rootName = baseResource.name ? baseResource.name : basename(baseResource.uri);\r\n                pathLabel = pathLabel ? (rootName + ' • ' + pathLabel) : rootName; // always show root basename if there are multiple\r\n            }\r\n            return pathLabel;\r\n        }\r\n    }\r\n    // return if the resource is neither file:// nor untitled:// and no baseResource was provided\r\n    if (resource.scheme !== Schemas.file && resource.scheme !== Schemas.untitled) {\r\n        return resource.with({ query: null, fragment: null }).toString(true);\r\n    }\r\n    // convert c:\\something => C:\\something\r\n    if (hasDriveLetter(resource.fsPath)) {\r\n        return normalize(normalizeDriveLetter(resource.fsPath));\r\n    }\r\n    // normalize and tildify (macOS, Linux only)\r\n    var res = normalize(resource.fsPath);\r\n    if (!isWindows && userHomeProvider) {\r\n        res = tildify(res, userHomeProvider.userHome);\r\n    }\r\n    return res;\r\n}\r\nexport function getBaseLabel(resource) {\r\n    if (!resource) {\r\n        return undefined;\r\n    }\r\n    if (typeof resource === 'string') {\r\n        resource = URI.file(resource);\r\n    }\r\n    var base = basename(resource) || (resource.scheme === Schemas.file ? resource.fsPath : resource.path) /* can be empty string if '/' is passed in */;\r\n    // convert c: => C:\r\n    if (hasDriveLetter(base)) {\r\n        return normalizeDriveLetter(base);\r\n    }\r\n    return base;\r\n}\r\nfunction hasDriveLetter(path) {\r\n    return !!(isWindows && path && path[1] === ':');\r\n}\r\nexport function normalizeDriveLetter(path) {\r\n    if (hasDriveLetter(path)) {\r\n        return path.charAt(0).toUpperCase() + path.slice(1);\r\n    }\r\n    return path;\r\n}\r\nvar normalizedUserHomeCached = Object.create(null);\r\nexport function tildify(path, userHome) {\r\n    if (isWindows || !path || !userHome) {\r\n        return path; // unsupported\r\n    }\r\n    // Keep a normalized user home path as cache to prevent accumulated string creation\r\n    var normalizedUserHome = normalizedUserHomeCached.original === userHome ? normalizedUserHomeCached.normalized : undefined;\r\n    if (!normalizedUserHome) {\r\n        normalizedUserHome = \"\" + rtrim(userHome, posix.sep) + posix.sep;\r\n        normalizedUserHomeCached = { original: userHome, normalized: normalizedUserHome };\r\n    }\r\n    // Linux: case sensitive, macOS: case insensitive\r\n    if (isLinux ? startsWith(path, normalizedUserHome) : startsWithIgnoreCase(path, normalizedUserHome)) {\r\n        path = \"~/\" + path.substr(normalizedUserHome.length);\r\n    }\r\n    return path;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport './splitview.css';\r\nimport { toDisposable, Disposable, combinedDisposable } from '../../../common/lifecycle.js';\r\nimport { Event, Emitter } from '../../../common/event.js';\r\nimport * as types from '../../../common/types.js';\r\nimport * as dom from '../../dom.js';\r\nimport { clamp } from '../../../common/numbers.js';\r\nimport { range, firstIndex, pushToStart, pushToEnd } from '../../../common/arrays.js';\r\nimport { Sash } from '../sash/sash.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { domEvent } from '../../event.js';\r\nvar defaultStyles = {\r\n    separatorBorder: Color.transparent\r\n};\r\nvar ViewItem = /** @class */ (function () {\r\n    function ViewItem(container, view, size, disposable) {\r\n        this.container = container;\r\n        this.view = view;\r\n        this.disposable = disposable;\r\n        this._cachedVisibleSize = undefined;\r\n        if (typeof size === 'number') {\r\n            this._size = size;\r\n            this._cachedVisibleSize = undefined;\r\n            dom.addClass(container, 'visible');\r\n        }\r\n        else {\r\n            this._size = 0;\r\n            this._cachedVisibleSize = size.cachedVisibleSize;\r\n        }\r\n    }\r\n    Object.defineProperty(ViewItem.prototype, \"size\", {\r\n        get: function () {\r\n            return this._size;\r\n        },\r\n        set: function (size) {\r\n            this._size = size;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"visible\", {\r\n        get: function () {\r\n            return typeof this._cachedVisibleSize === 'undefined';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.setVisible = function (visible, size) {\r\n        if (visible === this.visible) {\r\n            return;\r\n        }\r\n        if (visible) {\r\n            this.size = clamp(this._cachedVisibleSize, this.viewMinimumSize, this.viewMaximumSize);\r\n            this._cachedVisibleSize = undefined;\r\n        }\r\n        else {\r\n            this._cachedVisibleSize = typeof size === 'number' ? size : this.size;\r\n            this.size = 0;\r\n        }\r\n        dom.toggleClass(this.container, 'visible', visible);\r\n        if (this.view.setVisible) {\r\n            this.view.setVisible(visible);\r\n        }\r\n    };\r\n    Object.defineProperty(ViewItem.prototype, \"minimumSize\", {\r\n        get: function () { return this.visible ? this.view.minimumSize : 0; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"viewMinimumSize\", {\r\n        get: function () { return this.view.minimumSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"maximumSize\", {\r\n        get: function () { return this.visible ? this.view.maximumSize : 0; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"viewMaximumSize\", {\r\n        get: function () { return this.view.maximumSize; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"priority\", {\r\n        get: function () { return this.view.priority; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"snap\", {\r\n        get: function () { return !!this.view.snap; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"enabled\", {\r\n        set: function (enabled) {\r\n            this.container.style.pointerEvents = enabled ? null : 'none';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.layout = function (offset, layoutContext) {\r\n        this.layoutContainer(offset);\r\n        this.view.layout(this.size, offset, layoutContext);\r\n    };\r\n    ViewItem.prototype.dispose = function () {\r\n        this.disposable.dispose();\r\n        return this.view;\r\n    };\r\n    return ViewItem;\r\n}());\r\nvar VerticalViewItem = /** @class */ (function (_super) {\r\n    __extends(VerticalViewItem, _super);\r\n    function VerticalViewItem() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    VerticalViewItem.prototype.layoutContainer = function (offset) {\r\n        this.container.style.top = offset + \"px\";\r\n        this.container.style.height = this.size + \"px\";\r\n    };\r\n    return VerticalViewItem;\r\n}(ViewItem));\r\nvar HorizontalViewItem = /** @class */ (function (_super) {\r\n    __extends(HorizontalViewItem, _super);\r\n    function HorizontalViewItem() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    HorizontalViewItem.prototype.layoutContainer = function (offset) {\r\n        this.container.style.left = offset + \"px\";\r\n        this.container.style.width = this.size + \"px\";\r\n    };\r\n    return HorizontalViewItem;\r\n}(ViewItem));\r\nvar State;\r\n(function (State) {\r\n    State[State[\"Idle\"] = 0] = \"Idle\";\r\n    State[State[\"Busy\"] = 1] = \"Busy\";\r\n})(State || (State = {}));\r\nexport var Sizing;\r\n(function (Sizing) {\r\n    Sizing.Distribute = { type: 'distribute' };\r\n    function Split(index) { return { type: 'split', index: index }; }\r\n    Sizing.Split = Split;\r\n    function Invisible(cachedVisibleSize) { return { type: 'invisible', cachedVisibleSize: cachedVisibleSize }; }\r\n    Sizing.Invisible = Invisible;\r\n})(Sizing || (Sizing = {}));\r\nvar SplitView = /** @class */ (function (_super) {\r\n    __extends(SplitView, _super);\r\n    function SplitView(container, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this) || this;\r\n        _this.size = 0;\r\n        _this.contentSize = 0;\r\n        _this.proportions = undefined;\r\n        _this.viewItems = [];\r\n        _this.sashItems = [];\r\n        _this.state = State.Idle;\r\n        _this._onDidSashChange = _this._register(new Emitter());\r\n        _this.onDidSashChange = _this._onDidSashChange.event;\r\n        _this._onDidSashReset = _this._register(new Emitter());\r\n        _this._startSnappingEnabled = true;\r\n        _this._endSnappingEnabled = true;\r\n        _this.orientation = types.isUndefined(options.orientation) ? 0 /* VERTICAL */ : options.orientation;\r\n        _this.inverseAltBehavior = !!options.inverseAltBehavior;\r\n        _this.proportionalLayout = types.isUndefined(options.proportionalLayout) ? true : !!options.proportionalLayout;\r\n        _this.el = document.createElement('div');\r\n        dom.addClass(_this.el, 'monaco-split-view2');\r\n        dom.addClass(_this.el, _this.orientation === 0 /* VERTICAL */ ? 'vertical' : 'horizontal');\r\n        container.appendChild(_this.el);\r\n        _this.sashContainer = dom.append(_this.el, dom.$('.sash-container'));\r\n        _this.viewContainer = dom.append(_this.el, dom.$('.split-view-container'));\r\n        _this.style(options.styles || defaultStyles);\r\n        // We have an existing set of view, add them now\r\n        if (options.descriptor) {\r\n            _this.size = options.descriptor.size;\r\n            options.descriptor.views.forEach(function (viewDescriptor, index) {\r\n                var sizing = types.isUndefined(viewDescriptor.visible) || viewDescriptor.visible ? viewDescriptor.size : { type: 'invisible', cachedVisibleSize: viewDescriptor.size };\r\n                var view = viewDescriptor.view;\r\n                _this.doAddView(view, sizing, index, true);\r\n            });\r\n            // Initialize content size and proportions for first layout\r\n            _this.contentSize = _this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n            _this.saveProportions();\r\n        }\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SplitView.prototype, \"orthogonalStartSash\", {\r\n        get: function () { return this._orthogonalStartSash; },\r\n        set: function (sash) {\r\n            for (var _i = 0, _a = this.sashItems; _i < _a.length; _i++) {\r\n                var sashItem = _a[_i];\r\n                sashItem.sash.orthogonalStartSash = sash;\r\n            }\r\n            this._orthogonalStartSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"orthogonalEndSash\", {\r\n        get: function () { return this._orthogonalEndSash; },\r\n        set: function (sash) {\r\n            for (var _i = 0, _a = this.sashItems; _i < _a.length; _i++) {\r\n                var sashItem = _a[_i];\r\n                sashItem.sash.orthogonalEndSash = sash;\r\n            }\r\n            this._orthogonalEndSash = sash;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"startSnappingEnabled\", {\r\n        get: function () { return this._startSnappingEnabled; },\r\n        set: function (startSnappingEnabled) {\r\n            if (this._startSnappingEnabled === startSnappingEnabled) {\r\n                return;\r\n            }\r\n            this._startSnappingEnabled = startSnappingEnabled;\r\n            this.updateSashEnablement();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SplitView.prototype, \"endSnappingEnabled\", {\r\n        get: function () { return this._endSnappingEnabled; },\r\n        set: function (endSnappingEnabled) {\r\n            if (this._endSnappingEnabled === endSnappingEnabled) {\r\n                return;\r\n            }\r\n            this._endSnappingEnabled = endSnappingEnabled;\r\n            this.updateSashEnablement();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SplitView.prototype.style = function (styles) {\r\n        if (styles.separatorBorder.isTransparent()) {\r\n            dom.removeClass(this.el, 'separator-border');\r\n            this.el.style.removeProperty('--separator-border');\r\n        }\r\n        else {\r\n            dom.addClass(this.el, 'separator-border');\r\n            this.el.style.setProperty('--separator-border', styles.separatorBorder.toString());\r\n        }\r\n    };\r\n    SplitView.prototype.addView = function (view, size, index) {\r\n        if (index === void 0) { index = this.viewItems.length; }\r\n        this.doAddView(view, size, index, false);\r\n    };\r\n    SplitView.prototype.layout = function (size, layoutContext) {\r\n        var _this = this;\r\n        var previousSize = Math.max(this.size, this.contentSize);\r\n        this.size = size;\r\n        this.layoutContext = layoutContext;\r\n        if (!this.proportions) {\r\n            var indexes = range(this.viewItems.length);\r\n            var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n            var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n            this.resize(this.viewItems.length - 1, size - previousSize, undefined, lowPriorityIndexes, highPriorityIndexes);\r\n        }\r\n        else {\r\n            for (var i = 0; i < this.viewItems.length; i++) {\r\n                var item = this.viewItems[i];\r\n                item.size = clamp(Math.round(this.proportions[i] * size), item.minimumSize, item.maximumSize);\r\n            }\r\n        }\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n    };\r\n    SplitView.prototype.saveProportions = function () {\r\n        var _this = this;\r\n        if (this.proportionalLayout && this.contentSize > 0) {\r\n            this.proportions = this.viewItems.map(function (i) { return i.size / _this.contentSize; });\r\n        }\r\n    };\r\n    SplitView.prototype.onSashStart = function (_a) {\r\n        var _this = this;\r\n        var sash = _a.sash, start = _a.start, alt = _a.alt;\r\n        for (var _i = 0, _b = this.viewItems; _i < _b.length; _i++) {\r\n            var item = _b[_i];\r\n            item.enabled = false;\r\n        }\r\n        var index = firstIndex(this.sashItems, function (item) { return item.sash === sash; });\r\n        // This way, we can press Alt while we resize a sash, macOS style!\r\n        var disposable = combinedDisposable(domEvent(document.body, 'keydown')(function (e) { return resetSashDragState(_this.sashDragState.current, e.altKey); }), domEvent(document.body, 'keyup')(function () { return resetSashDragState(_this.sashDragState.current, false); }));\r\n        var resetSashDragState = function (start, alt) {\r\n            var sizes = _this.viewItems.map(function (i) { return i.size; });\r\n            var minDelta = Number.NEGATIVE_INFINITY;\r\n            var maxDelta = Number.POSITIVE_INFINITY;\r\n            if (_this.inverseAltBehavior) {\r\n                alt = !alt;\r\n            }\r\n            if (alt) {\r\n                // When we're using the last sash with Alt, we're resizing\r\n                // the view to the left/up, instead of right/down as usual\r\n                // Thus, we must do the inverse of the usual\r\n                var isLastSash = index === _this.sashItems.length - 1;\r\n                if (isLastSash) {\r\n                    var viewItem = _this.viewItems[index];\r\n                    minDelta = (viewItem.minimumSize - viewItem.size) / 2;\r\n                    maxDelta = (viewItem.maximumSize - viewItem.size) / 2;\r\n                }\r\n                else {\r\n                    var viewItem = _this.viewItems[index + 1];\r\n                    minDelta = (viewItem.size - viewItem.maximumSize) / 2;\r\n                    maxDelta = (viewItem.size - viewItem.minimumSize) / 2;\r\n                }\r\n            }\r\n            var snapBefore;\r\n            var snapAfter;\r\n            if (!alt) {\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, _this.viewItems.length);\r\n                var minDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].minimumSize - sizes[i]); }, 0);\r\n                var maxDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].viewMaximumSize - sizes[i]); }, 0);\r\n                var maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].minimumSize); }, 0);\r\n                var minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].viewMaximumSize); }, 0);\r\n                var minDelta_1 = Math.max(minDeltaUp, minDeltaDown);\r\n                var maxDelta_1 = Math.min(maxDeltaDown, maxDeltaUp);\r\n                var snapBeforeIndex = _this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = _this.findFirstSnapIndex(downIndexes);\r\n                if (typeof snapBeforeIndex === 'number') {\r\n                    var viewItem = _this.viewItems[snapBeforeIndex];\r\n                    var halfSize = Math.floor(viewItem.viewMinimumSize / 2);\r\n                    snapBefore = {\r\n                        index: snapBeforeIndex,\r\n                        limitDelta: viewItem.visible ? minDelta_1 - halfSize : minDelta_1 + halfSize,\r\n                        size: viewItem.size\r\n                    };\r\n                }\r\n                if (typeof snapAfterIndex === 'number') {\r\n                    var viewItem = _this.viewItems[snapAfterIndex];\r\n                    var halfSize = Math.floor(viewItem.viewMinimumSize / 2);\r\n                    snapAfter = {\r\n                        index: snapAfterIndex,\r\n                        limitDelta: viewItem.visible ? maxDelta_1 + halfSize : maxDelta_1 - halfSize,\r\n                        size: viewItem.size\r\n                    };\r\n                }\r\n            }\r\n            _this.sashDragState = { start: start, current: start, index: index, sizes: sizes, minDelta: minDelta, maxDelta: maxDelta, alt: alt, snapBefore: snapBefore, snapAfter: snapAfter, disposable: disposable };\r\n        };\r\n        resetSashDragState(start, alt);\r\n    };\r\n    SplitView.prototype.onSashChange = function (_a) {\r\n        var current = _a.current;\r\n        var _b = this.sashDragState, index = _b.index, start = _b.start, sizes = _b.sizes, alt = _b.alt, minDelta = _b.minDelta, maxDelta = _b.maxDelta, snapBefore = _b.snapBefore, snapAfter = _b.snapAfter;\r\n        this.sashDragState.current = current;\r\n        var delta = current - start;\r\n        var newDelta = this.resize(index, delta, sizes, undefined, undefined, minDelta, maxDelta, snapBefore, snapAfter);\r\n        if (alt) {\r\n            var isLastSash = index === this.sashItems.length - 1;\r\n            var newSizes = this.viewItems.map(function (i) { return i.size; });\r\n            var viewItemIndex = isLastSash ? index : index + 1;\r\n            var viewItem = this.viewItems[viewItemIndex];\r\n            var newMinDelta = viewItem.size - viewItem.maximumSize;\r\n            var newMaxDelta = viewItem.size - viewItem.minimumSize;\r\n            var resizeIndex = isLastSash ? index - 1 : index + 1;\r\n            this.resize(resizeIndex, -newDelta, newSizes, undefined, undefined, newMinDelta, newMaxDelta);\r\n        }\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n    };\r\n    SplitView.prototype.onSashEnd = function (index) {\r\n        this._onDidSashChange.fire(index);\r\n        this.sashDragState.disposable.dispose();\r\n        this.saveProportions();\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.enabled = true;\r\n        }\r\n    };\r\n    SplitView.prototype.onViewChange = function (item, size) {\r\n        var index = this.viewItems.indexOf(item);\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return;\r\n        }\r\n        size = typeof size === 'number' ? size : item.size;\r\n        size = clamp(size, item.minimumSize, item.maximumSize);\r\n        if (this.inverseAltBehavior && index > 0) {\r\n            // In this case, we want the view to grow or shrink both sides equally\r\n            // so we just resize the \"left\" side by half and let `resize` do the clamping magic\r\n            this.resize(index - 1, Math.floor((item.size - size) / 2));\r\n            this.distributeEmptySpace();\r\n            this.layoutViews();\r\n        }\r\n        else {\r\n            item.size = size;\r\n            this.relayout([index], undefined);\r\n        }\r\n    };\r\n    SplitView.prototype.resizeView = function (index, size) {\r\n        var _this = this;\r\n        if (this.state !== State.Idle) {\r\n            throw new Error('Cant modify splitview');\r\n        }\r\n        this.state = State.Busy;\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return;\r\n        }\r\n        var indexes = range(this.viewItems.length).filter(function (i) { return i !== index; });\r\n        var lowPriorityIndexes = __spreadArrays(indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; }), [index]);\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        var item = this.viewItems[index];\r\n        size = Math.round(size);\r\n        size = clamp(size, item.minimumSize, Math.min(item.maximumSize, this.size));\r\n        item.size = size;\r\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\r\n        this.state = State.Idle;\r\n    };\r\n    SplitView.prototype.distributeViewSizes = function () {\r\n        var _this = this;\r\n        var flexibleViewItems = [];\r\n        var flexibleSize = 0;\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            if (item.maximumSize - item.minimumSize > 0) {\r\n                flexibleViewItems.push(item);\r\n                flexibleSize += item.size;\r\n            }\r\n        }\r\n        var size = Math.floor(flexibleSize / flexibleViewItems.length);\r\n        for (var _b = 0, flexibleViewItems_1 = flexibleViewItems; _b < flexibleViewItems_1.length; _b++) {\r\n            var item = flexibleViewItems_1[_b];\r\n            item.size = clamp(size, item.minimumSize, item.maximumSize);\r\n        }\r\n        var indexes = range(this.viewItems.length);\r\n        var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\r\n    };\r\n    SplitView.prototype.getViewSize = function (index) {\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return -1;\r\n        }\r\n        return this.viewItems[index].size;\r\n    };\r\n    SplitView.prototype.doAddView = function (view, size, index, skipLayout) {\r\n        var _this = this;\r\n        if (index === void 0) { index = this.viewItems.length; }\r\n        if (this.state !== State.Idle) {\r\n            throw new Error('Cant modify splitview');\r\n        }\r\n        this.state = State.Busy;\r\n        // Add view\r\n        var container = dom.$('.split-view-view');\r\n        if (index === this.viewItems.length) {\r\n            this.viewContainer.appendChild(container);\r\n        }\r\n        else {\r\n            this.viewContainer.insertBefore(container, this.viewContainer.children.item(index));\r\n        }\r\n        var onChangeDisposable = view.onDidChange(function (size) { return _this.onViewChange(item, size); });\r\n        var containerDisposable = toDisposable(function () { return _this.viewContainer.removeChild(container); });\r\n        var disposable = combinedDisposable(onChangeDisposable, containerDisposable);\r\n        var viewSize;\r\n        if (typeof size === 'number') {\r\n            viewSize = size;\r\n        }\r\n        else if (size.type === 'split') {\r\n            viewSize = this.getViewSize(size.index) / 2;\r\n        }\r\n        else if (size.type === 'invisible') {\r\n            viewSize = { cachedVisibleSize: size.cachedVisibleSize };\r\n        }\r\n        else {\r\n            viewSize = view.minimumSize;\r\n        }\r\n        var item = this.orientation === 0 /* VERTICAL */\r\n            ? new VerticalViewItem(container, view, viewSize, disposable)\r\n            : new HorizontalViewItem(container, view, viewSize, disposable);\r\n        this.viewItems.splice(index, 0, item);\r\n        // Add sash\r\n        if (this.viewItems.length > 1) {\r\n            var orientation_1 = this.orientation === 0 /* VERTICAL */ ? 1 /* HORIZONTAL */ : 0 /* VERTICAL */;\r\n            var layoutProvider = this.orientation === 0 /* VERTICAL */ ? { getHorizontalSashTop: function (sash) { return _this.getSashPosition(sash); } } : { getVerticalSashLeft: function (sash) { return _this.getSashPosition(sash); } };\r\n            var sash_1 = new Sash(this.sashContainer, layoutProvider, {\r\n                orientation: orientation_1,\r\n                orthogonalStartSash: this.orthogonalStartSash,\r\n                orthogonalEndSash: this.orthogonalEndSash\r\n            });\r\n            var sashEventMapper = this.orientation === 0 /* VERTICAL */\r\n                ? function (e) { return ({ sash: sash_1, start: e.startY, current: e.currentY, alt: e.altKey }); }\r\n                : function (e) { return ({ sash: sash_1, start: e.startX, current: e.currentX, alt: e.altKey }); };\r\n            var onStart = Event.map(sash_1.onDidStart, sashEventMapper);\r\n            var onStartDisposable = onStart(this.onSashStart, this);\r\n            var onChange = Event.map(sash_1.onDidChange, sashEventMapper);\r\n            var onChangeDisposable_1 = onChange(this.onSashChange, this);\r\n            var onEnd = Event.map(sash_1.onDidEnd, function () { return firstIndex(_this.sashItems, function (item) { return item.sash === sash_1; }); });\r\n            var onEndDisposable = onEnd(this.onSashEnd, this);\r\n            var onDidResetDisposable = sash_1.onDidReset(function () {\r\n                var index = firstIndex(_this.sashItems, function (item) { return item.sash === sash_1; });\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, _this.viewItems.length);\r\n                var snapBeforeIndex = _this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = _this.findFirstSnapIndex(downIndexes);\r\n                if (typeof snapBeforeIndex === 'number' && !_this.viewItems[snapBeforeIndex].visible) {\r\n                    return;\r\n                }\r\n                if (typeof snapAfterIndex === 'number' && !_this.viewItems[snapAfterIndex].visible) {\r\n                    return;\r\n                }\r\n                _this._onDidSashReset.fire(index);\r\n            });\r\n            var disposable_1 = combinedDisposable(onStartDisposable, onChangeDisposable_1, onEndDisposable, onDidResetDisposable, sash_1);\r\n            var sashItem = { sash: sash_1, disposable: disposable_1 };\r\n            this.sashItems.splice(index - 1, 0, sashItem);\r\n        }\r\n        container.appendChild(view.element);\r\n        var highPriorityIndexes;\r\n        if (typeof size !== 'number' && size.type === 'split') {\r\n            highPriorityIndexes = [size.index];\r\n        }\r\n        if (!skipLayout) {\r\n            this.relayout([index], highPriorityIndexes);\r\n        }\r\n        this.state = State.Idle;\r\n        if (!skipLayout && typeof size !== 'number' && size.type === 'distribute') {\r\n            this.distributeViewSizes();\r\n        }\r\n    };\r\n    SplitView.prototype.relayout = function (lowPriorityIndexes, highPriorityIndexes) {\r\n        var contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        this.resize(this.viewItems.length - 1, this.size - contentSize, undefined, lowPriorityIndexes, highPriorityIndexes);\r\n        this.distributeEmptySpace();\r\n        this.layoutViews();\r\n        this.saveProportions();\r\n    };\r\n    SplitView.prototype.resize = function (index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta, snapBefore, snapAfter) {\r\n        var _this = this;\r\n        if (sizes === void 0) { sizes = this.viewItems.map(function (i) { return i.size; }); }\r\n        if (overloadMinDelta === void 0) { overloadMinDelta = Number.NEGATIVE_INFINITY; }\r\n        if (overloadMaxDelta === void 0) { overloadMaxDelta = Number.POSITIVE_INFINITY; }\r\n        if (index < 0 || index >= this.viewItems.length) {\r\n            return 0;\r\n        }\r\n        var upIndexes = range(index, -1);\r\n        var downIndexes = range(index + 1, this.viewItems.length);\r\n        if (highPriorityIndexes) {\r\n            for (var _i = 0, highPriorityIndexes_1 = highPriorityIndexes; _i < highPriorityIndexes_1.length; _i++) {\r\n                var index_1 = highPriorityIndexes_1[_i];\r\n                pushToStart(upIndexes, index_1);\r\n                pushToStart(downIndexes, index_1);\r\n            }\r\n        }\r\n        if (lowPriorityIndexes) {\r\n            for (var _a = 0, lowPriorityIndexes_1 = lowPriorityIndexes; _a < lowPriorityIndexes_1.length; _a++) {\r\n                var index_2 = lowPriorityIndexes_1[_a];\r\n                pushToEnd(upIndexes, index_2);\r\n                pushToEnd(downIndexes, index_2);\r\n            }\r\n        }\r\n        var upItems = upIndexes.map(function (i) { return _this.viewItems[i]; });\r\n        var upSizes = upIndexes.map(function (i) { return sizes[i]; });\r\n        var downItems = downIndexes.map(function (i) { return _this.viewItems[i]; });\r\n        var downSizes = downIndexes.map(function (i) { return sizes[i]; });\r\n        var minDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].minimumSize - sizes[i]); }, 0);\r\n        var maxDeltaUp = upIndexes.reduce(function (r, i) { return r + (_this.viewItems[i].maximumSize - sizes[i]); }, 0);\r\n        var maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].minimumSize); }, 0);\r\n        var minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce(function (r, i) { return r + (sizes[i] - _this.viewItems[i].maximumSize); }, 0);\r\n        var minDelta = Math.max(minDeltaUp, minDeltaDown, overloadMinDelta);\r\n        var maxDelta = Math.min(maxDeltaDown, maxDeltaUp, overloadMaxDelta);\r\n        var snapped = false;\r\n        if (snapBefore) {\r\n            var snapView = this.viewItems[snapBefore.index];\r\n            var visible = delta >= snapBefore.limitDelta;\r\n            snapped = visible !== snapView.visible;\r\n            snapView.setVisible(visible, snapBefore.size);\r\n        }\r\n        if (!snapped && snapAfter) {\r\n            var snapView = this.viewItems[snapAfter.index];\r\n            var visible = delta < snapAfter.limitDelta;\r\n            snapped = visible !== snapView.visible;\r\n            snapView.setVisible(visible, snapAfter.size);\r\n        }\r\n        if (snapped) {\r\n            return this.resize(index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta);\r\n        }\r\n        delta = clamp(delta, minDelta, maxDelta);\r\n        for (var i = 0, deltaUp = delta; i < upItems.length; i++) {\r\n            var item = upItems[i];\r\n            var size = clamp(upSizes[i] + deltaUp, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - upSizes[i];\r\n            deltaUp -= viewDelta;\r\n            item.size = size;\r\n        }\r\n        for (var i = 0, deltaDown = delta; i < downItems.length; i++) {\r\n            var item = downItems[i];\r\n            var size = clamp(downSizes[i] - deltaDown, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - downSizes[i];\r\n            deltaDown += viewDelta;\r\n            item.size = size;\r\n        }\r\n        return delta;\r\n    };\r\n    SplitView.prototype.distributeEmptySpace = function (lowPriorityIndex) {\r\n        var _this = this;\r\n        var contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        var emptyDelta = this.size - contentSize;\r\n        var indexes = range(this.viewItems.length - 1, -1);\r\n        var lowPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 1 /* Low */; });\r\n        var highPriorityIndexes = indexes.filter(function (i) { return _this.viewItems[i].priority === 2 /* High */; });\r\n        for (var _i = 0, highPriorityIndexes_2 = highPriorityIndexes; _i < highPriorityIndexes_2.length; _i++) {\r\n            var index = highPriorityIndexes_2[_i];\r\n            pushToStart(indexes, index);\r\n        }\r\n        for (var _a = 0, lowPriorityIndexes_2 = lowPriorityIndexes; _a < lowPriorityIndexes_2.length; _a++) {\r\n            var index = lowPriorityIndexes_2[_a];\r\n            pushToEnd(indexes, index);\r\n        }\r\n        if (typeof lowPriorityIndex === 'number') {\r\n            pushToEnd(indexes, lowPriorityIndex);\r\n        }\r\n        for (var i = 0; emptyDelta !== 0 && i < indexes.length; i++) {\r\n            var item = this.viewItems[indexes[i]];\r\n            var size = clamp(item.size + emptyDelta, item.minimumSize, item.maximumSize);\r\n            var viewDelta = size - item.size;\r\n            emptyDelta -= viewDelta;\r\n            item.size = size;\r\n        }\r\n    };\r\n    SplitView.prototype.layoutViews = function () {\r\n        // Save new content size\r\n        this.contentSize = this.viewItems.reduce(function (r, i) { return r + i.size; }, 0);\r\n        // Layout views\r\n        var offset = 0;\r\n        for (var _i = 0, _a = this.viewItems; _i < _a.length; _i++) {\r\n            var viewItem = _a[_i];\r\n            viewItem.layout(offset, this.layoutContext);\r\n            offset += viewItem.size;\r\n        }\r\n        // Layout sashes\r\n        this.sashItems.forEach(function (item) { return item.sash.layout(); });\r\n        this.updateSashEnablement();\r\n    };\r\n    SplitView.prototype.updateSashEnablement = function () {\r\n        var previous = false;\r\n        var collapsesDown = this.viewItems.map(function (i) { return previous = (i.size - i.minimumSize > 0) || previous; });\r\n        previous = false;\r\n        var expandsDown = this.viewItems.map(function (i) { return previous = (i.maximumSize - i.size > 0) || previous; });\r\n        var reverseViews = __spreadArrays(this.viewItems).reverse();\r\n        previous = false;\r\n        var collapsesUp = reverseViews.map(function (i) { return previous = (i.size - i.minimumSize > 0) || previous; }).reverse();\r\n        previous = false;\r\n        var expandsUp = reverseViews.map(function (i) { return previous = (i.maximumSize - i.size > 0) || previous; }).reverse();\r\n        var position = 0;\r\n        for (var index = 0; index < this.sashItems.length; index++) {\r\n            var sash = this.sashItems[index].sash;\r\n            var viewItem = this.viewItems[index];\r\n            position += viewItem.size;\r\n            var min = !(collapsesDown[index] && expandsUp[index + 1]);\r\n            var max = !(expandsDown[index] && collapsesUp[index + 1]);\r\n            if (min && max) {\r\n                var upIndexes = range(index, -1);\r\n                var downIndexes = range(index + 1, this.viewItems.length);\r\n                var snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\r\n                var snapAfterIndex = this.findFirstSnapIndex(downIndexes);\r\n                var snappedBefore = typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible;\r\n                var snappedAfter = typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible;\r\n                if (snappedBefore && collapsesUp[index] && (position > 0 || this.startSnappingEnabled)) {\r\n                    sash.state = 1 /* Minimum */;\r\n                }\r\n                else if (snappedAfter && collapsesDown[index] && (position < this.contentSize || this.endSnappingEnabled)) {\r\n                    sash.state = 2 /* Maximum */;\r\n                }\r\n                else {\r\n                    sash.state = 0 /* Disabled */;\r\n                }\r\n            }\r\n            else if (min && !max) {\r\n                sash.state = 1 /* Minimum */;\r\n            }\r\n            else if (!min && max) {\r\n                sash.state = 2 /* Maximum */;\r\n            }\r\n            else {\r\n                sash.state = 3 /* Enabled */;\r\n            }\r\n        }\r\n    };\r\n    SplitView.prototype.getSashPosition = function (sash) {\r\n        var position = 0;\r\n        for (var i = 0; i < this.sashItems.length; i++) {\r\n            position += this.viewItems[i].size;\r\n            if (this.sashItems[i].sash === sash) {\r\n                return Math.min(position, this.contentSize - 2);\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    SplitView.prototype.findFirstSnapIndex = function (indexes) {\r\n        // visible views first\r\n        for (var _i = 0, indexes_1 = indexes; _i < indexes_1.length; _i++) {\r\n            var index = indexes_1[_i];\r\n            var viewItem = this.viewItems[index];\r\n            if (!viewItem.visible) {\r\n                continue;\r\n            }\r\n            if (viewItem.snap) {\r\n                return index;\r\n            }\r\n        }\r\n        // then, hidden views\r\n        for (var _a = 0, indexes_2 = indexes; _a < indexes_2.length; _a++) {\r\n            var index = indexes_2[_a];\r\n            var viewItem = this.viewItems[index];\r\n            if (viewItem.visible && viewItem.maximumSize - viewItem.minimumSize > 0) {\r\n                return undefined;\r\n            }\r\n            if (!viewItem.visible && viewItem.snap) {\r\n                return index;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    SplitView.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.viewItems.forEach(function (i) { return i.dispose(); });\r\n        this.viewItems = [];\r\n        this.sashItems.forEach(function (i) { return i.disposable.dispose(); });\r\n        this.sashItems = [];\r\n    };\r\n    return SplitView;\r\n}(Disposable));\r\nexport { SplitView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nimport { getBaseLabel } from '../../../../base/common/labels.js';\r\nimport { dirname, basename } from '../../../../base/common/resources.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\r\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(_resolverService) {\r\n        this._resolverService = _resolverService;\r\n    }\r\n    DataSource.prototype.hasChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return true;\r\n        }\r\n        if (element instanceof FileReferences && !element.failure) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DataSource.prototype.getChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return element.groups;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return element.resolve(this._resolverService).then(function (val) {\r\n                // if (element.failure) {\r\n                // \t// refresh the element on failure so that\r\n                // \t// we can update its rendering\r\n                // \treturn tree.refresh(element).then(() => val.children);\r\n                // }\r\n                return val.children;\r\n            });\r\n        }\r\n        throw new Error('bad tree');\r\n    };\r\n    DataSource = __decorate([\r\n        __param(0, ITextModelService)\r\n    ], DataSource);\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\n//#endregion\r\nvar Delegate = /** @class */ (function () {\r\n    function Delegate() {\r\n    }\r\n    Delegate.prototype.getHeight = function () {\r\n        return 23;\r\n    };\r\n    Delegate.prototype.getTemplateId = function (element) {\r\n        if (element instanceof FileReferences) {\r\n            return FileReferencesRenderer.id;\r\n        }\r\n        else {\r\n            return OneReferenceRenderer.id;\r\n        }\r\n    };\r\n    return Delegate;\r\n}());\r\nexport { Delegate };\r\nvar StringRepresentationProvider = /** @class */ (function () {\r\n    function StringRepresentationProvider(_keybindingService) {\r\n        this._keybindingService = _keybindingService;\r\n    }\r\n    StringRepresentationProvider.prototype.getKeyboardNavigationLabel = function (element) {\r\n        if (element instanceof OneReference) {\r\n            var preview = element.parent.preview;\r\n            var parts = preview && preview.preview(element.range);\r\n            if (parts) {\r\n                return parts.value;\r\n            }\r\n        }\r\n        // FileReferences or unresolved OneReference\r\n        return basename(element.uri);\r\n    };\r\n    StringRepresentationProvider = __decorate([\r\n        __param(0, IKeybindingService)\r\n    ], StringRepresentationProvider);\r\n    return StringRepresentationProvider;\r\n}());\r\nexport { StringRepresentationProvider };\r\nvar IdentityProvider = /** @class */ (function () {\r\n    function IdentityProvider() {\r\n    }\r\n    IdentityProvider.prototype.getId = function (element) {\r\n        return element instanceof OneReference ? element.id : element.uri;\r\n    };\r\n    return IdentityProvider;\r\n}());\r\nexport { IdentityProvider };\r\n//#region render: File\r\nvar FileReferencesTemplate = /** @class */ (function (_super) {\r\n    __extends(FileReferencesTemplate, _super);\r\n    function FileReferencesTemplate(container, _uriLabel, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._uriLabel = _uriLabel;\r\n        var parent = document.createElement('div');\r\n        dom.addClass(parent, 'reference-file');\r\n        _this.file = _this._register(new IconLabel(parent, { supportHighlights: true }));\r\n        _this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\r\n        _this._register(attachBadgeStyler(_this.badge, themeService));\r\n        container.appendChild(parent);\r\n        return _this;\r\n    }\r\n    FileReferencesTemplate.prototype.set = function (element, matches) {\r\n        var parent = dirname(element.uri);\r\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches: matches });\r\n        var len = element.children.length;\r\n        this.badge.setCount(len);\r\n        if (element.failure) {\r\n            this.badge.setTitleFormat(localize('referencesFailre', \"Failed to resolve file.\"));\r\n        }\r\n        else if (len > 1) {\r\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\r\n        }\r\n        else {\r\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\r\n        }\r\n    };\r\n    FileReferencesTemplate = __decorate([\r\n        __param(1, ILabelService),\r\n        __param(2, IThemeService)\r\n    ], FileReferencesTemplate);\r\n    return FileReferencesTemplate;\r\n}(Disposable));\r\nvar FileReferencesRenderer = /** @class */ (function () {\r\n    function FileReferencesRenderer(_instantiationService) {\r\n        this._instantiationService = _instantiationService;\r\n        this.templateId = FileReferencesRenderer.id;\r\n    }\r\n    FileReferencesRenderer.prototype.renderTemplate = function (container) {\r\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\r\n    };\r\n    FileReferencesRenderer.prototype.renderElement = function (node, index, template) {\r\n        template.set(node.element, createMatches(node.filterData));\r\n    };\r\n    FileReferencesRenderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.dispose();\r\n    };\r\n    FileReferencesRenderer.id = 'FileReferencesRenderer';\r\n    FileReferencesRenderer = __decorate([\r\n        __param(0, IInstantiationService)\r\n    ], FileReferencesRenderer);\r\n    return FileReferencesRenderer;\r\n}());\r\nexport { FileReferencesRenderer };\r\n//#endregion\r\n//#region render: Reference\r\nvar OneReferenceTemplate = /** @class */ (function () {\r\n    function OneReferenceTemplate(container) {\r\n        this.label = new HighlightedLabel(container, false);\r\n    }\r\n    OneReferenceTemplate.prototype.set = function (element, score) {\r\n        var filePreview = element.parent.preview;\r\n        var preview = filePreview && filePreview.preview(element.range);\r\n        if (!preview) {\r\n            // this means we FAILED to resolve the document...\r\n            this.label.set(basename(element.uri) + \":\" + (element.range.startLineNumber + 1) + \":\" + (element.range.startColumn + 1));\r\n        }\r\n        else {\r\n            // render search match as highlight unless\r\n            // we have score, then render the score\r\n            var value = preview.value, highlight = preview.highlight;\r\n            if (score && !FuzzyScore.isDefault(score)) {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', false);\r\n                this.label.set(value, createMatches(score));\r\n            }\r\n            else {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', true);\r\n                this.label.set(value, [highlight]);\r\n            }\r\n        }\r\n    };\r\n    return OneReferenceTemplate;\r\n}());\r\nvar OneReferenceRenderer = /** @class */ (function () {\r\n    function OneReferenceRenderer() {\r\n        this.templateId = OneReferenceRenderer.id;\r\n    }\r\n    OneReferenceRenderer.prototype.renderTemplate = function (container) {\r\n        return new OneReferenceTemplate(container);\r\n    };\r\n    OneReferenceRenderer.prototype.renderElement = function (node, index, templateData) {\r\n        templateData.set(node.element, node.filterData);\r\n    };\r\n    OneReferenceRenderer.prototype.disposeTemplate = function () {\r\n    };\r\n    OneReferenceRenderer.id = 'OneReferenceRenderer';\r\n    return OneReferenceRenderer;\r\n}());\r\nexport { OneReferenceRenderer };\r\n//#endregion\r\nvar AriaProvider = /** @class */ (function () {\r\n    function AriaProvider() {\r\n    }\r\n    AriaProvider.prototype.getAriaLabel = function (element) {\r\n        return element.ariaMessage;\r\n    };\r\n    return AriaProvider;\r\n}());\r\nexport { AriaProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './referencesWidget.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Emitter, Event } from '../../../../base/common/event.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../../base/common/network.js';\r\nimport { basenameOrAuthority, dirname, isEqual } from '../../../../base/common/resources.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { AriaProvider, DataSource, Delegate, FileReferencesRenderer, OneReferenceRenderer, StringRepresentationProvider, IdentityProvider } from './referencesTree.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\r\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport * as peekView from '../../peekView/peekView.js';\r\nimport { FileReferences, OneReference } from '../referencesModel.js';\r\nimport { SplitView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\r\nvar DecorationsManager = /** @class */ (function () {\r\n    function DecorationsManager(_editor, _model) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._model = _model;\r\n        this._decorations = new Map();\r\n        this._decorationIgnoreSet = new Set();\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModelChange = new DisposableStore();\r\n        this._callOnDispose.add(this._editor.onDidChangeModel(function () { return _this._onModelChanged(); }));\r\n        this._onModelChanged();\r\n    }\r\n    DecorationsManager.prototype.dispose = function () {\r\n        this._callOnModelChange.dispose();\r\n        this._callOnDispose.dispose();\r\n        this.removeDecorations();\r\n    };\r\n    DecorationsManager.prototype._onModelChanged = function () {\r\n        this._callOnModelChange.clear();\r\n        var model = this._editor.getModel();\r\n        if (model) {\r\n            for (var _i = 0, _a = this._model.groups; _i < _a.length; _i++) {\r\n                var ref = _a[_i];\r\n                if (isEqual(ref.uri, model.uri)) {\r\n                    this._addDecorations(ref);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorationsManager.prototype._addDecorations = function (reference) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(function (event) { return _this._onDecorationChanged(); }));\r\n        var newDecorations = [];\r\n        var newDecorationsActualIndex = [];\r\n        for (var i = 0, len = reference.children.length; i < len; i++) {\r\n            var oneReference = reference.children[i];\r\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\r\n                continue;\r\n            }\r\n            newDecorations.push({\r\n                range: oneReference.range,\r\n                options: DecorationsManager.DecorationOptions\r\n            });\r\n            newDecorationsActualIndex.push(i);\r\n        }\r\n        var decorations = this._editor.deltaDecorations([], newDecorations);\r\n        for (var i = 0; i < decorations.length; i++) {\r\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\r\n        }\r\n    };\r\n    DecorationsManager.prototype._onDecorationChanged = function () {\r\n        var _this = this;\r\n        var toRemove = [];\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        this._decorations.forEach(function (reference, decorationId) {\r\n            var newRange = model.getDecorationRange(decorationId);\r\n            if (!newRange) {\r\n                return;\r\n            }\r\n            var ignore = false;\r\n            if (Range.equalsRange(newRange, reference.range)) {\r\n                return;\r\n            }\r\n            else if (Range.spansMultipleLines(newRange)) {\r\n                ignore = true;\r\n            }\r\n            else {\r\n                var lineLength = reference.range.endColumn - reference.range.startColumn;\r\n                var newLineLength = newRange.endColumn - newRange.startColumn;\r\n                if (lineLength !== newLineLength) {\r\n                    ignore = true;\r\n                }\r\n            }\r\n            if (ignore) {\r\n                _this._decorationIgnoreSet.add(reference.id);\r\n                toRemove.push(decorationId);\r\n            }\r\n            else {\r\n                reference.range = newRange;\r\n            }\r\n        });\r\n        for (var i = 0, len = toRemove.length; i < len; i++) {\r\n            this._decorations.delete(toRemove[i]);\r\n        }\r\n        this._editor.deltaDecorations(toRemove, []);\r\n    };\r\n    DecorationsManager.prototype.removeDecorations = function () {\r\n        var toRemove = [];\r\n        this._decorations.forEach(function (value, key) {\r\n            toRemove.push(key);\r\n        });\r\n        this._editor.deltaDecorations(toRemove, []);\r\n        this._decorations.clear();\r\n    };\r\n    DecorationsManager.DecorationOptions = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'reference-decoration'\r\n    });\r\n    return DecorationsManager;\r\n}());\r\nvar LayoutData = /** @class */ (function () {\r\n    function LayoutData() {\r\n        this.ratio = 0.7;\r\n        this.heightInLines = 18;\r\n    }\r\n    LayoutData.fromJSON = function (raw) {\r\n        var ratio;\r\n        var heightInLines;\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            ratio = data.ratio;\r\n            heightInLines = data.heightInLines;\r\n        }\r\n        catch (_a) {\r\n            //\r\n        }\r\n        return {\r\n            ratio: ratio || 0.7,\r\n            heightInLines: heightInLines || 18\r\n        };\r\n    };\r\n    return LayoutData;\r\n}());\r\nexport { LayoutData };\r\n/**\r\n * ZoneWidget that is shown inside the editor\r\n */\r\nvar ReferenceWidget = /** @class */ (function (_super) {\r\n    __extends(ReferenceWidget, _super);\r\n    function ReferenceWidget(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel) {\r\n        var _this = _super.call(this, editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true }) || this;\r\n        _this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        _this.layoutData = layoutData;\r\n        _this._textModelResolverService = _textModelResolverService;\r\n        _this._instantiationService = _instantiationService;\r\n        _this._peekViewService = _peekViewService;\r\n        _this._uriLabel = _uriLabel;\r\n        _this._disposeOnNewModel = new DisposableStore();\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectReference = new Emitter();\r\n        _this.onDidSelectReference = _this._onDidSelectReference.event;\r\n        _this._dim = { height: 0, width: 0 };\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._callOnDispose.add(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this._peekViewService.addExclusiveWidget(editor, _this);\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    ReferenceWidget.prototype.dispose = function () {\r\n        this.setModel(undefined);\r\n        this._callOnDispose.dispose();\r\n        this._disposeOnNewModel.dispose();\r\n        dispose(this._preview);\r\n        dispose(this._previewNotAvailableMessage);\r\n        dispose(this._tree);\r\n        dispose(this._previewModelReference);\r\n        this._splitView.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ReferenceWidget.prototype._applyTheme = function (theme) {\r\n        var borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\r\n        this.style({\r\n            arrowColor: borderColor,\r\n            frameColor: borderColor,\r\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\r\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.show = function (where) {\r\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\r\n        _super.prototype.show.call(this, where, this.layoutData.heightInLines || 18);\r\n    };\r\n    ReferenceWidget.prototype.focusOnReferenceTree = function () {\r\n        this._tree.domFocus();\r\n    };\r\n    ReferenceWidget.prototype.focusOnPreviewEditor = function () {\r\n        this._preview.focus();\r\n    };\r\n    ReferenceWidget.prototype.isPreviewEditorFocused = function () {\r\n        return this._preview.hasTextFocus();\r\n    };\r\n    ReferenceWidget.prototype._onTitleClick = function (e) {\r\n        if (this._preview && this._preview.getModel()) {\r\n            this._onDidSelectReference.fire({\r\n                element: this._getFocusedReference(),\r\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\r\n                source: 'title'\r\n            });\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._fillBody = function (containerElement) {\r\n        var _this = this;\r\n        this.setCssClass('reference-zone-widget');\r\n        // message pane\r\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\r\n        dom.hide(this._messageContainer);\r\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\r\n        // editor\r\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\r\n        var options = {\r\n            scrollBeyondLastLine: false,\r\n            scrollbar: {\r\n                verticalScrollbarSize: 14,\r\n                horizontal: 'auto',\r\n                useShadows: true,\r\n                verticalHasArrows: false,\r\n                horizontalHasArrows: false,\r\n                alwaysConsumeMouseWheel: false\r\n            },\r\n            overviewRulerLanes: 2,\r\n            fixedOverflowWidgets: true,\r\n            minimap: {\r\n                enabled: false\r\n            }\r\n        };\r\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\r\n        dom.hide(this._previewContainer);\r\n        this._previewNotAvailableMessage = TextModel.createFromString(nls.localize('missingPreviewMessage', \"no preview available\"));\r\n        // tree\r\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\r\n        var treeOptions = {\r\n            ariaLabel: nls.localize('treeAriaLabel', \"References\"),\r\n            keyboardSupport: this._defaultTreeKeyboardSupport,\r\n            accessibilityProvider: new AriaProvider(),\r\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\r\n            identityProvider: new IdentityProvider(),\r\n            overrideStyles: {\r\n                listBackground: peekView.peekViewResultsBackground\r\n            }\r\n        };\r\n        this._tree = this._instantiationService.createInstance(WorkbenchAsyncDataTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\r\n            this._instantiationService.createInstance(FileReferencesRenderer),\r\n            this._instantiationService.createInstance(OneReferenceRenderer),\r\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\r\n        // split stuff\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._previewContainer,\r\n            minimumSize: 200,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._preview.layout({ height: _this._dim.height, width: width });\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._treeContainer,\r\n            minimumSize: 100,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._treeContainer.style.height = _this._dim.height + \"px\";\r\n                _this._treeContainer.style.width = width + \"px\";\r\n                _this._tree.layout(_this._dim.height, width);\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._disposables.add(this._splitView.onDidSashChange(function () {\r\n            if (_this._dim.width) {\r\n                _this.layoutData.ratio = _this._splitView.getViewSize(0) / _this._dim.width;\r\n            }\r\n        }, undefined));\r\n        // listen on selection and focus\r\n        var onEvent = function (element, kind) {\r\n            if (element instanceof OneReference) {\r\n                if (kind === 'show') {\r\n                    _this._revealReference(element, false);\r\n                }\r\n                _this._onDidSelectReference.fire({ element: element, kind: kind, source: 'tree' });\r\n            }\r\n        };\r\n        this._tree.onDidChangeFocus(function (e) {\r\n            onEvent(e.elements[0], 'show');\r\n        });\r\n        this._tree.onDidOpen(function (e) {\r\n            if (e.browserEvent instanceof MouseEvent && (e.browserEvent.ctrlKey || e.browserEvent.metaKey || e.browserEvent.altKey)) {\r\n                // modifier-click -> open to the side\r\n                onEvent(e.elements[0], 'side');\r\n            }\r\n            else if (e.browserEvent instanceof KeyboardEvent || (e.browserEvent instanceof MouseEvent && e.browserEvent.detail === 2) || e.browserEvent.tapCount === 2) {\r\n                // keybinding (list service command)\r\n                // OR double click\r\n                // OR double tap\r\n                // -> close widget and goto target\r\n                onEvent(e.elements[0], 'goto');\r\n            }\r\n            else {\r\n                // preview location\r\n                onEvent(e.elements[0], 'show');\r\n            }\r\n        });\r\n        dom.hide(this._treeContainer);\r\n    };\r\n    ReferenceWidget.prototype._onWidth = function (width) {\r\n        if (this._dim) {\r\n            this._doLayoutBody(this._dim.height, width);\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._dim = { height: heightInPixel, width: widthInPixel };\r\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\r\n        this._splitView.layout(widthInPixel);\r\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\r\n    };\r\n    ReferenceWidget.prototype.setSelection = function (selection) {\r\n        var _this = this;\r\n        return this._revealReference(selection, true).then(function () {\r\n            if (!_this._model) {\r\n                // disposed\r\n                return;\r\n            }\r\n            // show in tree\r\n            _this._tree.setSelection([selection]);\r\n            _this._tree.setFocus([selection]);\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.setModel = function (newModel) {\r\n        // clean up\r\n        this._disposeOnNewModel.clear();\r\n        this._model = newModel;\r\n        if (this._model) {\r\n            return this._onNewModel();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    ReferenceWidget.prototype._onNewModel = function () {\r\n        var _this = this;\r\n        if (!this._model) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        if (this._model.isEmpty) {\r\n            this.setTitle('');\r\n            this._messageContainer.innerHTML = nls.localize('noResults', \"No results\");\r\n            dom.show(this._messageContainer);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        dom.hide(this._messageContainer);\r\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\r\n        this._disposeOnNewModel.add(this._decorationsManager);\r\n        // listen on model changes\r\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(function (reference) { return _this._tree.rerender(reference); }));\r\n        // listen on editor\r\n        this._disposeOnNewModel.add(this._preview.onMouseDown(function (e) {\r\n            var event = e.event, target = e.target;\r\n            if (event.detail !== 2) {\r\n                return;\r\n            }\r\n            var element = _this._getFocusedReference();\r\n            if (!element) {\r\n                return;\r\n            }\r\n            _this._onDidSelectReference.fire({\r\n                element: { uri: element.uri, range: target.range },\r\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\r\n                source: 'editor'\r\n            });\r\n        }));\r\n        // make sure things are rendered\r\n        dom.addClass(this.container, 'results-loaded');\r\n        dom.show(this._treeContainer);\r\n        dom.show(this._previewContainer);\r\n        this._splitView.layout(this._dim.width);\r\n        this.focusOnReferenceTree();\r\n        // pick input and a reference to begin with\r\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\r\n    };\r\n    ReferenceWidget.prototype._getFocusedReference = function () {\r\n        var element = this._tree.getFocus()[0];\r\n        if (element instanceof OneReference) {\r\n            return element;\r\n        }\r\n        else if (element instanceof FileReferences) {\r\n            if (element.children.length > 0) {\r\n                return element.children[0];\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferenceWidget.prototype._revealReference = function (reference, revealParent) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promise, ref, model, scrollType, sel;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // check if there is anything to do...\r\n                        if (this._revealedReference === reference) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this._revealedReference = reference;\r\n                        // Update widget header\r\n                        if (reference.uri.scheme !== Schemas.inMemory) {\r\n                            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\r\n                        }\r\n                        else {\r\n                            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\r\n                        }\r\n                        promise = this._textModelResolverService.createModelReference(reference.uri);\r\n                        if (!(this._tree.getInput() === reference.parent)) return [3 /*break*/, 1];\r\n                        this._tree.reveal(reference);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        if (revealParent) {\r\n                            this._tree.reveal(reference.parent);\r\n                        }\r\n                        return [4 /*yield*/, this._tree.expand(reference.parent)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this._tree.reveal(reference);\r\n                        _a.label = 3;\r\n                    case 3: return [4 /*yield*/, promise];\r\n                    case 4:\r\n                        ref = _a.sent();\r\n                        if (!this._model) {\r\n                            // disposed\r\n                            ref.dispose();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        dispose(this._previewModelReference);\r\n                        model = ref.object;\r\n                        if (model) {\r\n                            scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\r\n                            sel = Range.lift(reference.range).collapseToStart();\r\n                            this._previewModelReference = ref;\r\n                            this._preview.setModel(model.textEditorModel);\r\n                            this._preview.setSelection(sel);\r\n                            this._preview.revealRangeInCenter(sel, scrollType);\r\n                        }\r\n                        else {\r\n                            this._preview.setModel(this._previewNotAvailableMessage);\r\n                            ref.dispose();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferenceWidget = __decorate([\r\n        __param(3, IThemeService),\r\n        __param(4, ITextModelService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, peekView.IPeekViewService),\r\n        __param(7, ILabelService)\r\n    ], ReferenceWidget);\r\n    return ReferenceWidget;\r\n}(peekView.PeekViewWidget));\r\nexport { ReferenceWidget };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\r\n    if (findMatchHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: \" + findMatchHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\r\n    if (referenceHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: \" + referenceHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\r\n    if (referenceHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid \" + referenceHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var hcOutline = theme.getColor(activeContrastBorder);\r\n    if (hcOutline) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted \" + hcOutline + \"; box-sizing: border-box; }\");\r\n    }\r\n    var resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\r\n    if (resultsBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { background-color: \" + resultsBackground + \"; }\");\r\n    }\r\n    var resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\r\n    if (resultsMatchForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { color: \" + resultsMatchForeground + \"; }\");\r\n    }\r\n    var resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\r\n    if (resultsFileForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .reference-file { color: \" + resultsFileForeground + \"; }\");\r\n    }\r\n    var resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\r\n    if (resultsSelectedBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: \" + resultsSelectedBackground + \"; }\");\r\n    }\r\n    var resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\r\n    if (resultsSelectedForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: \" + resultsSelectedForeground + \" !important; }\");\r\n    }\r\n    var editorBackground = theme.getColor(peekView.peekViewEditorBackground);\r\n    if (editorBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,\" +\r\n            \".monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {\" +\r\n            (\"\\tbackground-color: \" + editorBackground + \";\") +\r\n            \"}\");\r\n    }\r\n    var editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\r\n    if (editorGutterBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .margin {\" +\r\n            (\"\\tbackground-color: \" + editorGutterBackground + \";\") +\r\n            \"}\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../../nls.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IContextKeyService, RawContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nimport { OneReference } from '../referencesModel.js';\r\nimport { ReferenceWidget, LayoutData } from './referencesWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { getOuterEditor, PeekContext } from '../../peekView/peekView.js';\r\nimport { IListService, WorkbenchListFocusContextKey } from '../../../../platform/list/browser/listService.js';\r\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\r\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\r\nexport var ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false);\r\nvar ReferencesController = /** @class */ (function () {\r\n    function ReferencesController(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\r\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        this._editor = _editor;\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._instantiationService = _instantiationService;\r\n        this._storageService = _storageService;\r\n        this._configurationService = _configurationService;\r\n        this._disposables = new DisposableStore();\r\n        this._requestIdPool = 0;\r\n        this._ignoreModelChangeEvent = false;\r\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\r\n    }\r\n    ReferencesController.get = function (editor) {\r\n        return editor.getContribution(ReferencesController.ID);\r\n    };\r\n    ReferencesController.prototype.dispose = function () {\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.dispose();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n    };\r\n    ReferencesController.prototype.toggleWidget = function (range, modelPromise, peekMode) {\r\n        var _this = this;\r\n        // close current widget and return early is position didn't change\r\n        var widgetPosition;\r\n        if (this._widget) {\r\n            widgetPosition = this._widget.position;\r\n        }\r\n        this.closeWidget();\r\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\r\n            return;\r\n        }\r\n        this._peekMode = peekMode;\r\n        this._referenceSearchVisible.set(true);\r\n        // close the widget on model/mode changes\r\n        this._disposables.add(this._editor.onDidChangeModelLanguage(function () { _this.closeWidget(); }));\r\n        this._disposables.add(this._editor.onDidChangeModel(function () {\r\n            if (!_this._ignoreModelChangeEvent) {\r\n                _this.closeWidget();\r\n            }\r\n        }));\r\n        var storageKey = 'peekViewLayout';\r\n        var data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* GLOBAL */, '{}'));\r\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\r\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\r\n        this._widget.show(range);\r\n        this._disposables.add(this._widget.onDidClose(function () {\r\n            modelPromise.cancel();\r\n            if (_this._widget) {\r\n                _this._storageService.store(storageKey, JSON.stringify(_this._widget.layoutData), 0 /* GLOBAL */);\r\n                _this._widget = undefined;\r\n            }\r\n            _this.closeWidget();\r\n        }));\r\n        this._disposables.add(this._widget.onDidSelectReference(function (event) {\r\n            var element = event.element, kind = event.kind;\r\n            if (!element) {\r\n                return;\r\n            }\r\n            switch (kind) {\r\n                case 'open':\r\n                    if (event.source !== 'editor' || !_this._configurationService.getValue('editor.stablePeek')) {\r\n                        // when stable peek is configured we don't close\r\n                        // the peek window on selecting the editor\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n                case 'side':\r\n                    _this.openReference(element, true);\r\n                    break;\r\n                case 'goto':\r\n                    if (peekMode) {\r\n                        _this._gotoReference(element);\r\n                    }\r\n                    else {\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n            }\r\n        }));\r\n        var requestId = ++this._requestIdPool;\r\n        modelPromise.then(function (model) {\r\n            // still current request? widget still open?\r\n            if (requestId !== _this._requestIdPool || !_this._widget) {\r\n                return undefined;\r\n            }\r\n            if (_this._model) {\r\n                _this._model.dispose();\r\n            }\r\n            _this._model = model;\r\n            // show widget\r\n            return _this._widget.setModel(_this._model).then(function () {\r\n                if (_this._widget && _this._model && _this._editor.hasModel()) { // might have been closed\r\n                    // set title\r\n                    if (!_this._model.isEmpty) {\r\n                        _this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", _this._model.title, _this._model.references.length));\r\n                    }\r\n                    else {\r\n                        _this._widget.setMetaTitle('');\r\n                    }\r\n                    // set 'best' selection\r\n                    var uri = _this._editor.getModel().uri;\r\n                    var pos = new Position(range.startLineNumber, range.startColumn);\r\n                    var selection = _this._model.nearestReference(uri, pos);\r\n                    if (selection) {\r\n                        return _this._widget.setSelection(selection).then(function () {\r\n                            if (_this._widget && _this._editor.getOption(65 /* peekWidgetDefaultFocus */) === 'editor') {\r\n                                _this._widget.focusOnPreviewEditor();\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                return undefined;\r\n            });\r\n        }, function (error) {\r\n            _this._notificationService.error(error);\r\n        });\r\n    };\r\n    ReferencesController.prototype.changeFocusBetweenPreviewAndReferences = function () {\r\n        if (!this._widget) {\r\n            // can be called while still resolving...\r\n            return;\r\n        }\r\n        if (this._widget.isPreviewEditorFocused()) {\r\n            this._widget.focusOnReferenceTree();\r\n        }\r\n        else {\r\n            this._widget.focusOnPreviewEditor();\r\n        }\r\n    };\r\n    ReferencesController.prototype.goToNextOrPreviousReference = function (fwd) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var currentPosition, source, target, editorFocus, previewEditorFocus;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._editor.hasModel() || !this._model || !this._widget) {\r\n                            // can be called while still resolving...\r\n                            return [2 /*return*/];\r\n                        }\r\n                        currentPosition = this._widget.position;\r\n                        if (!currentPosition) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\r\n                        if (!source) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        target = this._model.nextOrPreviousReference(source, fwd);\r\n                        editorFocus = this._editor.hasTextFocus();\r\n                        previewEditorFocus = this._widget.isPreviewEditorFocused();\r\n                        return [4 /*yield*/, this._widget.setSelection(target)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, this._gotoReference(target)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        if (editorFocus) {\r\n                            this._editor.focus();\r\n                        }\r\n                        else if (this._widget && previewEditorFocus) {\r\n                            this._widget.focusOnPreviewEditor();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferencesController.prototype.closeWidget = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.clear();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n        this._requestIdPool += 1; // Cancel pending requests\r\n    };\r\n    ReferencesController.prototype._gotoReference = function (ref) {\r\n        var _this = this;\r\n        if (this._widget) {\r\n            this._widget.hide();\r\n        }\r\n        this._ignoreModelChangeEvent = true;\r\n        var range = Range.lift(ref.range).collapseToStart();\r\n        return this._editorService.openCodeEditor({\r\n            resource: ref.uri,\r\n            options: { selection: range }\r\n        }, this._editor).then(function (openedEditor) {\r\n            var _a;\r\n            _this._ignoreModelChangeEvent = false;\r\n            if (!openedEditor || !_this._widget) {\r\n                // something went wrong...\r\n                _this.closeWidget();\r\n                return;\r\n            }\r\n            if (_this._editor === openedEditor) {\r\n                //\r\n                _this._widget.show(range);\r\n                _this._widget.focusOnReferenceTree();\r\n            }\r\n            else {\r\n                // we opened a different editor instance which means a different controller instance.\r\n                // therefore we stop with this controller and continue with the other\r\n                var other = ReferencesController.get(openedEditor);\r\n                var model_1 = _this._model.clone();\r\n                _this.closeWidget();\r\n                openedEditor.focus();\r\n                other.toggleWidget(range, createCancelablePromise(function (_) { return Promise.resolve(model_1); }), (_a = _this._peekMode) !== null && _a !== void 0 ? _a : false);\r\n            }\r\n        }, function (err) {\r\n            _this._ignoreModelChangeEvent = false;\r\n            onUnexpectedError(err);\r\n        });\r\n    };\r\n    ReferencesController.prototype.openReference = function (ref, sideBySide) {\r\n        // clear stage\r\n        if (!sideBySide) {\r\n            this.closeWidget();\r\n        }\r\n        var uri = ref.uri, range = ref.range;\r\n        this._editorService.openCodeEditor({\r\n            resource: uri,\r\n            options: { selection: range }\r\n        }, this._editor, sideBySide);\r\n    };\r\n    ReferencesController.ID = 'editor.contrib.referencesController';\r\n    ReferencesController = __decorate([\r\n        __param(2, IContextKeyService),\r\n        __param(3, ICodeEditorService),\r\n        __param(4, INotificationService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, IStorageService),\r\n        __param(7, IConfigurationService)\r\n    ], ReferencesController);\r\n    return ReferencesController;\r\n}());\r\nexport { ReferencesController };\r\nfunction withController(accessor, fn) {\r\n    var outerEditor = getOuterEditor(accessor);\r\n    if (!outerEditor) {\r\n        return;\r\n    }\r\n    var controller = ReferencesController.get(outerEditor);\r\n    if (controller) {\r\n        fn(controller);\r\n    }\r\n}\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'togglePeekWidgetFocus',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 60 /* F2 */),\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.changeFocusBetweenPreviewAndReferences();\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToNextReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 62 /* F4 */,\r\n    secondary: [70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(true);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToPreviousReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 1024 /* Shift */ | 62 /* F4 */,\r\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(false);\r\n        });\r\n    }\r\n});\r\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\r\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\r\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\r\n// close\r\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\r\nCommandsRegistry.registerCommand('closeReferenceSearch', function (accessor) { return withController(accessor, function (controller) { return controller.closeWidget(); }); });\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 100 /* EditorContrib */ - 101,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'openReferenceToSide',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n    mac: {\r\n        primary: 256 /* WinCtrl */ | 3 /* Enter */\r\n    },\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey),\r\n    handler: function (accessor) {\r\n        var _a;\r\n        var listService = accessor.get(IListService);\r\n        var focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n            withController(accessor, function (controller) { return controller.openReference(focus[0], true); });\r\n        }\r\n    }\r\n});\r\nCommandsRegistry.registerCommand('openReference', function (accessor) {\r\n    var _a;\r\n    var listService = accessor.get(IListService);\r\n    var focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n        withController(accessor, function (controller) { return controller.openReference(focus[0], false); });\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { flatten, coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { DefinitionProviderRegistry, ImplementationProviderRegistry, TypeDefinitionProviderRegistry, DeclarationProviderRegistry, ReferenceProviderRegistry } from '../../common/modes.js';\r\nfunction getLocationLinks(model, position, registry, provide) {\r\n    var provider = registry.ordered(model);\r\n    // get results\r\n    var promises = provider.map(function (provider) {\r\n        return Promise.resolve(provide(provider, model, position)).then(undefined, function (err) {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises)\r\n        .then(flatten)\r\n        .then(coalesce);\r\n}\r\nexport function getDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getDeclarationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DeclarationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDeclaration(model, position, token);\r\n    });\r\n}\r\nexport function getImplementationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, ImplementationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideImplementation(model, position, token);\r\n    });\r\n}\r\nexport function getTypeDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, TypeDefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideTypeDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getReferencesAtPosition(model, position, compact, token) {\r\n    var _this = this;\r\n    return getLocationLinks(model, position, ReferenceProviderRegistry, function (provider, model, position) { return __awaiter(_this, void 0, void 0, function () {\r\n        var result, resultWithoutDeclaration;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: true }, token)];\r\n                case 1:\r\n                    result = _a.sent();\r\n                    if (!compact || !result || result.length !== 2) {\r\n                        return [2 /*return*/, result];\r\n                    }\r\n                    return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: false }, token)];\r\n                case 2:\r\n                    resultWithoutDeclaration = _a.sent();\r\n                    if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\r\n                        return [2 /*return*/, resultWithoutDeclaration];\r\n                    }\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    }); });\r\n}\r\nregisterModelAndPositionCommand('_executeDefinitionProvider', function (model, position) { return getDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeDeclarationProvider', function (model, position) { return getDeclarationsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeImplementationProvider', function (model, position) { return getImplementationsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', function (model, position) { return getTypeDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeReferenceProvider', function (model, position) { return getReferencesAtPosition(model, position, false, CancellationToken.None); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { registerEditorCommand, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { dispose, combinedDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport var ctxHasSymbols = new RawContextKey('hasSymbols', false);\r\nexport var ISymbolNavigationService = createDecorator('ISymbolNavigationService');\r\nvar SymbolNavigationService = /** @class */ (function () {\r\n    function SymbolNavigationService(contextKeyService, _editorService, _notificationService, _keybindingService) {\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._keybindingService = _keybindingService;\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n        this._ignoreEditorChange = false;\r\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\r\n    }\r\n    SymbolNavigationService.prototype.reset = function () {\r\n        this._ctxHasSymbols.reset();\r\n        dispose(this._currentState);\r\n        dispose(this._currentMessage);\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n    };\r\n    SymbolNavigationService.prototype.put = function (anchor) {\r\n        var _this = this;\r\n        var refModel = anchor.parent.parent;\r\n        if (refModel.references.length <= 1) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._currentModel = refModel;\r\n        this._currentIdx = refModel.references.indexOf(anchor);\r\n        this._ctxHasSymbols.set(true);\r\n        this._showMessage();\r\n        var editorState = new EditorState(this._editorService);\r\n        var listener = editorState.onDidChange(function (_) {\r\n            if (_this._ignoreEditorChange) {\r\n                return;\r\n            }\r\n            var editor = _this._editorService.getActiveCodeEditor();\r\n            if (!editor) {\r\n                return;\r\n            }\r\n            var model = editor.getModel();\r\n            var position = editor.getPosition();\r\n            if (!model || !position) {\r\n                return;\r\n            }\r\n            var seenUri = false;\r\n            var seenPosition = false;\r\n            for (var _i = 0, _a = refModel.references; _i < _a.length; _i++) {\r\n                var reference = _a[_i];\r\n                if (isEqual(reference.uri, model.uri)) {\r\n                    seenUri = true;\r\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\r\n                }\r\n                else if (seenUri) {\r\n                    break;\r\n                }\r\n            }\r\n            if (!seenUri || !seenPosition) {\r\n                _this.reset();\r\n            }\r\n        });\r\n        this._currentState = combinedDisposable(editorState, listener);\r\n    };\r\n    SymbolNavigationService.prototype.revealNext = function (source) {\r\n        var _this = this;\r\n        if (!this._currentModel) {\r\n            return Promise.resolve();\r\n        }\r\n        // get next result and advance\r\n        this._currentIdx += 1;\r\n        this._currentIdx %= this._currentModel.references.length;\r\n        var reference = this._currentModel.references[this._currentIdx];\r\n        // status\r\n        this._showMessage();\r\n        // open editor, ignore events while that happens\r\n        this._ignoreEditorChange = true;\r\n        return this._editorService.openCodeEditor({\r\n            resource: reference.uri,\r\n            options: {\r\n                selection: Range.collapseToStart(reference.range),\r\n                revealInCenterIfOutsideViewport: true\r\n            }\r\n        }, source).finally(function () {\r\n            _this._ignoreEditorChange = false;\r\n        });\r\n    };\r\n    SymbolNavigationService.prototype._showMessage = function () {\r\n        dispose(this._currentMessage);\r\n        var kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\r\n        var message = kb\r\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\r\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\r\n        this._currentMessage = this._notificationService.status(message);\r\n    };\r\n    SymbolNavigationService = __decorate([\r\n        __param(0, IContextKeyService),\r\n        __param(1, ICodeEditorService),\r\n        __param(2, INotificationService),\r\n        __param(3, IKeybindingService)\r\n    ], SymbolNavigationService);\r\n    return SymbolNavigationService;\r\n}());\r\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\r\nregisterEditorCommand(new /** @class */ (function (_super) {\r\n    __extends(class_1, _super);\r\n    function class_1() {\r\n        return _super.call(this, {\r\n            id: 'editor.gotoNextSymbolFromResult',\r\n            precondition: ctxHasSymbols,\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 70 /* F12 */\r\n            }\r\n        }) || this;\r\n    }\r\n    class_1.prototype.runEditorCommand = function (accessor, editor) {\r\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\r\n    };\r\n    return class_1;\r\n}(EditorCommand)));\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'editor.gotoNextSymbolFromResult.cancel',\r\n    weight: 100 /* EditorContrib */,\r\n    when: ctxHasSymbols,\r\n    primary: 9 /* Escape */,\r\n    handler: function (accessor) {\r\n        accessor.get(ISymbolNavigationService).reset();\r\n    }\r\n});\r\n//\r\nvar EditorState = /** @class */ (function () {\r\n    function EditorState(editorService) {\r\n        this._listener = new Map();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\r\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\r\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\r\n    }\r\n    EditorState.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._onDidChange.dispose();\r\n        this._listener.forEach(dispose);\r\n    };\r\n    EditorState.prototype._onDidAddEditor = function (editor) {\r\n        var _this = this;\r\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(function (_) { return _this._onDidChange.fire({ editor: editor }); }), editor.onDidChangeModelContent(function (_) { return _this._onDidChange.fire({ editor: editor }); })));\r\n    };\r\n    EditorState.prototype._onDidRemoveEditor = function (editor) {\r\n        dispose(this._listener.get(editor));\r\n        this._listener.delete(editor);\r\n    };\r\n    EditorState = __decorate([\r\n        __param(0, ICodeEditorService)\r\n    ], EditorState);\r\n    return EditorState;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar _a, _b, _c, _d, _e, _f, _g, _h;\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { createCancelablePromise, raceCancellation } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { isWeb } from '../../../base/common/platform.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport * as corePosition from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { isLocationLink } from '../../common/modes.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { PeekContext } from '../peekView/peekView.js';\r\nimport { ReferencesController } from './peek/referencesController.js';\r\nimport { ReferencesModel } from './referencesModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from './goToSymbol.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { ISymbolNavigationService } from './symbolNavigation.js';\r\nimport { isStandalone } from '../../../base/browser/browser.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nMenuRegistry.appendMenuItem(7 /* EditorContext */, {\r\n    submenu: 8 /* EditorContextPeek */,\r\n    title: nls.localize('peek.submenu', \"Peek\"),\r\n    group: 'navigation',\r\n    order: 100\r\n});\r\nvar SymbolNavigationAction = /** @class */ (function (_super) {\r\n    __extends(SymbolNavigationAction, _super);\r\n    function SymbolNavigationAction(configuration, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._configuration = configuration;\r\n        return _this;\r\n    }\r\n    SymbolNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var notificationService = accessor.get(INotificationService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var progressService = accessor.get(IEditorProgressService);\r\n        var symbolNavService = accessor.get(ISymbolNavigationService);\r\n        var model = editor.getModel();\r\n        var pos = editor.getPosition();\r\n        var cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\r\n        var promise = raceCancellation(this._getLocationModel(model, pos, cts.token), cts.token).then(function (references) { return __awaiter(_this, void 0, void 0, function () {\r\n            var altAction, altActionId, referenceCount, info;\r\n            return __generator(this, function (_a) {\r\n                if (!references || cts.token.isCancellationRequested) {\r\n                    return [2 /*return*/];\r\n                }\r\n                alert(references.ariaMessage);\r\n                if (references.referenceAt(model.uri, pos)) {\r\n                    altActionId = this._getAlternativeCommand(editor);\r\n                    if (altActionId !== this.id) {\r\n                        altAction = editor.getAction(altActionId);\r\n                    }\r\n                }\r\n                referenceCount = references.references.length;\r\n                if (referenceCount === 0) {\r\n                    // no result -> show message\r\n                    if (!this._configuration.muteMessage) {\r\n                        info = model.getWordAtPosition(pos);\r\n                        MessageController.get(editor).showMessage(this._getNoResultFoundMessage(info), pos);\r\n                    }\r\n                }\r\n                else if (referenceCount === 1 && altAction) {\r\n                    // already at the only result, run alternative\r\n                    altAction.run();\r\n                }\r\n                else {\r\n                    // normal results handling\r\n                    return [2 /*return*/, this._onResult(editorService, symbolNavService, editor, references)];\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        }); }, function (err) {\r\n            // report an error\r\n            notificationService.error(err);\r\n        }).finally(function () {\r\n            cts.dispose();\r\n        });\r\n        progressService.showWhile(promise, 250);\r\n        return promise;\r\n    };\r\n    SymbolNavigationAction.prototype._onResult = function (editorService, symbolNavService, editor, model) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var gotoLocation, next, peek, targetEditor;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        gotoLocation = this._getGoToPreference(editor);\r\n                        if (!(!(editor instanceof EmbeddedCodeEditorWidget) && (this._configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1)))) return [3 /*break*/, 1];\r\n                        this._openInPeek(editor, model);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        next = model.firstReference();\r\n                        peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\r\n                        return [4 /*yield*/, this._openReference(editor, editorService, next, this._configuration.openToSide, !peek)];\r\n                    case 2:\r\n                        targetEditor = _a.sent();\r\n                        if (peek && targetEditor) {\r\n                            this._openInPeek(targetEditor, model);\r\n                        }\r\n                        else {\r\n                            model.dispose();\r\n                        }\r\n                        // keep remaining locations around when using\r\n                        // 'goto'-mode\r\n                        if (gotoLocation === 'goto') {\r\n                            symbolNavService.put(next);\r\n                        }\r\n                        _a.label = 3;\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openReference = function (editor, editorService, reference, sideBySide, highlight) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var range, targetEditor, modelNow_1, ids_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        range = undefined;\r\n                        if (isLocationLink(reference)) {\r\n                            range = reference.targetSelectionRange;\r\n                        }\r\n                        if (!range) {\r\n                            range = reference.range;\r\n                        }\r\n                        return [4 /*yield*/, editorService.openCodeEditor({\r\n                                resource: reference.uri,\r\n                                options: {\r\n                                    selection: Range.collapseToStart(range),\r\n                                    revealInCenterIfOutsideViewport: true\r\n                                }\r\n                            }, editor, sideBySide)];\r\n                    case 1:\r\n                        targetEditor = _a.sent();\r\n                        if (!targetEditor) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (highlight) {\r\n                            modelNow_1 = targetEditor.getModel();\r\n                            ids_1 = targetEditor.deltaDecorations([], [{ range: range, options: { className: 'symbolHighlight' } }]);\r\n                            setTimeout(function () {\r\n                                if (targetEditor.getModel() === modelNow_1) {\r\n                                    targetEditor.deltaDecorations(ids_1, []);\r\n                                }\r\n                            }, 350);\r\n                        }\r\n                        return [2 /*return*/, targetEditor];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openInPeek = function (target, model) {\r\n        var controller = ReferencesController.get(target);\r\n        if (controller && target.hasModel()) {\r\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(function (_) { return Promise.resolve(model); }), this._configuration.openInPeek);\r\n        }\r\n        else {\r\n            model.dispose();\r\n        }\r\n    };\r\n    return SymbolNavigationAction;\r\n}(EditorAction));\r\n//#region --- DEFINITION\r\nvar DefinitionAction = /** @class */ (function (_super) {\r\n    __extends(DefinitionAction, _super);\r\n    function DefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('def.title', 'Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\r\n            : nls.localize('generic.noResults', \"No definition found\");\r\n    };\r\n    DefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeDefinitionCommand;\r\n    };\r\n    DefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleDefinitions;\r\n    };\r\n    return DefinitionAction;\r\n}(SymbolNavigationAction));\r\nexport { DefinitionAction };\r\nvar goToDefinitionKb = isWeb && !isStandalone\r\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\r\n    : 70 /* F12 */;\r\nregisterEditorAction((_a = /** @class */ (function (_super) {\r\n        __extends(GoToDefinitionAction, _super);\r\n        function GoToDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDefinitionAction.id,\r\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\r\n                alias: 'Go to Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: goToDefinitionKb,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.1\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 2,\r\n                    title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return GoToDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _a.id = 'editor.action.revealDefinition',\r\n    _a));\r\nregisterEditorAction((_b = /** @class */ (function (_super) {\r\n        __extends(OpenDefinitionToSideAction, _super);\r\n        function OpenDefinitionToSideAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: true,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: OpenDefinitionToSideAction.id,\r\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\r\n                alias: 'Open Definition to the Side',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, goToDefinitionKb),\r\n                    weight: 100 /* EditorContrib */\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\r\n            return _this;\r\n        }\r\n        return OpenDefinitionToSideAction;\r\n    }(DefinitionAction)),\r\n    _b.id = 'editor.action.revealDefinitionAside',\r\n    _b));\r\nregisterEditorAction((_c = /** @class */ (function (_super) {\r\n        __extends(PeekDefinitionAction, _super);\r\n        function PeekDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekDefinitionAction.id,\r\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\r\n                alias: 'Peek Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 512 /* Alt */ | 70 /* F12 */,\r\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 2\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return PeekDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _c.id = 'editor.action.peekDefinition',\r\n    _c));\r\n//#endregion\r\n//#region --- DECLARATION\r\nvar DeclarationAction = /** @class */ (function (_super) {\r\n    __extends(DeclarationAction, _super);\r\n    function DeclarationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeclarationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDeclarationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('decl.title', 'Declarations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n    };\r\n    DeclarationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeDeclarationCommand;\r\n    };\r\n    DeclarationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleDeclarations;\r\n    };\r\n    return DeclarationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_d = /** @class */ (function (_super) {\r\n        __extends(GoToDeclarationAction, _super);\r\n        function GoToDeclarationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDeclarationAction.id,\r\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\r\n                alias: 'Go to Declaration',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.3\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\r\n                },\r\n            }) || this;\r\n        }\r\n        GoToDeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n            return info && info.word\r\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n        };\r\n        return GoToDeclarationAction;\r\n    }(DeclarationAction)),\r\n    _d.id = 'editor.action.revealDeclaration',\r\n    _d));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekDeclarationAction, _super);\r\n    function PeekDeclarationAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.peekDeclaration',\r\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\r\n            alias: 'Peek Declaration',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return PeekDeclarationAction;\r\n}(DeclarationAction)));\r\n//#endregion\r\n//#region --- TYPE DEFINITION\r\nvar TypeDefinitionAction = /** @class */ (function (_super) {\r\n    __extends(TypeDefinitionAction, _super);\r\n    function TypeDefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    TypeDefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getTypeDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('typedef.title', 'Type Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TypeDefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\r\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\r\n    };\r\n    TypeDefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeTypeDefinitionCommand;\r\n    };\r\n    TypeDefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleTypeDefinitions;\r\n    };\r\n    return TypeDefinitionAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_e = /** @class */ (function (_super) {\r\n        __extends(GoToTypeDefinitionAction, _super);\r\n        function GoToTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\r\n                alias: 'Go to Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 0,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.4\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _e.ID = 'editor.action.goToTypeDefinition',\r\n    _e));\r\nregisterEditorAction((_f = /** @class */ (function (_super) {\r\n        __extends(PeekTypeDefinitionAction, _super);\r\n        function PeekTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\r\n                alias: 'Peek Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 4\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _f.ID = 'editor.action.peekTypeDefinition',\r\n    _f));\r\n//#endregion\r\n//#region --- IMPLEMENTATION\r\nvar ImplementationAction = /** @class */ (function (_super) {\r\n    __extends(ImplementationAction, _super);\r\n    function ImplementationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ImplementationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getImplementationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('impl.title', 'Implementations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ImplementationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\r\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\r\n    };\r\n    ImplementationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeImplementationCommand;\r\n    };\r\n    ImplementationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleImplementations;\r\n    };\r\n    return ImplementationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_g = /** @class */ (function (_super) {\r\n        __extends(GoToImplementationAction, _super);\r\n        function GoToImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToImplementationAction.ID,\r\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\r\n                alias: 'Go to Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 4,\r\n                    title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.45\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToImplementationAction;\r\n    }(ImplementationAction)),\r\n    _g.ID = 'editor.action.goToImplementation',\r\n    _g));\r\nregisterEditorAction((_h = /** @class */ (function (_super) {\r\n        __extends(PeekImplementationAction, _super);\r\n        function PeekImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekImplementationAction.ID,\r\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\r\n                alias: 'Peek Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 5\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekImplementationAction;\r\n    }(ImplementationAction)),\r\n    _h.ID = 'editor.action.peekImplementation',\r\n    _h));\r\n//#endregion\r\n//#region --- REFERENCES\r\nvar ReferencesAction = /** @class */ (function (_super) {\r\n    __extends(ReferencesAction, _super);\r\n    function ReferencesAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ReferencesAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info\r\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\r\n            : nls.localize('references.noGeneric', \"No references found\");\r\n    };\r\n    ReferencesAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeReferenceCommand;\r\n    };\r\n    ReferencesAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleReferences;\r\n    };\r\n    return ReferencesAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(GoToReferencesAction, _super);\r\n    function GoToReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: false,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.goToReferences',\r\n            label: nls.localize('goToReferences.label', \"Go to References\"),\r\n            alias: 'Go to References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 70 /* F12 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 1.45\r\n            },\r\n            menuOpts: {\r\n                menuId: 19 /* MenubarGoMenu */,\r\n                group: '4_symbol_nav',\r\n                order: 5,\r\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\r\n            },\r\n        }) || this;\r\n    }\r\n    GoToReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, true, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return GoToReferencesAction;\r\n}(ReferencesAction)));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekReferencesAction, _super);\r\n    function PeekReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.referenceSearch.trigger',\r\n            label: nls.localize('references.action.label', \"Peek References\"),\r\n            alias: 'Peek References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    PeekReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, false, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return PeekReferencesAction;\r\n}(ReferencesAction)));\r\n//#endregion\r\n//#region --- GENERIC goto symbols command\r\nvar GenericGoToLocationAction = /** @class */ (function (_super) {\r\n    __extends(GenericGoToLocationAction, _super);\r\n    function GenericGoToLocationAction(config, _references, _gotoMultipleBehaviour) {\r\n        var _this = _super.call(this, config, {\r\n            id: 'editor.action.goToLocation',\r\n            label: nls.localize('label.generic', \"Go To Any Symbol\"),\r\n            alias: 'Go To Any Symbol',\r\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n        }) || this;\r\n        _this._references = _references;\r\n        _this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\r\n        return _this;\r\n    }\r\n    GenericGoToLocationAction.prototype._getLocationModel = function (_model, _position, _token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/, new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'))];\r\n            });\r\n        });\r\n    };\r\n    GenericGoToLocationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\r\n    };\r\n    GenericGoToLocationAction.prototype._getGoToPreference = function (editor) {\r\n        var _a;\r\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(41 /* gotoLocation */).multipleReferences;\r\n    };\r\n    GenericGoToLocationAction.prototype._getAlternativeCommand = function () { return ''; };\r\n    return GenericGoToLocationAction;\r\n}(SymbolNavigationAction));\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.goToLocations',\r\n    description: {\r\n        description: 'Go to locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: function (accessor, resource, position, references, multiple, openInPeek) { return __awaiter(void 0, void 0, void 0, function () {\r\n        var editorService, editor;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    assertType(URI.isUri(resource));\r\n                    assertType(corePosition.Position.isIPosition(position));\r\n                    assertType(Array.isArray(references));\r\n                    assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\r\n                    assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\r\n                    editorService = accessor.get(ICodeEditorService);\r\n                    return [4 /*yield*/, editorService.openCodeEditor({ resource: resource }, editorService.getFocusedCodeEditor())];\r\n                case 1:\r\n                    editor = _a.sent();\r\n                    if (isCodeEditor(editor)) {\r\n                        editor.setPosition(position);\r\n                        editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n                        return [2 /*return*/, editor.invokeWithinContext(function (accessor) {\r\n                                var command = new GenericGoToLocationAction({ muteMessage: true, openInPeek: Boolean(openInPeek), openToSide: false }, references, multiple);\r\n                                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\r\n                            })];\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    }); }\r\n});\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.peekLocations',\r\n    description: {\r\n        description: 'Peek locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: function (accessor, resource, position, references, multiple) { return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, true);\r\n            return [2 /*return*/];\r\n        });\r\n    }); }\r\n});\r\n//#endregion\r\n//#region --- REFERENCE search special commands\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.findReferences',\r\n    handler: function (accessor, resource, position) {\r\n        assertType(URI.isUri(resource));\r\n        assertType(corePosition.Position.isIPosition(position));\r\n        var codeEditorService = accessor.get(ICodeEditorService);\r\n        return codeEditorService.openCodeEditor({ resource: resource }, codeEditorService.getFocusedCodeEditor()).then(function (control) {\r\n            if (!isCodeEditor(control) || !control.hasModel()) {\r\n                return undefined;\r\n            }\r\n            var controller = ReferencesController.get(control);\r\n            if (!controller) {\r\n                return undefined;\r\n            }\r\n            var references = createCancelablePromise(function (token) { return getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(function (references) { return new ReferencesModel(references, nls.localize('ref.title', 'References')); }); });\r\n            var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n            return Promise.resolve(controller.toggleWidget(range, references, false));\r\n        });\r\n    }\r\n});\r\n// use NEW command\r\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { equals } from './arrays.js';\r\nimport { escapeCodicons } from './codicons.js';\r\nvar MarkdownString = /** @class */ (function () {\r\n    function MarkdownString(_value, isTrustedOrOptions) {\r\n        if (_value === void 0) { _value = ''; }\r\n        if (isTrustedOrOptions === void 0) { isTrustedOrOptions = false; }\r\n        var _a, _b;\r\n        this._value = _value;\r\n        if (typeof isTrustedOrOptions === 'boolean') {\r\n            this._isTrusted = isTrustedOrOptions;\r\n            this._supportThemeIcons = false;\r\n        }\r\n        else {\r\n            this._isTrusted = (_a = isTrustedOrOptions.isTrusted) !== null && _a !== void 0 ? _a : false;\r\n            this._supportThemeIcons = (_b = isTrustedOrOptions.supportThemeIcons) !== null && _b !== void 0 ? _b : false;\r\n        }\r\n    }\r\n    Object.defineProperty(MarkdownString.prototype, \"value\", {\r\n        get: function () { return this._value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkdownString.prototype, \"isTrusted\", {\r\n        get: function () { return this._isTrusted; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkdownString.prototype, \"supportThemeIcons\", {\r\n        get: function () { return this._supportThemeIcons; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkdownString.prototype.appendText = function (value) {\r\n        // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n        this._value += (this._supportThemeIcons ? escapeCodicons(value) : value)\r\n            .replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&')\r\n            .replace('\\n', '\\n\\n');\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendMarkdown = function (value) {\r\n        this._value += value;\r\n        return this;\r\n    };\r\n    MarkdownString.prototype.appendCodeblock = function (langId, code) {\r\n        this._value += '\\n```';\r\n        this._value += langId;\r\n        this._value += '\\n';\r\n        this._value += code;\r\n        this._value += '\\n```\\n';\r\n        return this;\r\n    };\r\n    return MarkdownString;\r\n}());\r\nexport { MarkdownString };\r\nexport function isEmptyMarkdownString(oneOrMany) {\r\n    if (isMarkdownString(oneOrMany)) {\r\n        return !oneOrMany.value;\r\n    }\r\n    else if (Array.isArray(oneOrMany)) {\r\n        return oneOrMany.every(isEmptyMarkdownString);\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nexport function isMarkdownString(thing) {\r\n    if (thing instanceof MarkdownString) {\r\n        return true;\r\n    }\r\n    else if (thing && typeof thing === 'object') {\r\n        return typeof thing.value === 'string'\r\n            && (typeof thing.isTrusted === 'boolean' || thing.isTrusted === undefined)\r\n            && (typeof thing.supportThemeIcons === 'boolean' || thing.supportThemeIcons === undefined);\r\n    }\r\n    return false;\r\n}\r\nexport function markedStringsEquals(a, b) {\r\n    if (!a && !b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else if (Array.isArray(a) && Array.isArray(b)) {\r\n        return equals(a, b, markdownStringEqual);\r\n    }\r\n    else if (isMarkdownString(a) && isMarkdownString(b)) {\r\n        return markdownStringEqual(a, b);\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nfunction markdownStringEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    else if (!a || !b) {\r\n        return false;\r\n    }\r\n    else {\r\n        return a.value === b.value && a.isTrusted === b.isTrusted && a.supportThemeIcons === b.supportThemeIcons;\r\n    }\r\n}\r\nexport function removeMarkdownEscapes(text) {\r\n    if (!text) {\r\n        return text;\r\n    }\r\n    return text.replace(/\\\\([\\\\`*_{}[\\]()#+\\-.!])/g, '$1');\r\n}\r\nexport function parseHrefAndDimensions(href) {\r\n    var dimensions = [];\r\n    var splitted = href.split('|').map(function (s) { return s.trim(); });\r\n    href = splitted[0];\r\n    var parameters = splitted[1];\r\n    if (parameters) {\r\n        var heightFromParams = /height=(\\d+)/.exec(parameters);\r\n        var widthFromParams = /width=(\\d+)/.exec(parameters);\r\n        var height = heightFromParams ? heightFromParams[1] : '';\r\n        var width = widthFromParams ? widthFromParams[1] : '';\r\n        var widthIsFinite = isFinite(parseInt(width));\r\n        var heightIsFinite = isFinite(parseInt(height));\r\n        if (widthIsFinite) {\r\n            dimensions.push(\"width=\\\"\" + width + \"\\\"\");\r\n        }\r\n        if (heightIsFinite) {\r\n            dimensions.push(\"height=\\\"\" + height + \"\\\"\");\r\n        }\r\n    }\r\n    return { href: href, dimensions: dimensions };\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../../base/common/event.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nfunction hasModifier(e, modifier) {\r\n    return !!e[modifier];\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkMouseEvent = /** @class */ (function () {\r\n    function ClickLinkMouseEvent(source, opts) {\r\n        this.target = source.target;\r\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\r\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\r\n        this.isNoneOrSingleMouseDown = (browser.isIE || source.event.detail <= 1); // IE does not support event.detail properly\r\n    }\r\n    return ClickLinkMouseEvent;\r\n}());\r\nexport { ClickLinkMouseEvent };\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkKeyboardEvent = /** @class */ (function () {\r\n    function ClickLinkKeyboardEvent(source, opts) {\r\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\r\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\r\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\r\n    }\r\n    return ClickLinkKeyboardEvent;\r\n}());\r\nexport { ClickLinkKeyboardEvent };\r\nvar ClickLinkOptions = /** @class */ (function () {\r\n    function ClickLinkOptions(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\r\n        this.triggerKey = triggerKey;\r\n        this.triggerModifier = triggerModifier;\r\n        this.triggerSideBySideKey = triggerSideBySideKey;\r\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\r\n    }\r\n    ClickLinkOptions.prototype.equals = function (other) {\r\n        return (this.triggerKey === other.triggerKey\r\n            && this.triggerModifier === other.triggerModifier\r\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\r\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\r\n    };\r\n    return ClickLinkOptions;\r\n}());\r\nexport { ClickLinkOptions };\r\nfunction createOptions(multiCursorModifier) {\r\n    if (multiCursorModifier === 'altKey') {\r\n        if (platform.isMacintosh) {\r\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\r\n        }\r\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\r\n    }\r\n    if (platform.isMacintosh) {\r\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\r\n    }\r\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\r\n}\r\nvar ClickLinkGesture = /** @class */ (function (_super) {\r\n    __extends(ClickLinkGesture, _super);\r\n    function ClickLinkGesture(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onMouseMoveOrRelevantKeyDown = _this._register(new Emitter());\r\n        _this.onMouseMoveOrRelevantKeyDown = _this._onMouseMoveOrRelevantKeyDown.event;\r\n        _this._onExecute = _this._register(new Emitter());\r\n        _this.onExecute = _this._onExecute.event;\r\n        _this._onCancel = _this._register(new Emitter());\r\n        _this.onCancel = _this._onCancel.event;\r\n        _this._editor = editor;\r\n        _this._opts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n        _this.lastMouseMoveEvent = null;\r\n        _this.hasTriggerKeyOnMouseDown = false;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(59 /* multiCursorModifier */)) {\r\n                var newOpts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n                if (_this._opts.equals(newOpts)) {\r\n                    return;\r\n                }\r\n                _this._opts = newOpts;\r\n                _this.lastMouseMoveEvent = null;\r\n                _this.hasTriggerKeyOnMouseDown = false;\r\n                _this._onCancel.fire();\r\n            }\r\n        }));\r\n        _this._register(_this._editor.onMouseMove(function (e) { return _this.onEditorMouseMove(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this.onEditorMouseDown(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this.onEditorMouseUp(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDrag(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function (e) { return _this.onDidChangeCursorSelection(e); }));\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeModelContent(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n                _this.resetHandler();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ClickLinkGesture.prototype.onDidChangeCursorSelection = function (e) {\r\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\r\n            this.resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/Microsoft/vscode/issues/7827)\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseMove = function (mouseEvent) {\r\n        this.lastMouseMoveEvent = mouseEvent;\r\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\r\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\r\n        // release the mouse button without wanting to do the navigation.\r\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\r\n        this.hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (this.hasTriggerKeyOnMouseDown) {\r\n            this._onExecute.fire(mouseEvent);\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyDown = function (e) {\r\n        if (this.lastMouseMoveEvent\r\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\r\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\r\n            )) {\r\n            this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent, e]);\r\n        }\r\n        else if (e.hasTriggerModifier) {\r\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyUp = function (e) {\r\n        if (e.keyCodeIsTriggerKey) {\r\n            this._onCancel.fire();\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.resetHandler = function () {\r\n        this.lastMouseMoveEvent = null;\r\n        this.hasTriggerKeyOnMouseDown = false;\r\n        this._onCancel.fire();\r\n    };\r\n    return ClickLinkGesture;\r\n}(Disposable));\r\nexport { ClickLinkGesture };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './goToDefinitionAtPosition.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { DefinitionProviderRegistry } from '../../../common/modes.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\r\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { editorActiveLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { EditorState } from '../../../browser/core/editorState.js';\r\nimport { DefinitionAction } from '../goToCommands.js';\r\nimport { ClickLinkGesture } from './clickLinkGesture.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\r\nvar GotoDefinitionAtPositionEditorContribution = /** @class */ (function () {\r\n    function GotoDefinitionAtPositionEditorContribution(editor, textModelResolverService, modeService) {\r\n        var _this = this;\r\n        this.textModelResolverService = textModelResolverService;\r\n        this.modeService = modeService;\r\n        this.toUnhook = new DisposableStore();\r\n        this.toUnhookForKeyboard = new DisposableStore();\r\n        this.linkDecorations = [];\r\n        this.currentWordAtPosition = null;\r\n        this.previousPromise = null;\r\n        this.editor = editor;\r\n        var linkGesture = new ClickLinkGesture(editor);\r\n        this.toUnhook.add(linkGesture);\r\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\r\n        }));\r\n        this.toUnhook.add(linkGesture.onExecute(function (mouseEvent) {\r\n            if (_this.isEnabled(mouseEvent)) {\r\n                _this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(function () {\r\n                    _this.removeLinkDecorations();\r\n                }, function (error) {\r\n                    _this.removeLinkDecorations();\r\n                    onUnexpectedError(error);\r\n                });\r\n            }\r\n        }));\r\n        this.toUnhook.add(linkGesture.onCancel(function () {\r\n            _this.removeLinkDecorations();\r\n            _this.currentWordAtPosition = null;\r\n        }));\r\n    }\r\n    GotoDefinitionAtPositionEditorContribution.get = function (editor) {\r\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromCursor = function (position) {\r\n        // For issue: https://github.com/microsoft/vscode/issues/46257\r\n        // equivalent to mouse move with meta/ctrl key\r\n        var _this = this;\r\n        // First find the definition and add decorations\r\n        // to the editor to be shown with the content hover widget\r\n        return this.startFindDefinition(position).then(function () {\r\n            // Add listeners for editor cursor move and key down events\r\n            // Dismiss the \"extended\" editor decorations when the user hides\r\n            // the hover widget. There is no event for the widget itself so these\r\n            // serve as a best effort. After removing the link decorations, the hover\r\n            // widget is clean and will only show declarations per next request.\r\n            _this.toUnhookForKeyboard.add(_this.editor.onDidChangeCursorPosition(function () {\r\n                _this.currentWordAtPosition = null;\r\n                _this.removeLinkDecorations();\r\n                _this.toUnhookForKeyboard.clear();\r\n            }));\r\n            _this.toUnhookForKeyboard.add(_this.editor.onKeyDown(function (e) {\r\n                if (e) {\r\n                    _this.currentWordAtPosition = null;\r\n                    _this.removeLinkDecorations();\r\n                    _this.toUnhookForKeyboard.clear();\r\n                }\r\n            }));\r\n        });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromMouse = function (mouseEvent, withKey) {\r\n        // check if we are active and on a content widget\r\n        if (mouseEvent.target.type === 9 /* CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return;\r\n        }\r\n        var position = mouseEvent.target.position;\r\n        this.startFindDefinition(position);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinition = function (position) {\r\n        var _this = this;\r\n        var _a;\r\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\r\n        this.toUnhookForKeyboard.clear();\r\n        // Find word at mouse position\r\n        var word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\r\n        if (!word) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return Promise.resolve(0);\r\n        }\r\n        // Return early if word at position is still the same\r\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\r\n            return Promise.resolve(0);\r\n        }\r\n        this.currentWordAtPosition = word;\r\n        // Find definition and decorate word if found\r\n        var state = new EditorState(this.editor, 4 /* Position */ | 1 /* Value */ | 2 /* Selection */ | 8 /* Scroll */);\r\n        if (this.previousPromise) {\r\n            this.previousPromise.cancel();\r\n            this.previousPromise = null;\r\n        }\r\n        this.previousPromise = createCancelablePromise(function (token) { return _this.findDefinition(position, token); });\r\n        return this.previousPromise.then(function (results) {\r\n            if (!results || !results.length || !state.validate(_this.editor)) {\r\n                _this.removeLinkDecorations();\r\n                return;\r\n            }\r\n            // Multiple results\r\n            if (results.length > 1) {\r\n                _this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\r\n            }\r\n            // Single result\r\n            else {\r\n                var result_1 = results[0];\r\n                if (!result_1.uri) {\r\n                    return;\r\n                }\r\n                _this.textModelResolverService.createModelReference(result_1.uri).then(function (ref) {\r\n                    if (!ref.object || !ref.object.textEditorModel) {\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var textEditorModel = ref.object.textEditorModel;\r\n                    var startLineNumber = result_1.range.startLineNumber;\r\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\r\n                        // invalid range\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var previewValue = _this.getPreviewValue(textEditorModel, startLineNumber, result_1);\r\n                    var wordRange;\r\n                    if (result_1.originSelectionRange) {\r\n                        wordRange = Range.lift(result_1.originSelectionRange);\r\n                    }\r\n                    else {\r\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\r\n                    }\r\n                    var modeId = _this.modeService.getModeIdByFilepathOrFirstLine(textEditorModel.uri);\r\n                    _this.addDecoration(wordRange, new MarkdownString().appendCodeblock(modeId ? modeId : '', previewValue));\r\n                    ref.dispose();\r\n                });\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewValue = function (textEditorModel, startLineNumber, result) {\r\n        var rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\r\n        var numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\r\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\r\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\r\n        }\r\n        var previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.stripIndentationFromPreviewRange = function (textEditorModel, startLineNumber, previewRange) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var minIndent = startIndent;\r\n        for (var endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            minIndent = Math.min(minIndent, endIndent);\r\n        }\r\n        var previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(\"^\\\\s{\" + (minIndent - 1) + \"}\", 'gm'), '').trim();\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnIndentation = function (textEditorModel, startLineNumber) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var endLineNumber = startLineNumber + 1;\r\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            if (startIndent === endIndent) {\r\n                break;\r\n            }\r\n        }\r\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnBrackets = function (textEditorModel, startLineNumber) {\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var brackets = [];\r\n        var ignoreFirstEmpty = true;\r\n        var currentBracket = textEditorModel.findNextBracket(new Position(startLineNumber, 1));\r\n        while (currentBracket !== null) {\r\n            if (brackets.length === 0) {\r\n                brackets.push(currentBracket);\r\n            }\r\n            else {\r\n                var lastBracket = brackets[brackets.length - 1];\r\n                if (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\r\n                    brackets.pop();\r\n                }\r\n                else {\r\n                    brackets.push(currentBracket);\r\n                }\r\n                if (brackets.length === 0) {\r\n                    if (ignoreFirstEmpty) {\r\n                        ignoreFirstEmpty = false;\r\n                    }\r\n                    else {\r\n                        return new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\r\n                    }\r\n                }\r\n            }\r\n            var maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\r\n            var nextLineNumber = currentBracket.range.endLineNumber;\r\n            var nextColumn = currentBracket.range.endColumn;\r\n            if (maxColumn === currentBracket.range.endColumn) {\r\n                nextLineNumber++;\r\n                nextColumn = 1;\r\n            }\r\n            if (nextLineNumber > maxLineNumber) {\r\n                return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n            }\r\n            currentBracket = textEditorModel.findNextBracket(new Position(nextLineNumber, nextColumn));\r\n        }\r\n        return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.addDecoration = function (range, hoverMessage) {\r\n        var newDecorations = {\r\n            range: range,\r\n            options: {\r\n                inlineClassName: 'goto-definition-link',\r\n                hoverMessage: hoverMessage\r\n            }\r\n        };\r\n        this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.removeLinkDecorations = function () {\r\n        if (this.linkDecorations.length > 0) {\r\n            this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\r\n        }\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return this.editor.hasModel() &&\r\n            mouseEvent.isNoneOrSingleMouseDown &&\r\n            (mouseEvent.target.type === 6 /* CONTENT_TEXT */) &&\r\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\r\n            DefinitionProviderRegistry.has(this.editor.getModel());\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.findDefinition = function (position, token) {\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return getDefinitionsAtPosition(model, position, token);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.gotoDefinition = function (position, openToSide) {\r\n        var _this = this;\r\n        this.editor.setPosition(position);\r\n        var action = new DefinitionAction({ openToSide: openToSide, openInPeek: false, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\r\n        return this.editor.invokeWithinContext(function (accessor) { return action.run(accessor, _this.editor); });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.dispose = function () {\r\n        this.toUnhook.dispose();\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\r\n    GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\r\n    GotoDefinitionAtPositionEditorContribution = __decorate([\r\n        __param(1, ITextModelService),\r\n        __param(2, IModeService)\r\n    ], GotoDefinitionAtPositionEditorContribution);\r\n    return GotoDefinitionAtPositionEditorContribution;\r\n}());\r\nexport { GotoDefinitionAtPositionEditorContribution };\r\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .goto-definition-link { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport Severity from '../../../base/common/severity.js';\r\nimport { registerThemingParticipant } from '../../theme/common/themeService.js';\r\nimport { problemsErrorIconForeground, problemsInfoIconForeground, problemsWarningIconForeground } from '../../theme/common/colorRegistry.js';\r\nexport var SeverityIcon;\r\n(function (SeverityIcon) {\r\n    function className(severity) {\r\n        switch (severity) {\r\n            case Severity.Ignore:\r\n                return 'severity-ignore codicon-info';\r\n            case Severity.Info:\r\n                return 'codicon-info';\r\n            case Severity.Warning:\r\n                return 'codicon-warning';\r\n            case Severity.Error:\r\n                return 'codicon-error';\r\n        }\r\n        return '';\r\n    }\r\n    SeverityIcon.className = className;\r\n})(SeverityIcon || (SeverityIcon = {}));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var errorIconForeground = theme.getColor(problemsErrorIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-error,\\n\\t\\t\\t.markers-panel .marker-icon.codicon-error,\\n\\t\\t\\t.extensions-viewlet > .extensions .codicon-error,\\n\\t\\t\\t.monaco-dialog-box .dialog-message-row .codicon-error {\\n\\t\\t\\t\\tcolor: \" + errorIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n    var warningIconForeground = theme.getColor(problemsWarningIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-warning,\\n\\t\\t\\t.markers-panel .marker-icon.codicon-warning,\\n\\t\\t\\t.extensions-viewlet > .extensions .codicon-warning,\\n\\t\\t\\t.extension-editor .codicon-warning,\\n\\t\\t\\t.monaco-dialog-box .dialog-message-row .codicon-warning {\\n\\t\\t\\t\\tcolor: \" + warningIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n    var infoIconForeground = theme.getColor(problemsInfoIconForeground);\r\n    if (errorIconForeground) {\r\n        collector.addRule(\"\\n\\t\\t\\t.monaco-editor .zone-widget .codicon-info,\\n\\t\\t\\t.markers-panel .marker-icon.codicon-info,\\n\\t\\t\\t.extensions-viewlet > .extensions .codicon-info,\\n\\t\\t\\t.extension-editor .codicon-info,\\n\\t\\t\\t.monaco-dialog-box .dialog-message-row .codicon-info {\\n\\t\\t\\t\\tcolor: \" + infoIconForeground + \";\\n\\t\\t\\t}\\n\\t\\t\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/gotoErrorWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { getBaseLabel, getPathLabel } from '../../../base/common/labels.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(parent, editor, onRelatedInformation, _openerService) {\r\n        var _this = this;\r\n        this._openerService = _openerService;\r\n        this._lines = 0;\r\n        this._longestLineLength = 0;\r\n        this._relatedDiagnostics = new WeakMap();\r\n        this._disposables = new DisposableStore();\r\n        this._editor = editor;\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'descriptioncontainer';\r\n        domNode.setAttribute('aria-live', 'assertive');\r\n        domNode.setAttribute('role', 'alert');\r\n        this._messageBlock = document.createElement('div');\r\n        dom.addClass(this._messageBlock, 'message');\r\n        domNode.appendChild(this._messageBlock);\r\n        this._relatedBlock = document.createElement('div');\r\n        domNode.appendChild(this._relatedBlock);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', function (event) {\r\n            event.preventDefault();\r\n            var related = _this._relatedDiagnostics.get(event.target);\r\n            if (related) {\r\n                onRelatedInformation(related);\r\n            }\r\n        }));\r\n        this._scrollable = new ScrollableElement(domNode, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: 1 /* Auto */,\r\n            useShadows: false,\r\n            horizontalScrollbarSize: 3,\r\n            verticalScrollbarSize: 3\r\n        });\r\n        parent.appendChild(this._scrollable.getDomNode());\r\n        this._disposables.add(this._scrollable.onScroll(function (e) {\r\n            domNode.style.left = \"-\" + e.scrollLeft + \"px\";\r\n            domNode.style.top = \"-\" + e.scrollTop + \"px\";\r\n        }));\r\n        this._disposables.add(this._scrollable);\r\n    }\r\n    MessageWidget.prototype.dispose = function () {\r\n        dispose(this._disposables);\r\n    };\r\n    MessageWidget.prototype.update = function (_a) {\r\n        var _this = this;\r\n        var source = _a.source, message = _a.message, relatedInformation = _a.relatedInformation, code = _a.code;\r\n        var sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\r\n        if (code) {\r\n            if (typeof code === 'string') {\r\n                sourceAndCodeLength += code.length;\r\n            }\r\n            else {\r\n                sourceAndCodeLength += code.value.length;\r\n            }\r\n        }\r\n        var lines = message.split(/\\r\\n|\\r|\\n/g);\r\n        this._lines = lines.length;\r\n        this._longestLineLength = 0;\r\n        for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\r\n            var line = lines_1[_i];\r\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\r\n        }\r\n        dom.clearNode(this._messageBlock);\r\n        this._editor.applyFontInfo(this._messageBlock);\r\n        var lastLineElement = this._messageBlock;\r\n        for (var _b = 0, lines_2 = lines; _b < lines_2.length; _b++) {\r\n            var line = lines_2[_b];\r\n            lastLineElement = document.createElement('div');\r\n            lastLineElement.innerText = line;\r\n            if (line === '') {\r\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\r\n            }\r\n            this._messageBlock.appendChild(lastLineElement);\r\n        }\r\n        if (source || code) {\r\n            var detailsElement = document.createElement('span');\r\n            dom.addClass(detailsElement, 'details');\r\n            lastLineElement.appendChild(detailsElement);\r\n            if (source) {\r\n                var sourceElement = document.createElement('span');\r\n                sourceElement.innerText = source;\r\n                dom.addClass(sourceElement, 'source');\r\n                detailsElement.appendChild(sourceElement);\r\n            }\r\n            if (code) {\r\n                if (typeof code === 'string') {\r\n                    var codeElement = document.createElement('span');\r\n                    codeElement.innerText = \"(\" + code + \")\";\r\n                    dom.addClass(codeElement, 'code');\r\n                    detailsElement.appendChild(codeElement);\r\n                }\r\n                else {\r\n                    this._codeLink = dom.$('a.code-link');\r\n                    this._codeLink.setAttribute('href', \"\" + code.link.toString());\r\n                    this._codeLink.onclick = function (e) {\r\n                        _this._openerService.open(code.link);\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    };\r\n                    var codeElement = dom.append(this._codeLink, dom.$('span'));\r\n                    codeElement.innerText = code.value;\r\n                    detailsElement.appendChild(this._codeLink);\r\n                }\r\n            }\r\n        }\r\n        dom.clearNode(this._relatedBlock);\r\n        this._editor.applyFontInfo(this._relatedBlock);\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\r\n            relatedInformationNode.style.paddingTop = Math.floor(this._editor.getOption(49 /* lineHeight */) * 0.66) + \"px\";\r\n            this._lines += 1;\r\n            for (var _c = 0, relatedInformation_1 = relatedInformation; _c < relatedInformation_1.length; _c++) {\r\n                var related = relatedInformation_1[_c];\r\n                var container = document.createElement('div');\r\n                var relatedResource = document.createElement('a');\r\n                dom.addClass(relatedResource, 'filename');\r\n                relatedResource.innerHTML = getBaseLabel(related.resource) + \"(\" + related.startLineNumber + \", \" + related.startColumn + \"): \";\r\n                relatedResource.title = getPathLabel(related.resource, undefined);\r\n                this._relatedDiagnostics.set(relatedResource, related);\r\n                var relatedMessage = document.createElement('span');\r\n                relatedMessage.innerText = related.message;\r\n                container.appendChild(relatedResource);\r\n                container.appendChild(relatedMessage);\r\n                this._lines += 1;\r\n                relatedInformationNode.appendChild(container);\r\n            }\r\n        }\r\n        var fontInfo = this._editor.getOption(34 /* fontInfo */);\r\n        var scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\r\n        var scrollHeight = fontInfo.lineHeight * this._lines;\r\n        this._scrollable.setScrollDimensions({ scrollWidth: scrollWidth, scrollHeight: scrollHeight });\r\n    };\r\n    MessageWidget.prototype.layout = function (height, width) {\r\n        this._scrollable.getDomNode().style.height = height + \"px\";\r\n        this._scrollable.getDomNode().style.width = width + \"px\";\r\n        this._scrollable.setScrollDimensions({ width: width, height: height });\r\n    };\r\n    MessageWidget.prototype.getHeightInLines = function () {\r\n        return Math.min(17, this._lines);\r\n    };\r\n    return MessageWidget;\r\n}());\r\nvar MarkerNavigationWidget = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationWidget, _super);\r\n    function MarkerNavigationWidget(editor, actions, _themeService, _openerService) {\r\n        var _this = _super.call(this, editor, { showArrow: true, showFrame: true, isAccessible: true }) || this;\r\n        _this.actions = actions;\r\n        _this._themeService = _themeService;\r\n        _this._openerService = _openerService;\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectRelatedInformation = new Emitter();\r\n        _this.onDidSelectRelatedInformation = _this._onDidSelectRelatedInformation.event;\r\n        _this._severity = MarkerSeverity.Warning;\r\n        _this._backgroundColor = Color.white;\r\n        _this._applyTheme(_themeService.getTheme());\r\n        _this._callOnDispose.add(_themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    MarkerNavigationWidget.prototype._applyTheme = function (theme) {\r\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\r\n        var colorId = editorMarkerNavigationError;\r\n        if (this._severity === MarkerSeverity.Warning) {\r\n            colorId = editorMarkerNavigationWarning;\r\n        }\r\n        else if (this._severity === MarkerSeverity.Info) {\r\n            colorId = editorMarkerNavigationInfo;\r\n        }\r\n        var frameColor = theme.getColor(colorId);\r\n        this.style({\r\n            arrowColor: frameColor,\r\n            frameColor: frameColor,\r\n            headerBackgroundColor: this._backgroundColor,\r\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\r\n        }); // style() will trigger _applyStyles\r\n    };\r\n    MarkerNavigationWidget.prototype._applyStyles = function () {\r\n        if (this._parentContainer) {\r\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\r\n        }\r\n        _super.prototype._applyStyles.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype._fillHead = function (container) {\r\n        _super.prototype._fillHead.call(this, container);\r\n        this._actionbarWidget.push(this.actions, { label: false, icon: true, index: 0 });\r\n    };\r\n    MarkerNavigationWidget.prototype._fillTitleIcon = function (container) {\r\n        this._icon = dom.append(container, dom.$(''));\r\n    };\r\n    MarkerNavigationWidget.prototype._getActionBarOptions = function () {\r\n        return {\r\n            orientation: 0 /* HORIZONTAL */\r\n        };\r\n    };\r\n    MarkerNavigationWidget.prototype._fillBody = function (container) {\r\n        var _this = this;\r\n        this._parentContainer = container;\r\n        dom.addClass(container, 'marker-widget');\r\n        this._parentContainer.tabIndex = 0;\r\n        this._parentContainer.setAttribute('role', 'tooltip');\r\n        this._container = document.createElement('div');\r\n        container.appendChild(this._container);\r\n        this._message = new MessageWidget(this._container, this.editor, function (related) { return _this._onDidSelectRelatedInformation.fire(related); }, this._openerService);\r\n        this._disposables.add(this._message);\r\n    };\r\n    MarkerNavigationWidget.prototype.show = function (where, heightInLines) {\r\n        throw new Error('call showAtMarker');\r\n    };\r\n    MarkerNavigationWidget.prototype.showAtMarker = function (marker, markerIdx, markerCount) {\r\n        // update:\r\n        // * title\r\n        // * message\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n        // update frame color (only applied on 'show')\r\n        this._severity = marker.severity;\r\n        this._applyTheme(this._themeService.getTheme());\r\n        // show\r\n        var range = Range.lift(marker);\r\n        var editorPosition = this.editor.getPosition();\r\n        var position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\r\n        _super.prototype.show.call(this, position, this.computeRequiredHeight());\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var detail = markerCount > 1\r\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\r\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\r\n            this.setTitle(basename(model.uri), detail);\r\n        }\r\n        this._icon.className = \"codicon \" + SeverityIcon.className(MarkerSeverity.toSeverity(this._severity));\r\n        this.editor.revealPositionInCenter(position, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    };\r\n    MarkerNavigationWidget.prototype.updateMarker = function (marker) {\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n    };\r\n    MarkerNavigationWidget.prototype.showStale = function () {\r\n        this._container.classList.add('stale');\r\n        this._relayout();\r\n    };\r\n    MarkerNavigationWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._heightInPixel = heightInPixel;\r\n        this._message.layout(heightInPixel, widthInPixel);\r\n        this._container.style.height = heightInPixel + \"px\";\r\n    };\r\n    MarkerNavigationWidget.prototype._onWidth = function (widthInPixel) {\r\n        this._message.layout(this._heightInPixel, widthInPixel);\r\n    };\r\n    MarkerNavigationWidget.prototype._relayout = function () {\r\n        _super.prototype._relayout.call(this, this.computeRequiredHeight());\r\n    };\r\n    MarkerNavigationWidget.prototype.computeRequiredHeight = function () {\r\n        return 3 + this._message.getHeightInLines();\r\n    };\r\n    return MarkerNavigationWidget;\r\n}(PeekViewWidget));\r\nexport { MarkerNavigationWidget };\r\n// theming\r\nvar errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\r\nvar warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\r\nvar infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\r\nexport var editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hc: errorDefault }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\r\nexport var editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hc: warningDefault }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\r\nexport var editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hc: infoDefault }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\r\nexport var editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: '#2D2D30', light: Color.white, hc: '#0C141F' }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(\".monaco-editor .marker-widget a { color: \" + linkFg + \"; }\");\r\n        collector.addRule(\".monaco-editor .marker-widget a.code-link span:hover { color: \" + linkFg + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\r\nimport { compare } from '../../../base/common/strings.js';\r\nimport { binarySearch, find } from '../../../base/common/arrays.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nvar MarkerModel = /** @class */ (function () {\r\n    function MarkerModel(editor, markers) {\r\n        var _this = this;\r\n        this._toUnbind = new DisposableStore();\r\n        this._editor = editor;\r\n        this._markers = [];\r\n        this._nextIdx = -1;\r\n        this._ignoreSelectionChange = false;\r\n        this._onCurrentMarkerChanged = new Emitter();\r\n        this._onMarkerSetChanged = new Emitter();\r\n        this.setMarkers(markers);\r\n        // listen on editor\r\n        this._toUnbind.add(this._editor.onDidDispose(function () { return _this.dispose(); }));\r\n        this._toUnbind.add(this._editor.onDidChangeCursorPosition(function () {\r\n            if (_this._ignoreSelectionChange) {\r\n                return;\r\n            }\r\n            if (_this.currentMarker && _this._editor.getPosition() && Range.containsPosition(_this.currentMarker, _this._editor.getPosition())) {\r\n                return;\r\n            }\r\n            _this._nextIdx = -1;\r\n        }));\r\n    }\r\n    Object.defineProperty(MarkerModel.prototype, \"onCurrentMarkerChanged\", {\r\n        get: function () {\r\n            return this._onCurrentMarkerChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkerModel.prototype, \"onMarkerSetChanged\", {\r\n        get: function () {\r\n            return this._onMarkerSetChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.setMarkers = function (markers) {\r\n        var oldMarker = this._nextIdx >= 0 ? this._markers[this._nextIdx] : undefined;\r\n        this._markers = markers || [];\r\n        this._markers.sort(MarkerNavigationAction.compareMarker);\r\n        if (!oldMarker) {\r\n            this._nextIdx = -1;\r\n        }\r\n        else {\r\n            this._nextIdx = Math.max(-1, binarySearch(this._markers, oldMarker, MarkerNavigationAction.compareMarker));\r\n        }\r\n        this._onMarkerSetChanged.fire(this);\r\n    };\r\n    MarkerModel.prototype.withoutWatchingEditorPosition = function (callback) {\r\n        this._ignoreSelectionChange = true;\r\n        try {\r\n            callback();\r\n        }\r\n        finally {\r\n            this._ignoreSelectionChange = false;\r\n        }\r\n    };\r\n    MarkerModel.prototype._initIdx = function (fwd) {\r\n        var found = false;\r\n        var position = this._editor.getPosition();\r\n        for (var i = 0; i < this._markers.length; i++) {\r\n            var range = Range.lift(this._markers[i]);\r\n            if (range.isEmpty() && this._editor.getModel()) {\r\n                var word = this._editor.getModel().getWordAtPosition(range.getStartPosition());\r\n                if (word) {\r\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\r\n                }\r\n            }\r\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\r\n                this._nextIdx = i;\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\r\n        }\r\n        if (this._nextIdx < 0) {\r\n            this._nextIdx = this._markers.length - 1;\r\n        }\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"currentMarker\", {\r\n        get: function () {\r\n            return this.canNavigate() ? this._markers[this._nextIdx] : undefined;\r\n        },\r\n        set: function (marker) {\r\n            var idx = this._nextIdx;\r\n            this._nextIdx = -1;\r\n            if (marker) {\r\n                this._nextIdx = this.indexOf(marker);\r\n            }\r\n            if (this._nextIdx !== idx) {\r\n                this._onCurrentMarkerChanged.fire(marker);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.move = function (fwd, inCircles) {\r\n        if (!this.canNavigate()) {\r\n            this._onCurrentMarkerChanged.fire(undefined);\r\n            return !inCircles;\r\n        }\r\n        var oldIdx = this._nextIdx;\r\n        var atEdge = false;\r\n        if (this._nextIdx === -1) {\r\n            this._initIdx(fwd);\r\n        }\r\n        else if (fwd) {\r\n            if (inCircles || this._nextIdx + 1 < this._markers.length) {\r\n                this._nextIdx = (this._nextIdx + 1) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        else if (!fwd) {\r\n            if (inCircles || this._nextIdx > 0) {\r\n                this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        if (oldIdx !== this._nextIdx) {\r\n            var marker = this._markers[this._nextIdx];\r\n            this._onCurrentMarkerChanged.fire(marker);\r\n        }\r\n        return atEdge;\r\n    };\r\n    MarkerModel.prototype.canNavigate = function () {\r\n        return this._markers.length > 0;\r\n    };\r\n    MarkerModel.prototype.findMarkerAtPosition = function (pos) {\r\n        return find(this._markers, function (marker) { return Range.containsPosition(marker, pos); });\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"total\", {\r\n        get: function () {\r\n            return this._markers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.indexOf = function (marker) {\r\n        return 1 + this._markers.indexOf(marker);\r\n    };\r\n    MarkerModel.prototype.dispose = function () {\r\n        this._toUnbind.dispose();\r\n    };\r\n    return MarkerModel;\r\n}());\r\nvar MarkerController = /** @class */ (function () {\r\n    function MarkerController(editor, _markerService, _contextKeyService, _themeService, _editorService, _keybindingService, _openerService) {\r\n        this._markerService = _markerService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._themeService = _themeService;\r\n        this._editorService = _editorService;\r\n        this._keybindingService = _keybindingService;\r\n        this._openerService = _openerService;\r\n        this._model = null;\r\n        this._widget = null;\r\n        this._disposeOnClose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\r\n    }\r\n    MarkerController.get = function (editor) {\r\n        return editor.getContribution(MarkerController.ID);\r\n    };\r\n    MarkerController.prototype.dispose = function () {\r\n        this._cleanUp();\r\n        this._disposeOnClose.dispose();\r\n    };\r\n    MarkerController.prototype._cleanUp = function () {\r\n        this._widgetVisible.reset();\r\n        this._disposeOnClose.clear();\r\n        this._widget = null;\r\n        this._model = null;\r\n    };\r\n    MarkerController.prototype.getOrCreateModel = function () {\r\n        var _this = this;\r\n        if (this._model) {\r\n            return this._model;\r\n        }\r\n        var markers = this._getMarkers();\r\n        this._model = new MarkerModel(this._editor, markers);\r\n        this._markerService.onMarkerChanged(this._onMarkerChanged, this, this._disposeOnClose);\r\n        var prevMarkerKeybinding = this._keybindingService.lookupKeybinding(PrevMarkerAction.ID);\r\n        var nextMarkerKeybinding = this._keybindingService.lookupKeybinding(NextMarkerAction.ID);\r\n        var actions = [\r\n            new Action(NextMarkerAction.ID, NextMarkerAction.LABEL + (nextMarkerKeybinding ? \" (\" + nextMarkerKeybinding.getLabel() + \")\" : ''), 'show-next-problem codicon-chevron-down', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(true, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); }),\r\n            new Action(PrevMarkerAction.ID, PrevMarkerAction.LABEL + (prevMarkerKeybinding ? \" (\" + prevMarkerKeybinding.getLabel() + \")\" : ''), 'show-previous-problem codicon-chevron-up', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(false, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); })\r\n        ];\r\n        this._widget = new MarkerNavigationWidget(this._editor, actions, this._themeService, this._openerService);\r\n        this._widgetVisible.set(true);\r\n        this._widget.onDidClose(function () { return _this.closeMarkersNavigation(); }, this, this._disposeOnClose);\r\n        this._disposeOnClose.add(this._model);\r\n        this._disposeOnClose.add(this._widget);\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            this._disposeOnClose.add(action);\r\n        }\r\n        this._disposeOnClose.add(this._widget.onDidSelectRelatedInformation(function (related) {\r\n            _this._editorService.openCodeEditor({\r\n                resource: related.resource,\r\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\r\n            }, _this._editor).then(undefined, onUnexpectedError);\r\n            _this.closeMarkersNavigation(false);\r\n        }));\r\n        this._disposeOnClose.add(this._editor.onDidChangeModel(function () { return _this._cleanUp(); }));\r\n        this._disposeOnClose.add(this._model.onCurrentMarkerChanged(function (marker) {\r\n            if (!marker || !_this._model) {\r\n                _this._cleanUp();\r\n            }\r\n            else {\r\n                _this._model.withoutWatchingEditorPosition(function () {\r\n                    if (!_this._widget || !_this._model) {\r\n                        return;\r\n                    }\r\n                    _this._widget.showAtMarker(marker, _this._model.indexOf(marker), _this._model.total);\r\n                });\r\n            }\r\n        }));\r\n        this._disposeOnClose.add(this._model.onMarkerSetChanged(function () {\r\n            if (!_this._widget || !_this._widget.position || !_this._model) {\r\n                return;\r\n            }\r\n            var marker = _this._model.findMarkerAtPosition(_this._widget.position);\r\n            if (marker) {\r\n                _this._widget.updateMarker(marker);\r\n            }\r\n            else {\r\n                _this._widget.showStale();\r\n            }\r\n        }));\r\n        return this._model;\r\n    };\r\n    MarkerController.prototype.closeMarkersNavigation = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._cleanUp();\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    MarkerController.prototype.show = function (marker) {\r\n        var model = this.getOrCreateModel();\r\n        model.currentMarker = marker;\r\n    };\r\n    MarkerController.prototype._onMarkerChanged = function (changedResources) {\r\n        var editorModel = this._editor.getModel();\r\n        if (!editorModel) {\r\n            return;\r\n        }\r\n        if (!this._model) {\r\n            return;\r\n        }\r\n        if (!changedResources.some(function (r) { return isEqual(editorModel.uri, r); })) {\r\n            return;\r\n        }\r\n        this._model.setMarkers(this._getMarkers());\r\n    };\r\n    MarkerController.prototype._getMarkers = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return [];\r\n        }\r\n        return this._markerService.read({\r\n            resource: model.uri,\r\n            severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\r\n        });\r\n    };\r\n    MarkerController.ID = 'editor.contrib.markerController';\r\n    MarkerController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IThemeService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, IOpenerService)\r\n    ], MarkerController);\r\n    return MarkerController;\r\n}());\r\nexport { MarkerController };\r\nvar MarkerNavigationAction = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationAction, _super);\r\n    function MarkerNavigationAction(next, multiFile, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        _this._multiFile = multiFile;\r\n        return _this;\r\n    }\r\n    MarkerNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var markerService = accessor.get(IMarkerService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var controller = MarkerController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var model = controller.getOrCreateModel();\r\n        var atEdge = model.move(this._isNext, !this._multiFile);\r\n        if (!atEdge || !this._multiFile) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // try with the next/prev file\r\n        var markers = markerService.read({ severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info }).sort(MarkerNavigationAction.compareMarker);\r\n        if (markers.length === 0) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var editorModel = editor.getModel();\r\n        if (!editorModel) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var oldMarker = model.currentMarker || { resource: editorModel.uri, severity: MarkerSeverity.Error, startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 };\r\n        var idx = binarySearch(markers, oldMarker, MarkerNavigationAction.compareMarker);\r\n        if (idx < 0) {\r\n            // find best match...\r\n            idx = ~idx;\r\n            idx %= markers.length;\r\n        }\r\n        else if (this._isNext) {\r\n            idx = (idx + 1) % markers.length;\r\n        }\r\n        else {\r\n            idx = (idx + markers.length - 1) % markers.length;\r\n        }\r\n        var newMarker = markers[idx];\r\n        if (isEqual(newMarker.resource, editorModel.uri)) {\r\n            // the next `resource` is this resource which\r\n            // means we cycle within this file\r\n            model.move(this._isNext, true);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // close the widget for this editor-instance, open the resource\r\n        // for the next marker and re-start marker navigation in there\r\n        controller.closeMarkersNavigation();\r\n        return editorService.openCodeEditor({\r\n            resource: newMarker.resource,\r\n            options: { pinned: false, revealIfOpened: true, revealInCenterIfOutsideViewport: true, selection: newMarker }\r\n        }, editor).then(function (editor) {\r\n            if (!editor) {\r\n                return undefined;\r\n            }\r\n            return editor.getAction(_this.id).run();\r\n        });\r\n    };\r\n    MarkerNavigationAction.compareMarker = function (a, b) {\r\n        var res = compare(a.resource.toString(), b.resource.toString());\r\n        if (res === 0) {\r\n            res = MarkerSeverity.compare(a.severity, b.severity);\r\n        }\r\n        if (res === 0) {\r\n            res = Range.compareRangesUsingStarts(a, b);\r\n        }\r\n        return res;\r\n    };\r\n    return MarkerNavigationAction;\r\n}(EditorAction));\r\nvar NextMarkerAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerAction, _super);\r\n    function NextMarkerAction() {\r\n        return _super.call(this, true, false, {\r\n            id: NextMarkerAction.ID,\r\n            label: NextMarkerAction.LABEL,\r\n            alias: 'Go to Next Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    NextMarkerAction.ID = 'editor.action.marker.next';\r\n    NextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\r\n    return NextMarkerAction;\r\n}(MarkerNavigationAction));\r\nexport { NextMarkerAction };\r\nvar PrevMarkerAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerAction, _super);\r\n    function PrevMarkerAction() {\r\n        return _super.call(this, false, false, {\r\n            id: PrevMarkerAction.ID,\r\n            label: PrevMarkerAction.LABEL,\r\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 1024 /* Shift */ | 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    PrevMarkerAction.ID = 'editor.action.marker.prev';\r\n    PrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\r\n    return PrevMarkerAction;\r\n}(MarkerNavigationAction));\r\nvar NextMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerInFilesAction, _super);\r\n    function NextMarkerInFilesAction() {\r\n        return _super.call(this, true, true, {\r\n            id: 'editor.action.marker.nextInFiles',\r\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nvar PrevMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerInFilesAction, _super);\r\n    function PrevMarkerInFilesAction() {\r\n        return _super.call(this, false, true, {\r\n            id: 'editor.action.marker.prevInFiles',\r\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nregisterEditorContribution(MarkerController.ID, MarkerController);\r\nregisterEditorAction(NextMarkerAction);\r\nregisterEditorAction(PrevMarkerAction);\r\nregisterEditorAction(NextMarkerInFilesAction);\r\nregisterEditorAction(PrevMarkerInFilesAction);\r\nvar CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\r\nvar MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\r\nregisterEditorCommand(new MarkerCommand({\r\n    id: 'closeMarkersNavigation',\r\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\r\n    handler: function (x) { return x.closeMarkersNavigation(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 50,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.nextInFiles',\r\n        title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\")\r\n    },\r\n    order: 1\r\n});\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.prevInFiles',\r\n        title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\")\r\n    },\r\n    order: 2\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nvar ColorPickerModel = /** @class */ (function () {\r\n    function ColorPickerModel(color, availableColorPresentations, presentationIndex) {\r\n        this.presentationIndex = presentationIndex;\r\n        this._onColorFlushed = new Emitter();\r\n        this.onColorFlushed = this._onColorFlushed.event;\r\n        this._onDidChangeColor = new Emitter();\r\n        this.onDidChangeColor = this._onDidChangeColor.event;\r\n        this._onDidChangePresentation = new Emitter();\r\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\r\n        this.originalColor = color;\r\n        this._color = color;\r\n        this._colorPresentations = availableColorPresentations;\r\n    }\r\n    Object.defineProperty(ColorPickerModel.prototype, \"color\", {\r\n        get: function () {\r\n            return this._color;\r\n        },\r\n        set: function (color) {\r\n            if (this._color.equals(color)) {\r\n                return;\r\n            }\r\n            this._color = color;\r\n            this._onDidChangeColor.fire(color);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColorPickerModel.prototype, \"presentation\", {\r\n        get: function () { return this.colorPresentations[this.presentationIndex]; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColorPickerModel.prototype, \"colorPresentations\", {\r\n        get: function () {\r\n            return this._colorPresentations;\r\n        },\r\n        set: function (colorPresentations) {\r\n            this._colorPresentations = colorPresentations;\r\n            if (this.presentationIndex > colorPresentations.length - 1) {\r\n                this.presentationIndex = 0;\r\n            }\r\n            this._onDidChangePresentation.fire(this.presentation);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ColorPickerModel.prototype.selectNextColorPresentation = function () {\r\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\r\n        this.flushColor();\r\n        this._onDidChangePresentation.fire(this.presentation);\r\n    };\r\n    ColorPickerModel.prototype.guessColorPresentation = function (color, originalText) {\r\n        for (var i = 0; i < this.colorPresentations.length; i++) {\r\n            if (originalText === this.colorPresentations[i].label) {\r\n                this.presentationIndex = i;\r\n                this._onDidChangePresentation.fire(this.presentation);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    ColorPickerModel.prototype.flushColor = function () {\r\n        this._onColorFlushed.fire(this._color);\r\n    };\r\n    return ColorPickerModel;\r\n}());\r\nexport { ColorPickerModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './colorPicker.css';\r\nimport { onDidChangeZoomLevel } from '../../../base/browser/browser.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Color, HSVA, RGBA } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { editorHoverBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nvar $ = dom.$;\r\nvar ColorPickerHeader = /** @class */ (function (_super) {\r\n    __extends(ColorPickerHeader, _super);\r\n    function ColorPickerHeader(container, model, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.domNode = $('.colorpicker-header');\r\n        dom.append(container, _this.domNode);\r\n        _this.pickedColorNode = dom.append(_this.domNode, $('.picked-color'));\r\n        var colorBox = dom.append(_this.domNode, $('.original-color'));\r\n        colorBox.style.backgroundColor = Color.Format.CSS.format(_this.model.originalColor) || '';\r\n        _this.backgroundColor = themeService.getTheme().getColor(editorHoverBackground) || Color.white;\r\n        _this._register(registerThemingParticipant(function (theme, collector) {\r\n            _this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this.pickedColorNode, dom.EventType.CLICK, function () { return _this.model.selectNextColorPresentation(); }));\r\n        _this._register(dom.addDisposableListener(colorBox, dom.EventType.CLICK, function () {\r\n            _this.model.color = _this.model.originalColor;\r\n            _this.model.flushColor();\r\n        }));\r\n        _this._register(model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this._register(model.onDidChangePresentation(_this.onDidChangePresentation, _this));\r\n        _this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\r\n        dom.toggleClass(_this.pickedColorNode, 'light', model.color.rgba.a < 0.5 ? _this.backgroundColor.isLighter() : model.color.isLighter());\r\n        return _this;\r\n    }\r\n    ColorPickerHeader.prototype.onDidChangeColor = function (color) {\r\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\r\n        dom.toggleClass(this.pickedColorNode, 'light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\r\n        this.onDidChangePresentation();\r\n    };\r\n    ColorPickerHeader.prototype.onDidChangePresentation = function () {\r\n        this.pickedColorNode.textContent = this.model.presentation ? this.model.presentation.label : '';\r\n    };\r\n    return ColorPickerHeader;\r\n}(Disposable));\r\nexport { ColorPickerHeader };\r\nvar ColorPickerBody = /** @class */ (function (_super) {\r\n    __extends(ColorPickerBody, _super);\r\n    function ColorPickerBody(container, model, pixelRatio) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this.domNode = $('.colorpicker-body');\r\n        dom.append(container, _this.domNode);\r\n        _this.saturationBox = new SaturationBox(_this.domNode, _this.model, _this.pixelRatio);\r\n        _this._register(_this.saturationBox);\r\n        _this._register(_this.saturationBox.onDidChange(_this.onDidSaturationValueChange, _this));\r\n        _this._register(_this.saturationBox.onColorFlushed(_this.flushColor, _this));\r\n        _this.opacityStrip = new OpacityStrip(_this.domNode, _this.model);\r\n        _this._register(_this.opacityStrip);\r\n        _this._register(_this.opacityStrip.onDidChange(_this.onDidOpacityChange, _this));\r\n        _this._register(_this.opacityStrip.onColorFlushed(_this.flushColor, _this));\r\n        _this.hueStrip = new HueStrip(_this.domNode, _this.model);\r\n        _this._register(_this.hueStrip);\r\n        _this._register(_this.hueStrip.onDidChange(_this.onDidHueChange, _this));\r\n        _this._register(_this.hueStrip.onColorFlushed(_this.flushColor, _this));\r\n        return _this;\r\n    }\r\n    ColorPickerBody.prototype.flushColor = function () {\r\n        this.model.flushColor();\r\n    };\r\n    ColorPickerBody.prototype.onDidSaturationValueChange = function (_a) {\r\n        var s = _a.s, v = _a.v;\r\n        var hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\r\n    };\r\n    ColorPickerBody.prototype.onDidOpacityChange = function (a) {\r\n        var hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\r\n    };\r\n    ColorPickerBody.prototype.onDidHueChange = function (value) {\r\n        var hsva = this.model.color.hsva;\r\n        var h = (1 - value) * 360;\r\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\r\n    };\r\n    ColorPickerBody.prototype.layout = function () {\r\n        this.saturationBox.layout();\r\n        this.opacityStrip.layout();\r\n        this.hueStrip.layout();\r\n    };\r\n    return ColorPickerBody;\r\n}(Disposable));\r\nexport { ColorPickerBody };\r\nvar SaturationBox = /** @class */ (function (_super) {\r\n    __extends(SaturationBox, _super);\r\n    function SaturationBox(container, model, pixelRatio) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this._onDidChange = new Emitter();\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onColorFlushed = new Emitter();\r\n        _this.onColorFlushed = _this._onColorFlushed.event;\r\n        _this.domNode = $('.saturation-wrap');\r\n        dom.append(container, _this.domNode);\r\n        // Create canvas, draw selected color\r\n        _this.canvas = document.createElement('canvas');\r\n        _this.canvas.className = 'saturation-box';\r\n        dom.append(_this.domNode, _this.canvas);\r\n        // Add selection circle\r\n        _this.selection = $('.saturation-selection');\r\n        dom.append(_this.domNode, _this.selection);\r\n        _this.layout();\r\n        _this._register(dom.addDisposableGenericMouseDownListner(_this.domNode, function (e) { return _this.onMouseDown(e); }));\r\n        _this._register(_this.model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this.monitor = null;\r\n        return _this;\r\n    }\r\n    SaturationBox.prototype.onMouseDown = function (e) {\r\n        var _this = this;\r\n        this.monitor = this._register(new GlobalMouseMoveMonitor());\r\n        var origin = dom.getDomNodePagePosition(this.domNode);\r\n        if (e.target !== this.selection) {\r\n            this.onDidChangePosition(e.offsetX, e.offsetY);\r\n        }\r\n        this.monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, function (event) { return _this.onDidChangePosition(event.posx - origin.left, event.posy - origin.top); }, function () { return null; });\r\n        var mouseUpListener = dom.addDisposableGenericMouseUpListner(document, function () {\r\n            _this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            if (_this.monitor) {\r\n                _this.monitor.stopMonitoring(true);\r\n                _this.monitor = null;\r\n            }\r\n        }, true);\r\n    };\r\n    SaturationBox.prototype.onDidChangePosition = function (left, top) {\r\n        var s = Math.max(0, Math.min(1, left / this.width));\r\n        var v = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.paintSelection(s, v);\r\n        this._onDidChange.fire({ s: s, v: v });\r\n    };\r\n    SaturationBox.prototype.layout = function () {\r\n        this.width = this.domNode.offsetWidth;\r\n        this.height = this.domNode.offsetHeight;\r\n        this.canvas.width = this.width * this.pixelRatio;\r\n        this.canvas.height = this.height * this.pixelRatio;\r\n        this.paint();\r\n        var hsva = this.model.color.hsva;\r\n        this.paintSelection(hsva.s, hsva.v);\r\n    };\r\n    SaturationBox.prototype.paint = function () {\r\n        var hsva = this.model.color.hsva;\r\n        var saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\r\n        var ctx = this.canvas.getContext('2d');\r\n        var whiteGradient = ctx.createLinearGradient(0, 0, this.canvas.width, 0);\r\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\r\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\r\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n        var blackGradient = ctx.createLinearGradient(0, 0, 0, this.canvas.height);\r\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\r\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\r\n        ctx.rect(0, 0, this.canvas.width, this.canvas.height);\r\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\r\n        ctx.fill();\r\n        ctx.fillStyle = whiteGradient;\r\n        ctx.fill();\r\n        ctx.fillStyle = blackGradient;\r\n        ctx.fill();\r\n    };\r\n    SaturationBox.prototype.paintSelection = function (s, v) {\r\n        this.selection.style.left = s * this.width + \"px\";\r\n        this.selection.style.top = this.height - v * this.height + \"px\";\r\n    };\r\n    SaturationBox.prototype.onDidChangeColor = function () {\r\n        if (this.monitor && this.monitor.isMonitoring()) {\r\n            return;\r\n        }\r\n        this.paint();\r\n    };\r\n    return SaturationBox;\r\n}(Disposable));\r\nvar Strip = /** @class */ (function (_super) {\r\n    __extends(Strip, _super);\r\n    function Strip(container, model) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this._onDidChange = new Emitter();\r\n        _this.onDidChange = _this._onDidChange.event;\r\n        _this._onColorFlushed = new Emitter();\r\n        _this.onColorFlushed = _this._onColorFlushed.event;\r\n        _this.domNode = dom.append(container, $('.strip'));\r\n        _this.overlay = dom.append(_this.domNode, $('.overlay'));\r\n        _this.slider = dom.append(_this.domNode, $('.slider'));\r\n        _this.slider.style.top = \"0px\";\r\n        _this._register(dom.addDisposableGenericMouseDownListner(_this.domNode, function (e) { return _this.onMouseDown(e); }));\r\n        _this.layout();\r\n        return _this;\r\n    }\r\n    Strip.prototype.layout = function () {\r\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\r\n        var value = this.getValue(this.model.color);\r\n        this.updateSliderPosition(value);\r\n    };\r\n    Strip.prototype.onMouseDown = function (e) {\r\n        var _this = this;\r\n        var monitor = this._register(new GlobalMouseMoveMonitor());\r\n        var origin = dom.getDomNodePagePosition(this.domNode);\r\n        dom.addClass(this.domNode, 'grabbing');\r\n        if (e.target !== this.slider) {\r\n            this.onDidChangeTop(e.offsetY);\r\n        }\r\n        monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, function (event) { return _this.onDidChangeTop(event.posy - origin.top); }, function () { return null; });\r\n        var mouseUpListener = dom.addDisposableGenericMouseUpListner(document, function () {\r\n            _this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            monitor.stopMonitoring(true);\r\n            dom.removeClass(_this.domNode, 'grabbing');\r\n        }, true);\r\n    };\r\n    Strip.prototype.onDidChangeTop = function (top) {\r\n        var value = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.updateSliderPosition(value);\r\n        this._onDidChange.fire(value);\r\n    };\r\n    Strip.prototype.updateSliderPosition = function (value) {\r\n        this.slider.style.top = (1 - value) * this.height + \"px\";\r\n    };\r\n    return Strip;\r\n}(Disposable));\r\nvar OpacityStrip = /** @class */ (function (_super) {\r\n    __extends(OpacityStrip, _super);\r\n    function OpacityStrip(container, model) {\r\n        var _this = _super.call(this, container, model) || this;\r\n        dom.addClass(_this.domNode, 'opacity-strip');\r\n        _this._register(model.onDidChangeColor(_this.onDidChangeColor, _this));\r\n        _this.onDidChangeColor(_this.model.color);\r\n        return _this;\r\n    }\r\n    OpacityStrip.prototype.onDidChangeColor = function (color) {\r\n        var _a = color.rgba, r = _a.r, g = _a.g, b = _a.b;\r\n        var opaque = new Color(new RGBA(r, g, b, 1));\r\n        var transparent = new Color(new RGBA(r, g, b, 0));\r\n        this.overlay.style.background = \"linear-gradient(to bottom, \" + opaque + \" 0%, \" + transparent + \" 100%)\";\r\n    };\r\n    OpacityStrip.prototype.getValue = function (color) {\r\n        return color.hsva.a;\r\n    };\r\n    return OpacityStrip;\r\n}(Strip));\r\nvar HueStrip = /** @class */ (function (_super) {\r\n    __extends(HueStrip, _super);\r\n    function HueStrip(container, model) {\r\n        var _this = _super.call(this, container, model) || this;\r\n        dom.addClass(_this.domNode, 'hue-strip');\r\n        return _this;\r\n    }\r\n    HueStrip.prototype.getValue = function (color) {\r\n        return 1 - (color.hsva.h / 360);\r\n    };\r\n    return HueStrip;\r\n}(Strip));\r\nvar ColorPickerWidget = /** @class */ (function (_super) {\r\n    __extends(ColorPickerWidget, _super);\r\n    function ColorPickerWidget(container, model, pixelRatio, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = model;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this._register(onDidChangeZoomLevel(function () { return _this.layout(); }));\r\n        var element = $('.colorpicker-widget');\r\n        container.appendChild(element);\r\n        var header = new ColorPickerHeader(element, _this.model, themeService);\r\n        _this.body = new ColorPickerBody(element, _this.model, _this.pixelRatio);\r\n        _this._register(header);\r\n        _this._register(_this.body);\r\n        return _this;\r\n    }\r\n    ColorPickerWidget.prototype.layout = function () {\r\n        this.body.layout();\r\n    };\r\n    return ColorPickerWidget;\r\n}(Widget));\r\nexport { ColorPickerWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { HoverProviderRegistry } from '../../common/modes.js';\r\nexport function getHover(model, position, token) {\r\n    var supports = HoverProviderRegistry.ordered(model);\r\n    var promises = supports.map(function (support) {\r\n        return Promise.resolve(support.provideHover(model, position, token)).then(function (hover) {\r\n            return hover && isValid(hover) ? hover : undefined;\r\n        }, function (err) {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises).then(coalesce);\r\n}\r\nregisterModelAndPositionCommand('_executeHoverProvider', function (model, position) { return getHover(model, position, CancellationToken.None); });\r\nfunction isValid(result) {\r\n    var hasRange = (typeof result.range !== 'undefined');\r\n    var hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\r\n    return hasRange && hasHtmlContent;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar HoverOperation = /** @class */ (function () {\r\n    function HoverOperation(computer, success, error, progress, hoverTime) {\r\n        var _this = this;\r\n        this._computer = computer;\r\n        this._state = 0 /* IDLE */;\r\n        this._hoverTime = hoverTime;\r\n        this._firstWaitScheduler = new RunOnceScheduler(function () { return _this._triggerAsyncComputation(); }, 0);\r\n        this._secondWaitScheduler = new RunOnceScheduler(function () { return _this._triggerSyncComputation(); }, 0);\r\n        this._loadingMessageScheduler = new RunOnceScheduler(function () { return _this._showLoadingMessage(); }, 0);\r\n        this._asyncComputationPromise = null;\r\n        this._asyncComputationPromiseDone = false;\r\n        this._completeCallback = success;\r\n        this._errorCallback = error;\r\n        this._progressCallback = progress;\r\n    }\r\n    HoverOperation.prototype.setHoverTime = function (hoverTime) {\r\n        this._hoverTime = hoverTime;\r\n    };\r\n    HoverOperation.prototype._firstWaitTime = function () {\r\n        return this._hoverTime / 2;\r\n    };\r\n    HoverOperation.prototype._secondWaitTime = function () {\r\n        return this._hoverTime / 2;\r\n    };\r\n    HoverOperation.prototype._loadingMessageTime = function () {\r\n        return 3 * this._hoverTime;\r\n    };\r\n    HoverOperation.prototype._triggerAsyncComputation = function () {\r\n        var _this = this;\r\n        this._state = 2 /* SECOND_WAIT */;\r\n        this._secondWaitScheduler.schedule(this._secondWaitTime());\r\n        if (this._computer.computeAsync) {\r\n            this._asyncComputationPromiseDone = false;\r\n            this._asyncComputationPromise = createCancelablePromise(function (token) { return _this._computer.computeAsync(token); });\r\n            this._asyncComputationPromise.then(function (asyncResult) {\r\n                _this._asyncComputationPromiseDone = true;\r\n                _this._withAsyncResult(asyncResult);\r\n            }, function (e) { return _this._onError(e); });\r\n        }\r\n        else {\r\n            this._asyncComputationPromiseDone = true;\r\n        }\r\n    };\r\n    HoverOperation.prototype._triggerSyncComputation = function () {\r\n        if (this._computer.computeSync) {\r\n            this._computer.onResult(this._computer.computeSync(), true);\r\n        }\r\n        if (this._asyncComputationPromiseDone) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n        else {\r\n            this._state = 3 /* WAITING_FOR_ASYNC_COMPUTATION */;\r\n            this._onProgress(this._computer.getResult());\r\n        }\r\n    };\r\n    HoverOperation.prototype._showLoadingMessage = function () {\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._onProgress(this._computer.getResultWithLoadingMessage());\r\n        }\r\n    };\r\n    HoverOperation.prototype._withAsyncResult = function (asyncResult) {\r\n        if (asyncResult) {\r\n            this._computer.onResult(asyncResult, false);\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n    };\r\n    HoverOperation.prototype._onComplete = function (value) {\r\n        if (this._completeCallback) {\r\n            this._completeCallback(value);\r\n        }\r\n    };\r\n    HoverOperation.prototype._onError = function (error) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback(error);\r\n        }\r\n        else {\r\n            onUnexpectedError(error);\r\n        }\r\n    };\r\n    HoverOperation.prototype._onProgress = function (value) {\r\n        if (this._progressCallback) {\r\n            this._progressCallback(value);\r\n        }\r\n    };\r\n    HoverOperation.prototype.start = function (mode) {\r\n        if (mode === 0 /* Delayed */) {\r\n            if (this._state === 0 /* IDLE */) {\r\n                this._state = 1 /* FIRST_WAIT */;\r\n                this._firstWaitScheduler.schedule(this._firstWaitTime());\r\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime());\r\n            }\r\n        }\r\n        else {\r\n            switch (this._state) {\r\n                case 0 /* IDLE */:\r\n                    this._triggerAsyncComputation();\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n                case 2 /* SECOND_WAIT */:\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    HoverOperation.prototype.cancel = function () {\r\n        this._loadingMessageScheduler.cancel();\r\n        if (this._state === 1 /* FIRST_WAIT */) {\r\n            this._firstWaitScheduler.cancel();\r\n        }\r\n        if (this._state === 2 /* SECOND_WAIT */) {\r\n            this._secondWaitScheduler.cancel();\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        this._state = 0 /* IDLE */;\r\n    };\r\n    return HoverOperation;\r\n}());\r\nexport { HoverOperation };\r\n","/**\n * marked - a markdown parser\n * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n// BEGIN MONACOCHANGE\nvar __marked_exports;\n// END MONACOCHANGE\n\n;(function(root) {\n'use strict';\n\n/**\n * Block-Level Grammar\n */\n\nvar block = {\n  newline: /^\\n+/,\n  code: /^( {4}[^\\n]+\\n*)+/,\n  fences: noop,\n  hr: /^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)/,\n  heading: /^ *(#{1,6}) *([^\\n]+?) *(?:#+ *)?(?:\\n+|$)/,\n  nptable: noop,\n  blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n  list: /^( {0,3})(bull) [\\s\\S]+?(?:hr|def|\\n{2,}(?! )(?!\\1bull )\\n*|\\s*$)/,\n  html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?\\\\?>\\\\n*' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?>\\\\n*' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\\\\n*' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (6)\n    + '|<(?!script|pre|style)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) open tag\n    + '|</(?!script|pre|style)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) closing tag\n    + ')',\n  def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,\n  table: noop,\n  lheading: /^([^\\n]+)\\n *(=|-){2,} *(?:\\n+|$)/,\n  paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading| {0,3}>|<\\/?(?:tag)(?: +|\\n|\\/?>)|<(?:script|pre|style|!--))[^\\n]+)*)/,\n  text: /^[^\\n]+/\n};\n\nblock._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;\nblock._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\nblock.def = edit(block.def)\n  .replace('label', block._label)\n  .replace('title', block._title)\n  .getRegex();\n\nblock.bullet = /(?:[*+-]|\\d{1,9}\\.)/;\nblock.item = /^( *)(bull) ?[^\\n]*(?:\\n(?!\\1bull ?)[^\\n]*)*/;\nblock.item = edit(block.item, 'gm')\n  .replace(/bull/g, block.bullet)\n  .getRegex();\n\nblock.list = edit(block.list)\n  .replace(/bull/g, block.bullet)\n  .replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))')\n  .replace('def', '\\\\n+(?=' + block.def.source + ')')\n  .getRegex();\n\nblock._tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n  + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n  + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n  + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n  + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'\n  + '|track|ul';\nblock._comment = /<!--(?!-?>)[\\s\\S]*?-->/;\nblock.html = edit(block.html, 'i')\n  .replace('comment', block._comment)\n  .replace('tag', block._tag)\n  .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n  .getRegex();\n\nblock.paragraph = edit(block.paragraph)\n  .replace('hr', block.hr)\n  .replace('heading', block.heading)\n  .replace('lheading', block.lheading)\n  .replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n\nblock.blockquote = edit(block.blockquote)\n  .replace('paragraph', block.paragraph)\n  .getRegex();\n\n/**\n * Normal Block Grammar\n */\n\nblock.normal = merge({}, block);\n\n/**\n * GFM Block Grammar\n */\n\nblock.gfm = merge({}, block.normal, {\n  fences: /^ {0,3}(`{3,}|~{3,})([^`\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?:\\n+|$)|$)/,\n  paragraph: /^/,\n  heading: /^ *(#{1,6}) +([^\\n]+?) *#* *(?:\\n+|$)/\n});\n\nblock.gfm.paragraph = edit(block.paragraph)\n  .replace('(?!', '(?!'\n    + block.gfm.fences.source.replace('\\\\1', '\\\\2') + '|'\n    + block.list.source.replace('\\\\1', '\\\\3') + '|')\n  .getRegex();\n\n/**\n * GFM + Tables Block Grammar\n */\n\nblock.tables = merge({}, block.gfm, {\n  nptable: /^ *([^|\\n ].*\\|.*)\\n *([-:]+ *\\|[-| :]*)(?:\\n((?:.*[^>\\n ].*(?:\\n|$))*)\\n*|$)/,\n  table: /^ *\\|(.+)\\n *\\|?( *[-:]+[-| :]*)(?:\\n((?: *[^>\\n ].*(?:\\n|$))*)\\n*|$)/\n});\n\n/**\n * Pedantic grammar\n */\n\nblock.pedantic = merge({}, block.normal, {\n  html: edit(\n    '^ *(?:comment *(?:\\\\n|\\\\s*$)'\n    + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n    .replace('comment', block._comment)\n    .replace(/tag/g, '(?!(?:'\n      + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n      + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n      + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n    .getRegex(),\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/\n});\n\n/**\n * Block Lexer\n */\n\nfunction Lexer(options) {\n  this.tokens = [];\n  this.tokens.links = Object.create(null);\n  this.options = options || marked.defaults;\n  this.rules = block.normal;\n\n  if (this.options.pedantic) {\n    this.rules = block.pedantic;\n  } else if (this.options.gfm) {\n    if (this.options.tables) {\n      this.rules = block.tables;\n    } else {\n      this.rules = block.gfm;\n    }\n  }\n}\n\n/**\n * Expose Block Rules\n */\n\nLexer.rules = block;\n\n/**\n * Static Lex Method\n */\n\nLexer.lex = function(src, options) {\n  var lexer = new Lexer(options);\n  return lexer.lex(src);\n};\n\n/**\n * Preprocessing\n */\n\nLexer.prototype.lex = function(src) {\n  src = src\n    .replace(/\\r\\n|\\r/g, '\\n')\n    .replace(/\\t/g, '    ')\n    .replace(/\\u00a0/g, ' ')\n    .replace(/\\u2424/g, '\\n');\n\n  return this.token(src, true);\n};\n\n/**\n * Lexing\n */\n\nLexer.prototype.token = function(src, top) {\n  src = src.replace(/^ +$/gm, '');\n  var next,\n      loose,\n      cap,\n      bull,\n      b,\n      item,\n      listStart,\n      listItems,\n      t,\n      space,\n      i,\n      tag,\n      l,\n      isordered,\n      istask,\n      ischecked;\n\n  while (src) {\n    // newline\n    if (cap = this.rules.newline.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[0].length > 1) {\n        this.tokens.push({\n          type: 'space'\n        });\n      }\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      cap = cap[0].replace(/^ {4}/gm, '');\n      this.tokens.push({\n        type: 'code',\n        text: !this.options.pedantic\n          ? rtrim(cap, '\\n')\n          : cap\n      });\n      continue;\n    }\n\n    // fences (gfm)\n    if (cap = this.rules.fences.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'code',\n        lang: cap[2] ? cap[2].trim() : cap[2],\n        text: cap[3] || ''\n      });\n      continue;\n    }\n\n    // heading\n    if (cap = this.rules.heading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[1].length,\n        text: cap[2]\n      });\n      continue;\n    }\n\n    // table no leading pipe (gfm)\n    if (cap = this.rules.nptable.exec(src)) {\n      item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n      };\n\n      if (item.header.length === item.align.length) {\n        src = src.substring(cap[0].length);\n\n        for (i = 0; i < item.align.length; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        for (i = 0; i < item.cells.length; i++) {\n          item.cells[i] = splitCells(item.cells[i], item.header.length);\n        }\n\n        this.tokens.push(item);\n\n        continue;\n      }\n    }\n\n    // hr\n    if (cap = this.rules.hr.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'hr'\n      });\n      continue;\n    }\n\n    // blockquote\n    if (cap = this.rules.blockquote.exec(src)) {\n      src = src.substring(cap[0].length);\n\n      this.tokens.push({\n        type: 'blockquote_start'\n      });\n\n      cap = cap[0].replace(/^ *> ?/gm, '');\n\n      // Pass `top` to keep the current\n      // \"toplevel\" state. This is exactly\n      // how markdown.pl works.\n      this.token(cap, top);\n\n      this.tokens.push({\n        type: 'blockquote_end'\n      });\n\n      continue;\n    }\n\n    // list\n    if (cap = this.rules.list.exec(src)) {\n      src = src.substring(cap[0].length);\n      bull = cap[2];\n      isordered = bull.length > 1;\n\n      listStart = {\n        type: 'list_start',\n        ordered: isordered,\n        start: isordered ? +bull : '',\n        loose: false\n      };\n\n      this.tokens.push(listStart);\n\n      // Get each top-level item.\n      cap = cap[0].match(this.rules.item);\n\n      listItems = [];\n      next = false;\n      l = cap.length;\n      i = 0;\n\n      for (; i < l; i++) {\n        item = cap[i];\n\n        // Remove the list item's bullet\n        // so it is seen as the next token.\n        space = item.length;\n        item = item.replace(/^ *([*+-]|\\d+\\.) */, '');\n\n        // Outdent whatever the\n        // list item contains. Hacky.\n        if (~item.indexOf('\\n ')) {\n          space -= item.length;\n          item = !this.options.pedantic\n            ? item.replace(new RegExp('^ {1,' + space + '}', 'gm'), '')\n            : item.replace(/^ {1,4}/gm, '');\n        }\n\n        // Determine whether the next list item belongs here.\n        // Backpedal if it does not belong in this list.\n        if (i !== l - 1) {\n          b = block.bullet.exec(cap[i + 1])[0];\n          if (bull.length > 1 ? b.length === 1\n            : (b.length > 1 || (this.options.smartLists && b !== bull))) {\n            src = cap.slice(i + 1).join('\\n') + src;\n            i = l - 1;\n          }\n        }\n\n        // Determine whether item is loose or not.\n        // Use: /(^|\\n)(?! )[^\\n]+\\n\\n(?!\\s*$)/\n        // for discount behavior.\n        loose = next || /\\n\\n(?!\\s*$)/.test(item);\n        if (i !== l - 1) {\n          next = item.charAt(item.length - 1) === '\\n';\n          if (!loose) loose = next;\n        }\n\n        if (loose) {\n          listStart.loose = true;\n        }\n\n        // Check for task list items\n        istask = /^\\[[ xX]\\] /.test(item);\n        ischecked = undefined;\n        if (istask) {\n          ischecked = item[1] !== ' ';\n          item = item.replace(/^\\[[ xX]\\] +/, '');\n        }\n\n        t = {\n          type: 'list_item_start',\n          task: istask,\n          checked: ischecked,\n          loose: loose\n        };\n\n        listItems.push(t);\n        this.tokens.push(t);\n\n        // Recurse.\n        this.token(item, false);\n\n        this.tokens.push({\n          type: 'list_item_end'\n        });\n      }\n\n      if (listStart.loose) {\n        l = listItems.length;\n        i = 0;\n        for (; i < l; i++) {\n          listItems[i].loose = true;\n        }\n      }\n\n      this.tokens.push({\n        type: 'list_end'\n      });\n\n      continue;\n    }\n\n    // html\n    if (cap = this.rules.html.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: this.options.sanitize\n          ? 'paragraph'\n          : 'html',\n        pre: !this.options.sanitizer\n          && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n        text: cap[0]\n      });\n      continue;\n    }\n\n    // def\n    if (top && (cap = this.rules.def.exec(src))) {\n      src = src.substring(cap[0].length);\n      if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n      tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n      if (!this.tokens.links[tag]) {\n        this.tokens.links[tag] = {\n          href: cap[2],\n          title: cap[3]\n        };\n      }\n      continue;\n    }\n\n    // table (gfm)\n    if (cap = this.rules.table.exec(src)) {\n      item = {\n        type: 'table',\n        header: splitCells(cap[1].replace(/^ *| *\\| *$/g, '')),\n        align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n        cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n      };\n\n      if (item.header.length === item.align.length) {\n        src = src.substring(cap[0].length);\n\n        for (i = 0; i < item.align.length; i++) {\n          if (/^ *-+: *$/.test(item.align[i])) {\n            item.align[i] = 'right';\n          } else if (/^ *:-+: *$/.test(item.align[i])) {\n            item.align[i] = 'center';\n          } else if (/^ *:-+ *$/.test(item.align[i])) {\n            item.align[i] = 'left';\n          } else {\n            item.align[i] = null;\n          }\n        }\n\n        for (i = 0; i < item.cells.length; i++) {\n          item.cells[i] = splitCells(\n            item.cells[i].replace(/^ *\\| *| *\\| *$/g, ''),\n            item.header.length);\n        }\n\n        this.tokens.push(item);\n\n        continue;\n      }\n    }\n\n    // lheading\n    if (cap = this.rules.lheading.exec(src)) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'heading',\n        depth: cap[2] === '=' ? 1 : 2,\n        text: cap[1]\n      });\n      continue;\n    }\n\n    // top-level paragraph\n    if (top && (cap = this.rules.paragraph.exec(src))) {\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'paragraph',\n        text: cap[1].charAt(cap[1].length - 1) === '\\n'\n          ? cap[1].slice(0, -1)\n          : cap[1]\n      });\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      // Top-level should never reach here.\n      src = src.substring(cap[0].length);\n      this.tokens.push({\n        type: 'text',\n        text: cap[0]\n      });\n      continue;\n    }\n\n    if (src) {\n      throw new Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return this.tokens;\n};\n\n/**\n * Inline-Level Grammar\n */\n\nvar inline = {\n  escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n  autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n  url: noop,\n  tag: '^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>', // CDATA section\n  link: /^!?\\[(label)\\]\\(href(?:\\s+(title))?\\s*\\)/,\n  reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,\n  nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,\n  strong: /^__([^\\s_])__(?!_)|^\\*\\*([^\\s*])\\*\\*(?!\\*)|^__([^\\s][\\s\\S]*?[^\\s])__(?!_)|^\\*\\*([^\\s][\\s\\S]*?[^\\s])\\*\\*(?!\\*)/,\n  em: /^_([^\\s_])_(?!_)|^\\*([^\\s*\"<\\[])\\*(?!\\*)|^_([^\\s][\\s\\S]*?[^\\s_])_(?!_|[^\\spunctuation])|^_([^\\s_][\\s\\S]*?[^\\s])_(?!_|[^\\spunctuation])|^\\*([^\\s\"<\\[][\\s\\S]*?[^\\s*])\\*(?!\\*)|^\\*([^\\s*\"<\\[][\\s\\S]*?[^\\s])\\*(?!\\*)/,\n  code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n  br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n  del: noop,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[\\\\<!\\[`*]|\\b_|$)|[^ ](?= {2,}\\n))|(?= {2,}\\n))/\n};\n\n// list of punctuation marks from common mark spec\n// without ` and ] to workaround Rule 17 (inline code blocks/links)\ninline._punctuation = '!\"#$%&\\'()*+,\\\\-./:;<=>?@\\\\[^_{|}~';\ninline.em = edit(inline.em).replace(/punctuation/g, inline._punctuation).getRegex();\n\ninline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n\ninline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\ninline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\ninline.autolink = edit(inline.autolink)\n  .replace('scheme', inline._scheme)\n  .replace('email', inline._email)\n  .getRegex();\n\ninline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n\ninline.tag = edit(inline.tag)\n  .replace('comment', block._comment)\n  .replace('attribute', inline._attribute)\n  .getRegex();\n\ninline._label = /(?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]?|`[^`]*`|`(?!`)|[^\\[\\]\\\\`])*?/;\ninline._href = /\\s*(<(?:\\\\[<>]?|[^\\s<>\\\\])*>|[^\\s\\x00-\\x1f]*)/;\ninline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n\ninline.link = edit(inline.link)\n  .replace('label', inline._label)\n  .replace('href', inline._href)\n  .replace('title', inline._title)\n  .getRegex();\n\ninline.reflink = edit(inline.reflink)\n  .replace('label', inline._label)\n  .getRegex();\n\n/**\n * Normal Inline Grammar\n */\n\ninline.normal = merge({}, inline);\n\n/**\n * Pedantic Inline Grammar\n */\n\ninline.pedantic = merge({}, inline.normal, {\n  strong: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n  em: /^_(?=\\S)([\\s\\S]*?\\S)_(?!_)|^\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)/,\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n    .replace('label', inline._label)\n    .getRegex(),\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n    .replace('label', inline._label)\n    .getRegex()\n});\n\n/**\n * GFM Inline Grammar\n */\n\ninline.gfm = merge({}, inline.normal, {\n  escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n  _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n  url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n  _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n  del: /^~+(?=\\S)([\\s\\S]*?\\S)~+/,\n  text: /^(`+|[^`])(?:[\\s\\S]*?(?:(?=[\\\\<!\\[`*~]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))|(?= {2,}\\n|[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))/\n});\n\ninline.gfm.url = edit(inline.gfm.url, 'i')\n  .replace('email', inline.gfm._extended_email)\n  .getRegex();\n/**\n * GFM + Line Breaks Inline Grammar\n */\n\ninline.breaks = merge({}, inline.gfm, {\n  br: edit(inline.br).replace('{2,}', '*').getRegex(),\n  text: edit(inline.gfm.text).replace(/\\{2,\\}/g, '*').getRegex()\n});\n\n/**\n * Inline Lexer & Compiler\n */\n\nfunction InlineLexer(links, options) {\n  this.options = options || marked.defaults;\n  this.links = links;\n  this.rules = inline.normal;\n  this.renderer = this.options.renderer || new Renderer();\n  this.renderer.options = this.options;\n\n  if (!this.links) {\n    throw new Error('Tokens array requires a `links` property.');\n  }\n\n  if (this.options.pedantic) {\n    this.rules = inline.pedantic;\n  } else if (this.options.gfm) {\n    if (this.options.breaks) {\n      this.rules = inline.breaks;\n    } else {\n      this.rules = inline.gfm;\n    }\n  }\n}\n\n/**\n * Expose Inline Rules\n */\n\nInlineLexer.rules = inline;\n\n/**\n * Static Lexing/Compiling Method\n */\n\nInlineLexer.output = function(src, links, options) {\n  var inline = new InlineLexer(links, options);\n  return inline.output(src);\n};\n\n/**\n * Lexing/Compiling\n */\n\nInlineLexer.prototype.output = function(src) {\n  var out = '',\n      link,\n      text,\n      href,\n      title,\n      cap,\n      prevCapZero;\n\n  while (src) {\n    // escape\n    if (cap = this.rules.escape.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += escape(cap[1]);\n      continue;\n    }\n\n    // tag\n    if (cap = this.rules.tag.exec(src)) {\n      if (!this.inLink && /^<a /i.test(cap[0])) {\n        this.inLink = true;\n      } else if (this.inLink && /^<\\/a>/i.test(cap[0])) {\n        this.inLink = false;\n      }\n      if (!this.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.inRawBlock = true;\n      } else if (this.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n        this.inRawBlock = false;\n      }\n\n      src = src.substring(cap[0].length);\n      out += this.options.sanitize\n        ? this.options.sanitizer\n          ? this.options.sanitizer(cap[0])\n          : escape(cap[0])\n        : cap[0];\n      continue;\n    }\n\n    // link\n    if (cap = this.rules.link.exec(src)) {\n      var lastParenIndex = findClosingBracket(cap[2], '()');\n      if (lastParenIndex > -1) {\n        var linkLen = cap[0].length - (cap[2].length - lastParenIndex) - (cap[3] || '').length;\n        cap[2] = cap[2].substring(0, lastParenIndex);\n        cap[0] = cap[0].substring(0, linkLen).trim();\n        cap[3] = '';\n      }\n      src = src.substring(cap[0].length);\n      this.inLink = true;\n      href = cap[2];\n      if (this.options.pedantic) {\n        link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n        if (link) {\n          href = link[1];\n          title = link[3];\n        } else {\n          title = '';\n        }\n      } else {\n        title = cap[3] ? cap[3].slice(1, -1) : '';\n      }\n      href = href.trim().replace(/^<([\\s\\S]*)>$/, '$1');\n      out += this.outputLink(cap, {\n        href: InlineLexer.escapes(href),\n        title: InlineLexer.escapes(title)\n      });\n      this.inLink = false;\n      continue;\n    }\n\n    // reflink, nolink\n    if ((cap = this.rules.reflink.exec(src))\n        || (cap = this.rules.nolink.exec(src))) {\n      src = src.substring(cap[0].length);\n      link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n      link = this.links[link.toLowerCase()];\n      if (!link || !link.href) {\n        out += cap[0].charAt(0);\n        src = cap[0].substring(1) + src;\n        continue;\n      }\n      this.inLink = true;\n      out += this.outputLink(cap, link);\n      this.inLink = false;\n      continue;\n    }\n\n    // strong\n    if (cap = this.rules.strong.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.strong(this.output(cap[4] || cap[3] || cap[2] || cap[1]));\n      continue;\n    }\n\n    // em\n    if (cap = this.rules.em.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.em(this.output(cap[6] || cap[5] || cap[4] || cap[3] || cap[2] || cap[1]));\n      continue;\n    }\n\n    // code\n    if (cap = this.rules.code.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.codespan(escape(cap[2].trim(), true));\n      continue;\n    }\n\n    // br\n    if (cap = this.rules.br.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.br();\n      continue;\n    }\n\n    // del (gfm)\n    if (cap = this.rules.del.exec(src)) {\n      src = src.substring(cap[0].length);\n      out += this.renderer.del(this.output(cap[1]));\n      continue;\n    }\n\n    // autolink\n    if (cap = this.rules.autolink.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (cap[2] === '@') {\n        text = escape(this.mangle(cap[1]));\n        href = 'mailto:' + text;\n      } else {\n        text = escape(cap[1]);\n        href = text;\n      }\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // url (gfm)\n    if (!this.inLink && (cap = this.rules.url.exec(src))) {\n      if (cap[2] === '@') {\n        text = escape(cap[0]);\n        href = 'mailto:' + text;\n      } else {\n        // do extended autolink path validation\n        do {\n          prevCapZero = cap[0];\n          cap[0] = this.rules._backpedal.exec(cap[0])[0];\n        } while (prevCapZero !== cap[0]);\n        text = escape(cap[0]);\n        if (cap[1] === 'www.') {\n          href = 'http://' + text;\n        } else {\n          href = text;\n        }\n      }\n      src = src.substring(cap[0].length);\n      out += this.renderer.link(href, null, text);\n      continue;\n    }\n\n    // text\n    if (cap = this.rules.text.exec(src)) {\n      src = src.substring(cap[0].length);\n      if (this.inRawBlock) {\n        out += this.renderer.text(cap[0]);\n      } else {\n        out += this.renderer.text(escape(this.smartypants(cap[0])));\n      }\n      continue;\n    }\n\n    if (src) {\n      throw new Error('Infinite loop on byte: ' + src.charCodeAt(0));\n    }\n  }\n\n  return out;\n};\n\nInlineLexer.escapes = function(text) {\n  return text ? text.replace(InlineLexer.rules._escapes, '$1') : text;\n};\n\n/**\n * Compile Link\n */\n\nInlineLexer.prototype.outputLink = function(cap, link) {\n  var href = link.href,\n      title = link.title ? escape(link.title) : null;\n\n  return cap[0].charAt(0) !== '!'\n    ? this.renderer.link(href, title, this.output(cap[1]))\n    : this.renderer.image(href, title, escape(cap[1]));\n};\n\n/**\n * Smartypants Transformations\n */\n\nInlineLexer.prototype.smartypants = function(text) {\n  if (!this.options.smartypants) return text;\n  return text\n    // em-dashes\n    .replace(/---/g, '\\u2014')\n    // en-dashes\n    .replace(/--/g, '\\u2013')\n    // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, '$1\\u2018')\n    // closing singles & apostrophes\n    .replace(/'/g, '\\u2019')\n    // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, '$1\\u201c')\n    // closing doubles\n    .replace(/\"/g, '\\u201d')\n    // ellipses\n    .replace(/\\.{3}/g, '\\u2026');\n};\n\n/**\n * Mangle Links\n */\n\nInlineLexer.prototype.mangle = function(text) {\n  if (!this.options.mangle) return text;\n  var out = '',\n      l = text.length,\n      i = 0,\n      ch;\n\n  for (; i < l; i++) {\n    ch = text.charCodeAt(i);\n    if (Math.random() > 0.5) {\n      ch = 'x' + ch.toString(16);\n    }\n    out += '&#' + ch + ';';\n  }\n\n  return out;\n};\n\n/**\n * Renderer\n */\n\nfunction Renderer(options) {\n  this.options = options || marked.defaults;\n}\n\nRenderer.prototype.code = function(code, infostring, escaped) {\n  var lang = (infostring || '').match(/\\S*/)[0];\n  if (this.options.highlight) {\n    var out = this.options.highlight(code, lang);\n    if (out != null && out !== code) {\n      escaped = true;\n      code = out;\n    }\n  }\n\n  if (!lang) {\n    return '<pre><code>'\n      + (escaped ? code : escape(code, true))\n      + '</code></pre>';\n  }\n\n  return '<pre><code class=\"'\n    + this.options.langPrefix\n    + escape(lang, true)\n    + '\">'\n    + (escaped ? code : escape(code, true))\n    + '</code></pre>\\n';\n};\n\nRenderer.prototype.blockquote = function(quote) {\n  return '<blockquote>\\n' + quote + '</blockquote>\\n';\n};\n\nRenderer.prototype.html = function(html) {\n  return html;\n};\n\nRenderer.prototype.heading = function(text, level, raw, slugger) {\n  if (this.options.headerIds) {\n    return '<h'\n      + level\n      + ' id=\"'\n      + this.options.headerPrefix\n      + slugger.slug(raw)\n      + '\">'\n      + text\n      + '</h'\n      + level\n      + '>\\n';\n  }\n  // ignore IDs\n  return '<h' + level + '>' + text + '</h' + level + '>\\n';\n};\n\nRenderer.prototype.hr = function() {\n  return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n};\n\nRenderer.prototype.list = function(body, ordered, start) {\n  var type = ordered ? 'ol' : 'ul',\n      startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n  return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n};\n\nRenderer.prototype.listitem = function(text) {\n  return '<li>' + text + '</li>\\n';\n};\n\nRenderer.prototype.checkbox = function(checked) {\n  return '<input '\n    + (checked ? 'checked=\"\" ' : '')\n    + 'disabled=\"\" type=\"checkbox\"'\n    + (this.options.xhtml ? ' /' : '')\n    + '> ';\n};\n\nRenderer.prototype.paragraph = function(text) {\n  return '<p>' + text + '</p>\\n';\n};\n\nRenderer.prototype.table = function(header, body) {\n  if (body) body = '<tbody>' + body + '</tbody>';\n\n  return '<table>\\n'\n    + '<thead>\\n'\n    + header\n    + '</thead>\\n'\n    + body\n    + '</table>\\n';\n};\n\nRenderer.prototype.tablerow = function(content) {\n  return '<tr>\\n' + content + '</tr>\\n';\n};\n\nRenderer.prototype.tablecell = function(content, flags) {\n  var type = flags.header ? 'th' : 'td';\n  var tag = flags.align\n    ? '<' + type + ' align=\"' + flags.align + '\">'\n    : '<' + type + '>';\n  return tag + content + '</' + type + '>\\n';\n};\n\n// span level renderer\nRenderer.prototype.strong = function(text) {\n  return '<strong>' + text + '</strong>';\n};\n\nRenderer.prototype.em = function(text) {\n  return '<em>' + text + '</em>';\n};\n\nRenderer.prototype.codespan = function(text) {\n  return '<code>' + text + '</code>';\n};\n\nRenderer.prototype.br = function() {\n  return this.options.xhtml ? '<br/>' : '<br>';\n};\n\nRenderer.prototype.del = function(text) {\n  return '<del>' + text + '</del>';\n};\n\nRenderer.prototype.link = function(href, title, text) {\n  href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n  if (href === null) {\n    return text;\n  }\n  var out = '<a href=\"' + escape(href) + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += '>' + text + '</a>';\n  return out;\n};\n\nRenderer.prototype.image = function(href, title, text) {\n  href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n  if (href === null) {\n    return text;\n  }\n\n  var out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n  if (title) {\n    out += ' title=\"' + title + '\"';\n  }\n  out += this.options.xhtml ? '/>' : '>';\n  return out;\n};\n\nRenderer.prototype.text = function(text) {\n  return text;\n};\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\n\nfunction TextRenderer() {}\n\n// no need for block level renderers\n\nTextRenderer.prototype.strong =\nTextRenderer.prototype.em =\nTextRenderer.prototype.codespan =\nTextRenderer.prototype.del =\nTextRenderer.prototype.text = function (text) {\n  return text;\n};\n\nTextRenderer.prototype.link =\nTextRenderer.prototype.image = function(href, title, text) {\n  return '' + text;\n};\n\nTextRenderer.prototype.br = function() {\n  return '';\n};\n\n/**\n * Parsing & Compiling\n */\n\nfunction Parser(options) {\n  this.tokens = [];\n  this.token = null;\n  this.options = options || marked.defaults;\n  this.options.renderer = this.options.renderer || new Renderer();\n  this.renderer = this.options.renderer;\n  this.renderer.options = this.options;\n  this.slugger = new Slugger();\n}\n\n/**\n * Static Parse Method\n */\n\nParser.parse = function(src, options) {\n  var parser = new Parser(options);\n  return parser.parse(src);\n};\n\n/**\n * Parse Loop\n */\n\nParser.prototype.parse = function(src) {\n  this.inline = new InlineLexer(src.links, this.options);\n  // use an InlineLexer with a TextRenderer to extract pure text\n  this.inlineText = new InlineLexer(\n    src.links,\n    merge({}, this.options, {renderer: new TextRenderer()})\n  );\n  this.tokens = src.reverse();\n\n  var out = '';\n  while (this.next()) {\n    out += this.tok();\n  }\n\n  return out;\n};\n\n/**\n * Next Token\n */\n\nParser.prototype.next = function() {\n  return this.token = this.tokens.pop();\n};\n\n/**\n * Preview Next Token\n */\n\nParser.prototype.peek = function() {\n  return this.tokens[this.tokens.length - 1] || 0;\n};\n\n/**\n * Parse Text Tokens\n */\n\nParser.prototype.parseText = function() {\n  var body = this.token.text;\n\n  while (this.peek().type === 'text') {\n    body += '\\n' + this.next().text;\n  }\n\n  return this.inline.output(body);\n};\n\n/**\n * Parse Current Token\n */\n\nParser.prototype.tok = function() {\n  switch (this.token.type) {\n    case 'space': {\n      return '';\n    }\n    case 'hr': {\n      return this.renderer.hr();\n    }\n    case 'heading': {\n      return this.renderer.heading(\n        this.inline.output(this.token.text),\n        this.token.depth,\n        unescape(this.inlineText.output(this.token.text)),\n        this.slugger);\n    }\n    case 'code': {\n      return this.renderer.code(this.token.text,\n        this.token.lang,\n        this.token.escaped);\n    }\n    case 'table': {\n      var header = '',\n          body = '',\n          i,\n          row,\n          cell,\n          j;\n\n      // header\n      cell = '';\n      for (i = 0; i < this.token.header.length; i++) {\n        cell += this.renderer.tablecell(\n          this.inline.output(this.token.header[i]),\n          { header: true, align: this.token.align[i] }\n        );\n      }\n      header += this.renderer.tablerow(cell);\n\n      for (i = 0; i < this.token.cells.length; i++) {\n        row = this.token.cells[i];\n\n        cell = '';\n        for (j = 0; j < row.length; j++) {\n          cell += this.renderer.tablecell(\n            this.inline.output(row[j]),\n            { header: false, align: this.token.align[j] }\n          );\n        }\n\n        body += this.renderer.tablerow(cell);\n      }\n      return this.renderer.table(header, body);\n    }\n    case 'blockquote_start': {\n      body = '';\n\n      while (this.next().type !== 'blockquote_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.blockquote(body);\n    }\n    case 'list_start': {\n      body = '';\n      var ordered = this.token.ordered,\n          start = this.token.start;\n\n      while (this.next().type !== 'list_end') {\n        body += this.tok();\n      }\n\n      return this.renderer.list(body, ordered, start);\n    }\n    case 'list_item_start': {\n      body = '';\n      var loose = this.token.loose;\n      var checked = this.token.checked;\n      var task = this.token.task;\n\n      if (this.token.task) {\n        body += this.renderer.checkbox(checked);\n      }\n\n      while (this.next().type !== 'list_item_end') {\n        body += !loose && this.token.type === 'text'\n          ? this.parseText()\n          : this.tok();\n      }\n      return this.renderer.listitem(body, task, checked);\n    }\n    case 'html': {\n      // TODO parse inline content if parameter markdown=1\n      return this.renderer.html(this.token.text);\n    }\n    case 'paragraph': {\n      return this.renderer.paragraph(this.inline.output(this.token.text));\n    }\n    case 'text': {\n      return this.renderer.paragraph(this.parseText());\n    }\n    default: {\n      var errMsg = 'Token with \"' + this.token.type + '\" type was not found.';\n      if (this.options.silent) {\n        console.log(errMsg);\n      } else {\n        throw new Error(errMsg);\n      }\n    }\n  }\n};\n\n/**\n * Slugger generates header id\n */\n\nfunction Slugger () {\n  this.seen = {};\n}\n\n/**\n * Convert string to unique id\n */\n\nSlugger.prototype.slug = function (value) {\n  var slug = value\n    .toLowerCase()\n    .trim()\n    .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '')\n    .replace(/\\s/g, '-');\n\n  if (this.seen.hasOwnProperty(slug)) {\n    var originalSlug = slug;\n    do {\n      this.seen[originalSlug]++;\n      slug = originalSlug + '-' + this.seen[originalSlug];\n    } while (this.seen.hasOwnProperty(slug));\n  }\n  this.seen[slug] = 0;\n\n  return slug;\n};\n\n/**\n * Helpers\n */\n\nfunction escape(html, encode) {\n  if (encode) {\n    if (escape.escapeTest.test(html)) {\n      return html.replace(escape.escapeReplace, function (ch) { return escape.replacements[ch]; });\n    }\n  } else {\n    if (escape.escapeTestNoEncode.test(html)) {\n      return html.replace(escape.escapeReplaceNoEncode, function (ch) { return escape.replacements[ch]; });\n    }\n  }\n\n  return html;\n}\n\nescape.escapeTest = /[&<>\"']/;\nescape.escapeReplace = /[&<>\"']/g;\nescape.replacements = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\n\nescape.escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\nescape.escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\n\nfunction unescape(html) {\n  // explicitly match decimal, hex, and named HTML entities\n  return html.replace(/&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig, function(_, n) {\n    n = n.toLowerCase();\n    if (n === 'colon') return ':';\n    if (n.charAt(0) === '#') {\n      return n.charAt(1) === 'x'\n        ? String.fromCharCode(parseInt(n.substring(2), 16))\n        : String.fromCharCode(+n.substring(1));\n    }\n    return '';\n  });\n}\n\nfunction edit(regex, opt) {\n  regex = regex.source || regex;\n  opt = opt || '';\n  return {\n    replace: function(name, val) {\n      val = val.source || val;\n      val = val.replace(/(^|[^\\[])\\^/g, '$1');\n      regex = regex.replace(name, val);\n      return this;\n    },\n    getRegex: function() {\n      return new RegExp(regex, opt);\n    }\n  };\n}\n\nfunction cleanUrl(sanitize, base, href) {\n  if (sanitize) {\n    try {\n      var prot = decodeURIComponent(unescape(href))\n        .replace(/[^\\w:]/g, '')\n        .toLowerCase();\n    } catch (e) {\n      return null;\n    }\n    if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n      return null;\n    }\n  }\n  if (base && !originIndependentUrl.test(href)) {\n    href = resolveUrl(base, href);\n  }\n  try {\n    href = encodeURI(href).replace(/%25/g, '%');\n  } catch (e) {\n    return null;\n  }\n  return href;\n}\n\nfunction resolveUrl(base, href) {\n  if (!baseUrls[' ' + base]) {\n    // we can ignore everything in base after the last slash of its path component,\n    // but we might need to add _that_\n    // https://tools.ietf.org/html/rfc3986#section-3\n    if (/^[^:]+:\\/*[^/]*$/.test(base)) {\n      baseUrls[' ' + base] = base + '/';\n    } else {\n      baseUrls[' ' + base] = rtrim(base, '/', true);\n    }\n  }\n  base = baseUrls[' ' + base];\n\n  if (href.slice(0, 2) === '//') {\n    return base.replace(/:[\\s\\S]*/, ':') + href;\n  } else if (href.charAt(0) === '/') {\n    return base.replace(/(:\\/*[^/]*)[\\s\\S]*/, '$1') + href;\n  } else {\n    return base + href;\n  }\n}\nvar baseUrls = {};\nvar originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\n\nfunction noop() {}\nnoop.exec = noop;\n\nfunction merge(obj) {\n  var i = 1,\n      target,\n      key;\n\n  for (; i < arguments.length; i++) {\n    target = arguments[i];\n    for (key in target) {\n      if (Object.prototype.hasOwnProperty.call(target, key)) {\n        obj[key] = target[key];\n      }\n    }\n  }\n\n  return obj;\n}\n\nfunction splitCells(tableRow, count) {\n  // ensure that every cell-delimiting pipe has a space\n  // before it to distinguish it from an escaped pipe\n  var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n        var escaped = false,\n            curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\') escaped = !escaped;\n        if (escaped) {\n          // odd number of slashes means | is escaped\n          // so we leave it alone\n          return '|';\n        } else {\n          // add space before unescaped |\n          return ' |';\n        }\n      }),\n      cells = row.split(/ \\|/),\n      i = 0;\n\n  if (cells.length > count) {\n    cells.splice(count);\n  } else {\n    while (cells.length < count) cells.push('');\n  }\n\n  for (; i < cells.length; i++) {\n    // leading or trailing whitespace is ignored per the gfm spec\n    cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n  }\n  return cells;\n}\n\n// Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n// /c*$/ is vulnerable to REDOS.\n// invert: Remove suffix of non-c chars instead. Default falsey.\nfunction rtrim(str, c, invert) {\n  if (str.length === 0) {\n    return '';\n  }\n\n  // Length of suffix matching the invert condition.\n  var suffLen = 0;\n\n  // Step left until we fail to match the invert condition.\n  while (suffLen < str.length) {\n    var currChar = str.charAt(str.length - suffLen - 1);\n    if (currChar === c && !invert) {\n      suffLen++;\n    } else if (currChar !== c && invert) {\n      suffLen++;\n    } else {\n      break;\n    }\n  }\n\n  return str.substr(0, str.length - suffLen);\n}\n\nfunction findClosingBracket(str, b) {\n  if (str.indexOf(b[1]) === -1) {\n    return -1;\n  }\n  var level = 0;\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] === '\\\\') {\n      i++;\n    } else if (str[i] === b[0]) {\n      level++;\n    } else if (str[i] === b[1]) {\n      level--;\n      if (level < 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Marked\n */\n\nfunction marked(src, opt, callback) {\n  // throw error in case of non string input\n  if (typeof src === 'undefined' || src === null) {\n    throw new Error('marked(): input parameter is undefined or null');\n  }\n  if (typeof src !== 'string') {\n    throw new Error('marked(): input parameter is of type '\n      + Object.prototype.toString.call(src) + ', string expected');\n  }\n\n  if (callback || typeof opt === 'function') {\n    if (!callback) {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n\n    var highlight = opt.highlight,\n        tokens,\n        pending,\n        i = 0;\n\n    try {\n      tokens = Lexer.lex(src, opt);\n    } catch (e) {\n      return callback(e);\n    }\n\n    pending = tokens.length;\n\n    var done = function(err) {\n      if (err) {\n        opt.highlight = highlight;\n        return callback(err);\n      }\n\n      var out;\n\n      try {\n        out = Parser.parse(tokens, opt);\n      } catch (e) {\n        err = e;\n      }\n\n      opt.highlight = highlight;\n\n      return err\n        ? callback(err)\n        : callback(null, out);\n    };\n\n    if (!highlight || highlight.length < 3) {\n      return done();\n    }\n\n    delete opt.highlight;\n\n    if (!pending) return done();\n\n    for (; i < tokens.length; i++) {\n      (function(token) {\n        if (token.type !== 'code') {\n          return --pending || done();\n        }\n        return highlight(token.text, token.lang, function(err, code) {\n          if (err) return done(err);\n          if (code == null || code === token.text) {\n            return --pending || done();\n          }\n          token.text = code;\n          token.escaped = true;\n          --pending || done();\n        });\n      })(tokens[i]);\n    }\n\n    return;\n  }\n  try {\n    if (opt) opt = merge({}, marked.defaults, opt);\n    return Parser.parse(Lexer.lex(src, opt), opt);\n  } catch (e) {\n    e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n    if ((opt || marked.defaults).silent) {\n      return '<p>An error occurred:</p><pre>'\n        + escape(e.message + '', true)\n        + '</pre>';\n    }\n    throw e;\n  }\n}\n\n/**\n * Options\n */\n\nmarked.options =\nmarked.setOptions = function(opt) {\n  merge(marked.defaults, opt);\n  return marked;\n};\n\nmarked.getDefaults = function () {\n  return {\n    baseUrl: null,\n    breaks: false,\n    gfm: true,\n    headerIds: true,\n    headerPrefix: '',\n    highlight: null,\n    langPrefix: 'language-',\n    mangle: true,\n    pedantic: false,\n    renderer: new Renderer(),\n    sanitize: false,\n    sanitizer: null,\n    silent: false,\n    smartLists: false,\n    smartypants: false,\n    tables: true,\n    xhtml: false\n  };\n};\n\nmarked.defaults = marked.getDefaults();\n\n/**\n * Expose\n */\n\nmarked.Parser = Parser;\nmarked.parser = Parser.parse;\n\nmarked.Renderer = Renderer;\nmarked.TextRenderer = TextRenderer;\n\nmarked.Lexer = Lexer;\nmarked.lexer = Lexer.lex;\n\nmarked.InlineLexer = InlineLexer;\nmarked.inlineLexer = InlineLexer.output;\n\nmarked.Slugger = Slugger;\n\nmarked.parse = marked;\n\n// BEGIN MONACOCHANGE\n// if (typeof module !== 'undefined' && typeof exports === 'object') {\n//   module.exports = marked;\n// } else if (typeof define === 'function' && define.amd) {\n//   define(function() { return marked; });\n// } else {\n//   root.marked = marked;\n// }\n// })(this || (typeof window !== 'undefined' ? window : global));\n__marked_exports = marked;\n}).call(this);\n\n// ESM-comment-begin\n// define(function() { return __marked_exports; });\n// ESM-comment-end\n\n// ESM-uncomment-begin\nexport var marked = __marked_exports;\nexport var Parser = __marked_exports.Parser;\nexport var parser = __marked_exports.parser;\nexport var Renderer = __marked_exports.Renderer;\nexport var TextRenderer = __marked_exports.TextRenderer;\nexport var Lexer = __marked_exports.Lexer;\nexport var lexer = __marked_exports.lexer;\nexport var InlineLexer = __marked_exports.InlineLexer;\nexport var inlineLexer = __marked_exports.inlineLexer;\nexport var parse = __marked_exports.parse;\n// ESM-uncomment-end\n// END MONACOCHANGE\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { toggleClass } from '../../../base/browser/dom.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nvar ContentHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ContentHoverWidget, _super);\r\n    function ContentHoverWidget(id, editor) {\r\n        var _this = _super.call(this) || this;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this._id = id;\r\n        _this._editor = editor;\r\n        _this._isVisible = false;\r\n        _this._stoleFocus = false;\r\n        _this._containerDomNode = document.createElement('div');\r\n        _this._containerDomNode.className = 'monaco-editor-hover hidden';\r\n        _this._containerDomNode.tabIndex = 0;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'monaco-editor-hover-content';\r\n        _this.scrollbar = new DomScrollableElement(_this._domNode, {});\r\n        _this._register(_this.scrollbar);\r\n        _this._containerDomNode.appendChild(_this.scrollbar.getDomNode());\r\n        _this.onkeydown(_this._containerDomNode, function (e) {\r\n            if (e.equals(9 /* Escape */)) {\r\n                _this.hide();\r\n            }\r\n        });\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */)) {\r\n                _this.updateFont();\r\n            }\r\n        }));\r\n        _this._editor.onDidLayoutChange(function (e) { return _this.layout(); });\r\n        _this.layout();\r\n        _this._editor.addContentWidget(_this);\r\n        _this._showAtPosition = null;\r\n        _this._showAtRange = null;\r\n        _this._stoleFocus = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ContentHoverWidget.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._isVisible;\r\n        },\r\n        set: function (value) {\r\n            this._isVisible = value;\r\n            toggleClass(this._containerDomNode, 'hidden', !this._isVisible);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ContentHoverWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    ContentHoverWidget.prototype.getDomNode = function () {\r\n        return this._containerDomNode;\r\n    };\r\n    ContentHoverWidget.prototype.showAt = function (position, range, focus) {\r\n        // Position has changed\r\n        this._showAtPosition = position;\r\n        this._showAtRange = range;\r\n        this.isVisible = true;\r\n        this._editor.layoutContentWidget(this);\r\n        // Simply force a synchronous render on the editor\r\n        // such that the widget does not really render with left = '0px'\r\n        this._editor.render();\r\n        this._stoleFocus = focus;\r\n        if (focus) {\r\n            this._containerDomNode.focus();\r\n        }\r\n    };\r\n    ContentHoverWidget.prototype.hide = function () {\r\n        if (!this.isVisible) {\r\n            return;\r\n        }\r\n        this.isVisible = false;\r\n        this._editor.layoutContentWidget(this);\r\n        if (this._stoleFocus) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    ContentHoverWidget.prototype.getPosition = function () {\r\n        if (this.isVisible) {\r\n            return {\r\n                position: this._showAtPosition,\r\n                range: this._showAtRange,\r\n                preference: [\r\n                    1 /* ABOVE */,\r\n                    2 /* BELOW */\r\n                ]\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    ContentHoverWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ContentHoverWidget.prototype.updateFont = function () {\r\n        var _this = this;\r\n        var codeClasses = Array.prototype.slice.call(this._domNode.getElementsByClassName('code'));\r\n        codeClasses.forEach(function (node) { return _this._editor.applyFontInfo(node); });\r\n    };\r\n    ContentHoverWidget.prototype.updateContents = function (node) {\r\n        this._domNode.textContent = '';\r\n        this._domNode.appendChild(node);\r\n        this.updateFont();\r\n        this._editor.layoutContentWidget(this);\r\n        this.onContentsChange();\r\n    };\r\n    ContentHoverWidget.prototype.onContentsChange = function () {\r\n        this.scrollbar.scanDomNode();\r\n    };\r\n    ContentHoverWidget.prototype.layout = function () {\r\n        var height = Math.max(this._editor.getLayoutInfo().height / 4, 250);\r\n        var _a = this._editor.getOption(34 /* fontInfo */), fontSize = _a.fontSize, lineHeight = _a.lineHeight;\r\n        this._domNode.style.fontSize = fontSize + \"px\";\r\n        this._domNode.style.lineHeight = lineHeight + \"px\";\r\n        this._domNode.style.maxHeight = height + \"px\";\r\n        this._domNode.style.maxWidth = Math.max(this._editor.getLayoutInfo().width * 0.66, 500) + \"px\";\r\n    };\r\n    return ContentHoverWidget;\r\n}(Widget));\r\nexport { ContentHoverWidget };\r\nvar GlyphHoverWidget = /** @class */ (function (_super) {\r\n    __extends(GlyphHoverWidget, _super);\r\n    function GlyphHoverWidget(id, editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._id = id;\r\n        _this._editor = editor;\r\n        _this._isVisible = false;\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'monaco-editor-hover hidden';\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._showAtLineNumber = -1;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */)) {\r\n                _this.updateFont();\r\n            }\r\n        }));\r\n        _this._editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(GlyphHoverWidget.prototype, \"isVisible\", {\r\n        get: function () {\r\n            return this._isVisible;\r\n        },\r\n        set: function (value) {\r\n            this._isVisible = value;\r\n            toggleClass(this._domNode, 'hidden', !this._isVisible);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GlyphHoverWidget.prototype.getId = function () {\r\n        return this._id;\r\n    };\r\n    GlyphHoverWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    GlyphHoverWidget.prototype.showAt = function (lineNumber) {\r\n        this._showAtLineNumber = lineNumber;\r\n        if (!this.isVisible) {\r\n            this.isVisible = true;\r\n        }\r\n        var editorLayout = this._editor.getLayoutInfo();\r\n        var topForLineNumber = this._editor.getTopForLineNumber(this._showAtLineNumber);\r\n        var editorScrollTop = this._editor.getScrollTop();\r\n        var lineHeight = this._editor.getOption(49 /* lineHeight */);\r\n        var nodeHeight = this._domNode.clientHeight;\r\n        var top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\r\n        this._domNode.style.left = editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth + \"px\";\r\n        this._domNode.style.top = Math.max(Math.round(top), 0) + \"px\";\r\n    };\r\n    GlyphHoverWidget.prototype.hide = function () {\r\n        if (!this.isVisible) {\r\n            return;\r\n        }\r\n        this.isVisible = false;\r\n    };\r\n    GlyphHoverWidget.prototype.getPosition = function () {\r\n        return null;\r\n    };\r\n    GlyphHoverWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    GlyphHoverWidget.prototype.updateFont = function () {\r\n        var _this = this;\r\n        var codeTags = Array.prototype.slice.call(this._domNode.getElementsByTagName('code'));\r\n        var codeClasses = Array.prototype.slice.call(this._domNode.getElementsByClassName('code'));\r\n        __spreadArrays(codeTags, codeClasses).forEach(function (node) { return _this._editor.applyFontInfo(node); });\r\n    };\r\n    GlyphHoverWidget.prototype.updateContents = function (node) {\r\n        this._domNode.textContent = '';\r\n        this._domNode.appendChild(node);\r\n        this.updateFont();\r\n    };\r\n    return GlyphHoverWidget;\r\n}(Widget));\r\nexport { GlyphHoverWidget };\r\n","/*\nThe MIT License (MIT)\n\nCopyright © 2015 Nicolas Bevacqua\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n\nlet __insane_func;\n\n(function () { function r(e, n, t) { function o(i, f) { if (!n[i]) { if (!e[i]) { var c = \"function\" == typeof require && require; if (!f && c) return c(i, !0); if (u) return u(i, !0); var a = new Error(\"Cannot find module '\" + i + \"'\"); throw a.code = \"MODULE_NOT_FOUND\", a } var p = n[i] = { exports: {} }; e[i][0].call(p.exports, function (r) { var n = e[i][1][r]; return o(n || r) }, p, p.exports, r, e, n, t) } return n[i].exports } for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++)o(t[i]); return o } return r })()({\n\t1: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\n\t\tmodule.exports = {\n\t\t\turis: toMap(uris) // attributes that have an href and hence need to be sanitized\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 2: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar defaults = {\n\t\t\tallowedAttributes: {\n\t\t\t\t'*': ['title', 'accesskey'],\n\t\t\t\ta: ['href', 'name', 'target', 'aria-label'],\n\t\t\t\tiframe: ['allowfullscreen', 'frameborder', 'src'],\n\t\t\t\timg: ['src', 'alt', 'title', 'aria-label']\n\t\t\t},\n\t\t\tallowedClasses: {},\n\t\t\tallowedSchemes: ['http', 'https', 'mailto'],\n\t\t\tallowedTags: [\n\t\t\t\t'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n\t\t\t\t'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n\t\t\t\t'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n\t\t\t\t'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n\t\t\t],\n\t\t\tfilter: null\n\t\t};\n\n\t\tmodule.exports = defaults;\n\n\t}, {}], 3: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\n\t\tmodule.exports = {\n\t\t\tvoids: toMap(voids)\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 4: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar assign = require('assignment');\n\t\tvar parser = require('./parser');\n\t\tvar sanitizer = require('./sanitizer');\n\t\tvar defaults = require('./defaults');\n\n\t\tfunction insane(html, options, strict) {\n\t\t\tvar buffer = [];\n\t\t\tvar configuration = strict === true ? options : assign({}, defaults, options);\n\t\t\tvar handler = sanitizer(buffer, configuration);\n\n\t\t\tparser(html, handler);\n\n\t\t\treturn buffer.join('');\n\t\t}\n\n\t\tinsane.defaults = defaults;\n\t\tmodule.exports = insane;\n\t\t__insane_func = insane;\n\n\t}, { \"./defaults\": 2, \"./parser\": 7, \"./sanitizer\": 8, \"assignment\": 6, \"he\": 9 }], 5: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tmodule.exports = function lowercase(string) {\n\t\t\treturn typeof string === 'string' ? string.toLowerCase() : string;\n\t\t};\n\n\t}, {}], 6: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction assignment(result) {\n\t\t\tvar stack = Array.prototype.slice.call(arguments, 1);\n\t\t\tvar item;\n\t\t\tvar key;\n\t\t\twhile (stack.length) {\n\t\t\t\titem = stack.shift();\n\t\t\t\tfor (key in item) {\n\t\t\t\t\tif (item.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (Object.prototype.toString.call(result[key]) === '[object Object]') {\n\t\t\t\t\t\t\tresult[key] = assignment(result[key], item[key]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[key] = item[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tmodule.exports = assignment;\n\n\t}, {}], 7: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\t\tvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\n\t\tvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\n\t\tvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\n\t\tvar rtag = /^</;\n\t\tvar rtagend = /^<\\s*\\//;\n\n\t\tfunction createStack() {\n\t\t\tvar stack = [];\n\t\t\tstack.lastItem = function lastItem() {\n\t\t\t\treturn stack[stack.length - 1];\n\t\t\t};\n\t\t\treturn stack;\n\t\t}\n\n\t\tfunction parser(html, handler) {\n\t\t\tvar stack = createStack();\n\t\t\tvar last = html;\n\t\t\tvar chars;\n\n\t\t\twhile (html) {\n\t\t\t\tparsePart();\n\t\t\t}\n\t\t\tparseEndTag(); // clean up any remaining tags\n\n\t\t\tfunction parsePart() {\n\t\t\t\tchars = true;\n\t\t\t\tparseTag();\n\n\t\t\t\tvar same = html === last;\n\t\t\t\tlast = html;\n\n\t\t\t\tif (same) { // discard, because it's invalid\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTag() {\n\t\t\t\tif (html.substr(0, 4) === '<!--') { // comments\n\t\t\t\t\tparseComment();\n\t\t\t\t} else if (rtagend.test(html)) {\n\t\t\t\t\tparseEdge(rend, parseEndTag);\n\t\t\t\t} else if (rtag.test(html)) {\n\t\t\t\t\tparseEdge(rstart, parseStartTag);\n\t\t\t\t}\n\t\t\t\tparseTagDecode();\n\t\t\t}\n\n\t\t\tfunction parseEdge(regex, parser) {\n\t\t\t\tvar match = html.match(regex);\n\t\t\t\tif (match) {\n\t\t\t\t\thtml = html.substring(match[0].length);\n\t\t\t\t\tmatch[0].replace(regex, parser);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseComment() {\n\t\t\t\tvar index = html.indexOf('-->');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tif (handler.comment) {\n\t\t\t\t\t\thandler.comment(html.substring(4, index));\n\t\t\t\t\t}\n\t\t\t\t\thtml = html.substring(index + 3);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTagDecode() {\n\t\t\t\tif (!chars) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar text;\n\t\t\t\tvar index = html.indexOf('<');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\ttext = html.substring(0, index);\n\t\t\t\t\thtml = html.substring(index);\n\t\t\t\t} else {\n\t\t\t\t\ttext = html;\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t\tif (handler.chars) {\n\t\t\t\t\thandler.chars(text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseStartTag(tag, tagName, rest, unary) {\n\t\t\t\tvar attrs = {};\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tvar u = elements.voids[low] || !!unary;\n\n\t\t\t\trest.replace(rattrs, attrReplacer);\n\n\t\t\t\tif (!u) {\n\t\t\t\t\tstack.push(low);\n\t\t\t\t}\n\t\t\t\tif (handler.start) {\n\t\t\t\t\thandler.start(low, attrs, u);\n\t\t\t\t}\n\n\t\t\t\tfunction attrReplacer(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n\t\t\t\t\tif (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n\t\t\t\t\t\tattrs[name] = void 0; // attribute is like <button disabled></button>\n\t\t\t\t\t} else {\n\t\t\t\t\t\tattrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseEndTag(tag, tagName) {\n\t\t\t\tvar i;\n\t\t\t\tvar pos = 0;\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tif (low) {\n\t\t\t\t\tfor (pos = stack.length - 1; pos >= 0; pos--) {\n\t\t\t\t\t\tif (stack[pos] === low) {\n\t\t\t\t\t\t\tbreak; // find the closest opened tag of the same type\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\tfor (i = stack.length - 1; i >= pos; i--) {\n\t\t\t\t\t\tif (handler.end) { // close all the open elements, up the stack\n\t\t\t\t\t\t\thandler.end(stack[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstack.length = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = parser;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 8: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\n\t\tfunction sanitizer(buffer, options) {\n\t\t\tvar last;\n\t\t\tvar context;\n\t\t\tvar o = options || {};\n\n\t\t\treset();\n\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end,\n\t\t\t\tchars: chars\n\t\t\t};\n\n\t\t\tfunction out(value) {\n\t\t\t\tbuffer.push(value);\n\t\t\t}\n\n\t\t\tfunction start(tag, attrs, unary) {\n\t\t\t\tvar low = lowercase(tag);\n\n\t\t\t\tif (context.ignoring) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif ((o.allowedTags || []).indexOf(low) === -1) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\n\t\t\t\tout('<');\n\t\t\t\tout(low);\n\t\t\t\tObject.keys(attrs).forEach(parse);\n\t\t\t\tout(unary ? '/>' : '>');\n\n\t\t\t\tfunction parse(key) {\n\t\t\t\t\tvar value = attrs[key];\n\t\t\t\t\tvar classesOk = (o.allowedClasses || {})[low] || [];\n\t\t\t\t\tvar attrsOk = (o.allowedAttributes || {})[low] || [];\n\t\t\t\t\tattrsOk = attrsOk.concat((o.allowedAttributes || {})['*'] || []);\n\t\t\t\t\tvar valid;\n\t\t\t\t\tvar lkey = lowercase(key);\n\t\t\t\t\tif (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n\t\t\t\t\t\tvalue = value.split(' ').filter(isValidClass).join(' ').trim();\n\t\t\t\t\t\tvalid = value.length;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n\t\t\t\t\t}\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tout(' ');\n\t\t\t\t\t\tout(key);\n\t\t\t\t\t\tif (typeof value === 'string') {\n\t\t\t\t\t\t\tout('=\"');\n\t\t\t\t\t\t\tout(he.encode(value));\n\t\t\t\t\t\t\tout('\"');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction isValidClass(className) {\n\t\t\t\t\t\treturn classesOk && classesOk.indexOf(className) !== -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction end(tag) {\n\t\t\t\tvar low = lowercase(tag);\n\t\t\t\tvar allowed = (o.allowedTags || []).indexOf(low) !== -1;\n\t\t\t\tif (allowed) {\n\t\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\t\tout('</');\n\t\t\t\t\t\tout(low);\n\t\t\t\t\t\tout('>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tunignore(low);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tunignore(low);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction testUrl(text) {\n\t\t\t\tvar start = text[0];\n\t\t\t\tif (start === '#' || start === '/') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar colon = text.indexOf(':');\n\t\t\t\tif (colon === -1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar questionmark = text.indexOf('?');\n\t\t\t\tif (questionmark !== -1 && colon > questionmark) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar hash = text.indexOf('#');\n\t\t\t\tif (hash !== -1 && colon > hash) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn o.allowedSchemes.some(matches);\n\n\t\t\t\tfunction matches(scheme) {\n\t\t\t\t\treturn text.indexOf(scheme + ':') === 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction chars(text) {\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tout(o.transformText ? o.transformText(text) : text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction ignore(tag) {\n\t\t\t\tif (elements.voids[tag]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tcontext = { ignoring: tag, depth: 1 };\n\t\t\t\t} else if (context.ignoring === tag) {\n\t\t\t\t\tcontext.depth++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction unignore(tag) {\n\t\t\t\tif (context.ignoring === tag) {\n\t\t\t\t\tif (--context.depth <= 0) {\n\t\t\t\t\t\treset();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction reset() {\n\t\t\t\tcontext = { ignoring: false, depth: 0 };\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = sanitizer;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 9: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar escapes = {\n\t\t\t'&': '&amp;',\n\t\t\t'<': '&lt;',\n\t\t\t'>': '&gt;',\n\t\t\t'\"': '&quot;',\n\t\t\t\"'\": '&#39;'\n\t\t};\n\t\tvar unescapes = {\n\t\t\t'&amp;': '&',\n\t\t\t'&lt;': '<',\n\t\t\t'&gt;': '>',\n\t\t\t'&quot;': '\"',\n\t\t\t'&#39;': \"'\"\n\t\t};\n\t\tvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\n\t\tvar runescaped = /[&<>\"']/g;\n\n\t\tfunction escapeHtmlChar(match) {\n\t\t\treturn escapes[match];\n\t\t}\n\t\tfunction unescapeHtmlChar(match) {\n\t\t\treturn unescapes[match];\n\t\t}\n\n\t\tfunction escapeHtml(text) {\n\t\t\treturn text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n\t\t}\n\n\t\tfunction unescapeHtml(html) {\n\t\t\treturn html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n\t\t}\n\n\t\tescapeHtml.options = unescapeHtml.options = {};\n\n\t\tmodule.exports = {\n\t\t\tencode: escapeHtml,\n\t\t\tescape: escapeHtml,\n\t\t\tdecode: unescapeHtml,\n\t\t\tunescape: unescapeHtml,\n\t\t\tversion: '1.0.0-browser'\n\t\t};\n\n\t}, {}], 10: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction toMap(list) {\n\t\t\treturn list.reduce(asKey, {});\n\t\t}\n\n\t\tfunction asKey(accumulator, item) {\n\t\t\taccumulator[item] = true;\n\t\t\treturn accumulator;\n\t\t}\n\n\t\tmodule.exports = toMap;\n\n\t}, {}]\n}, {}, [4]);\n\n// ESM-comment-begin\n// define(function() { return { insane: __insane_func }; });\n// ESM-comment-end\n\n// ESM-uncomment-begin\nexport var insane = __insane_func;\n// ESM-uncomment-end\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as DOM from './dom.js';\r\nimport { createElement } from './formattedTextRenderer.js';\r\nimport { onUnexpectedError } from '../common/errors.js';\r\nimport { parseHrefAndDimensions, removeMarkdownEscapes } from '../common/htmlContent.js';\r\nimport { defaultGenerator } from '../common/idGenerator.js';\r\nimport * as marked from '../common/marked/marked.js';\r\nimport { insane } from '../common/insane/insane.js';\r\nimport { parse } from '../common/marshalling.js';\r\nimport { cloneAndChange } from '../common/objects.js';\r\nimport { escape } from '../common/strings.js';\r\nimport { URI } from '../common/uri.js';\r\nimport { Schemas } from '../common/network.js';\r\nimport { renderCodicons, markdownEscapeEscapedCodicons } from '../common/codicons.js';\r\n/**\r\n * Create html nodes for the given content element.\r\n */\r\nexport function renderMarkdown(markdown, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var element = createElement(options);\r\n    var _uriMassage = function (part) {\r\n        var data;\r\n        try {\r\n            data = parse(decodeURIComponent(part));\r\n        }\r\n        catch (e) {\r\n            // ignore\r\n        }\r\n        if (!data) {\r\n            return part;\r\n        }\r\n        data = cloneAndChange(data, function (value) {\r\n            if (markdown.uris && markdown.uris[value]) {\r\n                return URI.revive(markdown.uris[value]);\r\n            }\r\n            else {\r\n                return undefined;\r\n            }\r\n        });\r\n        return encodeURIComponent(JSON.stringify(data));\r\n    };\r\n    var _href = function (href, isDomUri) {\r\n        var data = markdown.uris && markdown.uris[href];\r\n        if (!data) {\r\n            return href; // no uri exists\r\n        }\r\n        var uri = URI.revive(data);\r\n        if (URI.parse(href).toString() === uri.toString()) {\r\n            return href; // no tranformation performed\r\n        }\r\n        if (isDomUri) {\r\n            uri = DOM.asDomUri(uri);\r\n        }\r\n        if (uri.query) {\r\n            uri = uri.with({ query: _uriMassage(uri.query) });\r\n        }\r\n        return uri.toString(true);\r\n    };\r\n    // signal to code-block render that the\r\n    // element has been created\r\n    var signalInnerHTML;\r\n    var withInnerHTML = new Promise(function (c) { return signalInnerHTML = c; });\r\n    var renderer = new marked.Renderer();\r\n    renderer.image = function (href, title, text) {\r\n        var _a;\r\n        var dimensions = [];\r\n        var attributes = [];\r\n        if (href) {\r\n            (_a = parseHrefAndDimensions(href), href = _a.href, dimensions = _a.dimensions);\r\n            href = _href(href, true);\r\n            attributes.push(\"src=\\\"\" + href + \"\\\"\");\r\n        }\r\n        if (text) {\r\n            attributes.push(\"alt=\\\"\" + text + \"\\\"\");\r\n        }\r\n        if (title) {\r\n            attributes.push(\"title=\\\"\" + title + \"\\\"\");\r\n        }\r\n        if (dimensions.length) {\r\n            attributes = attributes.concat(dimensions);\r\n        }\r\n        return '<img ' + attributes.join(' ') + '>';\r\n    };\r\n    renderer.link = function (href, title, text) {\r\n        // Remove markdown escapes. Workaround for https://github.com/chjj/marked/issues/829\r\n        if (href === text) { // raw link case\r\n            text = removeMarkdownEscapes(text);\r\n        }\r\n        href = _href(href, false);\r\n        title = removeMarkdownEscapes(title);\r\n        href = removeMarkdownEscapes(href);\r\n        if (!href\r\n            || href.match(/^data:|javascript:/i)\r\n            || (href.match(/^command:/i) && !markdown.isTrusted)\r\n            || href.match(/^command:(\\/\\/\\/)?_workbench\\.downloadResource/i)) {\r\n            // drop the link\r\n            return text;\r\n        }\r\n        else {\r\n            // HTML Encode href\r\n            href = href.replace(/&/g, '&amp;')\r\n                .replace(/</g, '&lt;')\r\n                .replace(/>/g, '&gt;')\r\n                .replace(/\"/g, '&quot;')\r\n                .replace(/'/g, '&#39;');\r\n            return \"<a href=\\\"#\\\" data-href=\\\"\" + href + \"\\\" title=\\\"\" + (title || href) + \"\\\">\" + text + \"</a>\";\r\n        }\r\n    };\r\n    renderer.paragraph = function (text) {\r\n        return \"<p>\" + (markdown.supportThemeIcons ? renderCodicons(text) : text) + \"</p>\";\r\n    };\r\n    if (options.codeBlockRenderer) {\r\n        renderer.code = function (code, lang) {\r\n            var value = options.codeBlockRenderer(lang, code);\r\n            // when code-block rendering is async we return sync\r\n            // but update the node with the real result later.\r\n            var id = defaultGenerator.nextId();\r\n            var promise = Promise.all([value, withInnerHTML]).then(function (values) {\r\n                var strValue = values[0];\r\n                var span = element.querySelector(\"div[data-code=\\\"\" + id + \"\\\"]\");\r\n                if (span) {\r\n                    span.innerHTML = strValue;\r\n                }\r\n            }).catch(function (err) {\r\n                // ignore\r\n            });\r\n            if (options.codeBlockRenderCallback) {\r\n                promise.then(options.codeBlockRenderCallback);\r\n            }\r\n            return \"<div class=\\\"code\\\" data-code=\\\"\" + id + \"\\\">\" + escape(code) + \"</div>\";\r\n        };\r\n    }\r\n    var actionHandler = options.actionHandler;\r\n    if (actionHandler) {\r\n        actionHandler.disposeables.add(DOM.addStandardDisposableListener(element, 'click', function (event) {\r\n            var target = event.target;\r\n            if (target.tagName !== 'A') {\r\n                target = target.parentElement;\r\n                if (!target || target.tagName !== 'A') {\r\n                    return;\r\n                }\r\n            }\r\n            try {\r\n                var href = target.dataset['href'];\r\n                if (href) {\r\n                    actionHandler.callback(href, event);\r\n                }\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n            finally {\r\n                event.preventDefault();\r\n            }\r\n        }));\r\n    }\r\n    var markedOptions = {\r\n        sanitize: true,\r\n        renderer: renderer\r\n    };\r\n    var allowedSchemes = [Schemas.http, Schemas.https, Schemas.mailto, Schemas.data, Schemas.file, Schemas.vscodeRemote, Schemas.vscodeRemoteResource];\r\n    if (markdown.isTrusted) {\r\n        allowedSchemes.push(Schemas.command);\r\n    }\r\n    var renderedMarkdown = marked.parse(markdown.supportThemeIcons\r\n        ? markdownEscapeEscapedCodicons(markdown.value)\r\n        : markdown.value, markedOptions);\r\n    element.innerHTML = insane(renderedMarkdown, {\r\n        allowedSchemes: allowedSchemes,\r\n        allowedAttributes: {\r\n            'a': ['href', 'name', 'target', 'data-href'],\r\n            'iframe': ['allowfullscreen', 'frameborder', 'src'],\r\n            'img': ['src', 'title', 'alt', 'width', 'height'],\r\n            'div': ['class', 'data-code'],\r\n            'span': ['class']\r\n        }\r\n    });\r\n    signalInnerHTML();\r\n    return element;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { renderMarkdown } from '../../../base/browser/markdownRenderer.js';\r\nimport { IOpenerService, NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { tokenizeToString } from '../../common/modes/textToHtmlTokenizer.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nvar MarkdownRenderer = /** @class */ (function (_super) {\r\n    __extends(MarkdownRenderer, _super);\r\n    function MarkdownRenderer(_editor, _modeService, _openerService) {\r\n        if (_openerService === void 0) { _openerService = NullOpenerService; }\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._modeService = _modeService;\r\n        _this._openerService = _openerService;\r\n        _this._onDidRenderCodeBlock = _this._register(new Emitter());\r\n        _this.onDidRenderCodeBlock = _this._onDidRenderCodeBlock.event;\r\n        return _this;\r\n    }\r\n    MarkdownRenderer.prototype.getOptions = function (disposeables) {\r\n        var _this = this;\r\n        return {\r\n            codeBlockRenderer: function (languageAlias, value) {\r\n                // In markdown,\r\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\r\n                // it is possible no alias is given in which case we fall back to the current editor lang\r\n                var modeId = null;\r\n                if (languageAlias) {\r\n                    modeId = _this._modeService.getModeIdForLanguageName(languageAlias);\r\n                }\r\n                else {\r\n                    var model = _this._editor.getModel();\r\n                    if (model) {\r\n                        modeId = model.getLanguageIdentifier().language;\r\n                    }\r\n                }\r\n                _this._modeService.triggerMode(modeId || '');\r\n                return Promise.resolve(true).then(function (_) {\r\n                    var promise = TokenizationRegistry.getPromise(modeId || '');\r\n                    if (promise) {\r\n                        return promise.then(function (support) { return tokenizeToString(value, support); });\r\n                    }\r\n                    return tokenizeToString(value, undefined);\r\n                }).then(function (code) {\r\n                    return \"<span style=\\\"font-family: \" + _this._editor.getOption(34 /* fontInfo */).fontFamily + \"\\\">\" + code + \"</span>\";\r\n                });\r\n            },\r\n            codeBlockRenderCallback: function () { return _this._onDidRenderCodeBlock.fire(); },\r\n            actionHandler: {\r\n                callback: function (content) {\r\n                    _this._openerService.open(content, { fromUserGesture: true }).catch(onUnexpectedError);\r\n                },\r\n                disposeables: disposeables\r\n            }\r\n        };\r\n    };\r\n    MarkdownRenderer.prototype.render = function (markdown) {\r\n        var disposeables = new DisposableStore();\r\n        var element;\r\n        if (!markdown) {\r\n            element = document.createElement('span');\r\n        }\r\n        else {\r\n            element = renderMarkdown(markdown, this.getOptions(disposeables));\r\n        }\r\n        return {\r\n            element: element,\r\n            dispose: function () { return disposeables.dispose(); }\r\n        };\r\n    };\r\n    MarkdownRenderer = __decorate([\r\n        __param(1, IModeService),\r\n        __param(2, optional(IOpenerService))\r\n    ], MarkdownRenderer);\r\n    return MarkdownRenderer;\r\n}(Disposable));\r\nexport { MarkdownRenderer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { MarkdownString, isEmptyMarkdownString, markedStringsEquals } from '../../../base/common/htmlContent.js';\r\nimport { toDisposable, DisposableStore, combinedDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { HoverProviderRegistry, TokenizationRegistry } from '../../common/modes.js';\r\nimport { getColorPresentations } from '../colorPicker/color.js';\r\nimport { ColorDetector } from '../colorPicker/colorDetector.js';\r\nimport { ColorPickerModel } from '../colorPicker/colorPickerModel.js';\r\nimport { ColorPickerWidget } from '../colorPicker/colorPickerWidget.js';\r\nimport { getHover } from './getHover.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { ContentHoverWidget } from './hoverWidgets.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { coalesce, isNonEmptyArray, asArray } from '../../../base/common/arrays.js';\r\nimport { IMarkerData, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { MarkerController, NextMarkerAction } from '../gotoError/gotoError.js';\r\nimport { createCancelablePromise } from '../../../base/common/async.js';\r\nimport { getCodeActions } from '../codeAction/codeAction.js';\r\nimport { QuickFixAction, QuickFixController } from '../codeAction/codeActionCommands.js';\r\nimport { CodeActionKind } from '../codeAction/types.js';\r\nimport { textLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nvar $ = dom.$;\r\nvar ColorHover = /** @class */ (function () {\r\n    function ColorHover(range, color, provider) {\r\n        this.range = range;\r\n        this.color = color;\r\n        this.provider = provider;\r\n    }\r\n    return ColorHover;\r\n}());\r\nvar MarkerHover = /** @class */ (function () {\r\n    function MarkerHover(range, marker) {\r\n        this.range = range;\r\n        this.marker = marker;\r\n    }\r\n    return MarkerHover;\r\n}());\r\nvar ModesContentComputer = /** @class */ (function () {\r\n    function ModesContentComputer(editor, _markerDecorationsService) {\r\n        this._markerDecorationsService = _markerDecorationsService;\r\n        this._editor = editor;\r\n        this._result = [];\r\n    }\r\n    ModesContentComputer.prototype.setRange = function (range) {\r\n        this._range = range;\r\n        this._result = [];\r\n    };\r\n    ModesContentComputer.prototype.clearResult = function () {\r\n        this._result = [];\r\n    };\r\n    ModesContentComputer.prototype.computeAsync = function (token) {\r\n        if (!this._editor.hasModel() || !this._range) {\r\n            return Promise.resolve([]);\r\n        }\r\n        var model = this._editor.getModel();\r\n        if (!HoverProviderRegistry.has(model)) {\r\n            return Promise.resolve([]);\r\n        }\r\n        return getHover(model, new Position(this._range.startLineNumber, this._range.startColumn), token);\r\n    };\r\n    ModesContentComputer.prototype.computeSync = function () {\r\n        var _this = this;\r\n        if (!this._editor.hasModel() || !this._range) {\r\n            return [];\r\n        }\r\n        var model = this._editor.getModel();\r\n        var lineNumber = this._range.startLineNumber;\r\n        if (lineNumber > this._editor.getModel().getLineCount()) {\r\n            // Illegal line number => no results\r\n            return [];\r\n        }\r\n        var colorDetector = ColorDetector.get(this._editor);\r\n        var maxColumn = model.getLineMaxColumn(lineNumber);\r\n        var lineDecorations = this._editor.getLineDecorations(lineNumber);\r\n        var didFindColor = false;\r\n        var hoverRange = this._range;\r\n        var result = lineDecorations.map(function (d) {\r\n            var startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\r\n            var endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\r\n            if (startColumn > hoverRange.startColumn || hoverRange.endColumn > endColumn) {\r\n                return null;\r\n            }\r\n            var range = new Range(hoverRange.startLineNumber, startColumn, hoverRange.startLineNumber, endColumn);\r\n            var marker = _this._markerDecorationsService.getMarker(model, d);\r\n            if (marker) {\r\n                return new MarkerHover(range, marker);\r\n            }\r\n            var colorData = colorDetector.getColorData(d.range.getStartPosition());\r\n            if (!didFindColor && colorData) {\r\n                didFindColor = true;\r\n                var _a = colorData.colorInfo, color = _a.color, range_1 = _a.range;\r\n                return new ColorHover(range_1, color, colorData.provider);\r\n            }\r\n            else {\r\n                if (isEmptyMarkdownString(d.options.hoverMessage)) {\r\n                    return null;\r\n                }\r\n                var contents = d.options.hoverMessage ? asArray(d.options.hoverMessage) : [];\r\n                return { contents: contents, range: range };\r\n            }\r\n        });\r\n        return coalesce(result);\r\n    };\r\n    ModesContentComputer.prototype.onResult = function (result, isFromSynchronousComputation) {\r\n        // Always put synchronous messages before asynchronous ones\r\n        if (isFromSynchronousComputation) {\r\n            this._result = result.concat(this._result.sort(function (a, b) {\r\n                if (a instanceof ColorHover) { // sort picker messages at to the top\r\n                    return -1;\r\n                }\r\n                else if (b instanceof ColorHover) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            }));\r\n        }\r\n        else {\r\n            this._result = this._result.concat(result);\r\n        }\r\n    };\r\n    ModesContentComputer.prototype.getResult = function () {\r\n        return this._result.slice(0);\r\n    };\r\n    ModesContentComputer.prototype.getResultWithLoadingMessage = function () {\r\n        return this._result.slice(0).concat([this._getLoadingMessage()]);\r\n    };\r\n    ModesContentComputer.prototype._getLoadingMessage = function () {\r\n        return {\r\n            range: this._range,\r\n            contents: [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))]\r\n        };\r\n    };\r\n    return ModesContentComputer;\r\n}());\r\nvar markerCodeActionTrigger = {\r\n    type: 2 /* Manual */,\r\n    filter: { include: CodeActionKind.QuickFix }\r\n};\r\nvar ModesContentHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ModesContentHoverWidget, _super);\r\n    function ModesContentHoverWidget(editor, markerDecorationsService, _themeService, _keybindingService, _modeService, _openerService) {\r\n        if (_openerService === void 0) { _openerService = NullOpenerService; }\r\n        var _this = _super.call(this, ModesContentHoverWidget.ID, editor) || this;\r\n        _this._themeService = _themeService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._modeService = _modeService;\r\n        _this._openerService = _openerService;\r\n        _this.renderDisposable = _this._register(new MutableDisposable());\r\n        _this._messages = [];\r\n        _this._lastRange = null;\r\n        _this._computer = new ModesContentComputer(_this._editor, markerDecorationsService);\r\n        _this._highlightDecorations = [];\r\n        _this._isChangingDecorations = false;\r\n        _this._shouldFocus = false;\r\n        _this._colorPicker = null;\r\n        _this._hoverOperation = new HoverOperation(_this._computer, function (result) { return _this._withResult(result, true); }, null, function (result) { return _this._withResult(result, false); }, _this._editor.getOption(44 /* hover */).delay);\r\n        _this._register(dom.addStandardDisposableListener(_this.getDomNode(), dom.EventType.FOCUS, function () {\r\n            if (_this._colorPicker) {\r\n                dom.addClass(_this.getDomNode(), 'colorpicker-hover');\r\n            }\r\n        }));\r\n        _this._register(dom.addStandardDisposableListener(_this.getDomNode(), dom.EventType.BLUR, function () {\r\n            dom.removeClass(_this.getDomNode(), 'colorpicker-hover');\r\n        }));\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            _this._hoverOperation.setHoverTime(_this._editor.getOption(44 /* hover */).delay);\r\n        }));\r\n        _this._register(TokenizationRegistry.onDidChange(function (e) {\r\n            if (_this.isVisible && _this._lastRange && _this._messages.length > 0) {\r\n                _this._domNode.textContent = '';\r\n                _this._renderMessages(_this._lastRange, _this._messages);\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ModesContentHoverWidget.prototype.dispose = function () {\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ModesContentHoverWidget.prototype.onModelDecorationsChanged = function () {\r\n        if (this._isChangingDecorations) {\r\n            return;\r\n        }\r\n        if (this.isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            if (!this._colorPicker) { // TODO@Michel ensure that displayed text for other decorations is computed even if color picker is in place\r\n                this._hoverOperation.start(0 /* Delayed */);\r\n            }\r\n        }\r\n    };\r\n    ModesContentHoverWidget.prototype.startShowingAt = function (range, mode, focus) {\r\n        if (this._lastRange && this._lastRange.equalsRange(range)) {\r\n            // We have to show the widget at the exact same range as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        if (this.isVisible) {\r\n            // The range might have changed, but the hover is visible\r\n            // Instead of hiding it completely, filter out messages that are still in the new range and\r\n            // kick off a new computation\r\n            if (!this._showAtPosition || this._showAtPosition.lineNumber !== range.startLineNumber) {\r\n                this.hide();\r\n            }\r\n            else {\r\n                var filteredMessages = [];\r\n                for (var i = 0, len = this._messages.length; i < len; i++) {\r\n                    var msg = this._messages[i];\r\n                    var rng = msg.range;\r\n                    if (rng && rng.startColumn <= range.startColumn && rng.endColumn >= range.endColumn) {\r\n                        filteredMessages.push(msg);\r\n                    }\r\n                }\r\n                if (filteredMessages.length > 0) {\r\n                    if (hoverContentsEquals(filteredMessages, this._messages)) {\r\n                        return;\r\n                    }\r\n                    this._renderMessages(range, filteredMessages);\r\n                }\r\n                else {\r\n                    this.hide();\r\n                }\r\n            }\r\n        }\r\n        this._lastRange = range;\r\n        this._computer.setRange(range);\r\n        this._shouldFocus = focus;\r\n        this._hoverOperation.start(mode);\r\n    };\r\n    ModesContentHoverWidget.prototype.hide = function () {\r\n        this._lastRange = null;\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.hide.call(this);\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, []);\r\n        this._isChangingDecorations = false;\r\n        this.renderDisposable.clear();\r\n        this._colorPicker = null;\r\n    };\r\n    ModesContentHoverWidget.prototype.isColorPickerVisible = function () {\r\n        if (this._colorPicker) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ModesContentHoverWidget.prototype._withResult = function (result, complete) {\r\n        this._messages = result;\r\n        if (this._lastRange && this._messages.length > 0) {\r\n            this._renderMessages(this._lastRange, this._messages);\r\n        }\r\n        else if (complete) {\r\n            this.hide();\r\n        }\r\n    };\r\n    ModesContentHoverWidget.prototype._renderMessages = function (renderRange, messages) {\r\n        var _this = this;\r\n        this.renderDisposable.dispose();\r\n        this._colorPicker = null;\r\n        // update column from which to show\r\n        var renderColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        var highlightRange = messages[0].range ? Range.lift(messages[0].range) : null;\r\n        var fragment = document.createDocumentFragment();\r\n        var isEmptyHoverContent = true;\r\n        var containColorPicker = false;\r\n        var markdownDisposeables = new DisposableStore();\r\n        var markerMessages = [];\r\n        messages.forEach(function (msg) {\r\n            if (!msg.range) {\r\n                return;\r\n            }\r\n            renderColumn = Math.min(renderColumn, msg.range.startColumn);\r\n            highlightRange = highlightRange ? Range.plusRange(highlightRange, msg.range) : Range.lift(msg.range);\r\n            if (msg instanceof ColorHover) {\r\n                containColorPicker = true;\r\n                var _a = msg.color, red = _a.red, green = _a.green, blue = _a.blue, alpha = _a.alpha;\r\n                var rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n                var color_1 = new Color(rgba);\r\n                if (!_this._editor.hasModel()) {\r\n                    return;\r\n                }\r\n                var editorModel_1 = _this._editor.getModel();\r\n                var range_2 = new Range(msg.range.startLineNumber, msg.range.startColumn, msg.range.endLineNumber, msg.range.endColumn);\r\n                var colorInfo = { range: msg.range, color: msg.color };\r\n                // create blank olor picker model and widget first to ensure it's positioned correctly.\r\n                var model_1 = new ColorPickerModel(color_1, [], 0);\r\n                var widget_1 = new ColorPickerWidget(fragment, model_1, _this._editor.getOption(105 /* pixelRatio */), _this._themeService);\r\n                getColorPresentations(editorModel_1, colorInfo, msg.provider, CancellationToken.None).then(function (colorPresentations) {\r\n                    model_1.colorPresentations = colorPresentations || [];\r\n                    if (!_this._editor.hasModel()) {\r\n                        // gone...\r\n                        return;\r\n                    }\r\n                    var originalText = _this._editor.getModel().getValueInRange(msg.range);\r\n                    model_1.guessColorPresentation(color_1, originalText);\r\n                    var updateEditorModel = function () {\r\n                        var textEdits;\r\n                        var newRange;\r\n                        if (model_1.presentation.textEdit) {\r\n                            textEdits = [model_1.presentation.textEdit];\r\n                            newRange = new Range(model_1.presentation.textEdit.range.startLineNumber, model_1.presentation.textEdit.range.startColumn, model_1.presentation.textEdit.range.endLineNumber, model_1.presentation.textEdit.range.endColumn);\r\n                            newRange = newRange.setEndPosition(newRange.endLineNumber, newRange.startColumn + model_1.presentation.textEdit.text.length);\r\n                        }\r\n                        else {\r\n                            textEdits = [{ identifier: null, range: range_2, text: model_1.presentation.label, forceMoveMarkers: false }];\r\n                            newRange = range_2.setEndPosition(range_2.endLineNumber, range_2.startColumn + model_1.presentation.label.length);\r\n                        }\r\n                        _this._editor.pushUndoStop();\r\n                        _this._editor.executeEdits('colorpicker', textEdits);\r\n                        if (model_1.presentation.additionalTextEdits) {\r\n                            textEdits = __spreadArrays(model_1.presentation.additionalTextEdits);\r\n                            _this._editor.executeEdits('colorpicker', textEdits);\r\n                            _this.hide();\r\n                        }\r\n                        _this._editor.pushUndoStop();\r\n                        range_2 = newRange;\r\n                    };\r\n                    var updateColorPresentations = function (color) {\r\n                        return getColorPresentations(editorModel_1, {\r\n                            range: range_2,\r\n                            color: {\r\n                                red: color.rgba.r / 255,\r\n                                green: color.rgba.g / 255,\r\n                                blue: color.rgba.b / 255,\r\n                                alpha: color.rgba.a\r\n                            }\r\n                        }, msg.provider, CancellationToken.None).then(function (colorPresentations) {\r\n                            model_1.colorPresentations = colorPresentations || [];\r\n                        });\r\n                    };\r\n                    var colorListener = model_1.onColorFlushed(function (color) {\r\n                        updateColorPresentations(color).then(updateEditorModel);\r\n                    });\r\n                    var colorChangeListener = model_1.onDidChangeColor(updateColorPresentations);\r\n                    _this._colorPicker = widget_1;\r\n                    _this.showAt(range_2.getStartPosition(), range_2, _this._shouldFocus);\r\n                    _this.updateContents(fragment);\r\n                    _this._colorPicker.layout();\r\n                    _this.renderDisposable.value = combinedDisposable(colorListener, colorChangeListener, widget_1, markdownDisposeables);\r\n                });\r\n            }\r\n            else {\r\n                if (msg instanceof MarkerHover) {\r\n                    markerMessages.push(msg);\r\n                    isEmptyHoverContent = false;\r\n                }\r\n                else {\r\n                    msg.contents\r\n                        .filter(function (contents) { return !isEmptyMarkdownString(contents); })\r\n                        .forEach(function (contents) {\r\n                        var markdownHoverElement = $('div.hover-row.markdown-hover');\r\n                        var hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\r\n                        var renderer = markdownDisposeables.add(new MarkdownRenderer(_this._editor, _this._modeService, _this._openerService));\r\n                        markdownDisposeables.add(renderer.onDidRenderCodeBlock(function () {\r\n                            hoverContentsElement.className = 'hover-contents code-hover-contents';\r\n                            _this.onContentsChange();\r\n                        }));\r\n                        var renderedContents = markdownDisposeables.add(renderer.render(contents));\r\n                        hoverContentsElement.appendChild(renderedContents.element);\r\n                        fragment.appendChild(markdownHoverElement);\r\n                        isEmptyHoverContent = false;\r\n                    });\r\n                }\r\n            }\r\n        });\r\n        if (markerMessages.length) {\r\n            markerMessages.forEach(function (msg) { return fragment.appendChild(_this.renderMarkerHover(msg)); });\r\n            var markerHoverForStatusbar = markerMessages.length === 1 ? markerMessages[0] : markerMessages.sort(function (a, b) { return MarkerSeverity.compare(a.marker.severity, b.marker.severity); })[0];\r\n            fragment.appendChild(this.renderMarkerStatusbar(markerHoverForStatusbar));\r\n        }\r\n        // show\r\n        if (!containColorPicker && !isEmptyHoverContent) {\r\n            this.showAt(new Position(renderRange.startLineNumber, renderColumn), highlightRange, this._shouldFocus);\r\n            this.updateContents(fragment);\r\n        }\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, highlightRange ? [{\r\n                range: highlightRange,\r\n                options: ModesContentHoverWidget._DECORATION_OPTIONS\r\n            }] : []);\r\n        this._isChangingDecorations = false;\r\n    };\r\n    ModesContentHoverWidget.prototype.renderMarkerHover = function (markerHover) {\r\n        var _this = this;\r\n        var hoverElement = $('div.hover-row');\r\n        var markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\r\n        var _a = markerHover.marker, source = _a.source, message = _a.message, code = _a.code, relatedInformation = _a.relatedInformation;\r\n        this._editor.applyFontInfo(markerElement);\r\n        var messageElement = dom.append(markerElement, $('span'));\r\n        messageElement.style.whiteSpace = 'pre-wrap';\r\n        messageElement.innerText = message;\r\n        if (source || code) {\r\n            if (typeof code === 'string') {\r\n                var detailsElement = dom.append(markerElement, $('span'));\r\n                detailsElement.style.opacity = '0.6';\r\n                detailsElement.style.paddingLeft = '6px';\r\n                detailsElement.innerText = source && code ? source + \"(\" + code + \")\" : source ? source : \"(\" + code + \")\";\r\n            }\r\n            else {\r\n                if (code) {\r\n                    var sourceAndCodeElement = $('span');\r\n                    if (source) {\r\n                        var sourceElement = dom.append(sourceAndCodeElement, $('span'));\r\n                        sourceElement.innerText = source;\r\n                    }\r\n                    this._codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\r\n                    this._codeLink.setAttribute('href', code.link.toString());\r\n                    this._codeLink.onclick = function (e) {\r\n                        _this._openerService.open(code.link);\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    };\r\n                    var codeElement = dom.append(this._codeLink, $('span'));\r\n                    codeElement.innerText = code.value;\r\n                    var detailsElement = dom.append(markerElement, sourceAndCodeElement);\r\n                    detailsElement.style.opacity = '0.6';\r\n                    detailsElement.style.paddingLeft = '6px';\r\n                }\r\n            }\r\n        }\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var _loop_1 = function (message_1, resource, startLineNumber, startColumn) {\r\n                var relatedInfoContainer = dom.append(markerElement, $('div'));\r\n                relatedInfoContainer.style.marginTop = '8px';\r\n                var a = dom.append(relatedInfoContainer, $('a'));\r\n                a.innerText = basename(resource) + \"(\" + startLineNumber + \", \" + startColumn + \"): \";\r\n                a.style.cursor = 'pointer';\r\n                a.onclick = function (e) {\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                    if (_this._openerService) {\r\n                        _this._openerService.open(resource.with({ fragment: startLineNumber + \",\" + startColumn }), { fromUserGesture: true }).catch(onUnexpectedError);\r\n                    }\r\n                };\r\n                var messageElement_1 = dom.append(relatedInfoContainer, $('span'));\r\n                messageElement_1.innerText = message_1;\r\n                this_1._editor.applyFontInfo(messageElement_1);\r\n            };\r\n            var this_1 = this;\r\n            for (var _i = 0, relatedInformation_1 = relatedInformation; _i < relatedInformation_1.length; _i++) {\r\n                var _b = relatedInformation_1[_i], message_1 = _b.message, resource = _b.resource, startLineNumber = _b.startLineNumber, startColumn = _b.startColumn;\r\n                _loop_1(message_1, resource, startLineNumber, startColumn);\r\n            }\r\n        }\r\n        return hoverElement;\r\n    };\r\n    ModesContentHoverWidget.prototype.renderMarkerStatusbar = function (markerHover) {\r\n        var _this = this;\r\n        var hoverElement = $('div.hover-row.status-bar');\r\n        var disposables = new DisposableStore();\r\n        var actionsElement = dom.append(hoverElement, $('div.actions'));\r\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\r\n            disposables.add(this.renderAction(actionsElement, {\r\n                label: nls.localize('peek problem', \"Peek Problem\"),\r\n                commandId: NextMarkerAction.ID,\r\n                run: function () {\r\n                    _this.hide();\r\n                    MarkerController.get(_this._editor).show(markerHover.marker);\r\n                    _this._editor.focus();\r\n                }\r\n            }));\r\n        }\r\n        var quickfixPlaceholderElement = dom.append(actionsElement, $('div'));\r\n        quickfixPlaceholderElement.style.opacity = '0';\r\n        quickfixPlaceholderElement.style.transition = 'opacity 0.2s';\r\n        setTimeout(function () { return quickfixPlaceholderElement.style.opacity = '1'; }, 200);\r\n        quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\");\r\n        disposables.add(toDisposable(function () { return quickfixPlaceholderElement.remove(); }));\r\n        var codeActionsPromise = this.getCodeActions(markerHover.marker);\r\n        disposables.add(toDisposable(function () { return codeActionsPromise.cancel(); }));\r\n        codeActionsPromise.then(function (actions) {\r\n            quickfixPlaceholderElement.style.transition = '';\r\n            quickfixPlaceholderElement.style.opacity = '1';\r\n            if (!actions.validActions.length) {\r\n                actions.dispose();\r\n                quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\r\n                return;\r\n            }\r\n            quickfixPlaceholderElement.remove();\r\n            var showing = false;\r\n            disposables.add(toDisposable(function () {\r\n                if (!showing) {\r\n                    actions.dispose();\r\n                }\r\n            }));\r\n            disposables.add(_this.renderAction(actionsElement, {\r\n                label: nls.localize('quick fixes', \"Quick Fix...\"),\r\n                commandId: QuickFixAction.Id,\r\n                run: function (target) {\r\n                    showing = true;\r\n                    var controller = QuickFixController.get(_this._editor);\r\n                    var elementPosition = dom.getDomNodePagePosition(target);\r\n                    controller.showCodeActions(markerCodeActionTrigger, actions, {\r\n                        x: elementPosition.left + 6,\r\n                        y: elementPosition.top + elementPosition.height + 6\r\n                    });\r\n                }\r\n            }));\r\n        });\r\n        this.renderDisposable.value = disposables;\r\n        return hoverElement;\r\n    };\r\n    ModesContentHoverWidget.prototype.getCodeActions = function (marker) {\r\n        var _this = this;\r\n        return createCancelablePromise(function (cancellationToken) {\r\n            return getCodeActions(_this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, cancellationToken);\r\n        });\r\n    };\r\n    ModesContentHoverWidget.prototype.renderAction = function (parent, actionOptions) {\r\n        var actionContainer = dom.append(parent, $('div.action-container'));\r\n        var action = dom.append(actionContainer, $('a.action'));\r\n        if (actionOptions.iconClass) {\r\n            dom.append(action, $(\"span.icon.\" + actionOptions.iconClass));\r\n        }\r\n        var label = dom.append(action, $('span'));\r\n        label.textContent = actionOptions.label;\r\n        var keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\r\n        if (keybinding) {\r\n            label.title = actionOptions.label + \" (\" + keybinding.getLabel() + \")\";\r\n        }\r\n        return dom.addDisposableListener(actionContainer, dom.EventType.CLICK, function (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            actionOptions.run(actionContainer);\r\n        });\r\n    };\r\n    ModesContentHoverWidget.ID = 'editor.contrib.modesContentHoverWidget';\r\n    ModesContentHoverWidget._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n        className: 'hoverHighlight'\r\n    });\r\n    return ModesContentHoverWidget;\r\n}(ContentHoverWidget));\r\nexport { ModesContentHoverWidget };\r\nfunction hoverContentsEquals(first, second) {\r\n    if ((!first && second) || (first && !second) || first.length !== second.length) {\r\n        return false;\r\n    }\r\n    for (var i = 0; i < first.length; i++) {\r\n        var firstElement = first[i];\r\n        var secondElement = second[i];\r\n        if (firstElement instanceof MarkerHover && secondElement instanceof MarkerHover) {\r\n            return IMarkerData.makeKey(firstElement.marker) === IMarkerData.makeKey(secondElement.marker);\r\n        }\r\n        if (firstElement instanceof ColorHover || secondElement instanceof ColorHover) {\r\n            return false;\r\n        }\r\n        if (firstElement instanceof MarkerHover || secondElement instanceof MarkerHover) {\r\n            return false;\r\n        }\r\n        if (!markedStringsEquals(firstElement.contents, secondElement.contents)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(\".monaco-editor-hover .hover-contents a.code-link span:hover { color: \" + linkFg + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { $ } from '../../../base/browser/dom.js';\r\nimport { isEmptyMarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { GlyphHoverWidget } from './hoverWidgets.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { asArray } from '../../../base/common/arrays.js';\r\nvar MarginComputer = /** @class */ (function () {\r\n    function MarginComputer(editor) {\r\n        this._editor = editor;\r\n        this._lineNumber = -1;\r\n        this._result = [];\r\n    }\r\n    MarginComputer.prototype.setLineNumber = function (lineNumber) {\r\n        this._lineNumber = lineNumber;\r\n        this._result = [];\r\n    };\r\n    MarginComputer.prototype.clearResult = function () {\r\n        this._result = [];\r\n    };\r\n    MarginComputer.prototype.computeSync = function () {\r\n        var toHoverMessage = function (contents) {\r\n            return {\r\n                value: contents\r\n            };\r\n        };\r\n        var lineDecorations = this._editor.getLineDecorations(this._lineNumber);\r\n        var result = [];\r\n        if (!lineDecorations) {\r\n            return result;\r\n        }\r\n        for (var _i = 0, lineDecorations_1 = lineDecorations; _i < lineDecorations_1.length; _i++) {\r\n            var d = lineDecorations_1[_i];\r\n            if (!d.options.glyphMarginClassName) {\r\n                continue;\r\n            }\r\n            var hoverMessage = d.options.glyphMarginHoverMessage;\r\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\r\n                continue;\r\n            }\r\n            result.push.apply(result, asArray(hoverMessage).map(toHoverMessage));\r\n        }\r\n        return result;\r\n    };\r\n    MarginComputer.prototype.onResult = function (result, isFromSynchronousComputation) {\r\n        this._result = this._result.concat(result);\r\n    };\r\n    MarginComputer.prototype.getResult = function () {\r\n        return this._result;\r\n    };\r\n    MarginComputer.prototype.getResultWithLoadingMessage = function () {\r\n        return this.getResult();\r\n    };\r\n    return MarginComputer;\r\n}());\r\nvar ModesGlyphHoverWidget = /** @class */ (function (_super) {\r\n    __extends(ModesGlyphHoverWidget, _super);\r\n    function ModesGlyphHoverWidget(editor, modeService, openerService) {\r\n        if (openerService === void 0) { openerService = NullOpenerService; }\r\n        var _this = _super.call(this, ModesGlyphHoverWidget.ID, editor) || this;\r\n        _this._renderDisposeables = _this._register(new DisposableStore());\r\n        _this._messages = [];\r\n        _this._lastLineNumber = -1;\r\n        _this._markdownRenderer = _this._register(new MarkdownRenderer(_this._editor, modeService, openerService));\r\n        _this._computer = new MarginComputer(_this._editor);\r\n        _this._hoverOperation = new HoverOperation(_this._computer, function (result) { return _this._withResult(result); }, undefined, function (result) { return _this._withResult(result); }, 300);\r\n        return _this;\r\n    }\r\n    ModesGlyphHoverWidget.prototype.dispose = function () {\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ModesGlyphHoverWidget.prototype.onModelDecorationsChanged = function () {\r\n        if (this.isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            this._hoverOperation.start(0 /* Delayed */);\r\n        }\r\n    };\r\n    ModesGlyphHoverWidget.prototype.startShowingAt = function (lineNumber) {\r\n        if (this._lastLineNumber === lineNumber) {\r\n            // We have to show the widget at the exact same line number as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        this.hide();\r\n        this._lastLineNumber = lineNumber;\r\n        this._computer.setLineNumber(lineNumber);\r\n        this._hoverOperation.start(0 /* Delayed */);\r\n    };\r\n    ModesGlyphHoverWidget.prototype.hide = function () {\r\n        this._lastLineNumber = -1;\r\n        this._hoverOperation.cancel();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ModesGlyphHoverWidget.prototype._withResult = function (result) {\r\n        this._messages = result;\r\n        if (this._messages.length > 0) {\r\n            this._renderMessages(this._lastLineNumber, this._messages);\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n    };\r\n    ModesGlyphHoverWidget.prototype._renderMessages = function (lineNumber, messages) {\r\n        this._renderDisposeables.clear();\r\n        var fragment = document.createDocumentFragment();\r\n        for (var _i = 0, messages_1 = messages; _i < messages_1.length; _i++) {\r\n            var msg = messages_1[_i];\r\n            var renderedContents = this._markdownRenderer.render(msg.value);\r\n            this._renderDisposeables.add(renderedContents);\r\n            fragment.appendChild($('div.hover-row', undefined, renderedContents.element));\r\n        }\r\n        this.updateContents(fragment);\r\n        this.showAt(lineNumber);\r\n    };\r\n    ModesGlyphHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\r\n    return ModesGlyphHoverWidget;\r\n}(GlyphHoverWidget));\r\nexport { ModesGlyphHoverWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './hover.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { ModesContentHoverWidget } from './modesContentHover.js';\r\nimport { ModesGlyphHoverWidget } from './modesGlyphHover.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, editorHoverHighlight, textCodeBlockBackground, textLinkForeground, editorHoverStatusBarBackground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { IMarkerDecorationsService } from '../../common/services/markersDecorationService.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { GotoDefinitionAtPositionEditorContribution } from '../gotoSymbol/link/goToDefinitionAtPosition.js';\r\nvar ModesHoverController = /** @class */ (function () {\r\n    function ModesHoverController(_editor, _openerService, _modeService, _markerDecorationsService, _keybindingService, _themeService) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._openerService = _openerService;\r\n        this._modeService = _modeService;\r\n        this._markerDecorationsService = _markerDecorationsService;\r\n        this._keybindingService = _keybindingService;\r\n        this._themeService = _themeService;\r\n        this._toUnhook = new DisposableStore();\r\n        this._contentWidget = new MutableDisposable();\r\n        this._glyphWidget = new MutableDisposable();\r\n        this._isMouseDown = false;\r\n        this._hoverClicked = false;\r\n        this._hookEvents();\r\n        this._didChangeConfigurationHandler = this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(44 /* hover */)) {\r\n                _this._hideWidgets();\r\n                _this._unhookEvents();\r\n                _this._hookEvents();\r\n            }\r\n        });\r\n    }\r\n    Object.defineProperty(ModesHoverController.prototype, \"contentWidget\", {\r\n        get: function () {\r\n            if (!this._contentWidget.value) {\r\n                this._createHoverWidgets();\r\n            }\r\n            return this._contentWidget.value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ModesHoverController.prototype, \"glyphWidget\", {\r\n        get: function () {\r\n            if (!this._glyphWidget.value) {\r\n                this._createHoverWidgets();\r\n            }\r\n            return this._glyphWidget.value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ModesHoverController.get = function (editor) {\r\n        return editor.getContribution(ModesHoverController.ID);\r\n    };\r\n    ModesHoverController.prototype._hookEvents = function () {\r\n        var _this = this;\r\n        var hideWidgetsEventHandler = function () { return _this._hideWidgets(); };\r\n        var hoverOpts = this._editor.getOption(44 /* hover */);\r\n        this._isHoverEnabled = hoverOpts.enabled;\r\n        this._isHoverSticky = hoverOpts.sticky;\r\n        if (this._isHoverEnabled) {\r\n            this._toUnhook.add(this._editor.onMouseDown(function (e) { return _this._onEditorMouseDown(e); }));\r\n            this._toUnhook.add(this._editor.onMouseUp(function (e) { return _this._onEditorMouseUp(e); }));\r\n            this._toUnhook.add(this._editor.onMouseMove(function (e) { return _this._onEditorMouseMove(e); }));\r\n            this._toUnhook.add(this._editor.onKeyDown(function (e) { return _this._onKeyDown(e); }));\r\n            this._toUnhook.add(this._editor.onDidChangeModelDecorations(function () { return _this._onModelDecorationsChanged(); }));\r\n        }\r\n        else {\r\n            this._toUnhook.add(this._editor.onMouseMove(hideWidgetsEventHandler));\r\n        }\r\n        this._toUnhook.add(this._editor.onMouseLeave(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidScrollChange(function (e) { return _this._onEditorScrollChanged(e); }));\r\n    };\r\n    ModesHoverController.prototype._unhookEvents = function () {\r\n        this._toUnhook.clear();\r\n    };\r\n    ModesHoverController.prototype._onModelDecorationsChanged = function () {\r\n        this.contentWidget.onModelDecorationsChanged();\r\n        this.glyphWidget.onModelDecorationsChanged();\r\n    };\r\n    ModesHoverController.prototype._onEditorScrollChanged = function (e) {\r\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseDown = function (mouseEvent) {\r\n        this._isMouseDown = true;\r\n        var targetType = mouseEvent.target.type;\r\n        if (targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            this._hoverClicked = true;\r\n            // mouse down on top of content hover widget\r\n            return;\r\n        }\r\n        if (targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse down on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (targetType !== 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail !== ModesGlyphHoverWidget.ID) {\r\n            this._hoverClicked = false;\r\n        }\r\n        this._hideWidgets();\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseUp = function (mouseEvent) {\r\n        this._isMouseDown = false;\r\n    };\r\n    ModesHoverController.prototype._onEditorMouseMove = function (mouseEvent) {\r\n        var targetType = mouseEvent.target.type;\r\n        if (this._isMouseDown && this._hoverClicked && this.contentWidget.isColorPickerVisible()) {\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            // mouse moved on top of content hover widget\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse moved on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (targetType === 7 /* CONTENT_EMPTY */) {\r\n            var epsilon = this._editor.getOption(34 /* fontInfo */).typicalHalfwidthCharacterWidth / 2;\r\n            var data = mouseEvent.target.detail;\r\n            if (data && !data.isAfterLines && typeof data.horizontalDistanceToText === 'number' && data.horizontalDistanceToText < epsilon) {\r\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\r\n                targetType = 6 /* CONTENT_TEXT */;\r\n            }\r\n        }\r\n        if (targetType === 6 /* CONTENT_TEXT */) {\r\n            this.glyphWidget.hide();\r\n            if (this._isHoverEnabled && mouseEvent.target.range) {\r\n                this.contentWidget.startShowingAt(mouseEvent.target.range, 0 /* Delayed */, false);\r\n            }\r\n        }\r\n        else if (targetType === 2 /* GUTTER_GLYPH_MARGIN */) {\r\n            this.contentWidget.hide();\r\n            if (this._isHoverEnabled && mouseEvent.target.position) {\r\n                this.glyphWidget.startShowingAt(mouseEvent.target.position.lineNumber);\r\n            }\r\n        }\r\n        else {\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._onKeyDown = function (e) {\r\n        if (e.keyCode !== 5 /* Ctrl */ && e.keyCode !== 6 /* Alt */ && e.keyCode !== 57 /* Meta */ && e.keyCode !== 4 /* Shift */) {\r\n            // Do not hide hover when a modifier key is pressed\r\n            this._hideWidgets();\r\n        }\r\n    };\r\n    ModesHoverController.prototype._hideWidgets = function () {\r\n        if (!this._glyphWidget.value || !this._contentWidget.value || (this._isMouseDown && this._hoverClicked && this._contentWidget.value.isColorPickerVisible())) {\r\n            return;\r\n        }\r\n        this._glyphWidget.value.hide();\r\n        this._contentWidget.value.hide();\r\n    };\r\n    ModesHoverController.prototype._createHoverWidgets = function () {\r\n        this._contentWidget.value = new ModesContentHoverWidget(this._editor, this._markerDecorationsService, this._themeService, this._keybindingService, this._modeService, this._openerService);\r\n        this._glyphWidget.value = new ModesGlyphHoverWidget(this._editor, this._modeService, this._openerService);\r\n    };\r\n    ModesHoverController.prototype.showContentHover = function (range, mode, focus) {\r\n        this.contentWidget.startShowingAt(range, mode, focus);\r\n    };\r\n    ModesHoverController.prototype.dispose = function () {\r\n        this._unhookEvents();\r\n        this._toUnhook.dispose();\r\n        this._didChangeConfigurationHandler.dispose();\r\n        this._glyphWidget.dispose();\r\n        this._contentWidget.dispose();\r\n    };\r\n    ModesHoverController.ID = 'editor.contrib.hover';\r\n    ModesHoverController = __decorate([\r\n        __param(1, IOpenerService),\r\n        __param(2, IModeService),\r\n        __param(3, IMarkerDecorationsService),\r\n        __param(4, IKeybindingService),\r\n        __param(5, IThemeService)\r\n    ], ModesHoverController);\r\n    return ModesHoverController;\r\n}());\r\nexport { ModesHoverController };\r\nvar ShowHoverAction = /** @class */ (function (_super) {\r\n    __extends(ShowHoverAction, _super);\r\n    function ShowHoverAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showHover',\r\n            label: nls.localize({\r\n                key: 'showHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of a hover in the editor.',\r\n                    'This allows for users to show the hover without using the mouse.'\r\n                ]\r\n            }, \"Show Hover\"),\r\n            alias: 'Show Hover',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 39 /* KEY_I */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowHoverAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var position = editor.getPosition();\r\n        var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        var focus = editor.getOption(2 /* accessibilitySupport */) === 2 /* Enabled */;\r\n        controller.showContentHover(range, 1 /* Immediate */, focus);\r\n    };\r\n    return ShowHoverAction;\r\n}(EditorAction));\r\nvar ShowDefinitionPreviewHoverAction = /** @class */ (function (_super) {\r\n    __extends(ShowDefinitionPreviewHoverAction, _super);\r\n    function ShowDefinitionPreviewHoverAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showDefinitionPreviewHover',\r\n            label: nls.localize({\r\n                key: 'showDefinitionPreviewHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\r\n                    'This allows for users to show the definition preview hover without using the mouse.'\r\n                ]\r\n            }, \"Show Definition Preview Hover\"),\r\n            alias: 'Show Definition Preview Hover',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    ShowDefinitionPreviewHoverAction.prototype.run = function (accessor, editor) {\r\n        var controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        var position = editor.getPosition();\r\n        if (!position) {\r\n            return;\r\n        }\r\n        var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        var goto = GotoDefinitionAtPositionEditorContribution.get(editor);\r\n        var promise = goto.startFindDefinitionFromCursor(position);\r\n        if (promise) {\r\n            promise.then(function () {\r\n                controller.showContentHover(range, 1 /* Immediate */, true);\r\n            });\r\n        }\r\n        else {\r\n            controller.showContentHover(range, 1 /* Immediate */, true);\r\n        }\r\n    };\r\n    return ShowDefinitionPreviewHoverAction;\r\n}(EditorAction));\r\nregisterEditorContribution(ModesHoverController.ID, ModesHoverController);\r\nregisterEditorAction(ShowHoverAction);\r\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorHoverHighlightColor = theme.getColor(editorHoverHighlight);\r\n    if (editorHoverHighlightColor) {\r\n        collector.addRule(\".monaco-editor .hoverHighlight { background-color: \" + editorHoverHighlightColor + \"; }\");\r\n    }\r\n    var hoverBackground = theme.getColor(editorHoverBackground);\r\n    if (hoverBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { background-color: \" + hoverBackground + \"; }\");\r\n    }\r\n    var hoverBorder = theme.getColor(editorHoverBorder);\r\n    if (hoverBorder) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { border: 1px solid \" + hoverBorder + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover hr { border-top: 1px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover hr { border-bottom: 0px solid \" + hoverBorder.transparent(0.5) + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover a { color: \" + link + \"; }\");\r\n    }\r\n    var hoverForeground = theme.getColor(editorHoverForeground);\r\n    if (hoverForeground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover { color: \" + hoverForeground + \"; }\");\r\n    }\r\n    var actionsBackground = theme.getColor(editorHoverStatusBarBackground);\r\n    if (actionsBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover .hover-row .actions { background-color: \" + actionsBackground + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-hover code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar InPlaceReplaceCommand = /** @class */ (function () {\r\n    function InPlaceReplaceCommand(editRange, originalSelection, text) {\r\n        this._editRange = editRange;\r\n        this._originalSelection = originalSelection;\r\n        this._text = text;\r\n    }\r\n    InPlaceReplaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._editRange, this._text);\r\n    };\r\n    InPlaceReplaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        if (!this._originalSelection.isEmpty()) {\r\n            // Preserve selection and extends to typed text\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\r\n        }\r\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\r\n    };\r\n    return InPlaceReplaceCommand;\r\n}());\r\nexport { InPlaceReplaceCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { registerEditorAction, EditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\r\nimport { EditorState } from '../../browser/core/editorState.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { createCancelablePromise, timeout } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar InPlaceReplaceController = /** @class */ (function () {\r\n    function InPlaceReplaceController(editor, editorWorkerService) {\r\n        this.decorationIds = [];\r\n        this.editor = editor;\r\n        this.editorWorkerService = editorWorkerService;\r\n    }\r\n    InPlaceReplaceController.get = function (editor) {\r\n        return editor.getContribution(InPlaceReplaceController.ID);\r\n    };\r\n    InPlaceReplaceController.prototype.dispose = function () {\r\n    };\r\n    InPlaceReplaceController.prototype.run = function (source, up) {\r\n        var _this = this;\r\n        // cancel any pending request\r\n        if (this.currentRequest) {\r\n            this.currentRequest.cancel();\r\n        }\r\n        var editorSelection = this.editor.getSelection();\r\n        var model = this.editor.getModel();\r\n        if (!model || !editorSelection) {\r\n            return undefined;\r\n        }\r\n        var selection = editorSelection;\r\n        if (selection.startLineNumber !== selection.endLineNumber) {\r\n            // Can't accept multiline selection\r\n            return undefined;\r\n        }\r\n        var state = new EditorState(this.editor, 1 /* Value */ | 4 /* Position */);\r\n        var modelURI = model.uri;\r\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        this.currentRequest = createCancelablePromise(function (token) { return _this.editorWorkerService.navigateValueSet(modelURI, selection, up); });\r\n        return this.currentRequest.then(function (result) {\r\n            if (!result || !result.range || !result.value) {\r\n                // No proper result\r\n                return;\r\n            }\r\n            if (!state.validate(_this.editor)) {\r\n                // state has changed\r\n                return;\r\n            }\r\n            // Selection\r\n            var editRange = Range.lift(result.range);\r\n            var highlightRange = result.range;\r\n            var diff = result.value.length - (selection.endColumn - selection.startColumn);\r\n            // highlight\r\n            highlightRange = {\r\n                startLineNumber: highlightRange.startLineNumber,\r\n                startColumn: highlightRange.startColumn,\r\n                endLineNumber: highlightRange.endLineNumber,\r\n                endColumn: highlightRange.startColumn + result.value.length\r\n            };\r\n            if (diff > 1) {\r\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\r\n            }\r\n            // Insert new text\r\n            var command = new InPlaceReplaceCommand(editRange, selection, result.value);\r\n            _this.editor.pushUndoStop();\r\n            _this.editor.executeCommand(source, command);\r\n            _this.editor.pushUndoStop();\r\n            // add decoration\r\n            _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, [{\r\n                    range: highlightRange,\r\n                    options: InPlaceReplaceController.DECORATION\r\n                }]);\r\n            // remove decoration after delay\r\n            if (_this.decorationRemover) {\r\n                _this.decorationRemover.cancel();\r\n            }\r\n            _this.decorationRemover = timeout(350);\r\n            _this.decorationRemover.then(function () { return _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, []); }).catch(onUnexpectedError);\r\n        }).catch(onUnexpectedError);\r\n    };\r\n    InPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\r\n    InPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\r\n        className: 'valueSetReplacement'\r\n    });\r\n    InPlaceReplaceController = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], InPlaceReplaceController);\r\n    return InPlaceReplaceController;\r\n}());\r\nvar InPlaceReplaceUp = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceUp, _super);\r\n    function InPlaceReplaceUp() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.up',\r\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\r\n            alias: 'Replace with Previous Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 82 /* US_COMMA */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceUp.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, true);\r\n    };\r\n    return InPlaceReplaceUp;\r\n}(EditorAction));\r\nvar InPlaceReplaceDown = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceDown, _super);\r\n    function InPlaceReplaceDown() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.down',\r\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\r\n            alias: 'Replace with Next Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceDown.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, false);\r\n    };\r\n    return InPlaceReplaceDown;\r\n}(EditorAction));\r\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController);\r\nregisterEditorAction(InPlaceReplaceUp);\r\nregisterEditorAction(InPlaceReplaceDown);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorBracketMatchBorder);\r\n    if (border) {\r\n        collector.addRule(\".monaco-editor.vs .valueSetReplacement { outline: solid 2px \" + border + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../core/editOperation.js';\r\nimport { Range } from '../core/range.js';\r\nvar TrimTrailingWhitespaceCommand = /** @class */ (function () {\r\n    function TrimTrailingWhitespaceCommand(selection, cursors) {\r\n        this._selection = selection;\r\n        this._cursors = cursors;\r\n        this._selectionId = null;\r\n    }\r\n    TrimTrailingWhitespaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        var ops = trimTrailingWhitespace(model, this._cursors);\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            var op = ops[i];\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this._selectionId = builder.trackSelection(this._selection);\r\n    };\r\n    TrimTrailingWhitespaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this._selectionId);\r\n    };\r\n    return TrimTrailingWhitespaceCommand;\r\n}());\r\nexport { TrimTrailingWhitespaceCommand };\r\n/**\r\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\r\n */\r\nexport function trimTrailingWhitespace(model, cursors) {\r\n    // Sort cursors ascending\r\n    cursors.sort(function (a, b) {\r\n        if (a.lineNumber === b.lineNumber) {\r\n            return a.column - b.column;\r\n        }\r\n        return a.lineNumber - b.lineNumber;\r\n    });\r\n    // Reduce multiple cursors on the same line and only keep the last one on the line\r\n    for (var i = cursors.length - 2; i >= 0; i--) {\r\n        if (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\r\n            // Remove cursor at `i`\r\n            cursors.splice(i, 1);\r\n        }\r\n    }\r\n    var r = [];\r\n    var rLen = 0;\r\n    var cursorIndex = 0;\r\n    var cursorLen = cursors.length;\r\n    for (var lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n        var lineContent = model.getLineContent(lineNumber);\r\n        var maxLineColumn = lineContent.length + 1;\r\n        var minEditColumn = 0;\r\n        if (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\r\n            minEditColumn = cursors[cursorIndex].column;\r\n            cursorIndex++;\r\n            if (minEditColumn === maxLineColumn) {\r\n                // The cursor is at the end of the line => no edits for sure on this line\r\n                continue;\r\n            }\r\n        }\r\n        if (lineContent.length === 0) {\r\n            continue;\r\n        }\r\n        var lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\r\n        var fromColumn = 0;\r\n        if (lastNonWhitespaceIndex === -1) {\r\n            // Entire line is whitespace\r\n            fromColumn = 1;\r\n        }\r\n        else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\r\n            // There is trailing whitespace\r\n            fromColumn = lastNonWhitespaceIndex + 2;\r\n        }\r\n        else {\r\n            // There is no trailing whitespace\r\n            continue;\r\n        }\r\n        fromColumn = Math.max(minEditColumn, fromColumn);\r\n        r[rLen++] = EditOperation.delete(new Range(lineNumber, fromColumn, lineNumber, maxLineColumn));\r\n    }\r\n    return r;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar CopyLinesCommand = /** @class */ (function () {\r\n    function CopyLinesCommand(selection, isCopyingDown) {\r\n        this._selection = selection;\r\n        this._isCopyingDown = isCopyingDown;\r\n        this._selectionDirection = 0 /* LTR */;\r\n        this._selectionId = null;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n    }\r\n    CopyLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._endLineNumberDelta = 1;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var sourceLines = [];\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            sourceLines.push(model.getLineContent(i));\r\n        }\r\n        var sourceText = sourceLines.join('\\n');\r\n        if (sourceText === '') {\r\n            // Duplicating empty line\r\n            if (this._isCopyingDown) {\r\n                this._startLineNumberDelta++;\r\n                this._endLineNumberDelta++;\r\n            }\r\n        }\r\n        if (!this._isCopyingDown) {\r\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\r\n        }\r\n        else {\r\n            builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        this._selectionDirection = this._selection.getDirection();\r\n    };\r\n    CopyLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\r\n            var startLineNumber = result.startLineNumber;\r\n            var startColumn = result.startColumn;\r\n            var endLineNumber = result.endLineNumber;\r\n            var endColumn = result.endColumn;\r\n            if (this._startLineNumberDelta !== 0) {\r\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\r\n                startColumn = 1;\r\n            }\r\n            if (this._endLineNumberDelta !== 0) {\r\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\r\n                endColumn = 1;\r\n            }\r\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\r\n        }\r\n        return result;\r\n    };\r\n    return CopyLinesCommand;\r\n}());\r\nexport { CopyLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function getSpaceCnt(str, tabSize) {\r\n    var spacesCnt = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        if (str.charAt(i) === '\\t') {\r\n            spacesCnt += tabSize;\r\n        }\r\n        else {\r\n            spacesCnt++;\r\n        }\r\n    }\r\n    return spacesCnt;\r\n}\r\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\r\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\r\n    var result = '';\r\n    if (!insertSpaces) {\r\n        var tabsCnt = Math.floor(spacesCnt / tabSize);\r\n        spacesCnt = spacesCnt % tabSize;\r\n        for (var i = 0; i < tabsCnt; i++) {\r\n            result += '\\t';\r\n        }\r\n    }\r\n    for (var i = 0; i < spacesCnt; i++) {\r\n        result += ' ';\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ShiftCommand } from '../../common/commands/shiftCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { IndentAction } from '../../common/modes/languageConfiguration.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport * as indentUtils from '../indentation/indentUtils.js';\r\nvar MoveLinesCommand = /** @class */ (function () {\r\n    function MoveLinesCommand(selection, isMovingDown, autoIndent) {\r\n        this._selection = selection;\r\n        this._isMovingDown = isMovingDown;\r\n        this._autoIndent = autoIndent;\r\n        this._selectionId = null;\r\n        this._moveEndLineSelectionShrink = false;\r\n    }\r\n    MoveLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var modelLineCount = model.getLineCount();\r\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        this._moveEndPositionDown = false;\r\n        var s = this._selection;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var _a = model.getOptions(), tabSize = _a.tabSize, indentSize = _a.indentSize, insertSpaces = _a.insertSpaces;\r\n        var indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\r\n        var virtualModel = {\r\n            getLineTokens: function (lineNumber) {\r\n                return model.getLineTokens(lineNumber);\r\n            },\r\n            getLanguageIdentifier: function () {\r\n                return model.getLanguageIdentifier();\r\n            },\r\n            getLanguageIdAtPosition: function (lineNumber, column) {\r\n                return model.getLanguageIdAtPosition(lineNumber, column);\r\n            },\r\n            getLineContent: null,\r\n        };\r\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\r\n            // Current line is empty\r\n            var lineNumber = s.startLineNumber;\r\n            var otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\r\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\r\n                // Other line number is empty too, so no editing is needed\r\n                // Add a no-op to force running by the model\r\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\r\n            }\r\n            else {\r\n                // Type content from other line number on line number\r\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\r\n                // Remove content from other line number\r\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\r\n            }\r\n            // Track selection at the other line number\r\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\r\n        }\r\n        else {\r\n            var movingLineNumber_1;\r\n            var movingLineText = void 0;\r\n            if (this._isMovingDown) {\r\n                movingLineNumber_1 = s.endLineNumber + 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1 - 1, model.getLineMaxColumn(movingLineNumber_1 - 1), movingLineNumber_1, model.getLineMaxColumn(movingLineNumber_1)), null);\r\n                var insertingText_1 = movingLineText;\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    var movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber_1, s.startLineNumber - 1);\r\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\r\n                    if (movingLineMatchResult !== null) {\r\n                        var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                        var newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                        var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                        insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                    }\r\n                    else {\r\n                        // no enter rule matches, let's check indentatin rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return model.getLineContent(movingLineNumber_1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var indentOfMovingLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber, indentConverter);\r\n                        if (indentOfMovingLine !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                                insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                            }\r\n                        }\r\n                    }\r\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\r\n                    // to s.startLineNumber\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber, insertingText_1);\r\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match onEnter rules, let's check indentation rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return insertingText_1;\r\n                            }\r\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\r\n                                return model.getLineContent(lineNumber - 1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var newIndentatOfMovingBlock = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber + 1, indentConverter);\r\n                        if (newIndentatOfMovingBlock !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Insert line that needs to be moved before\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                }\r\n            }\r\n            else {\r\n                movingLineNumber_1 = s.startLineNumber - 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1, 1, movingLineNumber_1 + 1, 1), null);\r\n                // Insert line that needs to be moved after\r\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    virtualModel.getLineContent = function (lineNumber) {\r\n                        if (lineNumber === movingLineNumber_1) {\r\n                            return model.getLineContent(s.startLineNumber);\r\n                        }\r\n                        else {\r\n                            return model.getLineContent(lineNumber);\r\n                        }\r\n                    };\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\r\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\r\n                        var indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber_1, indentConverter);\r\n                        if (indentOfFirstLine !== null) {\r\n                            // adjust the indentation of the moving block\r\n                            var oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    };\r\n    MoveLinesCommand.prototype.buildIndentConverter = function (tabSize, indentSize, insertSpaces) {\r\n        return {\r\n            shiftIndent: function (indentation) {\r\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            },\r\n            unshiftIndent: function (indentation) {\r\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            }\r\n        };\r\n    };\r\n    MoveLinesCommand.prototype.matchEnterRule = function (model, indentConverter, tabSize, line, oneLineAbove, oneLineAboveText) {\r\n        var validPrecedingLine = oneLineAbove;\r\n        while (validPrecedingLine >= 1) {\r\n            // ship empty lines as empty lines just inherit indentation\r\n            var lineContent = void 0;\r\n            if (validPrecedingLine === oneLineAbove && oneLineAboveText !== undefined) {\r\n                lineContent = oneLineAboveText;\r\n            }\r\n            else {\r\n                lineContent = model.getLineContent(validPrecedingLine);\r\n            }\r\n            var nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\r\n            if (nonWhitespaceIdx >= 0) {\r\n                break;\r\n            }\r\n            validPrecedingLine--;\r\n        }\r\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\r\n            return null;\r\n        }\r\n        var maxColumn = model.getLineMaxColumn(validPrecedingLine);\r\n        var enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn));\r\n        if (enter) {\r\n            var enterPrefix = enter.indentation;\r\n            if (enter.indentAction === IndentAction.None) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Indent) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\r\n                enterPrefix = enter.indentation;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Outdent) {\r\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\r\n            }\r\n            var movingLineText = model.getLineContent(line);\r\n            if (this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix)) >= 0) {\r\n                var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\r\n                var newIndentation = strings.getLeadingWhitespace(enterPrefix);\r\n                var indentMetadataOfMovelingLine = LanguageConfigurationRegistry.getIndentMetadata(model, line);\r\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* DECREASE_MASK */) {\r\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\r\n                }\r\n                var newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\r\n                var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                return newSpaceCnt - oldSpaceCnt;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MoveLinesCommand.prototype.trimLeft = function (str) {\r\n        return str.replace(/^\\s+/, '');\r\n    };\r\n    MoveLinesCommand.prototype.shouldAutoIndent = function (model, selection) {\r\n        if (this._autoIndent < 4 /* Full */) {\r\n            return false;\r\n        }\r\n        // if it's not easy to tokenize, we stop auto indent.\r\n        if (!model.isCheapToTokenize(selection.startLineNumber)) {\r\n            return false;\r\n        }\r\n        var languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\r\n        var languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\r\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\r\n            return false;\r\n        }\r\n        if (LanguageConfigurationRegistry.getIndentRulesSupport(languageAtSelectionStart) === null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    MoveLinesCommand.prototype.getIndentEditsOfMovingBlock = function (model, builder, s, tabSize, insertSpaces, offset) {\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            var lineContent = model.getLineContent(i);\r\n            var originalIndent = strings.getLeadingWhitespace(lineContent);\r\n            var originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\r\n            var newSpacesCnt = originalSpacesCnt + offset;\r\n            var newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\r\n            if (newIndent !== originalIndent) {\r\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\r\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\r\n                    // as users select part of the original indent white spaces\r\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\r\n                    this._moveEndLineSelectionShrink = true;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    MoveLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\r\n            result = result.setEndPosition(result.endLineNumber, 2);\r\n        }\r\n        return result;\r\n    };\r\n    return MoveLinesCommand;\r\n}());\r\nexport { MoveLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar SortLinesCommand = /** @class */ (function () {\r\n    function SortLinesCommand(selection, descending) {\r\n        this.selection = selection;\r\n        this.descending = descending;\r\n        this.selectionId = null;\r\n    }\r\n    SortLinesCommand.getCollator = function () {\r\n        if (!SortLinesCommand._COLLATOR) {\r\n            SortLinesCommand._COLLATOR = new Intl.Collator();\r\n        }\r\n        return SortLinesCommand._COLLATOR;\r\n    };\r\n    SortLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var op = sortLines(model, this.selection, this.descending);\r\n        if (op) {\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n    };\r\n    SortLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    };\r\n    SortLinesCommand.canRun = function (model, selection, descending) {\r\n        if (model === null) {\r\n            return false;\r\n        }\r\n        var data = getSortData(model, selection, descending);\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = data.before.length; i < len; i++) {\r\n            if (data.before[i] !== data.after[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    SortLinesCommand._COLLATOR = null;\r\n    return SortLinesCommand;\r\n}());\r\nexport { SortLinesCommand };\r\nfunction getSortData(model, selection, descending) {\r\n    var startLineNumber = selection.startLineNumber;\r\n    var endLineNumber = selection.endLineNumber;\r\n    if (selection.endColumn === 1) {\r\n        endLineNumber--;\r\n    }\r\n    // Nothing to sort if user didn't select anything.\r\n    if (startLineNumber >= endLineNumber) {\r\n        return null;\r\n    }\r\n    var linesToSort = [];\r\n    // Get the contents of the selection to be sorted.\r\n    for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n        linesToSort.push(model.getLineContent(lineNumber));\r\n    }\r\n    var sorted = linesToSort.slice(0);\r\n    sorted.sort(SortLinesCommand.getCollator().compare);\r\n    // If descending, reverse the order.\r\n    if (descending === true) {\r\n        sorted = sorted.reverse();\r\n    }\r\n    return {\r\n        startLineNumber: startLineNumber,\r\n        endLineNumber: endLineNumber,\r\n        before: linesToSort,\r\n        after: sorted\r\n    };\r\n}\r\n/**\r\n * Generate commands for sorting lines on a model.\r\n */\r\nfunction sortLines(model, selection, descending) {\r\n    var data = getSortData(model, selection, descending);\r\n    if (!data) {\r\n        return null;\r\n    }\r\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { CoreEditingCommands } from '../../browser/controller/coreCommands.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../common/commands/replaceCommand.js';\r\nimport { TrimTrailingWhitespaceCommand } from '../../common/commands/trimTrailingWhitespaceCommand.js';\r\nimport { TypeOperations } from '../../common/controller/cursorTypeOperations.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CopyLinesCommand } from './copyLinesCommand.js';\r\nimport { MoveLinesCommand } from './moveLinesCommand.js';\r\nimport { SortLinesCommand } from './sortLinesCommand.js';\r\n// copy lines\r\nvar AbstractCopyLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCopyLinesAction, _super);\r\n    function AbstractCopyLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractCopyLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new CopyLinesCommand(selection, this.down));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCopyLinesAction;\r\n}(EditorAction));\r\nvar CopyLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesUpAction, _super);\r\n    function CopyLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.copyLinesUpAction',\r\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\r\n            alias: 'Copy Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesUpAction;\r\n}(AbstractCopyLinesAction));\r\nvar CopyLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesDownAction, _super);\r\n    function CopyLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.copyLinesDownAction',\r\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\r\n            alias: 'Copy Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesDownAction;\r\n}(AbstractCopyLinesAction));\r\nvar DuplicateSelectionAction = /** @class */ (function (_super) {\r\n    __extends(DuplicateSelectionAction, _super);\r\n    function DuplicateSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.duplicateSelection',\r\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\r\n            alias: 'Duplicate Selection',\r\n            precondition: EditorContextKeys.writable,\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    DuplicateSelectionAction.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        var model = editor.getModel();\r\n        for (var _i = 0, selections_2 = selections; _i < selections_2.length; _i++) {\r\n            var selection = selections_2[_i];\r\n            if (selection.isEmpty()) {\r\n                commands.push(new CopyLinesCommand(selection, true));\r\n            }\r\n            else {\r\n                var insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\r\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return DuplicateSelectionAction;\r\n}(EditorAction));\r\nexport { DuplicateSelectionAction };\r\n// move lines\r\nvar AbstractMoveLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractMoveLinesAction, _super);\r\n    function AbstractMoveLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractMoveLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        var autoIndent = editor.getOption(8 /* autoIndent */);\r\n        for (var _i = 0, selections_3 = selections; _i < selections_3.length; _i++) {\r\n            var selection = selections_3[_i];\r\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractMoveLinesAction;\r\n}(EditorAction));\r\nvar MoveLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesUpAction, _super);\r\n    function MoveLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.moveLinesUpAction',\r\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\r\n            alias: 'Move Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: { primary: 512 /* Alt */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesUpAction;\r\n}(AbstractMoveLinesAction));\r\nvar MoveLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesDownAction, _super);\r\n    function MoveLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.moveLinesDownAction',\r\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\r\n            alias: 'Move Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: { primary: 512 /* Alt */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesDownAction;\r\n}(AbstractMoveLinesAction));\r\nvar AbstractSortLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractSortLinesAction, _super);\r\n    function AbstractSortLinesAction(descending, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.descending = descending;\r\n        return _this;\r\n    }\r\n    AbstractSortLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_4 = selections; _i < selections_4.length; _i++) {\r\n            var selection = selections_4[_i];\r\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\r\n                return;\r\n            }\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractSortLinesAction;\r\n}(EditorAction));\r\nexport { AbstractSortLinesAction };\r\nvar SortLinesAscendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesAscendingAction, _super);\r\n    function SortLinesAscendingAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.sortLinesAscending',\r\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\r\n            alias: 'Sort Lines Ascending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesAscendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesAscendingAction };\r\nvar SortLinesDescendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesDescendingAction, _super);\r\n    function SortLinesDescendingAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.sortLinesDescending',\r\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\r\n            alias: 'Sort Lines Descending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesDescendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesDescendingAction };\r\nvar TrimTrailingWhitespaceAction = /** @class */ (function (_super) {\r\n    __extends(TrimTrailingWhitespaceAction, _super);\r\n    function TrimTrailingWhitespaceAction() {\r\n        return _super.call(this, {\r\n            id: TrimTrailingWhitespaceAction.ID,\r\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\r\n            alias: 'Trim Trailing Whitespace',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 54 /* KEY_X */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TrimTrailingWhitespaceAction.prototype.run = function (_accessor, editor, args) {\r\n        var cursors = [];\r\n        if (args.reason === 'auto-save') {\r\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\r\n            // It is very convenient for the editor config extension to invoke this action.\r\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\r\n            cursors = (editor.getSelections() || []).map(function (s) { return new Position(s.positionLineNumber, s.positionColumn); });\r\n        }\r\n        var selection = editor.getSelection();\r\n        if (selection === null) {\r\n            return;\r\n        }\r\n        var command = new TrimTrailingWhitespaceCommand(selection, cursors);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n    };\r\n    TrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\r\n    return TrimTrailingWhitespaceAction;\r\n}(EditorAction));\r\nexport { TrimTrailingWhitespaceAction };\r\nvar DeleteLinesAction = /** @class */ (function (_super) {\r\n    __extends(DeleteLinesAction, _super);\r\n    function DeleteLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.deleteLines',\r\n            label: nls.localize('lines.delete', \"Delete Line\"),\r\n            alias: 'Delete Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 41 /* KEY_K */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteLinesAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var ops = this._getLinesToRemove(editor);\r\n        var model = editor.getModel();\r\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n            // Model is empty\r\n            return;\r\n        }\r\n        var linesDeleted = 0;\r\n        var edits = [];\r\n        var cursorState = [];\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            var op = ops[i];\r\n            var startLineNumber = op.startLineNumber;\r\n            var endLineNumber = op.endLineNumber;\r\n            var startColumn = 1;\r\n            var endColumn = model.getLineMaxColumn(endLineNumber);\r\n            if (endLineNumber < model.getLineCount()) {\r\n                endLineNumber += 1;\r\n                endColumn = 1;\r\n            }\r\n            else if (startLineNumber > 1) {\r\n                startLineNumber -= 1;\r\n                startColumn = model.getLineMaxColumn(startLineNumber);\r\n            }\r\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\r\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\r\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, cursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    DeleteLinesAction.prototype._getLinesToRemove = function (editor) {\r\n        // Construct delete operations\r\n        var operations = editor.getSelections().map(function (s) {\r\n            var endLineNumber = s.endLineNumber;\r\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n                endLineNumber -= 1;\r\n            }\r\n            return {\r\n                startLineNumber: s.startLineNumber,\r\n                selectionStartColumn: s.selectionStartColumn,\r\n                endLineNumber: endLineNumber,\r\n                positionColumn: s.positionColumn\r\n            };\r\n        });\r\n        // Sort delete operations\r\n        operations.sort(function (a, b) {\r\n            if (a.startLineNumber === b.startLineNumber) {\r\n                return a.endLineNumber - b.endLineNumber;\r\n            }\r\n            return a.startLineNumber - b.startLineNumber;\r\n        });\r\n        // Merge delete operations which are adjacent or overlapping\r\n        var mergedOperations = [];\r\n        var previousOperation = operations[0];\r\n        for (var i = 1; i < operations.length; i++) {\r\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\r\n                // Merge current operations into the previous one\r\n                previousOperation.endLineNumber = operations[i].endLineNumber;\r\n            }\r\n            else {\r\n                // Push previous operation\r\n                mergedOperations.push(previousOperation);\r\n                previousOperation = operations[i];\r\n            }\r\n        }\r\n        // Push the last operation\r\n        mergedOperations.push(previousOperation);\r\n        return mergedOperations;\r\n    };\r\n    return DeleteLinesAction;\r\n}(EditorAction));\r\nexport { DeleteLinesAction };\r\nvar IndentLinesAction = /** @class */ (function (_super) {\r\n    __extends(IndentLinesAction, _super);\r\n    function IndentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.indentLines',\r\n            label: nls.localize('lines.indent', \"Indent Line\"),\r\n            alias: 'Indent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    IndentLinesAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.indent(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n        editor.pushUndoStop();\r\n    };\r\n    return IndentLinesAction;\r\n}(EditorAction));\r\nexport { IndentLinesAction };\r\nvar OutdentLinesAction = /** @class */ (function (_super) {\r\n    __extends(OutdentLinesAction, _super);\r\n    function OutdentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.outdentLines',\r\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\r\n            alias: 'Outdent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    OutdentLinesAction.prototype.run = function (_accessor, editor) {\r\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\r\n    };\r\n    return OutdentLinesAction;\r\n}(EditorAction));\r\nvar InsertLineBeforeAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineBeforeAction, _super);\r\n    function InsertLineBeforeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineBefore',\r\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\r\n            alias: 'Insert Line Above',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineBeforeAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineBeforeAction;\r\n}(EditorAction));\r\nexport { InsertLineBeforeAction };\r\nvar InsertLineAfterAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineAfterAction, _super);\r\n    function InsertLineAfterAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineAfter',\r\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\r\n            alias: 'Insert Line Below',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineAfterAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineAfterAction;\r\n}(EditorAction));\r\nexport { InsertLineAfterAction };\r\nvar AbstractDeleteAllToBoundaryAction = /** @class */ (function (_super) {\r\n    __extends(AbstractDeleteAllToBoundaryAction, _super);\r\n    function AbstractDeleteAllToBoundaryAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractDeleteAllToBoundaryAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        var rangesToDelete = this._getRangesToDelete(editor);\r\n        // merge overlapping selections\r\n        var effectiveRanges = [];\r\n        for (var i = 0, count = rangesToDelete.length - 1; i < count; i++) {\r\n            var range = rangesToDelete[i];\r\n            var nextRange = rangesToDelete[i + 1];\r\n            if (Range.intersectRanges(range, nextRange) === null) {\r\n                effectiveRanges.push(range);\r\n            }\r\n            else {\r\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\r\n            }\r\n        }\r\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\r\n        var endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\r\n        var edits = effectiveRanges.map(function (range) {\r\n            return EditOperation.replace(range, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractDeleteAllToBoundaryAction;\r\n}(EditorAction));\r\nexport { AbstractDeleteAllToBoundaryAction };\r\nvar DeleteAllLeftAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllLeftAction, _super);\r\n    function DeleteAllLeftAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllLeft',\r\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\r\n            alias: 'Delete All Left',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllLeftAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        var deletedLines = 0;\r\n        rangesToDelete.forEach(function (range) {\r\n            var endCursor;\r\n            if (range.endColumn === 1 && deletedLines > 0) {\r\n                var newStartLine = range.startLineNumber - deletedLines;\r\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\r\n            }\r\n            else {\r\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n            }\r\n            deletedLines += range.endLineNumber - range.startLineNumber;\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        });\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllLeftAction.prototype._getRangesToDelete = function (editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections;\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        rangesToDelete = rangesToDelete.map(function (selection) {\r\n            if (selection.isEmpty()) {\r\n                if (selection.startColumn === 1) {\r\n                    var deleteFromLine = Math.max(1, selection.startLineNumber - 1);\r\n                    var deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineContent(deleteFromLine).length + 1;\r\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\r\n                }\r\n                else {\r\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\r\n                }\r\n            }\r\n            else {\r\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\r\n            }\r\n        });\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllLeftAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllLeftAction };\r\nvar DeleteAllRightAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllRightAction, _super);\r\n    function DeleteAllRightAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllRight',\r\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\r\n            alias: 'Delete All Right',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 41 /* KEY_K */, secondary: [2048 /* CtrlCmd */ | 20 /* Delete */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllRightAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        for (var i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\r\n            var range = rangesToDelete[i];\r\n            var endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        }\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllRightAction.prototype._getRangesToDelete = function (editor) {\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections.map(function (sel) {\r\n            if (sel.isEmpty()) {\r\n                var maxColumn = model.getLineMaxColumn(sel.startLineNumber);\r\n                if (sel.startColumn === maxColumn) {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\r\n                }\r\n                else {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\r\n                }\r\n            }\r\n            return sel;\r\n        });\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllRightAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllRightAction };\r\nvar JoinLinesAction = /** @class */ (function (_super) {\r\n    __extends(JoinLinesAction, _super);\r\n    function JoinLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.joinLines',\r\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\r\n            alias: 'Join Lines',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 40 /* KEY_J */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    JoinLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        if (primaryCursor === null) {\r\n            return;\r\n        }\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        var reducedSelections = [];\r\n        var lastSelection = selections.reduce(function (previousValue, currentValue) {\r\n            if (previousValue.isEmpty()) {\r\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\r\n                    if (primaryCursor.equalsSelection(previousValue)) {\r\n                        primaryCursor = currentValue;\r\n                    }\r\n                    return currentValue;\r\n                }\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n            else {\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n        });\r\n        reducedSelections.push(lastSelection);\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var edits = [];\r\n        var endCursorState = [];\r\n        var endPrimaryCursor = primaryCursor;\r\n        var lineOffset = 0;\r\n        for (var i = 0, len = reducedSelections.length; i < len; i++) {\r\n            var selection = reducedSelections[i];\r\n            var startLineNumber = selection.startLineNumber;\r\n            var startColumn = 1;\r\n            var columnDeltaOffset = 0;\r\n            var endLineNumber = void 0, endColumn = void 0;\r\n            var selectionEndPositionOffset = model.getLineContent(selection.endLineNumber).length - selection.endColumn;\r\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\r\n                var position = selection.getStartPosition();\r\n                if (position.lineNumber < model.getLineCount()) {\r\n                    endLineNumber = startLineNumber + 1;\r\n                    endColumn = model.getLineMaxColumn(endLineNumber);\r\n                }\r\n                else {\r\n                    endLineNumber = position.lineNumber;\r\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                }\r\n            }\r\n            else {\r\n                endLineNumber = selection.endLineNumber;\r\n                endColumn = model.getLineMaxColumn(endLineNumber);\r\n            }\r\n            var trimmedLinesContent = model.getLineContent(startLineNumber);\r\n            for (var i_1 = startLineNumber + 1; i_1 <= endLineNumber; i_1++) {\r\n                var lineText = model.getLineContent(i_1);\r\n                var firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i_1);\r\n                if (firstNonWhitespaceIdx >= 1) {\r\n                    var insertSpace = true;\r\n                    if (trimmedLinesContent === '') {\r\n                        insertSpace = false;\r\n                    }\r\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\r\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\r\n                        insertSpace = false;\r\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\r\n                    }\r\n                    var lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\r\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\r\n                    if (insertSpace) {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\r\n                    }\r\n                    else {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length;\r\n                    }\r\n                }\r\n                else {\r\n                    columnDeltaOffset = 0;\r\n                }\r\n            }\r\n            var deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n            if (!deleteSelection.isEmpty()) {\r\n                var resultSelection = void 0;\r\n                if (selection.isEmpty()) {\r\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\r\n                }\r\n                else {\r\n                    if (selection.startLineNumber === selection.endLineNumber) {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\r\n                    }\r\n                    else {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\r\n                    }\r\n                }\r\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\r\n                    endPrimaryCursor = resultSelection;\r\n                }\r\n                else {\r\n                    endCursorState.push(resultSelection);\r\n                }\r\n            }\r\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\r\n        }\r\n        endCursorState.unshift(endPrimaryCursor);\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return JoinLinesAction;\r\n}(EditorAction));\r\nexport { JoinLinesAction };\r\nvar TransposeAction = /** @class */ (function (_super) {\r\n    __extends(TransposeAction, _super);\r\n    function TransposeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transpose',\r\n            label: nls.localize('editor.transpose', \"Transpose characters around the cursor\"),\r\n            alias: 'Transpose characters around the cursor',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TransposeAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            var cursor = selection.getStartPosition();\r\n            var maxColumn = model.getLineMaxColumn(cursor.lineNumber);\r\n            if (cursor.column >= maxColumn) {\r\n                if (cursor.lineNumber === model.getLineCount()) {\r\n                    continue;\r\n                }\r\n                // The cursor is at the end of current line and current line is not empty\r\n                // then we transpose the character before the cursor and the line break if there is any following line.\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\r\n            }\r\n            else {\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return TransposeAction;\r\n}(EditorAction));\r\nexport { TransposeAction };\r\nvar AbstractCaseAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCaseAction, _super);\r\n    function AbstractCaseAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractCaseAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var wordSeparators = editor.getOption(96 /* wordSeparators */);\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                var cursor = selection.getStartPosition();\r\n                var word = model.getWordAtPosition(cursor);\r\n                if (!word) {\r\n                    continue;\r\n                }\r\n                var wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\r\n                var text = model.getValueInRange(wordRange);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(wordRange, this._modifyText(text, wordSeparators), new Selection(cursor.lineNumber, cursor.column, cursor.lineNumber, cursor.column)));\r\n            }\r\n            else {\r\n                var text = model.getValueInRange(selection);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(selection, this._modifyText(text, wordSeparators), selection));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCaseAction;\r\n}(EditorAction));\r\nexport { AbstractCaseAction };\r\nvar UpperCaseAction = /** @class */ (function (_super) {\r\n    __extends(UpperCaseAction, _super);\r\n    function UpperCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToUppercase',\r\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\r\n            alias: 'Transform to Uppercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    UpperCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleUpperCase();\r\n    };\r\n    return UpperCaseAction;\r\n}(AbstractCaseAction));\r\nexport { UpperCaseAction };\r\nvar LowerCaseAction = /** @class */ (function (_super) {\r\n    __extends(LowerCaseAction, _super);\r\n    function LowerCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToLowercase',\r\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\r\n            alias: 'Transform to Lowercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    LowerCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleLowerCase();\r\n    };\r\n    return LowerCaseAction;\r\n}(AbstractCaseAction));\r\nexport { LowerCaseAction };\r\nvar TitleCaseAction = /** @class */ (function (_super) {\r\n    __extends(TitleCaseAction, _super);\r\n    function TitleCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToTitlecase',\r\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\r\n            alias: 'Transform to Title Case',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TitleCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        var separators = '\\r\\n\\t ' + wordSeparators;\r\n        var excludedChars = separators.split('');\r\n        var title = '';\r\n        var startUpperCase = true;\r\n        for (var i = 0; i < text.length; i++) {\r\n            var currentChar = text[i];\r\n            if (excludedChars.indexOf(currentChar) >= 0) {\r\n                startUpperCase = true;\r\n                title += currentChar;\r\n            }\r\n            else if (startUpperCase) {\r\n                startUpperCase = false;\r\n                title += currentChar.toLocaleUpperCase();\r\n            }\r\n            else {\r\n                title += currentChar.toLocaleLowerCase();\r\n            }\r\n        }\r\n        return title;\r\n    };\r\n    return TitleCaseAction;\r\n}(AbstractCaseAction));\r\nexport { TitleCaseAction };\r\nregisterEditorAction(CopyLinesUpAction);\r\nregisterEditorAction(CopyLinesDownAction);\r\nregisterEditorAction(DuplicateSelectionAction);\r\nregisterEditorAction(MoveLinesUpAction);\r\nregisterEditorAction(MoveLinesDownAction);\r\nregisterEditorAction(SortLinesAscendingAction);\r\nregisterEditorAction(SortLinesDescendingAction);\r\nregisterEditorAction(TrimTrailingWhitespaceAction);\r\nregisterEditorAction(DeleteLinesAction);\r\nregisterEditorAction(IndentLinesAction);\r\nregisterEditorAction(OutdentLinesAction);\r\nregisterEditorAction(InsertLineBeforeAction);\r\nregisterEditorAction(InsertLineAfterAction);\r\nregisterEditorAction(DeleteAllLeftAction);\r\nregisterEditorAction(DeleteAllRightAction);\r\nregisterEditorAction(JoinLinesAction);\r\nregisterEditorAction(TransposeAction);\r\nregisterEditorAction(UpperCaseAction);\r\nregisterEditorAction(LowerCaseAction);\r\nregisterEditorAction(TitleCaseAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { isDisposable, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nvar Link = /** @class */ (function () {\r\n    function Link(link, provider) {\r\n        this._link = link;\r\n        this._provider = provider;\r\n    }\r\n    Link.prototype.toJSON = function () {\r\n        return {\r\n            range: this.range,\r\n            url: this.url,\r\n            tooltip: this.tooltip\r\n        };\r\n    };\r\n    Object.defineProperty(Link.prototype, \"range\", {\r\n        get: function () {\r\n            return this._link.range;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"url\", {\r\n        get: function () {\r\n            return this._link.url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"tooltip\", {\r\n        get: function () {\r\n            return this._link.tooltip;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Link.prototype.resolve = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (this._link.url) {\r\n                    return [2 /*return*/, this._link.url];\r\n                }\r\n                if (typeof this._provider.resolveLink === 'function') {\r\n                    return [2 /*return*/, Promise.resolve(this._provider.resolveLink(this._link, token)).then(function (value) {\r\n                            _this._link = value || _this._link;\r\n                            if (_this._link.url) {\r\n                                // recurse\r\n                                return _this.resolve(token);\r\n                            }\r\n                            return Promise.reject(new Error('missing'));\r\n                        })];\r\n                }\r\n                return [2 /*return*/, Promise.reject(new Error('missing'))];\r\n            });\r\n        });\r\n    };\r\n    return Link;\r\n}());\r\nexport { Link };\r\nvar LinksList = /** @class */ (function (_super) {\r\n    __extends(LinksList, _super);\r\n    function LinksList(tuples) {\r\n        var _this = _super.call(this) || this;\r\n        var links = [];\r\n        var _loop_1 = function (list, provider) {\r\n            // merge all links\r\n            var newLinks = list.links.map(function (link) { return new Link(link, provider); });\r\n            links = LinksList._union(links, newLinks);\r\n            // register disposables\r\n            if (isDisposable(provider)) {\r\n                this_1._register(provider);\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, tuples_1 = tuples; _i < tuples_1.length; _i++) {\r\n            var _a = tuples_1[_i], list = _a[0], provider = _a[1];\r\n            _loop_1(list, provider);\r\n        }\r\n        _this.links = links;\r\n        return _this;\r\n    }\r\n    LinksList._union = function (oldLinks, newLinks) {\r\n        // reunite oldLinks with newLinks and remove duplicates\r\n        var result = [];\r\n        var oldIndex;\r\n        var oldLen;\r\n        var newIndex;\r\n        var newLen;\r\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\r\n            var oldLink = oldLinks[oldIndex];\r\n            var newLink = newLinks[newIndex];\r\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\r\n                // Remove the oldLink\r\n                oldIndex++;\r\n                continue;\r\n            }\r\n            var comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\r\n            if (comparisonResult < 0) {\r\n                // oldLink is before\r\n                result.push(oldLink);\r\n                oldIndex++;\r\n            }\r\n            else {\r\n                // newLink is before\r\n                result.push(newLink);\r\n                newIndex++;\r\n            }\r\n        }\r\n        for (; oldIndex < oldLen; oldIndex++) {\r\n            result.push(oldLinks[oldIndex]);\r\n        }\r\n        for (; newIndex < newLen; newIndex++) {\r\n            result.push(newLinks[newIndex]);\r\n        }\r\n        return result;\r\n    };\r\n    return LinksList;\r\n}(Disposable));\r\nexport { LinksList };\r\nexport function getLinks(model, token) {\r\n    var lists = [];\r\n    // ask all providers for links in parallel\r\n    var promises = LinkProviderRegistry.ordered(model).reverse().map(function (provider, i) {\r\n        return Promise.resolve(provider.provideLinks(model, token)).then(function (result) {\r\n            if (result) {\r\n                lists[i] = [result, provider];\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function () {\r\n        var result = new LinksList(coalesce(lists));\r\n        if (!token.isCancellationRequested) {\r\n            return result;\r\n        }\r\n        result.dispose();\r\n        return new LinksList([]);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeLinkProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        var uri, model, list, result;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    uri = args[0];\r\n                    if (!(uri instanceof URI)) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    model = accessor.get(IModelService).getModel(uri);\r\n                    if (!model) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    return [4 /*yield*/, getLinks(model, CancellationToken.None)];\r\n                case 1:\r\n                    list = _a.sent();\r\n                    if (!list) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    result = list.links.slice(0);\r\n                    list.dispose();\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './links.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as async from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\r\nimport { getLinks } from './getLinks.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nfunction getHoverMessage(link, useMetaKey) {\r\n    var executeCmd = link.url && /^command:/i.test(link.url.toString());\r\n    var label = link.tooltip\r\n        ? link.tooltip\r\n        : executeCmd\r\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\r\n            : nls.localize('links.navigate.follow', 'Follow link');\r\n    var kb = useMetaKey\r\n        ? platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\r\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\r\n        : platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\r\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\r\n    if (link.url) {\r\n        var hoverMessage = new MarkdownString('', true).appendMarkdown(\"[\" + label + \"](\" + link.url.toString() + \") (\" + kb + \")\");\r\n        return hoverMessage;\r\n    }\r\n    else {\r\n        return new MarkdownString().appendText(label + \" (\" + kb + \")\");\r\n    }\r\n}\r\nvar decoration = {\r\n    general: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link'\r\n    }),\r\n    active: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link-active'\r\n    })\r\n};\r\nvar LinkOccurrence = /** @class */ (function () {\r\n    function LinkOccurrence(link, decorationId) {\r\n        this.link = link;\r\n        this.decorationId = decorationId;\r\n    }\r\n    LinkOccurrence.decoration = function (link, useMetaKey) {\r\n        return {\r\n            range: link.range,\r\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\r\n        };\r\n    };\r\n    LinkOccurrence._getOptions = function (link, useMetaKey, isActive) {\r\n        var options = __assign({}, (isActive ? decoration.active : decoration.general));\r\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\r\n        return options;\r\n    };\r\n    LinkOccurrence.prototype.activate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\r\n    };\r\n    LinkOccurrence.prototype.deactivate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\r\n    };\r\n    return LinkOccurrence;\r\n}());\r\nvar LinkDetector = /** @class */ (function () {\r\n    function LinkDetector(editor, openerService, notificationService) {\r\n        var _this = this;\r\n        this.listenersToRemove = new DisposableStore();\r\n        this.editor = editor;\r\n        this.openerService = openerService;\r\n        this.notificationService = notificationService;\r\n        var clickLinkGesture = new ClickLinkGesture(editor);\r\n        this.listenersToRemove.add(clickLinkGesture);\r\n        this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this._onEditorMouseMove(mouseEvent, keyboardEvent);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onExecute(function (e) {\r\n            _this.onEditorMouseUp(e);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onCancel(function (e) {\r\n            _this.cleanUpActiveLinkDecoration();\r\n        }));\r\n        this.enabled = editor.getOption(52 /* links */);\r\n        this.listenersToRemove.add(editor.onDidChangeConfiguration(function (e) {\r\n            var enabled = editor.getOption(52 /* links */);\r\n            if (_this.enabled === enabled) {\r\n                // No change in our configuration option\r\n                return;\r\n            }\r\n            _this.enabled = enabled;\r\n            // Remove any links (for the getting disabled case)\r\n            _this.updateDecorations([]);\r\n            // Stop any computation (for the getting disabled case)\r\n            _this.stop();\r\n            // Start computing (for the getting enabled case)\r\n            _this.beginCompute();\r\n        }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelContent(function (e) { return _this.onChange(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelLanguage(function (e) { return _this.onModelModeChanged(); }));\r\n        this.listenersToRemove.add(LinkProviderRegistry.onDidChange(function (e) { return _this.onModelModeChanged(); }));\r\n        this.timeout = new async.TimeoutTimer();\r\n        this.computePromise = null;\r\n        this.activeLinksList = null;\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.beginCompute();\r\n    }\r\n    LinkDetector.get = function (editor) {\r\n        return editor.getContribution(LinkDetector.ID);\r\n    };\r\n    LinkDetector.prototype.onModelChanged = function () {\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onModelModeChanged = function () {\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onChange = function () {\r\n        var _this = this;\r\n        this.timeout.setIfNotSet(function () { return _this.beginCompute(); }, LinkDetector.RECOMPUTE_TIME);\r\n    };\r\n    LinkDetector.prototype.beginCompute = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var model, _a, err_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.editor.hasModel() || !this.enabled) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        if (!LinkProviderRegistry.has(model)) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (this.activeLinksList) {\r\n                            this.activeLinksList.dispose();\r\n                            this.activeLinksList = null;\r\n                        }\r\n                        this.computePromise = async.createCancelablePromise(function (token) { return getLinks(model, token); });\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 3, 4, 5]);\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.computePromise];\r\n                    case 2:\r\n                        _a.activeLinksList = _b.sent();\r\n                        this.updateDecorations(this.activeLinksList.links);\r\n                        return [3 /*break*/, 5];\r\n                    case 3:\r\n                        err_1 = _b.sent();\r\n                        onUnexpectedError(err_1);\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        this.computePromise = null;\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LinkDetector.prototype.updateDecorations = function (links) {\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        var oldDecorations = [];\r\n        var keys = Object.keys(this.currentOccurrences);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var decorationId = keys[i];\r\n            var occurance = this.currentOccurrences[decorationId];\r\n            oldDecorations.push(occurance.decorationId);\r\n        }\r\n        var newDecorations = [];\r\n        if (links) {\r\n            // Not sure why this is sometimes null\r\n            for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n                var link = links_1[_i];\r\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\r\n            }\r\n        }\r\n        var decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var occurance = new LinkOccurrence(links[i], decorations[i]);\r\n            this.currentOccurrences[occurance.decorationId] = occurance;\r\n        }\r\n    };\r\n    LinkDetector.prototype._onEditorMouseMove = function (mouseEvent, withKey) {\r\n        var _this = this;\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        if (this.isEnabled(mouseEvent, withKey)) {\r\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\r\n            var occurrence_1 = this.getLinkOccurrence(mouseEvent.target.position);\r\n            if (occurrence_1) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_1.activate(changeAccessor, useMetaKey);\r\n                    _this.activeLinkDecorationId = occurrence_1.decorationId;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }\r\n    };\r\n    LinkDetector.prototype.cleanUpActiveLinkDecoration = function () {\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        if (this.activeLinkDecorationId) {\r\n            var occurrence_2 = this.currentOccurrences[this.activeLinkDecorationId];\r\n            if (occurrence_2) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_2.deactivate(changeAccessor, useMetaKey);\r\n                });\r\n            }\r\n            this.activeLinkDecorationId = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (!this.isEnabled(mouseEvent)) {\r\n            return;\r\n        }\r\n        var occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n        if (!occurrence) {\r\n            return;\r\n        }\r\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\r\n    };\r\n    LinkDetector.prototype.openLinkOccurrence = function (occurrence, openToSide, fromUserGesture) {\r\n        var _this = this;\r\n        if (fromUserGesture === void 0) { fromUserGesture = false; }\r\n        if (!this.openerService) {\r\n            return;\r\n        }\r\n        var link = occurrence.link;\r\n        link.resolve(CancellationToken.None).then(function (uri) {\r\n            // open the uri\r\n            return _this.openerService.open(uri, { openToSide: openToSide, fromUserGesture: fromUserGesture });\r\n        }, function (err) {\r\n            var messageOrError = err instanceof Error ? err.message : err;\r\n            // different error cases\r\n            if (messageOrError === 'invalid') {\r\n                _this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\r\n            }\r\n            else if (messageOrError === 'missing') {\r\n                _this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\r\n            }\r\n            else {\r\n                onUnexpectedError(err);\r\n            }\r\n        });\r\n    };\r\n    LinkDetector.prototype.getLinkOccurrence = function (position) {\r\n        if (!this.editor.hasModel() || !position) {\r\n            return null;\r\n        }\r\n        var decorations = this.editor.getModel().getDecorationsInRange({\r\n            startLineNumber: position.lineNumber,\r\n            startColumn: position.column,\r\n            endLineNumber: position.lineNumber,\r\n            endColumn: position.column\r\n        }, 0, true);\r\n        for (var _i = 0, decorations_1 = decorations; _i < decorations_1.length; _i++) {\r\n            var decoration_1 = decorations_1[_i];\r\n            var currentOccurrence = this.currentOccurrences[decoration_1.id];\r\n            if (currentOccurrence) {\r\n                return currentOccurrence;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    LinkDetector.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return Boolean((mouseEvent.target.type === 6 /* CONTENT_TEXT */)\r\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\r\n    };\r\n    LinkDetector.prototype.stop = function () {\r\n        this.timeout.cancel();\r\n        if (this.activeLinksList) {\r\n            this.activeLinksList.dispose();\r\n        }\r\n        if (this.computePromise) {\r\n            this.computePromise.cancel();\r\n            this.computePromise = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.dispose = function () {\r\n        this.listenersToRemove.dispose();\r\n        this.stop();\r\n        this.timeout.dispose();\r\n    };\r\n    LinkDetector.ID = 'editor.linkDetector';\r\n    LinkDetector.RECOMPUTE_TIME = 1000; // ms\r\n    LinkDetector = __decorate([\r\n        __param(1, IOpenerService),\r\n        __param(2, INotificationService)\r\n    ], LinkDetector);\r\n    return LinkDetector;\r\n}());\r\nvar OpenLinkAction = /** @class */ (function (_super) {\r\n    __extends(OpenLinkAction, _super);\r\n    function OpenLinkAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.openLink',\r\n            label: nls.localize('label', \"Open Link\"),\r\n            alias: 'Open Link',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    OpenLinkAction.prototype.run = function (accessor, editor) {\r\n        var linkDetector = LinkDetector.get(editor);\r\n        if (!linkDetector) {\r\n            return;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var sel = selections_1[_i];\r\n            var link = linkDetector.getLinkOccurrence(sel.getEndPosition());\r\n            if (link) {\r\n                linkDetector.openLinkOccurrence(link, false);\r\n            }\r\n        }\r\n    };\r\n    return OpenLinkAction;\r\n}(EditorAction));\r\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\r\nregisterEditorAction(OpenLinkAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .detected-link-active { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CursorMoveCommands } from '../../common/controller/cursorMoveCommands.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { CommonFindController } from '../find/findController.js';\r\nimport { overviewRulerSelectionHighlightForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nvar InsertCursorAbove = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAbove, _super);\r\n    function InsertCursorAbove() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAbove',\r\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\r\n            alias: 'Add Cursor Above',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAbove.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorUp(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 1 /* TopMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorAbove;\r\n}(EditorAction));\r\nexport { InsertCursorAbove };\r\nvar InsertCursorBelow = /** @class */ (function (_super) {\r\n    __extends(InsertCursorBelow, _super);\r\n    function InsertCursorBelow() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorBelow',\r\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\r\n            alias: 'Add Cursor Below',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorBelow.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorDown(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 2 /* BottomMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorBelow;\r\n}(EditorAction));\r\nexport { InsertCursorBelow };\r\nvar InsertCursorAtEndOfEachLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfEachLineSelected, _super);\r\n    function InsertCursorAtEndOfEachLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\r\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\r\n            alias: 'Add Cursors to Line Ends',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 39 /* KEY_I */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfEachLineSelected.prototype.getCursorsForSelection = function (selection, model, result) {\r\n        if (selection.isEmpty()) {\r\n            return;\r\n        }\r\n        for (var i = selection.startLineNumber; i < selection.endLineNumber; i++) {\r\n            var currentLineMaxColumn = model.getLineMaxColumn(i);\r\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\r\n        }\r\n        if (selection.endColumn > 1) {\r\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\r\n        }\r\n    };\r\n    InsertCursorAtEndOfEachLineSelected.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        selections.forEach(function (sel) { return _this.getCursorsForSelection(sel, model, newSelections); });\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfEachLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtEndOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfLineSelected, _super);\r\n    function InsertCursorAtEndOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToBottom',\r\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\r\n            alias: 'Add Cursors To Bottom',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var lineCount = editor.getModel().getLineCount();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i <= lineCount; i++) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtTopOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtTopOfLineSelected, _super);\r\n    function InsertCursorAtTopOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToTop',\r\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\r\n            alias: 'Add Cursors To Top',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtTopOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i >= 1; i--) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtTopOfLineSelected;\r\n}(EditorAction));\r\nvar MultiCursorSessionResult = /** @class */ (function () {\r\n    function MultiCursorSessionResult(selections, revealRange, revealScrollType) {\r\n        this.selections = selections;\r\n        this.revealRange = revealRange;\r\n        this.revealScrollType = revealScrollType;\r\n    }\r\n    return MultiCursorSessionResult;\r\n}());\r\nexport { MultiCursorSessionResult };\r\nvar MultiCursorSession = /** @class */ (function () {\r\n    function MultiCursorSession(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\r\n        this._editor = _editor;\r\n        this.findController = findController;\r\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\r\n        this.searchText = searchText;\r\n        this.wholeWord = wholeWord;\r\n        this.matchCase = matchCase;\r\n        this.currentMatch = currentMatch;\r\n    }\r\n    MultiCursorSession.create = function (editor, findController) {\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var findState = findController.getState();\r\n        // Find widget owns entirely what we search for if:\r\n        //  - focus is not in the editor (i.e. it is in the find widget)\r\n        //  - and the search widget is visible\r\n        //  - and the search string is non-empty\r\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\r\n            // Find widget owns what is searched for\r\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\r\n        }\r\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\r\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\r\n        var isDisconnectedFromFindController = false;\r\n        var wholeWord;\r\n        var matchCase;\r\n        var selections = editor.getSelections();\r\n        if (selections.length === 1 && selections[0].isEmpty()) {\r\n            isDisconnectedFromFindController = true;\r\n            wholeWord = true;\r\n            matchCase = true;\r\n        }\r\n        else {\r\n            wholeWord = findState.wholeWord;\r\n            matchCase = findState.matchCase;\r\n        }\r\n        // Selection owns what is searched for\r\n        var s = editor.getSelection();\r\n        var searchText;\r\n        var currentMatch = null;\r\n        if (s.isEmpty()) {\r\n            // selection is empty => expand to current word\r\n            var word = editor.getModel().getWordAtPosition(s.getStartPosition());\r\n            if (!word) {\r\n                return null;\r\n            }\r\n            searchText = word.word;\r\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\r\n        }\r\n        else {\r\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\r\n        }\r\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getNextMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getPreviousMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.selectAll = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        return this._editor.getModel().findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n    };\r\n    return MultiCursorSession;\r\n}());\r\nexport { MultiCursorSession };\r\nvar MultiCursorSelectionController = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionController, _super);\r\n    function MultiCursorSelectionController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._sessionDispose = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._ignoreSelectionChange = false;\r\n        _this._session = null;\r\n        return _this;\r\n    }\r\n    MultiCursorSelectionController.get = function (editor) {\r\n        return editor.getContribution(MultiCursorSelectionController.ID);\r\n    };\r\n    MultiCursorSelectionController.prototype.dispose = function () {\r\n        this._endSession();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MultiCursorSelectionController.prototype._beginSessionIfNeeded = function (findController) {\r\n        var _this = this;\r\n        if (!this._session) {\r\n            // Create a new session\r\n            var session = MultiCursorSession.create(this._editor, findController);\r\n            if (!session) {\r\n                return;\r\n            }\r\n            this._session = session;\r\n            var newState = { searchString: this._session.searchText };\r\n            if (this._session.isDisconnectedFromFindController) {\r\n                newState.wholeWordOverride = 1 /* True */;\r\n                newState.matchCaseOverride = 1 /* True */;\r\n                newState.isRegexOverride = 2 /* False */;\r\n            }\r\n            findController.getState().change(newState, false);\r\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection(function (e) {\r\n                if (_this._ignoreSelectionChange) {\r\n                    return;\r\n                }\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(function () {\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange(function (e) {\r\n                if (e.matchCase || e.wholeWord) {\r\n                    _this._endSession();\r\n                }\r\n            }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype._endSession = function () {\r\n        this._sessionDispose.clear();\r\n        if (this._session && this._session.isDisconnectedFromFindController) {\r\n            var newState = {\r\n                wholeWordOverride: 0 /* NotSet */,\r\n                matchCaseOverride: 0 /* NotSet */,\r\n                isRegexOverride: 0 /* NotSet */,\r\n            };\r\n            this._session.findController.getState().change(newState, false);\r\n        }\r\n        this._session = null;\r\n    };\r\n    MultiCursorSelectionController.prototype._setSelections = function (selections) {\r\n        this._ignoreSelectionChange = true;\r\n        this._editor.setSelections(selections);\r\n        this._ignoreSelectionChange = false;\r\n    };\r\n    MultiCursorSelectionController.prototype._expandEmptyToWord = function (model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var word = model.getWordAtPosition(selection.getStartPosition());\r\n        if (!word) {\r\n            return selection;\r\n        }\r\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n    };\r\n    MultiCursorSelectionController.prototype._applySessionResult = function (result) {\r\n        if (!result) {\r\n            return;\r\n        }\r\n        this._setSelections(result.selections);\r\n        if (result.revealRange) {\r\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.getSession = function (findController) {\r\n        return this._session;\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToNextFindMatch = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._session) {\r\n            // If there are multiple cursors, handle the case where they do not all select the same text.\r\n            var allSelections = this._editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState = findController.getState();\r\n                var matchCase = findState.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    var model = this._editor.getModel();\r\n                    var resultingSelections = [];\r\n                    for (var i = 0, len = allSelections.length; i < len; i++) {\r\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\r\n                    }\r\n                    this._editor.setSelections(resultingSelections);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToNextFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.selectAll = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var matches = null;\r\n        var findState = findController.getState();\r\n        // Special case: find widget owns entirely what we search for if:\r\n        // - focus is not in the editor (i.e. it is in the find widget)\r\n        // - and the search widget is visible\r\n        // - and the search string is non-empty\r\n        // - and we're searching for a regex\r\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\r\n            matches = this._editor.getModel().findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        }\r\n        else {\r\n            this._beginSessionIfNeeded(findController);\r\n            if (!this._session) {\r\n                return;\r\n            }\r\n            matches = this._session.selectAll();\r\n        }\r\n        if (findState.searchScope) {\r\n            var state = findState.searchScope;\r\n            var inSelection = [];\r\n            for (var i = 0; i < matches.length; i++) {\r\n                if (matches[i].range.endLineNumber <= state.endLineNumber && matches[i].range.startLineNumber >= state.startLineNumber) {\r\n                    inSelection.push(matches[i]);\r\n                }\r\n            }\r\n            matches = inSelection;\r\n        }\r\n        if (matches.length > 0) {\r\n            var editorSelection = this._editor.getSelection();\r\n            // Have the primary cursor remain the one where the action was invoked\r\n            for (var i = 0, len = matches.length; i < len; i++) {\r\n                var match = matches[i];\r\n                var intersection = match.range.intersectRanges(editorSelection);\r\n                if (intersection) {\r\n                    // bingo!\r\n                    matches[i] = matches[0];\r\n                    matches[0] = match;\r\n                    break;\r\n                }\r\n            }\r\n            this._setSelections(matches.map(function (m) { return new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn); }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\r\n    return MultiCursorSelectionController;\r\n}(Disposable));\r\nexport { MultiCursorSelectionController };\r\nvar MultiCursorSelectionControllerAction = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionControllerAction, _super);\r\n    function MultiCursorSelectionControllerAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MultiCursorSelectionControllerAction.prototype.run = function (accessor, editor) {\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return;\r\n        }\r\n        this._run(multiCursorController, findController);\r\n    };\r\n    return MultiCursorSelectionControllerAction;\r\n}(EditorAction));\r\nexport { MultiCursorSelectionControllerAction };\r\nvar AddSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToNextFindMatchAction, _super);\r\n    function AddSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToNextFindMatch',\r\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\r\n            alias: 'Add Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 34 /* KEY_D */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToNextFindMatch(findController);\r\n    };\r\n    return AddSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToNextFindMatchAction };\r\nvar AddSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToPreviousFindMatchAction, _super);\r\n    function AddSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToPreviousFindMatch',\r\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\r\n            alias: 'Add Selection To Previous Find Match',\r\n            precondition: undefined,\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return AddSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToPreviousFindMatchAction };\r\nvar MoveSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToNextFindMatchAction, _super);\r\n    function MoveSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToNextFindMatch',\r\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\r\n            alias: 'Move Last Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 34 /* KEY_D */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    MoveSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToNextFindMatch(findController);\r\n    };\r\n    return MoveSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToNextFindMatchAction };\r\nvar MoveSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToPreviousFindMatchAction, _super);\r\n    function MoveSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\r\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\r\n            alias: 'Move Last Selection To Previous Find Match',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    MoveSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return MoveSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToPreviousFindMatchAction };\r\nvar SelectHighlightsAction = /** @class */ (function (_super) {\r\n    __extends(SelectHighlightsAction, _super);\r\n    function SelectHighlightsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.selectHighlights',\r\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\r\n            alias: 'Select All Occurrences of Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 42 /* KEY_L */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\r\n                order: 7\r\n            }\r\n        }) || this;\r\n    }\r\n    SelectHighlightsAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return SelectHighlightsAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { SelectHighlightsAction };\r\nvar CompatChangeAll = /** @class */ (function (_super) {\r\n    __extends(CompatChangeAll, _super);\r\n    function CompatChangeAll() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.changeAll',\r\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\r\n            alias: 'Change All Occurrences',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.2\r\n            }\r\n        }) || this;\r\n    }\r\n    CompatChangeAll.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return CompatChangeAll;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { CompatChangeAll };\r\nvar SelectionHighlighterState = /** @class */ (function () {\r\n    function SelectionHighlighterState(searchText, matchCase, wordSeparators) {\r\n        this.searchText = searchText;\r\n        this.matchCase = matchCase;\r\n        this.wordSeparators = wordSeparators;\r\n    }\r\n    /**\r\n     * Everything equals except for `lastWordUnderCursor`\r\n     */\r\n    SelectionHighlighterState.softEquals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.searchText === b.searchText\r\n            && a.matchCase === b.matchCase\r\n            && a.wordSeparators === b.wordSeparators);\r\n    };\r\n    return SelectionHighlighterState;\r\n}());\r\nvar SelectionHighlighter = /** @class */ (function (_super) {\r\n    __extends(SelectionHighlighter, _super);\r\n    function SelectionHighlighter(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this._isEnabled = editor.getOption(82 /* selectionHighlight */);\r\n        _this.decorations = [];\r\n        _this.updateSoon = _this._register(new RunOnceScheduler(function () { return _this._update(); }, 300));\r\n        _this.state = null;\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            _this._isEnabled = editor.getOption(82 /* selectionHighlight */);\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (!_this._isEnabled) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            if (e.selection.isEmpty()) {\r\n                if (e.reason === 3 /* Explicit */) {\r\n                    if (_this.state) {\r\n                        // no longer valid\r\n                        _this._setState(null);\r\n                    }\r\n                    _this.updateSoon.schedule();\r\n                }\r\n                else {\r\n                    _this._setState(null);\r\n                }\r\n            }\r\n            else {\r\n                _this._update();\r\n            }\r\n        }));\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._setState(null);\r\n        }));\r\n        _this._register(CommonFindController.get(editor).getState().onFindReplaceStateChange(function (e) {\r\n            _this._update();\r\n        }));\r\n        return _this;\r\n    }\r\n    SelectionHighlighter.prototype._update = function () {\r\n        this._setState(SelectionHighlighter._createState(this._isEnabled, this.editor));\r\n    };\r\n    SelectionHighlighter._createState = function (isEnabled, editor) {\r\n        if (!isEnabled) {\r\n            return null;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var s = editor.getSelection();\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            // multiline forbidden for perf reasons\r\n            return null;\r\n        }\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return null;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return null;\r\n        }\r\n        var r = multiCursorController.getSession(findController);\r\n        if (!r) {\r\n            var allSelections = editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState_1 = findController.getState();\r\n                var matchCase = findState_1.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    return null;\r\n                }\r\n            }\r\n            r = MultiCursorSession.create(editor, findController);\r\n        }\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        if (r.currentMatch) {\r\n            // This is an empty selection\r\n            // Do not interfere with semantic word highlighting in the no selection case\r\n            return null;\r\n        }\r\n        if (/^[ \\t]+$/.test(r.searchText)) {\r\n            // whitespace only selection\r\n            return null;\r\n        }\r\n        if (r.searchText.length > 200) {\r\n            // very long selection\r\n            return null;\r\n        }\r\n        // TODO: better handling of this case\r\n        var findState = findController.getState();\r\n        var caseSensitive = findState.matchCase;\r\n        // Return early if the find widget shows the exact same matches\r\n        if (findState.isRevealed) {\r\n            var findStateSearchString = findState.searchString;\r\n            if (!caseSensitive) {\r\n                findStateSearchString = findStateSearchString.toLowerCase();\r\n            }\r\n            var mySearchString = r.searchText;\r\n            if (!caseSensitive) {\r\n                mySearchString = mySearchString.toLowerCase();\r\n            }\r\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\r\n                return null;\r\n            }\r\n        }\r\n        return new SelectionHighlighterState(r.searchText, r.matchCase, r.wholeWord ? editor.getOption(96 /* wordSeparators */) : null);\r\n    };\r\n    SelectionHighlighter.prototype._setState = function (state) {\r\n        if (SelectionHighlighterState.softEquals(this.state, state)) {\r\n            this.state = state;\r\n            return;\r\n        }\r\n        this.state = state;\r\n        if (!this.state) {\r\n            this.decorations = this.editor.deltaDecorations(this.decorations, []);\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this.editor.getModel();\r\n        if (model.isTooLargeForTokenization()) {\r\n            // the file is too large, so searching word under cursor in the whole document takes is blocking the UI.\r\n            return;\r\n        }\r\n        var hasFindOccurrences = DocumentHighlightProviderRegistry.has(model);\r\n        var allMatches = model.findMatches(this.state.searchText, true, false, this.state.matchCase, this.state.wordSeparators, false).map(function (m) { return m.range; });\r\n        allMatches.sort(Range.compareRangesUsingStarts);\r\n        var selections = this.editor.getSelections();\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        // do not overlap with selection (issue #64 and #512)\r\n        var matches = [];\r\n        for (var i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\r\n            var match = allMatches[i];\r\n            if (j >= lenJ) {\r\n                // finished all editor selections\r\n                matches.push(match);\r\n                i++;\r\n            }\r\n            else {\r\n                var cmp = Range.compareRangesUsingStarts(match, selections[j]);\r\n                if (cmp < 0) {\r\n                    // match is before sel\r\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\r\n                        matches.push(match);\r\n                    }\r\n                    i++;\r\n                }\r\n                else if (cmp > 0) {\r\n                    // sel is before match\r\n                    j++;\r\n                }\r\n                else {\r\n                    // sel is equal to match\r\n                    i++;\r\n                    j++;\r\n                }\r\n            }\r\n        }\r\n        var decorations = matches.map(function (r) {\r\n            return {\r\n                range: r,\r\n                // Show in overviewRuler only if model has no semantic highlighting\r\n                options: (hasFindOccurrences ? SelectionHighlighter._SELECTION_HIGHLIGHT : SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW)\r\n            };\r\n        });\r\n        this.decorations = this.editor.deltaDecorations(this.decorations, decorations);\r\n    };\r\n    SelectionHighlighter.prototype.dispose = function () {\r\n        this._setState(null);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    SelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n    });\r\n    return SelectionHighlighter;\r\n}(Disposable));\r\nexport { SelectionHighlighter };\r\nfunction modelRangesContainSameText(model, ranges, matchCase) {\r\n    var selectedText = getValueInRange(model, ranges[0], !matchCase);\r\n    for (var i = 1, len = ranges.length; i < len; i++) {\r\n        var range = ranges[i];\r\n        if (range.isEmpty()) {\r\n            return false;\r\n        }\r\n        var thisSelectedText = getValueInRange(model, range, !matchCase);\r\n        if (selectedText !== thisSelectedText) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction getValueInRange(model, range, toLowerCase) {\r\n    var text = model.getValueInRange(range);\r\n    return (toLowerCase ? text.toLowerCase() : text);\r\n}\r\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController);\r\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter);\r\nregisterEditorAction(InsertCursorAbove);\r\nregisterEditorAction(InsertCursorBelow);\r\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\r\nregisterEditorAction(AddSelectionToNextFindMatchAction);\r\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\r\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(SelectHighlightsAction);\r\nregisterEditorAction(CompatChangeAll);\r\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\r\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { first } from '../../../base/common/async.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nexport var Context = {\r\n    Visible: new RawContextKey('parameterHintsVisible', false),\r\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\r\n};\r\nexport function provideSignatureHelp(model, position, context, token) {\r\n    var supports = modes.SignatureHelpProviderRegistry.ordered(model);\r\n    return first(supports.map(function (support) { return function () {\r\n        return Promise.resolve(support.provideSignatureHelp(model, position, token, context))\r\n            .catch(function (e) { return onUnexpectedExternalError(e); });\r\n    }; }));\r\n}\r\nregisterDefaultLanguageCommand('_executeSignatureHelpProvider', function (model, position, args) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4 /*yield*/, provideSignatureHelp(model, position, {\r\n                    triggerKind: modes.SignatureHelpTriggerKind.Invoke,\r\n                    isRetrigger: false,\r\n                    triggerCharacter: args['triggerCharacter']\r\n                }, CancellationToken.None)];\r\n            case 1:\r\n                result = _a.sent();\r\n                if (!result) {\r\n                    return [2 /*return*/, undefined];\r\n                }\r\n                setTimeout(function () { return result.dispose(); }, 0);\r\n                return [2 /*return*/, result.value];\r\n        }\r\n    });\r\n}); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { createCancelablePromise, Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\r\nvar ParameterHintState;\r\n(function (ParameterHintState) {\r\n    ParameterHintState.Default = { type: 0 /* Default */ };\r\n    var Pending = /** @class */ (function () {\r\n        function Pending(request) {\r\n            this.request = request;\r\n            this.type = 2 /* Pending */;\r\n        }\r\n        return Pending;\r\n    }());\r\n    ParameterHintState.Pending = Pending;\r\n    var Active = /** @class */ (function () {\r\n        function Active(hints) {\r\n            this.hints = hints;\r\n            this.type = 1 /* Active */;\r\n        }\r\n        return Active;\r\n    }());\r\n    ParameterHintState.Active = Active;\r\n})(ParameterHintState || (ParameterHintState = {}));\r\nvar ParameterHintsModel = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsModel, _super);\r\n    function ParameterHintsModel(editor, delay) {\r\n        if (delay === void 0) { delay = ParameterHintsModel.DEFAULT_DELAY; }\r\n        var _this = _super.call(this) || this;\r\n        _this._onChangedHints = _this._register(new Emitter());\r\n        _this.onChangedHints = _this._onChangedHints.event;\r\n        _this.triggerOnType = false;\r\n        _this._state = ParameterHintState.Default;\r\n        _this._pendingTriggers = [];\r\n        _this._lastSignatureHelpResult = _this._register(new MutableDisposable());\r\n        _this.triggerChars = new CharacterSet();\r\n        _this.retriggerChars = new CharacterSet();\r\n        _this.triggerId = 0;\r\n        _this.editor = editor;\r\n        _this.throttledDelayer = new Delayer(delay);\r\n        _this._register(_this.editor.onDidChangeConfiguration(function () { return _this.onEditorConfigurationChange(); }));\r\n        _this._register(_this.editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeModelLanguage(function (_) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeCursorSelection(function (e) { return _this.onCursorChange(e); }));\r\n        _this._register(_this.editor.onDidChangeModelContent(function (e) { return _this.onModelContentChange(); }));\r\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(_this.onModelChanged, _this));\r\n        _this._register(_this.editor.onDidType(function (text) { return _this.onDidType(text); }));\r\n        _this.onEditorConfigurationChange();\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (value) {\r\n            if (this._state.type === 2 /* Pending */) {\r\n                this._state.request.cancel();\r\n            }\r\n            this._state = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.cancel = function (silent) {\r\n        if (silent === void 0) { silent = false; }\r\n        this.state = ParameterHintState.Default;\r\n        this.throttledDelayer.cancel();\r\n        if (!silent) {\r\n            this._onChangedHints.fire(undefined);\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.trigger = function (context, delay) {\r\n        var _this = this;\r\n        var model = this.editor.getModel();\r\n        if (!model || !modes.SignatureHelpProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        var triggerId = ++this.triggerId;\r\n        this._pendingTriggers.push(context);\r\n        this.throttledDelayer.trigger(function () {\r\n            return _this.doTrigger(triggerId);\r\n        }, delay)\r\n            .catch(onUnexpectedError);\r\n    };\r\n    ParameterHintsModel.prototype.next = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var last = (activeSignature % length) === (length - 1);\r\n        var cycle = this.editor.getOption(64 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on last signature of list\r\n        if ((length < 2 || last) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\r\n    };\r\n    ParameterHintsModel.prototype.previous = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var first = activeSignature === 0;\r\n        var cycle = this.editor.getOption(64 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on first signature of list\r\n        if ((length < 2 || first) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\r\n    };\r\n    ParameterHintsModel.prototype.updateActiveSignature = function (activeSignature) {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        this.state = new ParameterHintState.Active(__assign(__assign({}, this.state.hints), { activeSignature: activeSignature }));\r\n        this._onChangedHints.fire(this.state.hints);\r\n    };\r\n    ParameterHintsModel.prototype.doTrigger = function (triggerId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var isRetrigger, activeSignatureHelp, context, triggerContext, model, position, result, error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        isRetrigger = this.state.type === 1 /* Active */ || this.state.type === 2 /* Pending */;\r\n                        activeSignatureHelp = this.state.type === 1 /* Active */ ? this.state.hints : undefined;\r\n                        this.cancel(true);\r\n                        if (this._pendingTriggers.length === 0) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        context = this._pendingTriggers.reduce(mergeTriggerContexts);\r\n                        this._pendingTriggers = [];\r\n                        triggerContext = {\r\n                            triggerKind: context.triggerKind,\r\n                            triggerCharacter: context.triggerCharacter,\r\n                            isRetrigger: isRetrigger,\r\n                            activeSignatureHelp: activeSignatureHelp\r\n                        };\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        position = this.editor.getPosition();\r\n                        this.state = new ParameterHintState.Pending(createCancelablePromise(function (token) {\r\n                            return provideSignatureHelp(model, position, triggerContext, token);\r\n                        }));\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.state.request];\r\n                    case 2:\r\n                        result = _a.sent();\r\n                        // Check that we are still resolving the correct signature help\r\n                        if (triggerId !== this.triggerId) {\r\n                            result === null || result === void 0 ? void 0 : result.dispose();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        if (!result || !result.value.signatures || result.value.signatures.length === 0) {\r\n                            result === null || result === void 0 ? void 0 : result.dispose();\r\n                            this._lastSignatureHelpResult.clear();\r\n                            this.cancel();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        else {\r\n                            this.state = new ParameterHintState.Active(result.value);\r\n                            this._lastSignatureHelpResult.value = result;\r\n                            this._onChangedHints.fire(this.state.hints);\r\n                            return [2 /*return*/, true];\r\n                        }\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        error_1 = _a.sent();\r\n                        if (triggerId === this.triggerId) {\r\n                            this.state = ParameterHintState.Default;\r\n                        }\r\n                        onUnexpectedError(error_1);\r\n                        return [2 /*return*/, false];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"isTriggered\", {\r\n        get: function () {\r\n            return this.state.type === 1 /* Active */\r\n                || this.state.type === 2 /* Pending */\r\n                || this.throttledDelayer.isTriggered();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.onModelChanged = function () {\r\n        this.cancel();\r\n        // Update trigger characters\r\n        this.triggerChars = new CharacterSet();\r\n        this.retriggerChars = new CharacterSet();\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = modes.SignatureHelpProviderRegistry.ordered(model); _i < _a.length; _i++) {\r\n            var support = _a[_i];\r\n            for (var _b = 0, _c = support.signatureHelpTriggerCharacters || []; _b < _c.length; _b++) {\r\n                var ch = _c[_b];\r\n                this.triggerChars.add(ch.charCodeAt(0));\r\n                // All trigger characters are also considered retrigger characters\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n            for (var _d = 0, _e = support.signatureHelpRetriggerCharacters || []; _d < _e.length; _d++) {\r\n                var ch = _e[_d];\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onDidType = function (text) {\r\n        if (!this.triggerOnType) {\r\n            return;\r\n        }\r\n        var lastCharIndex = text.length - 1;\r\n        var triggerCharCode = text.charCodeAt(lastCharIndex);\r\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\r\n            this.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.TriggerCharacter,\r\n                triggerCharacter: text.charAt(lastCharIndex),\r\n            });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onCursorChange = function (e) {\r\n        if (e.source === 'mouse') {\r\n            this.cancel();\r\n        }\r\n        else if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onModelContentChange = function () {\r\n        if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onEditorConfigurationChange = function () {\r\n        this.triggerOnType = this.editor.getOption(64 /* parameterHints */).enabled;\r\n        if (!this.triggerOnType) {\r\n            this.cancel();\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.dispose = function () {\r\n        this.cancel(true);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ParameterHintsModel.DEFAULT_DELAY = 120; // ms\r\n    return ParameterHintsModel;\r\n}(Disposable));\r\nexport { ParameterHintsModel };\r\nfunction mergeTriggerContexts(previous, current) {\r\n    switch (current.triggerKind) {\r\n        case modes.SignatureHelpTriggerKind.Invoke:\r\n            // Invoke overrides previous triggers.\r\n            return current;\r\n        case modes.SignatureHelpTriggerKind.ContentChange:\r\n            // Ignore content changes triggers\r\n            return previous;\r\n        case modes.SignatureHelpTriggerKind.TriggerCharacter:\r\n        default:\r\n            return current;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { domEvent, stop } from '../../../base/browser/event.js';\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport './parameterHints.css';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, textCodeBlockBackground, textLinkForeground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { HIGH_CONTRAST, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ParameterHintsModel } from './parameterHintsModel.js';\r\nimport { pad } from '../../../base/common/strings.js';\r\nvar $ = dom.$;\r\nvar ParameterHintsWidget = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsWidget, _super);\r\n    function ParameterHintsWidget(editor, contextKeyService, openerService, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.renderDisposeables = _this._register(new DisposableStore());\r\n        _this.visible = false;\r\n        _this.announcedLabel = null;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this.markdownRenderer = _this._register(new MarkdownRenderer(editor, modeService, openerService));\r\n        _this.model = _this._register(new ParameterHintsModel(editor));\r\n        _this.keyVisible = Context.Visible.bindTo(contextKeyService);\r\n        _this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\r\n        _this._register(_this.model.onChangedHints(function (newParameterHints) {\r\n            if (newParameterHints) {\r\n                _this.show();\r\n                _this.render(newParameterHints);\r\n            }\r\n            else {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ParameterHintsWidget.prototype.createParamaterHintDOMNodes = function () {\r\n        var _this = this;\r\n        var element = $('.editor-widget.parameter-hints-widget');\r\n        var wrapper = dom.append(element, $('.wrapper'));\r\n        wrapper.tabIndex = -1;\r\n        var controls = dom.append(wrapper, $('.controls'));\r\n        var previous = dom.append(controls, $('.button.codicon.codicon-chevron-up'));\r\n        var overloads = dom.append(controls, $('.overloads'));\r\n        var next = dom.append(controls, $('.button.codicon.codicon-chevron-down'));\r\n        var onPreviousClick = stop(domEvent(previous, 'click'));\r\n        this._register(onPreviousClick(this.previous, this));\r\n        var onNextClick = stop(domEvent(next, 'click'));\r\n        this._register(onNextClick(this.next, this));\r\n        var body = $('.body');\r\n        var scrollbar = new DomScrollableElement(body, {});\r\n        this._register(scrollbar);\r\n        wrapper.appendChild(scrollbar.getDomNode());\r\n        var signature = dom.append(body, $('.signature'));\r\n        var docs = dom.append(body, $('.docs'));\r\n        element.style.userSelect = 'text';\r\n        this.domNodes = {\r\n            element: element,\r\n            signature: signature,\r\n            overloads: overloads,\r\n            docs: docs,\r\n            scrollbar: scrollbar,\r\n        };\r\n        this.editor.addContentWidget(this);\r\n        this.hide();\r\n        this._register(this.editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this.visible) {\r\n                _this.editor.layoutContentWidget(_this);\r\n            }\r\n        }));\r\n        var updateFont = function () {\r\n            if (!_this.domNodes) {\r\n                return;\r\n            }\r\n            var fontInfo = _this.editor.getOption(34 /* fontInfo */);\r\n            _this.domNodes.element.style.fontSize = fontInfo.fontSize + \"px\";\r\n        };\r\n        updateFont();\r\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(34 /* fontInfo */); })\r\n            .on(updateFont, null));\r\n        this._register(this.editor.onDidLayoutChange(function (e) { return _this.updateMaxHeight(); }));\r\n        this.updateMaxHeight();\r\n    };\r\n    ParameterHintsWidget.prototype.show = function () {\r\n        var _this = this;\r\n        if (this.visible) {\r\n            return;\r\n        }\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        this.keyVisible.set(true);\r\n        this.visible = true;\r\n        setTimeout(function () {\r\n            if (_this.domNodes) {\r\n                dom.addClass(_this.domNodes.element, 'visible');\r\n            }\r\n        }, 100);\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.hide = function () {\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n        this.keyVisible.reset();\r\n        this.visible = false;\r\n        this.announcedLabel = null;\r\n        if (this.domNodes) {\r\n            dom.removeClass(this.domNodes.element, 'visible');\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.getPosition = function () {\r\n        if (this.visible) {\r\n            return {\r\n                position: this.editor.getPosition(),\r\n                preference: [1 /* ABOVE */, 2 /* BELOW */]\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    ParameterHintsWidget.prototype.render = function (hints) {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var multiple = hints.signatures.length > 1;\r\n        dom.toggleClass(this.domNodes.element, 'multiple', multiple);\r\n        this.keyMultipleSignatures.set(multiple);\r\n        this.domNodes.signature.innerHTML = '';\r\n        this.domNodes.docs.innerHTML = '';\r\n        var signature = hints.signatures[hints.activeSignature];\r\n        if (!signature) {\r\n            return;\r\n        }\r\n        var code = dom.append(this.domNodes.signature, $('.code'));\r\n        var hasParameters = signature.parameters.length > 0;\r\n        var fontInfo = this.editor.getOption(34 /* fontInfo */);\r\n        code.style.fontSize = fontInfo.fontSize + \"px\";\r\n        code.style.fontFamily = fontInfo.fontFamily;\r\n        if (!hasParameters) {\r\n            var label = dom.append(code, $('span'));\r\n            label.textContent = signature.label;\r\n        }\r\n        else {\r\n            this.renderParameters(code, signature, hints.activeParameter);\r\n        }\r\n        this.renderDisposeables.clear();\r\n        var activeParameter = signature.parameters[hints.activeParameter];\r\n        if (activeParameter && activeParameter.documentation) {\r\n            var documentation = $('span.documentation');\r\n            if (typeof activeParameter.documentation === 'string') {\r\n                documentation.textContent = activeParameter.documentation;\r\n            }\r\n            else {\r\n                var renderedContents = this.markdownRenderer.render(activeParameter.documentation);\r\n                dom.addClass(renderedContents.element, 'markdown-docs');\r\n                this.renderDisposeables.add(renderedContents);\r\n                documentation.appendChild(renderedContents.element);\r\n            }\r\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\r\n        }\r\n        if (signature.documentation === undefined) { /** no op */ }\r\n        else if (typeof signature.documentation === 'string') {\r\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\r\n        }\r\n        else {\r\n            var renderedContents = this.markdownRenderer.render(signature.documentation);\r\n            dom.addClass(renderedContents.element, 'markdown-docs');\r\n            this.renderDisposeables.add(renderedContents);\r\n            dom.append(this.domNodes.docs, renderedContents.element);\r\n        }\r\n        var hasDocs = this.hasDocs(signature, activeParameter);\r\n        dom.toggleClass(this.domNodes.signature, 'has-docs', hasDocs);\r\n        dom.toggleClass(this.domNodes.docs, 'empty', !hasDocs);\r\n        this.domNodes.overloads.textContent =\r\n            pad(hints.activeSignature + 1, hints.signatures.length.toString().length) + '/' + hints.signatures.length;\r\n        if (activeParameter) {\r\n            var labelToAnnounce = this.getParameterLabel(signature, hints.activeParameter);\r\n            // Select method gets called on every user type while parameter hints are visible.\r\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\r\n            if (this.announcedLabel !== labelToAnnounce) {\r\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\r\n                this.announcedLabel = labelToAnnounce;\r\n            }\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n        this.domNodes.scrollbar.scanDomNode();\r\n    };\r\n    ParameterHintsWidget.prototype.hasDocs = function (signature, activeParameter) {\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'string' && activeParameter.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'object' && activeParameter.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'string' && signature.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'object' && signature.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ParameterHintsWidget.prototype.renderParameters = function (parent, signature, currentParameter) {\r\n        var _a = this.getParameterLabelOffsets(signature, currentParameter), start = _a[0], end = _a[1];\r\n        var beforeSpan = document.createElement('span');\r\n        beforeSpan.textContent = signature.label.substring(0, start);\r\n        var paramSpan = document.createElement('span');\r\n        paramSpan.textContent = signature.label.substring(start, end);\r\n        paramSpan.className = 'parameter active';\r\n        var afterSpan = document.createElement('span');\r\n        afterSpan.textContent = signature.label.substring(end);\r\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabel = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (typeof param.label === 'string') {\r\n            return param.label;\r\n        }\r\n        else {\r\n            return signature.label.substring(param.label[0], param.label[1]);\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabelOffsets = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (!param) {\r\n            return [0, 0];\r\n        }\r\n        else if (Array.isArray(param.label)) {\r\n            return param.label;\r\n        }\r\n        else {\r\n            var idx = signature.label.lastIndexOf(param.label);\r\n            return idx >= 0\r\n                ? [idx, idx + param.label.length]\r\n                : [0, 0];\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.next = function () {\r\n        this.editor.focus();\r\n        this.model.next();\r\n    };\r\n    ParameterHintsWidget.prototype.previous = function () {\r\n        this.editor.focus();\r\n        this.model.previous();\r\n    };\r\n    ParameterHintsWidget.prototype.cancel = function () {\r\n        this.model.cancel();\r\n    };\r\n    ParameterHintsWidget.prototype.getDomNode = function () {\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        return this.domNodes.element;\r\n    };\r\n    ParameterHintsWidget.prototype.getId = function () {\r\n        return ParameterHintsWidget.ID;\r\n    };\r\n    ParameterHintsWidget.prototype.trigger = function (context) {\r\n        this.model.trigger(context, 0);\r\n    };\r\n    ParameterHintsWidget.prototype.updateMaxHeight = function () {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\r\n        var maxHeight = height + \"px\";\r\n        this.domNodes.element.style.maxHeight = maxHeight;\r\n        var wrapper = this.domNodes.element.getElementsByClassName('wrapper');\r\n        if (wrapper.length) {\r\n            wrapper[0].style.maxHeight = maxHeight;\r\n        }\r\n    };\r\n    ParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\r\n    ParameterHintsWidget = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IOpenerService),\r\n        __param(3, IModeService)\r\n    ], ParameterHintsWidget);\r\n    return ParameterHintsWidget;\r\n}(Disposable));\r\nexport { ParameterHintsWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n    }\r\n    var background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { background-color: \" + background + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget a { color: \" + link + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as modes from '../../common/modes.js';\r\nvar ParameterHintsController = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsController, _super);\r\n    function ParameterHintsController(editor, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.widget = _this._register(instantiationService.createInstance(ParameterHintsWidget, _this.editor));\r\n        return _this;\r\n    }\r\n    ParameterHintsController.get = function (editor) {\r\n        return editor.getContribution(ParameterHintsController.ID);\r\n    };\r\n    ParameterHintsController.prototype.cancel = function () {\r\n        this.widget.cancel();\r\n    };\r\n    ParameterHintsController.prototype.previous = function () {\r\n        this.widget.previous();\r\n    };\r\n    ParameterHintsController.prototype.next = function () {\r\n        this.widget.next();\r\n    };\r\n    ParameterHintsController.prototype.trigger = function (context) {\r\n        this.widget.trigger(context);\r\n    };\r\n    ParameterHintsController.ID = 'editor.controller.parameterHints';\r\n    ParameterHintsController = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], ParameterHintsController);\r\n    return ParameterHintsController;\r\n}(Disposable));\r\nvar TriggerParameterHintsAction = /** @class */ (function (_super) {\r\n    __extends(TriggerParameterHintsAction, _super);\r\n    function TriggerParameterHintsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.triggerParameterHints',\r\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\r\n            alias: 'Trigger Parameter Hints',\r\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 10 /* Space */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerParameterHintsAction.prototype.run = function (accessor, editor) {\r\n        var controller = ParameterHintsController.get(editor);\r\n        if (controller) {\r\n            controller.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.Invoke\r\n            });\r\n        }\r\n    };\r\n    return TriggerParameterHintsAction;\r\n}(EditorAction));\r\nexport { TriggerParameterHintsAction };\r\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController);\r\nregisterEditorAction(TriggerParameterHintsAction);\r\nvar weight = 100 /* EditorContrib */ + 75;\r\nvar ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'closeParameterHints',\r\n    precondition: Context.Visible,\r\n    handler: function (x) { return x.cancel(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showPrevParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.previous(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [512 /* Alt */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showNextParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.next(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [512 /* Alt */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './renameInputField.css';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { inputBackground, inputBorder, inputForeground, widgetShadow, editorWidgetBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { toggleClass } from '../../../base/browser/dom.js';\r\nexport var CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false);\r\nvar RenameInputField = /** @class */ (function () {\r\n    function RenameInputField(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._acceptKeybindings = _acceptKeybindings;\r\n        this._themeService = _themeService;\r\n        this._keybindingService = _keybindingService;\r\n        this._disposables = new DisposableStore();\r\n        this.allowEditorOverflow = true;\r\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\r\n        this._editor.addContentWidget(this);\r\n        this._disposables.add(this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */)) {\r\n                _this._updateFont();\r\n            }\r\n        }));\r\n        this._disposables.add(_themeService.onThemeChange(this._updateStyles, this));\r\n    }\r\n    RenameInputField.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    RenameInputField.prototype.getId = function () {\r\n        return '__renameInputWidget';\r\n    };\r\n    RenameInputField.prototype.getDomNode = function () {\r\n        var _this = this;\r\n        if (!this._domNode) {\r\n            this._domNode = document.createElement('div');\r\n            this._domNode.className = 'monaco-editor rename-box';\r\n            this._input = document.createElement('input');\r\n            this._input.className = 'rename-input';\r\n            this._input.type = 'text';\r\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\r\n            this._domNode.appendChild(this._input);\r\n            this._label = document.createElement('div');\r\n            this._label.className = 'rename-label';\r\n            this._domNode.appendChild(this._label);\r\n            var updateLabel = function () {\r\n                var _a, _b;\r\n                var _c = _this._acceptKeybindings, accept = _c[0], preview = _c[1];\r\n                _this._keybindingService.lookupKeybinding(accept);\r\n                _this._label.innerText = localize('label', \"{0} to Rename, {1} to Preview\", (_a = _this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = _this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\r\n            };\r\n            updateLabel();\r\n            this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\r\n            this._updateFont();\r\n            this._updateStyles(this._themeService.getTheme());\r\n        }\r\n        return this._domNode;\r\n    };\r\n    RenameInputField.prototype._updateStyles = function (theme) {\r\n        var _a, _b, _c, _d;\r\n        if (!this._input || !this._domNode) {\r\n            return;\r\n        }\r\n        var widgetShadowColor = theme.getColor(widgetShadow);\r\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\r\n        this._domNode.style.boxShadow = widgetShadowColor ? \" 0 2px 8px \" + widgetShadowColor : '';\r\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\r\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\r\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\r\n        var border = theme.getColor(inputBorder);\r\n        this._input.style.borderWidth = border ? '1px' : '0px';\r\n        this._input.style.borderStyle = border ? 'solid' : 'none';\r\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\r\n    };\r\n    RenameInputField.prototype._updateFont = function () {\r\n        if (!this._input || !this._label) {\r\n            return;\r\n        }\r\n        var fontInfo = this._editor.getOption(34 /* fontInfo */);\r\n        this._input.style.fontFamily = fontInfo.fontFamily;\r\n        this._input.style.fontWeight = fontInfo.fontWeight;\r\n        this._input.style.fontSize = fontInfo.fontSize + \"px\";\r\n        this._label.style.fontSize = fontInfo.fontSize * 0.8 + \"px\";\r\n    };\r\n    RenameInputField.prototype.getPosition = function () {\r\n        if (!this._visible) {\r\n            return null;\r\n        }\r\n        return {\r\n            position: this._position,\r\n            preference: [2 /* BELOW */, 1 /* ABOVE */]\r\n        };\r\n    };\r\n    RenameInputField.prototype.acceptInput = function (wantsPreview) {\r\n        if (this._currentAcceptInput) {\r\n            this._currentAcceptInput(wantsPreview);\r\n        }\r\n    };\r\n    RenameInputField.prototype.cancelInput = function (focusEditor) {\r\n        if (this._currentCancelInput) {\r\n            this._currentCancelInput(focusEditor);\r\n        }\r\n    };\r\n    RenameInputField.prototype.getInput = function (where, value, selectionStart, selectionEnd, supportPreview) {\r\n        var _this = this;\r\n        toggleClass(this._domNode, 'preview', supportPreview);\r\n        this._position = new Position(where.startLineNumber, where.startColumn);\r\n        this._input.value = value;\r\n        this._input.setAttribute('selectionStart', selectionStart.toString());\r\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\r\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\r\n        var disposeOnDone = new DisposableStore();\r\n        return new Promise(function (resolve) {\r\n            _this._currentCancelInput = function (focusEditor) {\r\n                _this._currentAcceptInput = undefined;\r\n                _this._currentCancelInput = undefined;\r\n                resolve(focusEditor);\r\n                return true;\r\n            };\r\n            _this._currentAcceptInput = function (wantsPreview) {\r\n                if (_this._input.value.trim().length === 0 || _this._input.value === value) {\r\n                    // empty or whitespace only or not changed\r\n                    _this.cancelInput(true);\r\n                    return;\r\n                }\r\n                _this._currentAcceptInput = undefined;\r\n                _this._currentCancelInput = undefined;\r\n                resolve({\r\n                    newName: _this._input.value,\r\n                    wantsPreview: supportPreview && wantsPreview\r\n                });\r\n            };\r\n            var onCursorChanged = function () {\r\n                var editorPosition = _this._editor.getPosition();\r\n                if (!editorPosition || !Range.containsPosition(where, editorPosition)) {\r\n                    _this.cancelInput(true);\r\n                }\r\n            };\r\n            disposeOnDone.add(_this._editor.onDidChangeCursorSelection(onCursorChanged));\r\n            disposeOnDone.add(_this._editor.onDidBlurEditorWidget(function () { return _this.cancelInput(false); }));\r\n            _this._show();\r\n        }).finally(function () {\r\n            disposeOnDone.dispose();\r\n            _this._hide();\r\n        });\r\n    };\r\n    RenameInputField.prototype._show = function () {\r\n        var _this = this;\r\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* Smooth */);\r\n        this._visible = true;\r\n        this._visibleContextKey.set(true);\r\n        this._editor.layoutContentWidget(this);\r\n        setTimeout(function () {\r\n            _this._input.focus();\r\n            _this._input.setSelectionRange(parseInt(_this._input.getAttribute('selectionStart')), parseInt(_this._input.getAttribute('selectionEnd')));\r\n        }, 100);\r\n    };\r\n    RenameInputField.prototype._hide = function () {\r\n        this._visible = false;\r\n        this._visibleContextKey.reset();\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    RenameInputField = __decorate([\r\n        __param(2, IThemeService),\r\n        __param(3, IKeybindingService),\r\n        __param(4, IContextKeyService)\r\n    ], RenameInputField);\r\n    return RenameInputField;\r\n}());\r\nexport { RenameInputField };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { illegalArgument, onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand, registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { RenameInputField, CONTEXT_RENAME_INPUT_VISIBLE } from './renameInputField.js';\r\nimport { RenameProviderRegistry } from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CancellationToken, CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { IdleValue, raceCancellation } from '../../../base/common/async.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\r\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfigurationService.js';\r\nvar RenameSkeleton = /** @class */ (function () {\r\n    function RenameSkeleton(model, position) {\r\n        this.model = model;\r\n        this.position = position;\r\n        this._providers = RenameProviderRegistry.ordered(model);\r\n    }\r\n    RenameSkeleton.prototype.hasProvider = function () {\r\n        return this._providers.length > 0;\r\n    };\r\n    RenameSkeleton.prototype.resolveRenameLocation = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var firstProvider, res, _a, word;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        firstProvider = this._providers[0];\r\n                        if (!firstProvider) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (!firstProvider.resolveRenameLocation) return [3 /*break*/, 2];\r\n                        _a = withNullAsUndefined;\r\n                        return [4 /*yield*/, firstProvider.resolveRenameLocation(this.model, this.position, token)];\r\n                    case 1:\r\n                        res = _a.apply(void 0, [_b.sent()]);\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!res) {\r\n                            word = this.model.getWordAtPosition(this.position);\r\n                            if (word) {\r\n                                return [2 /*return*/, {\r\n                                        range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\r\n                                        text: word.word\r\n                                    }];\r\n                            }\r\n                        }\r\n                        return [2 /*return*/, res];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameSkeleton.prototype.provideRenameEdits = function (newName, i, rejects, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var provider, result;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        provider = this._providers[i];\r\n                        if (!provider) {\r\n                            return [2 /*return*/, {\r\n                                    edits: [],\r\n                                    rejectReason: rejects.join('\\n')\r\n                                }];\r\n                        }\r\n                        return [4 /*yield*/, provider.provideRenameEdits(this.model, this.position, newName, token)];\r\n                    case 1:\r\n                        result = _a.sent();\r\n                        if (!result) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token)];\r\n                        }\r\n                        else if (result.rejectReason) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token)];\r\n                        }\r\n                        return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return RenameSkeleton;\r\n}());\r\nexport function rename(model, position, newName) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, new RenameSkeleton(model, position).provideRenameEdits(newName, 0, [], CancellationToken.None)];\r\n        });\r\n    });\r\n}\r\n// ---  register actions and commands\r\nvar RenameController = /** @class */ (function () {\r\n    function RenameController(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._instaService = _instaService;\r\n        this._notificationService = _notificationService;\r\n        this._bulkEditService = _bulkEditService;\r\n        this._progressService = _progressService;\r\n        this._logService = _logService;\r\n        this._configService = _configService;\r\n        this._dispoableStore = new DisposableStore();\r\n        this._cts = new CancellationTokenSource();\r\n        this._renameInputField = this._dispoableStore.add(new IdleValue(function () { return _this._dispoableStore.add(_this._instaService.createInstance(RenameInputField, _this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview'])); }));\r\n    }\r\n    RenameController.get = function (editor) {\r\n        return editor.getContribution(RenameController.ID);\r\n    };\r\n    RenameController.prototype.dispose = function () {\r\n        this._dispoableStore.dispose();\r\n        this._cts.dispose(true);\r\n    };\r\n    RenameController.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var position, skeleton, loc, resolveLocationOperation, e_1, selection, selectionStart, selectionEnd, supportPreview, inputFieldResult, renameOperation;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this._cts.dispose(true);\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        position = this.editor.getPosition();\r\n                        skeleton = new RenameSkeleton(this.editor.getModel(), position);\r\n                        if (!skeleton.hasProvider()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* Position */ | 1 /* Value */);\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\r\n                        this._progressService.showWhile(resolveLocationOperation, 250);\r\n                        return [4 /*yield*/, resolveLocationOperation];\r\n                    case 2:\r\n                        loc = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _a.sent();\r\n                        MessageController.get(this.editor).showMessage(e_1 || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\r\n                        return [2 /*return*/, undefined];\r\n                    case 4:\r\n                        if (!loc) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (loc.rejectReason) {\r\n                            MessageController.get(this.editor).showMessage(loc.rejectReason, position);\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (this._cts.token.isCancellationRequested) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selection = this.editor.getSelection();\r\n                        selectionStart = 0;\r\n                        selectionEnd = loc.text.length;\r\n                        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\r\n                            selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\r\n                            selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\r\n                        }\r\n                        supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\r\n                        return [4 /*yield*/, this._renameInputField.getValue().getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview)];\r\n                    case 5:\r\n                        inputFieldResult = _a.sent();\r\n                        // no result, only hint to focus the editor or not\r\n                        if (typeof inputFieldResult === 'boolean') {\r\n                            if (inputFieldResult) {\r\n                                this.editor.focus();\r\n                            }\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this.editor.focus();\r\n                        renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, 0, [], this._cts.token), this._cts.token).then(function (renameResult) { return __awaiter(_this, void 0, void 0, function () {\r\n                            var _this = this;\r\n                            return __generator(this, function (_a) {\r\n                                if (!renameResult || !this.editor.hasModel()) {\r\n                                    return [2 /*return*/];\r\n                                }\r\n                                if (renameResult.rejectReason) {\r\n                                    this._notificationService.info(renameResult.rejectReason);\r\n                                    return [2 /*return*/];\r\n                                }\r\n                                this._bulkEditService.apply(renameResult, {\r\n                                    editor: this.editor,\r\n                                    showPreview: inputFieldResult.wantsPreview,\r\n                                    label: nls.localize('label', \"Renaming '{0}'\", loc === null || loc === void 0 ? void 0 : loc.text)\r\n                                }).then(function (result) {\r\n                                    if (result.ariaSummary) {\r\n                                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\r\n                                    }\r\n                                }).catch(function (err) {\r\n                                    _this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\r\n                                    _this._logService.error(err);\r\n                                });\r\n                                return [2 /*return*/];\r\n                            });\r\n                        }); }, function (err) {\r\n                            _this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\r\n                            _this._logService.error(err);\r\n                        });\r\n                        this._progressService.showWhile(renameOperation, 250);\r\n                        return [2 /*return*/, renameOperation];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameController.prototype.acceptRenameInput = function (wantsPreview) {\r\n        this._renameInputField.getValue().acceptInput(wantsPreview);\r\n    };\r\n    RenameController.prototype.cancelRenameInput = function () {\r\n        this._renameInputField.getValue().cancelInput(true);\r\n    };\r\n    RenameController.ID = 'editor.contrib.renameController';\r\n    RenameController = __decorate([\r\n        __param(1, IInstantiationService),\r\n        __param(2, INotificationService),\r\n        __param(3, IBulkEditService),\r\n        __param(4, IEditorProgressService),\r\n        __param(5, ILogService),\r\n        __param(6, ITextResourceConfigurationService)\r\n    ], RenameController);\r\n    return RenameController;\r\n}());\r\n// ---- action implementation\r\nvar RenameAction = /** @class */ (function (_super) {\r\n    __extends(RenameAction, _super);\r\n    function RenameAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.rename',\r\n            label: nls.localize('rename.label', \"Rename Symbol\"),\r\n            alias: 'Rename Symbol',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.1\r\n            }\r\n        }) || this;\r\n    }\r\n    RenameAction.prototype.runCommand = function (accessor, args) {\r\n        var _this = this;\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var _a = Array.isArray(args) && args || [undefined, undefined], uri = _a[0], pos = _a[1];\r\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\r\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(function (editor) {\r\n                if (!editor) {\r\n                    return;\r\n                }\r\n                editor.setPosition(pos);\r\n                editor.invokeWithinContext(function (accessor) {\r\n                    _this.reportTelemetry(accessor, editor);\r\n                    return _this.run(accessor, editor);\r\n                });\r\n            }, onUnexpectedError);\r\n        }\r\n        return _super.prototype.runCommand.call(this, accessor, args);\r\n    };\r\n    RenameAction.prototype.run = function (accessor, editor) {\r\n        var controller = RenameController.get(editor);\r\n        if (controller) {\r\n            return controller.run();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    return RenameAction;\r\n}(EditorAction));\r\nexport { RenameAction };\r\nregisterEditorContribution(RenameController.ID, RenameController);\r\nregisterEditorAction(RenameAction);\r\nvar RenameCommand = EditorCommand.bindToContribution(RenameController.get);\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.acceptRenameInput(false); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInputWithPreview',\r\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\r\n    handler: function (x) { return x.acceptRenameInput(true); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 1024 /* Shift */ + 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'cancelRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.cancelRenameInput(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// ---- api bridge command\r\nregisterDefaultLanguageCommand('_executeDocumentRenameProvider', function (model, position, args) {\r\n    var newName = args.newName;\r\n    if (typeof newName !== 'string') {\r\n        throw illegalArgument('newName');\r\n    }\r\n    return rename(model, position, newName);\r\n});\r\n//todo@joh use editor options world\r\nRegistry.as(Extensions.Configuration).registerConfiguration({\r\n    id: 'editor',\r\n    properties: {\r\n        'editor.rename.enablePreview': {\r\n            scope: 5 /* LANGUAGE_OVERRIDABLE */,\r\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\r\n            default: true,\r\n            type: 'boolean'\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { isUpperAsciiLetter, isLowerAsciiLetter } from '../../../base/common/strings.js';\r\nvar WordSelectionRangeProvider = /** @class */ (function () {\r\n    function WordSelectionRangeProvider() {\r\n    }\r\n    WordSelectionRangeProvider.prototype.provideSelectionRanges = function (model, positions) {\r\n        var result = [];\r\n        for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n            var position = positions_1[_i];\r\n            var bucket = [];\r\n            result.push(bucket);\r\n            this._addInWordRanges(bucket, model, position);\r\n            this._addWordRanges(bucket, model, position);\r\n            this._addWhitespaceLine(bucket, model, position);\r\n            bucket.push({ range: model.getFullModelRange() });\r\n        }\r\n        return result;\r\n    };\r\n    WordSelectionRangeProvider.prototype._addInWordRanges = function (bucket, model, pos) {\r\n        var obj = model.getWordAtPosition(pos);\r\n        if (!obj) {\r\n            return;\r\n        }\r\n        var word = obj.word, startColumn = obj.startColumn;\r\n        var offset = pos.column - startColumn;\r\n        var start = offset;\r\n        var end = offset;\r\n        var lastCh = 0;\r\n        // LEFT anchor (start)\r\n        for (; start >= 0; start--) {\r\n            var ch = word.charCodeAt(start);\r\n            if (ch === 95 /* Underline */ || ch === 45 /* Dash */) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        start += 1;\r\n        // RIGHT anchor (end)\r\n        for (; end < word.length; end++) {\r\n            var ch = word.charCodeAt(end);\r\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            else if (ch === 95 /* Underline */ || ch === 45 /* Dash */) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        if (start < end) {\r\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\r\n        }\r\n    };\r\n    WordSelectionRangeProvider.prototype._addWordRanges = function (bucket, model, pos) {\r\n        var word = model.getWordAtPosition(pos);\r\n        if (word) {\r\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\r\n        }\r\n    };\r\n    WordSelectionRangeProvider.prototype._addWhitespaceLine = function (bucket, model, pos) {\r\n        if (model.getLineLength(pos.lineNumber) > 0\r\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\r\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\r\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\r\n        }\r\n    };\r\n    return WordSelectionRangeProvider;\r\n}());\r\nexport { WordSelectionRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nvar BracketSelectionRangeProvider = /** @class */ (function () {\r\n    function BracketSelectionRangeProvider() {\r\n    }\r\n    BracketSelectionRangeProvider.prototype.provideSelectionRanges = function (model, positions) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var result, _loop_1, _i, positions_1, position;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        result = [];\r\n                        _loop_1 = function (position) {\r\n                            var bucket, ranges;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        bucket = [];\r\n                                        result.push(bucket);\r\n                                        ranges = new Map();\r\n                                        return [4 /*yield*/, new Promise(function (resolve) { return BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges); })];\r\n                                    case 1:\r\n                                        _a.sent();\r\n                                        return [4 /*yield*/, new Promise(function (resolve) { return BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket); })];\r\n                                    case 2:\r\n                                        _a.sent();\r\n                                        return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        };\r\n                        _i = 0, positions_1 = positions;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        if (!(_i < positions_1.length)) return [3 /*break*/, 4];\r\n                        position = positions_1[_i];\r\n                        return [5 /*yield**/, _loop_1(position)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        _i++;\r\n                        return [3 /*break*/, 1];\r\n                    case 4: return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    BracketSelectionRangeProvider._bracketsRightYield = function (resolve, round, model, pos, ranges) {\r\n        var counts = new Map();\r\n        var t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var bracket = model.findNextBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(function () { return BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges); });\r\n                break;\r\n            }\r\n            var key = bracket.close[0];\r\n            if (bracket.isOpen) {\r\n                // wait for closing\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // process closing\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    var list = ranges.get(key);\r\n                    if (!list) {\r\n                        list = new LinkedList();\r\n                        ranges.set(key, list);\r\n                    }\r\n                    list.push(bracket.range);\r\n                }\r\n            }\r\n            pos = bracket.range.getEndPosition();\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._bracketsLeftYield = function (resolve, round, model, pos, ranges, bucket) {\r\n        var counts = new Map();\r\n        var t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var bracket = model.findPrevBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            var d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(function () { return BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket); });\r\n                break;\r\n            }\r\n            var key = bracket.close[0];\r\n            if (!bracket.isOpen) {\r\n                // wait for opening\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // opening\r\n                var val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    var list = ranges.get(key);\r\n                    if (list) {\r\n                        var closing = list.shift();\r\n                        if (list.size === 0) {\r\n                            ranges.delete(key);\r\n                        }\r\n                        var innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\r\n                        var outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\r\n                        bucket.push({ range: innerBracket });\r\n                        bucket.push({ range: outerBracket });\r\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\r\n                    }\r\n                }\r\n            }\r\n            pos = bracket.range.getStartPosition();\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._addBracketLeading = function (model, bracket, bucket) {\r\n        if (bracket.startLineNumber === bracket.endLineNumber) {\r\n            return;\r\n        }\r\n        // xxxxxxxx {\r\n        //\r\n        // }\r\n        var startLine = bracket.startLineNumber;\r\n        var column = model.getLineFirstNonWhitespaceColumn(startLine);\r\n        if (column !== 0 && column !== bracket.startColumn) {\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\r\n        }\r\n        // xxxxxxxx\r\n        // {\r\n        //\r\n        // }\r\n        var aboveLine = startLine - 1;\r\n        if (aboveLine > 0) {\r\n            var column_1 = model.getLineFirstNonWhitespaceColumn(aboveLine);\r\n            if (column_1 === bracket.startColumn && column_1 !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column_1), bracket.getEndPosition()) });\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\r\n            }\r\n        }\r\n    };\r\n    BracketSelectionRangeProvider._maxDuration = 30;\r\n    BracketSelectionRangeProvider._maxRounds = 2;\r\n    return BracketSelectionRangeProvider;\r\n}());\r\nexport { BracketSelectionRangeProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelCommand } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { WordSelectionRangeProvider } from './wordSelections.js';\r\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nvar SelectionRanges = /** @class */ (function () {\r\n    function SelectionRanges(index, ranges) {\r\n        this.index = index;\r\n        this.ranges = ranges;\r\n    }\r\n    SelectionRanges.prototype.mov = function (fwd) {\r\n        var index = this.index + (fwd ? 1 : -1);\r\n        if (index < 0 || index >= this.ranges.length) {\r\n            return this;\r\n        }\r\n        var res = new SelectionRanges(index, this.ranges);\r\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\r\n            // next range equals this range, retry with next-next\r\n            return res.mov(fwd);\r\n        }\r\n        return res;\r\n    };\r\n    return SelectionRanges;\r\n}());\r\nvar SmartSelectController = /** @class */ (function () {\r\n    function SmartSelectController(editor) {\r\n        this._ignoreSelection = false;\r\n        this._editor = editor;\r\n    }\r\n    SmartSelectController.get = function (editor) {\r\n        return editor.getContribution(SmartSelectController.ID);\r\n    };\r\n    SmartSelectController.prototype.dispose = function () {\r\n        dispose(this._selectionListener);\r\n    };\r\n    SmartSelectController.prototype.run = function (forward) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        var model = this._editor.getModel();\r\n        if (!modes.SelectionRangeRegistry.has(model)) {\r\n            return;\r\n        }\r\n        var promise = Promise.resolve(undefined);\r\n        if (!this._state) {\r\n            promise = provideSelectionRanges(model, selections.map(function (s) { return s.getPosition(); }), CancellationToken.None).then(function (ranges) {\r\n                if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\r\n                    // invalid result\r\n                    return;\r\n                }\r\n                if (!_this._editor.hasModel() || !arrays.equals(_this._editor.getSelections(), selections, function (a, b) { return a.equalsSelection(b); })) {\r\n                    // invalid editor state\r\n                    return;\r\n                }\r\n                var _loop_1 = function (i) {\r\n                    ranges[i] = ranges[i].filter(function (range) {\r\n                        // filter ranges inside the selection\r\n                        return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\r\n                    });\r\n                    // prepend current selection\r\n                    ranges[i].unshift(selections[i]);\r\n                };\r\n                for (var i = 0; i < ranges.length; i++) {\r\n                    _loop_1(i);\r\n                }\r\n                _this._state = ranges.map(function (ranges) { return new SelectionRanges(0, ranges); });\r\n                // listen to caret move and forget about state\r\n                dispose(_this._selectionListener);\r\n                _this._selectionListener = _this._editor.onDidChangeCursorPosition(function () {\r\n                    if (!_this._ignoreSelection) {\r\n                        dispose(_this._selectionListener);\r\n                        _this._state = undefined;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return promise.then(function () {\r\n            if (!_this._state) {\r\n                // no state\r\n                return;\r\n            }\r\n            _this._state = _this._state.map(function (state) { return state.mov(forward); });\r\n            var selections = _this._state.map(function (state) { return Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()); });\r\n            _this._ignoreSelection = true;\r\n            try {\r\n                _this._editor.setSelections(selections);\r\n            }\r\n            finally {\r\n                _this._ignoreSelection = false;\r\n            }\r\n        });\r\n    };\r\n    SmartSelectController.ID = 'editor.contrib.smartSelectController';\r\n    return SmartSelectController;\r\n}());\r\nvar AbstractSmartSelect = /** @class */ (function (_super) {\r\n    __extends(AbstractSmartSelect, _super);\r\n    function AbstractSmartSelect(forward, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._forward = forward;\r\n        return _this;\r\n    }\r\n    AbstractSmartSelect.prototype.run = function (_accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var controller;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        controller = SmartSelectController.get(editor);\r\n                        if (!controller) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, controller.run(this._forward)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return AbstractSmartSelect;\r\n}(EditorAction));\r\nvar GrowSelectionAction = /** @class */ (function (_super) {\r\n    __extends(GrowSelectionAction, _super);\r\n    function GrowSelectionAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.smartSelect.expand',\r\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\r\n            alias: 'Expand Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 17 /* RightArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    return GrowSelectionAction;\r\n}(AbstractSmartSelect));\r\n// renamed command id\r\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\r\nvar ShrinkSelectionAction = /** @class */ (function (_super) {\r\n    __extends(ShrinkSelectionAction, _super);\r\n    function ShrinkSelectionAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.smartSelect.shrink',\r\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\r\n            alias: 'Shrink Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 15 /* LeftArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return ShrinkSelectionAction;\r\n}(AbstractSmartSelect));\r\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController);\r\nregisterEditorAction(GrowSelectionAction);\r\nregisterEditorAction(ShrinkSelectionAction);\r\n// word selection\r\nmodes.SelectionRangeRegistry.register('*', new WordSelectionRangeProvider());\r\nexport function provideSelectionRanges(model, positions, token) {\r\n    var providers = modes.SelectionRangeRegistry.all(model);\r\n    if (providers.length === 1) {\r\n        // add word selection and bracket selection when no provider exists\r\n        providers.unshift(new BracketSelectionRangeProvider());\r\n    }\r\n    var work = [];\r\n    var allRawRanges = [];\r\n    for (var _i = 0, providers_1 = providers; _i < providers_1.length; _i++) {\r\n        var provider = providers_1[_i];\r\n        work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(function (allProviderRanges) {\r\n            if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\r\n                for (var i = 0; i < positions.length; i++) {\r\n                    if (!allRawRanges[i]) {\r\n                        allRawRanges[i] = [];\r\n                    }\r\n                    for (var _i = 0, _a = allProviderRanges[i]; _i < _a.length; _i++) {\r\n                        var oneProviderRanges = _a[_i];\r\n                        if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\r\n                            allRawRanges[i].push(Range.lift(oneProviderRanges.range));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, onUnexpectedExternalError));\r\n    }\r\n    return Promise.all(work).then(function () {\r\n        return allRawRanges.map(function (oneRawRanges) {\r\n            if (oneRawRanges.length === 0) {\r\n                return [];\r\n            }\r\n            // sort all by start/end position\r\n            oneRawRanges.sort(function (a, b) {\r\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\r\n                    return 1;\r\n                }\r\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\r\n                    return 1;\r\n                }\r\n                else {\r\n                    return 0;\r\n                }\r\n            });\r\n            // remove ranges that don't contain the former range or that are equal to the\r\n            // former range\r\n            var oneRanges = [];\r\n            var last;\r\n            for (var _i = 0, oneRawRanges_1 = oneRawRanges; _i < oneRawRanges_1.length; _i++) {\r\n                var range = oneRawRanges_1[_i];\r\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\r\n                    oneRanges.push(range);\r\n                    last = range;\r\n                }\r\n            }\r\n            // add ranges that expand trivia at line starts and ends whenever a range\r\n            // wraps onto the a new line\r\n            var oneRangesWithTrivia = [oneRanges[0]];\r\n            for (var i = 1; i < oneRanges.length; i++) {\r\n                var prev = oneRanges[i - 1];\r\n                var cur = oneRanges[i];\r\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\r\n                    // add line/block range without leading/failing whitespace\r\n                    var rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\r\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\r\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\r\n                    }\r\n                    // add line/block range\r\n                    var rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\r\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\r\n                        oneRangesWithTrivia.push(rangeFull);\r\n                    }\r\n                }\r\n                oneRangesWithTrivia.push(cur);\r\n            }\r\n            return oneRangesWithTrivia;\r\n        });\r\n    });\r\n}\r\nregisterModelCommand('_executeSelectionRangeProvider', function (model) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var positions = args[0];\r\n    return provideSelectionRanges(model, positions, CancellationToken.None);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { first } from '../../../base/common/async.js';\r\nimport { assign } from '../../../base/common/objects.js';\r\nimport { onUnexpectedExternalError, canceled, isPromiseCanceledError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { FuzzyScore } from '../../../base/common/filters.js';\r\nimport { isDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nexport var Context = {\r\n    Visible: new RawContextKey('suggestWidgetVisible', false),\r\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false),\r\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true),\r\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true)\r\n};\r\nvar CompletionItem = /** @class */ (function () {\r\n    function CompletionItem(position, completion, container, provider, model) {\r\n        var _this = this;\r\n        this.position = position;\r\n        this.completion = completion;\r\n        this.container = container;\r\n        this.provider = provider;\r\n        this.isResolved = false;\r\n        // sorting, filtering\r\n        this.score = FuzzyScore.Default;\r\n        this.distance = 0;\r\n        this.textLabel = typeof completion.label === 'string'\r\n            ? completion.label\r\n            : completion.label.name;\r\n        // ensure lower-variants (perf)\r\n        this.labelLow = this.textLabel.toLowerCase();\r\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\r\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\r\n        // normalize ranges\r\n        if (Range.isIRange(completion.range)) {\r\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n        }\r\n        else {\r\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\r\n        }\r\n        // create the suggestion resolver\r\n        var resolveCompletionItem = provider.resolveCompletionItem;\r\n        if (typeof resolveCompletionItem !== 'function') {\r\n            this.resolve = function () { return Promise.resolve(); };\r\n            this.isResolved = true;\r\n        }\r\n        else {\r\n            var cached_1;\r\n            this.resolve = function (token) {\r\n                if (!cached_1) {\r\n                    cached_1 = Promise.resolve(resolveCompletionItem.call(provider, model, position, completion, token)).then(function (value) {\r\n                        assign(completion, value);\r\n                        _this.isResolved = true;\r\n                    }, function (err) {\r\n                        if (isPromiseCanceledError(err)) {\r\n                            // the IPC queue will reject the request with the\r\n                            // cancellation error -> reset cached\r\n                            cached_1 = undefined;\r\n                        }\r\n                    });\r\n                    token.onCancellationRequested(function () {\r\n                        if (!_this.isResolved) {\r\n                            // cancellation after the request has been\r\n                            // dispatched -> reset cache\r\n                            cached_1 = undefined;\r\n                        }\r\n                    });\r\n                }\r\n                return cached_1;\r\n            };\r\n        }\r\n    }\r\n    return CompletionItem;\r\n}());\r\nexport { CompletionItem };\r\nvar CompletionOptions = /** @class */ (function () {\r\n    function CompletionOptions(snippetSortOrder, kindFilter, providerFilter) {\r\n        if (snippetSortOrder === void 0) { snippetSortOrder = 2 /* Bottom */; }\r\n        if (kindFilter === void 0) { kindFilter = new Set(); }\r\n        if (providerFilter === void 0) { providerFilter = new Set(); }\r\n        this.snippetSortOrder = snippetSortOrder;\r\n        this.kindFilter = kindFilter;\r\n        this.providerFilter = providerFilter;\r\n    }\r\n    CompletionOptions.default = new CompletionOptions();\r\n    return CompletionOptions;\r\n}());\r\nexport { CompletionOptions };\r\nvar _snippetSuggestSupport;\r\nexport function getSnippetSuggestSupport() {\r\n    return _snippetSuggestSupport;\r\n}\r\nexport function provideSuggestionItems(model, position, options, context, token) {\r\n    if (options === void 0) { options = CompletionOptions.default; }\r\n    if (context === void 0) { context = { triggerKind: 0 /* Invoke */ }; }\r\n    if (token === void 0) { token = CancellationToken.None; }\r\n    var word = model.getWordAtPosition(position);\r\n    var defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\r\n    var defaultInsertRange = defaultReplaceRange.setEndPosition(position.lineNumber, position.column);\r\n    // const wordUntil = model.getWordUntilPosition(position);\r\n    // const defaultRange = new Range(position.lineNumber, wordUntil.startColumn, position.lineNumber, wordUntil.endColumn);\r\n    position = position.clone();\r\n    // get provider groups, always add snippet suggestion provider\r\n    var supports = modes.CompletionProviderRegistry.orderedGroups(model);\r\n    // add snippets provider unless turned off\r\n    if (!options.kindFilter.has(25 /* Snippet */) && _snippetSuggestSupport) {\r\n        supports.unshift([_snippetSuggestSupport]);\r\n    }\r\n    var allSuggestions = [];\r\n    var disposables = new DisposableStore();\r\n    var hasResult = false;\r\n    // add suggestions from contributed providers - providers are ordered in groups of\r\n    // equal score and once a group produces a result the process stops\r\n    var factory = supports.map(function (supports) { return function () {\r\n        // for each support in the group ask for suggestions\r\n        return Promise.all(supports.map(function (provider) {\r\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\r\n                return undefined;\r\n            }\r\n            return Promise.resolve(provider.provideCompletionItems(model, position, context, token)).then(function (container) {\r\n                var len = allSuggestions.length;\r\n                if (container) {\r\n                    for (var _i = 0, _a = container.suggestions || []; _i < _a.length; _i++) {\r\n                        var suggestion = _a[_i];\r\n                        if (!options.kindFilter.has(suggestion.kind)) {\r\n                            // fill in default range when missing\r\n                            if (!suggestion.range) {\r\n                                suggestion.range = { insert: defaultInsertRange, replace: defaultReplaceRange };\r\n                            }\r\n                            // fill in default sortText when missing\r\n                            if (!suggestion.sortText) {\r\n                                suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.name;\r\n                            }\r\n                            allSuggestions.push(new CompletionItem(position, suggestion, container, provider, model));\r\n                        }\r\n                    }\r\n                    if (isDisposable(container)) {\r\n                        disposables.add(container);\r\n                    }\r\n                }\r\n                if (len !== allSuggestions.length && provider !== _snippetSuggestSupport) {\r\n                    hasResult = true;\r\n                }\r\n            }, onUnexpectedExternalError);\r\n        }));\r\n    }; });\r\n    var result = first(factory, function () {\r\n        // stop on result or cancellation\r\n        return hasResult || token.isCancellationRequested;\r\n    }).then(function () {\r\n        if (token.isCancellationRequested) {\r\n            disposables.dispose();\r\n            return Promise.reject(canceled());\r\n        }\r\n        return allSuggestions.sort(getSuggestionComparator(options.snippetSortOrder));\r\n    });\r\n    // result.then(items => {\r\n    // \tconsole.log(model.getWordUntilPosition(position), items.map(item => `${item.suggestion.label}, type=${item.suggestion.type}, incomplete?${item.container.incomplete}, overwriteBefore=${item.suggestion.overwriteBefore}`));\r\n    // \treturn items;\r\n    // }, err => {\r\n    // \tconsole.warn(model.getWordUntilPosition(position), err);\r\n    // });\r\n    return result;\r\n}\r\nfunction defaultComparator(a, b) {\r\n    // check with 'sortText'\r\n    if (a.sortTextLow && b.sortTextLow) {\r\n        if (a.sortTextLow < b.sortTextLow) {\r\n            return -1;\r\n        }\r\n        else if (a.sortTextLow > b.sortTextLow) {\r\n            return 1;\r\n        }\r\n    }\r\n    // check with 'label'\r\n    if (a.completion.label < b.completion.label) {\r\n        return -1;\r\n    }\r\n    else if (a.completion.label > b.completion.label) {\r\n        return 1;\r\n    }\r\n    // check with 'type'\r\n    return a.completion.kind - b.completion.kind;\r\n}\r\nfunction snippetUpComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 25 /* Snippet */) {\r\n            return -1;\r\n        }\r\n        else if (b.completion.kind === 25 /* Snippet */) {\r\n            return 1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nfunction snippetDownComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 25 /* Snippet */) {\r\n            return 1;\r\n        }\r\n        else if (b.completion.kind === 25 /* Snippet */) {\r\n            return -1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nvar _snippetComparators = new Map();\r\n_snippetComparators.set(0 /* Top */, snippetUpComparator);\r\n_snippetComparators.set(2 /* Bottom */, snippetDownComparator);\r\n_snippetComparators.set(1 /* Inline */, defaultComparator);\r\nexport function getSuggestionComparator(snippetConfig) {\r\n    return _snippetComparators.get(snippetConfig);\r\n}\r\nregisterDefaultLanguageCommand('_executeCompletionItemProvider', function (model, position, args) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result, disposables, resolving, maxItemsToResolve, items, _i, items_1, item;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                result = {\r\n                    incomplete: false,\r\n                    suggestions: []\r\n                };\r\n                disposables = new DisposableStore();\r\n                resolving = [];\r\n                maxItemsToResolve = args['maxItemsToResolve'] || 0;\r\n                return [4 /*yield*/, provideSuggestionItems(model, position)];\r\n            case 1:\r\n                items = _a.sent();\r\n                for (_i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                    item = items_1[_i];\r\n                    if (resolving.length < maxItemsToResolve) {\r\n                        resolving.push(item.resolve(CancellationToken.None));\r\n                    }\r\n                    result.incomplete = result.incomplete || item.container.incomplete;\r\n                    result.suggestions.push(item.completion);\r\n                    if (isDisposable(item.container)) {\r\n                        disposables.add(item.container);\r\n                    }\r\n                }\r\n                _a.label = 2;\r\n            case 2:\r\n                _a.trys.push([2, , 4, 5]);\r\n                return [4 /*yield*/, Promise.all(resolving)];\r\n            case 3:\r\n                _a.sent();\r\n                return [2 /*return*/, result];\r\n            case 4:\r\n                setTimeout(function () { return disposables.dispose(); }, 100);\r\n                return [7 /*endfinally*/];\r\n            case 5: return [2 /*return*/];\r\n        }\r\n    });\r\n}); });\r\nvar _provider = new /** @class */ (function () {\r\n    function class_1() {\r\n        this.onlyOnceSuggestions = [];\r\n    }\r\n    class_1.prototype.provideCompletionItems = function () {\r\n        var suggestions = this.onlyOnceSuggestions.slice(0);\r\n        var result = { suggestions: suggestions };\r\n        this.onlyOnceSuggestions.length = 0;\r\n        return result;\r\n    };\r\n    return class_1;\r\n}());\r\nmodes.CompletionProviderRegistry.register('*', _provider);\r\nexport function showSimpleSuggestions(editor, suggestions) {\r\n    setTimeout(function () {\r\n        var _a;\r\n        (_a = _provider.onlyOnceSuggestions).push.apply(_a, suggestions);\r\n        editor.getContribution('editor.contrib.suggestController').triggerSuggest(new Set().add(_provider));\r\n    }, 0);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nvar _a;\r\nvar Scanner = /** @class */ (function () {\r\n    function Scanner() {\r\n        this.value = '';\r\n        this.pos = 0;\r\n    }\r\n    Scanner.isDigitCharacter = function (ch) {\r\n        return ch >= 48 /* Digit0 */ && ch <= 57 /* Digit9 */;\r\n    };\r\n    Scanner.isVariableCharacter = function (ch) {\r\n        return ch === 95 /* Underline */\r\n            || (ch >= 97 /* a */ && ch <= 122 /* z */)\r\n            || (ch >= 65 /* A */ && ch <= 90 /* Z */);\r\n    };\r\n    Scanner.prototype.text = function (value) {\r\n        this.value = value;\r\n        this.pos = 0;\r\n    };\r\n    Scanner.prototype.tokenText = function (token) {\r\n        return this.value.substr(token.pos, token.len);\r\n    };\r\n    Scanner.prototype.next = function () {\r\n        if (this.pos >= this.value.length) {\r\n            return { type: 14 /* EOF */, pos: this.pos, len: 0 };\r\n        }\r\n        var pos = this.pos;\r\n        var len = 0;\r\n        var ch = this.value.charCodeAt(pos);\r\n        var type;\r\n        // static types\r\n        type = Scanner._table[ch];\r\n        if (typeof type === 'number') {\r\n            this.pos += 1;\r\n            return { type: type, pos: pos, len: 1 };\r\n        }\r\n        // number\r\n        if (Scanner.isDigitCharacter(ch)) {\r\n            type = 8 /* Int */;\r\n            do {\r\n                len += 1;\r\n                ch = this.value.charCodeAt(pos + len);\r\n            } while (Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type: type, pos: pos, len: len };\r\n        }\r\n        // variable name\r\n        if (Scanner.isVariableCharacter(ch)) {\r\n            type = 9 /* VariableName */;\r\n            do {\r\n                ch = this.value.charCodeAt(pos + (++len));\r\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type: type, pos: pos, len: len };\r\n        }\r\n        // format\r\n        type = 10 /* Format */;\r\n        do {\r\n            len += 1;\r\n            ch = this.value.charCodeAt(pos + len);\r\n        } while (!isNaN(ch)\r\n            && typeof Scanner._table[ch] === 'undefined' // not static token\r\n            && !Scanner.isDigitCharacter(ch) // not number\r\n            && !Scanner.isVariableCharacter(ch) // not variable\r\n        );\r\n        this.pos += len;\r\n        return { type: type, pos: pos, len: len };\r\n    };\r\n    Scanner._table = (_a = {},\r\n        _a[36 /* DollarSign */] = 0 /* Dollar */,\r\n        _a[58 /* Colon */] = 1 /* Colon */,\r\n        _a[44 /* Comma */] = 2 /* Comma */,\r\n        _a[123 /* OpenCurlyBrace */] = 3 /* CurlyOpen */,\r\n        _a[125 /* CloseCurlyBrace */] = 4 /* CurlyClose */,\r\n        _a[92 /* Backslash */] = 5 /* Backslash */,\r\n        _a[47 /* Slash */] = 6 /* Forwardslash */,\r\n        _a[124 /* Pipe */] = 7 /* Pipe */,\r\n        _a[43 /* Plus */] = 11 /* Plus */,\r\n        _a[45 /* Dash */] = 12 /* Dash */,\r\n        _a[63 /* QuestionMark */] = 13 /* QuestionMark */,\r\n        _a);\r\n    return Scanner;\r\n}());\r\nexport { Scanner };\r\nvar Marker = /** @class */ (function () {\r\n    function Marker() {\r\n        this._children = [];\r\n    }\r\n    Marker.prototype.appendChild = function (child) {\r\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\r\n            // this and previous child are text -> merge them\r\n            this._children[this._children.length - 1].value += child.value;\r\n        }\r\n        else {\r\n            // normal adoption of child\r\n            child.parent = this;\r\n            this._children.push(child);\r\n        }\r\n        return this;\r\n    };\r\n    Marker.prototype.replace = function (child, others) {\r\n        var parent = child.parent;\r\n        var idx = parent.children.indexOf(child);\r\n        var newChildren = parent.children.slice(0);\r\n        newChildren.splice.apply(newChildren, __spreadArrays([idx, 1], others));\r\n        parent._children = newChildren;\r\n        (function _fixParent(children, parent) {\r\n            for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\r\n                var child_1 = children_1[_i];\r\n                child_1.parent = parent;\r\n                _fixParent(child_1.children, child_1);\r\n            }\r\n        })(others, parent);\r\n    };\r\n    Object.defineProperty(Marker.prototype, \"children\", {\r\n        get: function () {\r\n            return this._children;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Marker.prototype, \"snippet\", {\r\n        get: function () {\r\n            var candidate = this;\r\n            while (true) {\r\n                if (!candidate) {\r\n                    return undefined;\r\n                }\r\n                if (candidate instanceof TextmateSnippet) {\r\n                    return candidate;\r\n                }\r\n                candidate = candidate.parent;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Marker.prototype.toString = function () {\r\n        return this.children.reduce(function (prev, cur) { return prev + cur.toString(); }, '');\r\n    };\r\n    Marker.prototype.len = function () {\r\n        return 0;\r\n    };\r\n    return Marker;\r\n}());\r\nexport { Marker };\r\nvar Text = /** @class */ (function (_super) {\r\n    __extends(Text, _super);\r\n    function Text(value) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.value = value;\r\n        return _this_1;\r\n    }\r\n    Text.prototype.toString = function () {\r\n        return this.value;\r\n    };\r\n    Text.prototype.len = function () {\r\n        return this.value.length;\r\n    };\r\n    Text.prototype.clone = function () {\r\n        return new Text(this.value);\r\n    };\r\n    return Text;\r\n}(Marker));\r\nexport { Text };\r\nvar TransformableMarker = /** @class */ (function (_super) {\r\n    __extends(TransformableMarker, _super);\r\n    function TransformableMarker() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return TransformableMarker;\r\n}(Marker));\r\nexport { TransformableMarker };\r\nvar Placeholder = /** @class */ (function (_super) {\r\n    __extends(Placeholder, _super);\r\n    function Placeholder(index) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.index = index;\r\n        return _this_1;\r\n    }\r\n    Placeholder.compareByIndex = function (a, b) {\r\n        if (a.index === b.index) {\r\n            return 0;\r\n        }\r\n        else if (a.isFinalTabstop) {\r\n            return 1;\r\n        }\r\n        else if (b.isFinalTabstop) {\r\n            return -1;\r\n        }\r\n        else if (a.index < b.index) {\r\n            return -1;\r\n        }\r\n        else if (a.index > b.index) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    Object.defineProperty(Placeholder.prototype, \"isFinalTabstop\", {\r\n        get: function () {\r\n            return this.index === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Placeholder.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._children.length === 1 && this._children[0] instanceof Choice\r\n                ? this._children[0]\r\n                : undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Placeholder.prototype.clone = function () {\r\n        var ret = new Placeholder(this.index);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Placeholder;\r\n}(TransformableMarker));\r\nexport { Placeholder };\r\nvar Choice = /** @class */ (function (_super) {\r\n    __extends(Choice, _super);\r\n    function Choice() {\r\n        var _this_1 = _super !== null && _super.apply(this, arguments) || this;\r\n        _this_1.options = [];\r\n        return _this_1;\r\n    }\r\n    Choice.prototype.appendChild = function (marker) {\r\n        if (marker instanceof Text) {\r\n            marker.parent = this;\r\n            this.options.push(marker);\r\n        }\r\n        return this;\r\n    };\r\n    Choice.prototype.toString = function () {\r\n        return this.options[0].value;\r\n    };\r\n    Choice.prototype.len = function () {\r\n        return this.options[0].len();\r\n    };\r\n    Choice.prototype.clone = function () {\r\n        var ret = new Choice();\r\n        this.options.forEach(ret.appendChild, ret);\r\n        return ret;\r\n    };\r\n    return Choice;\r\n}(Marker));\r\nexport { Choice };\r\nvar Transform = /** @class */ (function (_super) {\r\n    __extends(Transform, _super);\r\n    function Transform() {\r\n        var _this_1 = _super !== null && _super.apply(this, arguments) || this;\r\n        _this_1.regexp = new RegExp('');\r\n        return _this_1;\r\n    }\r\n    Transform.prototype.resolve = function (value) {\r\n        var _this = this;\r\n        var didMatch = false;\r\n        var ret = value.replace(this.regexp, function () {\r\n            didMatch = true;\r\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\r\n        });\r\n        // when the regex didn't match and when the transform has\r\n        // else branches, then run those\r\n        if (!didMatch && this._children.some(function (child) { return child instanceof FormatString && Boolean(child.elseValue); })) {\r\n            ret = this._replace([]);\r\n        }\r\n        return ret;\r\n    };\r\n    Transform.prototype._replace = function (groups) {\r\n        var ret = '';\r\n        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {\r\n            var marker = _a[_i];\r\n            if (marker instanceof FormatString) {\r\n                var value = groups[marker.index] || '';\r\n                value = marker.resolve(value);\r\n                ret += value;\r\n            }\r\n            else {\r\n                ret += marker.toString();\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n    Transform.prototype.toString = function () {\r\n        return '';\r\n    };\r\n    Transform.prototype.clone = function () {\r\n        var ret = new Transform();\r\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Transform;\r\n}(Marker));\r\nexport { Transform };\r\nvar FormatString = /** @class */ (function (_super) {\r\n    __extends(FormatString, _super);\r\n    function FormatString(index, shorthandName, ifValue, elseValue) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.index = index;\r\n        _this_1.shorthandName = shorthandName;\r\n        _this_1.ifValue = ifValue;\r\n        _this_1.elseValue = elseValue;\r\n        return _this_1;\r\n    }\r\n    FormatString.prototype.resolve = function (value) {\r\n        if (this.shorthandName === 'upcase') {\r\n            return !value ? '' : value.toLocaleUpperCase();\r\n        }\r\n        else if (this.shorthandName === 'downcase') {\r\n            return !value ? '' : value.toLocaleLowerCase();\r\n        }\r\n        else if (this.shorthandName === 'capitalize') {\r\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\r\n        }\r\n        else if (this.shorthandName === 'pascalcase') {\r\n            return !value ? '' : this._toPascalCase(value);\r\n        }\r\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\r\n            return this.ifValue;\r\n        }\r\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\r\n            return this.elseValue;\r\n        }\r\n        else {\r\n            return value || '';\r\n        }\r\n    };\r\n    FormatString.prototype._toPascalCase = function (value) {\r\n        var match = value.match(/[a-z]+/gi);\r\n        if (!match) {\r\n            return value;\r\n        }\r\n        return match.map(function (word) {\r\n            return word.charAt(0).toUpperCase()\r\n                + word.substr(1).toLowerCase();\r\n        })\r\n            .join('');\r\n    };\r\n    FormatString.prototype.clone = function () {\r\n        var ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\r\n        return ret;\r\n    };\r\n    return FormatString;\r\n}(Marker));\r\nexport { FormatString };\r\nvar Variable = /** @class */ (function (_super) {\r\n    __extends(Variable, _super);\r\n    function Variable(name) {\r\n        var _this_1 = _super.call(this) || this;\r\n        _this_1.name = name;\r\n        return _this_1;\r\n    }\r\n    Variable.prototype.resolve = function (resolver) {\r\n        var value = resolver.resolve(this);\r\n        if (this.transform) {\r\n            value = this.transform.resolve(value || '');\r\n        }\r\n        if (value !== undefined) {\r\n            this._children = [new Text(value)];\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Variable.prototype.clone = function () {\r\n        var ret = new Variable(this.name);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    return Variable;\r\n}(TransformableMarker));\r\nexport { Variable };\r\nfunction walk(marker, visitor) {\r\n    var stack = __spreadArrays(marker);\r\n    while (stack.length > 0) {\r\n        var marker_1 = stack.shift();\r\n        var recurse = visitor(marker_1);\r\n        if (!recurse) {\r\n            break;\r\n        }\r\n        stack.unshift.apply(stack, marker_1.children);\r\n    }\r\n}\r\nvar TextmateSnippet = /** @class */ (function (_super) {\r\n    __extends(TextmateSnippet, _super);\r\n    function TextmateSnippet() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(TextmateSnippet.prototype, \"placeholderInfo\", {\r\n        get: function () {\r\n            if (!this._placeholders) {\r\n                // fill in placeholders\r\n                var all_1 = [];\r\n                var last_1;\r\n                this.walk(function (candidate) {\r\n                    if (candidate instanceof Placeholder) {\r\n                        all_1.push(candidate);\r\n                        last_1 = !last_1 || last_1.index < candidate.index ? candidate : last_1;\r\n                    }\r\n                    return true;\r\n                });\r\n                this._placeholders = { all: all_1, last: last_1 };\r\n            }\r\n            return this._placeholders;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TextmateSnippet.prototype, \"placeholders\", {\r\n        get: function () {\r\n            var all = this.placeholderInfo.all;\r\n            return all;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    TextmateSnippet.prototype.offset = function (marker) {\r\n        var pos = 0;\r\n        var found = false;\r\n        this.walk(function (candidate) {\r\n            if (candidate === marker) {\r\n                found = true;\r\n                return false;\r\n            }\r\n            pos += candidate.len();\r\n            return true;\r\n        });\r\n        if (!found) {\r\n            return -1;\r\n        }\r\n        return pos;\r\n    };\r\n    TextmateSnippet.prototype.fullLen = function (marker) {\r\n        var ret = 0;\r\n        walk([marker], function (marker) {\r\n            ret += marker.len();\r\n            return true;\r\n        });\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.enclosingPlaceholders = function (placeholder) {\r\n        var ret = [];\r\n        var parent = placeholder.parent;\r\n        while (parent) {\r\n            if (parent instanceof Placeholder) {\r\n                ret.push(parent);\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.resolveVariables = function (resolver) {\r\n        var _this_1 = this;\r\n        this.walk(function (candidate) {\r\n            if (candidate instanceof Variable) {\r\n                if (candidate.resolve(resolver)) {\r\n                    _this_1._placeholders = undefined;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        return this;\r\n    };\r\n    TextmateSnippet.prototype.appendChild = function (child) {\r\n        this._placeholders = undefined;\r\n        return _super.prototype.appendChild.call(this, child);\r\n    };\r\n    TextmateSnippet.prototype.replace = function (child, others) {\r\n        this._placeholders = undefined;\r\n        return _super.prototype.replace.call(this, child, others);\r\n    };\r\n    TextmateSnippet.prototype.clone = function () {\r\n        var ret = new TextmateSnippet();\r\n        this._children = this.children.map(function (child) { return child.clone(); });\r\n        return ret;\r\n    };\r\n    TextmateSnippet.prototype.walk = function (visitor) {\r\n        walk(this.children, visitor);\r\n    };\r\n    return TextmateSnippet;\r\n}(Marker));\r\nexport { TextmateSnippet };\r\nvar SnippetParser = /** @class */ (function () {\r\n    function SnippetParser() {\r\n        this._scanner = new Scanner();\r\n        this._token = { type: 14 /* EOF */, pos: 0, len: 0 };\r\n    }\r\n    SnippetParser.escape = function (value) {\r\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\r\n    };\r\n    SnippetParser.prototype.parse = function (value, insertFinalTabstop, enforceFinalTabstop) {\r\n        this._scanner.text(value);\r\n        this._token = this._scanner.next();\r\n        var snippet = new TextmateSnippet();\r\n        while (this._parse(snippet)) {\r\n            // nothing\r\n        }\r\n        // fill in values for placeholders. the first placeholder of an index\r\n        // that has a value defines the value for all placeholders with that index\r\n        var placeholderDefaultValues = new Map();\r\n        var incompletePlaceholders = [];\r\n        var placeholderCount = 0;\r\n        snippet.walk(function (marker) {\r\n            if (marker instanceof Placeholder) {\r\n                placeholderCount += 1;\r\n                if (marker.isFinalTabstop) {\r\n                    placeholderDefaultValues.set(0, undefined);\r\n                }\r\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\r\n                    placeholderDefaultValues.set(marker.index, marker.children);\r\n                }\r\n                else {\r\n                    incompletePlaceholders.push(marker);\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        for (var _i = 0, incompletePlaceholders_1 = incompletePlaceholders; _i < incompletePlaceholders_1.length; _i++) {\r\n            var placeholder = incompletePlaceholders_1[_i];\r\n            var defaultValues = placeholderDefaultValues.get(placeholder.index);\r\n            if (defaultValues) {\r\n                var clone = new Placeholder(placeholder.index);\r\n                clone.transform = placeholder.transform;\r\n                for (var _a = 0, defaultValues_1 = defaultValues; _a < defaultValues_1.length; _a++) {\r\n                    var child = defaultValues_1[_a];\r\n                    clone.appendChild(child.clone());\r\n                }\r\n                snippet.replace(placeholder, [clone]);\r\n            }\r\n        }\r\n        if (!enforceFinalTabstop) {\r\n            enforceFinalTabstop = placeholderCount > 0 && insertFinalTabstop;\r\n        }\r\n        if (!placeholderDefaultValues.has(0) && enforceFinalTabstop) {\r\n            // the snippet uses placeholders but has no\r\n            // final tabstop defined -> insert at the end\r\n            snippet.appendChild(new Placeholder(0));\r\n        }\r\n        return snippet;\r\n    };\r\n    SnippetParser.prototype._accept = function (type, value) {\r\n        if (type === undefined || this._token.type === type) {\r\n            var ret = !value ? true : this._scanner.tokenText(this._token);\r\n            this._token = this._scanner.next();\r\n            return ret;\r\n        }\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._backTo = function (token) {\r\n        this._scanner.pos = token.pos + token.len;\r\n        this._token = token;\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._until = function (type) {\r\n        var start = this._token;\r\n        while (this._token.type !== type) {\r\n            if (this._token.type === 14 /* EOF */) {\r\n                return false;\r\n            }\r\n            else if (this._token.type === 5 /* Backslash */) {\r\n                var nextToken = this._scanner.next();\r\n                if (nextToken.type !== 0 /* Dollar */\r\n                    && nextToken.type !== 4 /* CurlyClose */\r\n                    && nextToken.type !== 5 /* Backslash */) {\r\n                    return false;\r\n                }\r\n            }\r\n            this._token = this._scanner.next();\r\n        }\r\n        var value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\r\n        this._token = this._scanner.next();\r\n        return value;\r\n    };\r\n    SnippetParser.prototype._parse = function (marker) {\r\n        return this._parseEscaped(marker)\r\n            || this._parseTabstopOrVariableName(marker)\r\n            || this._parseComplexPlaceholder(marker)\r\n            || this._parseComplexVariable(marker)\r\n            || this._parseAnything(marker);\r\n    };\r\n    // \\$, \\\\, \\} -> just text\r\n    SnippetParser.prototype._parseEscaped = function (marker) {\r\n        var value;\r\n        if (value = this._accept(5 /* Backslash */, true)) {\r\n            // saw a backslash, append escaped token or that backslash\r\n            value = this._accept(0 /* Dollar */, true)\r\n                || this._accept(4 /* CurlyClose */, true)\r\n                || this._accept(5 /* Backslash */, true)\r\n                || value;\r\n            marker.appendChild(new Text(value));\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    // $foo -> variable, $1 -> tabstop\r\n    SnippetParser.prototype._parseTabstopOrVariableName = function (parent) {\r\n        var value;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && (value = this._accept(9 /* VariableName */, true) || this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        parent.appendChild(/^\\d+$/.test(value)\r\n            ? new Placeholder(Number(value))\r\n            : new Variable(value));\r\n        return true;\r\n    };\r\n    // ${1:<children>}, ${1} -> placeholder\r\n    SnippetParser.prototype._parseComplexPlaceholder = function (parent) {\r\n        var index;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (index = this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        var placeholder = new Placeholder(Number(index));\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${1:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(placeholder);\r\n                    return true;\r\n                }\r\n                if (this._parse(placeholder)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + index + ':'));\r\n                placeholder.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (placeholder.index > 0 && this._accept(7 /* Pipe */)) {\r\n            // ${1|one,two,three|}\r\n            var choice = new Choice();\r\n            while (true) {\r\n                if (this._parseChoiceElement(choice)) {\r\n                    if (this._accept(2 /* Comma */)) {\r\n                        // opt, -> more\r\n                        continue;\r\n                    }\r\n                    if (this._accept(7 /* Pipe */)) {\r\n                        placeholder.appendChild(choice);\r\n                        if (this._accept(4 /* CurlyClose */)) {\r\n                            // ..|} -> done\r\n                            parent.appendChild(placeholder);\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1/<regex>/<format>/<options>}\r\n            if (this._parseTransform(placeholder)) {\r\n                parent.appendChild(placeholder);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(placeholder);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${1 <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    };\r\n    SnippetParser.prototype._parseChoiceElement = function (parent) {\r\n        var token = this._token;\r\n        var values = [];\r\n        while (true) {\r\n            if (this._token.type === 2 /* Comma */ || this._token.type === 7 /* Pipe */) {\r\n                break;\r\n            }\r\n            var value = void 0;\r\n            if (value = this._accept(5 /* Backslash */, true)) {\r\n                // \\, \\|, or \\\\\r\n                value = this._accept(2 /* Comma */, true)\r\n                    || this._accept(7 /* Pipe */, true)\r\n                    || this._accept(5 /* Backslash */, true)\r\n                    || value;\r\n            }\r\n            else {\r\n                value = this._accept(undefined, true);\r\n            }\r\n            if (!value) {\r\n                // EOF\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            values.push(value);\r\n        }\r\n        if (values.length === 0) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        parent.appendChild(new Text(values.join('')));\r\n        return true;\r\n    };\r\n    // ${foo:<children>}, ${foo} -> variable\r\n    SnippetParser.prototype._parseComplexVariable = function (parent) {\r\n        var name;\r\n        var token = this._token;\r\n        var match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (name = this._accept(9 /* VariableName */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        var variable = new Variable(name);\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${foo:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(variable);\r\n                    return true;\r\n                }\r\n                if (this._parse(variable)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + name + ':'));\r\n                variable.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${foo/<regex>/<format>/<options>}\r\n            if (this._parseTransform(variable)) {\r\n                parent.appendChild(variable);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${foo}\r\n            parent.appendChild(variable);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${foo <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    };\r\n    SnippetParser.prototype._parseTransform = function (parent) {\r\n        // ...<regex>/<format>/<options>}\r\n        var transform = new Transform();\r\n        var regexValue = '';\r\n        var regexOptions = '';\r\n        // (1) /regex\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            var escaped = void 0;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(6 /* Forwardslash */, true) || escaped;\r\n                regexValue += escaped;\r\n                continue;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexValue += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (2) /format\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            var escaped = void 0;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(5 /* Backslash */, true) || this._accept(6 /* Forwardslash */, true) || escaped;\r\n                transform.appendChild(new Text(escaped));\r\n                continue;\r\n            }\r\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (3) /option\r\n        while (true) {\r\n            if (this._accept(4 /* CurlyClose */)) {\r\n                break;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexOptions += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        try {\r\n            transform.regexp = new RegExp(regexValue, regexOptions);\r\n        }\r\n        catch (e) {\r\n            // invalid regexp\r\n            return false;\r\n        }\r\n        parent.transform = transform;\r\n        return true;\r\n    };\r\n    SnippetParser.prototype._parseFormatString = function (parent) {\r\n        var token = this._token;\r\n        if (!this._accept(0 /* Dollar */)) {\r\n            return false;\r\n        }\r\n        var complex = false;\r\n        if (this._accept(3 /* CurlyOpen */)) {\r\n            complex = true;\r\n        }\r\n        var index = this._accept(8 /* Int */, true);\r\n        if (!index) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (!complex) {\r\n            // $1\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (!this._accept(1 /* Colon */)) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1:/upcase}\r\n            var shorthand = this._accept(9 /* VariableName */, true);\r\n            if (!shorthand || !this._accept(4 /* CurlyClose */)) {\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            else {\r\n                parent.appendChild(new FormatString(Number(index), shorthand));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(11 /* Plus */)) {\r\n            // ${1:+<if>}\r\n            var ifValue = this._until(4 /* CurlyClose */);\r\n            if (ifValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(12 /* Dash */)) {\r\n            // ${2:-<else>}\r\n            var elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(13 /* QuestionMark */)) {\r\n            // ${2:?<if>:<else>}\r\n            var ifValue = this._until(1 /* Colon */);\r\n            if (ifValue) {\r\n                var elseValue = this._until(4 /* CurlyClose */);\r\n                if (elseValue) {\r\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // ${1:<else>}\r\n            var elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        this._backTo(token);\r\n        return false;\r\n    };\r\n    SnippetParser.prototype._parseAnything = function (marker) {\r\n        if (this._token.type !== 14 /* EOF */) {\r\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\r\n            this._accept(undefined);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return SnippetParser;\r\n}());\r\nexport { SnippetParser };\r\n","import { URI } from '../../../base/common/uri.js';\r\nexport var WORKSPACE_EXTENSION = 'code-workspace';\r\nexport function isSingleFolderWorkspaceIdentifier(obj) {\r\n    return obj instanceof URI;\r\n}\r\nexport function toWorkspaceIdentifier(workspace) {\r\n    if (workspace.configuration) {\r\n        return {\r\n            configPath: workspace.configuration,\r\n            id: workspace.id\r\n        };\r\n    }\r\n    if (workspace.folders.length === 1) {\r\n        return workspace.folders[0].uri;\r\n    }\r\n    // Empty workspace\r\n    return undefined;\r\n}\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport * as path from '../../../base/common/path.js';\r\nimport { dirname } from '../../../base/common/resources.js';\r\nimport { Text } from './snippetParser.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { getLeadingWhitespace, commonPrefixLength, isFalsyOrWhitespace, pad, endsWith } from '../../../base/common/strings.js';\r\nimport { isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, WORKSPACE_EXTENSION } from '../../../platform/workspaces/common/workspaces.js';\r\nimport { normalizeDriveLetter } from '../../../base/common/labels.js';\r\nvar CompositeSnippetVariableResolver = /** @class */ (function () {\r\n    function CompositeSnippetVariableResolver(_delegates) {\r\n        this._delegates = _delegates;\r\n        //\r\n    }\r\n    CompositeSnippetVariableResolver.prototype.resolve = function (variable) {\r\n        for (var _i = 0, _a = this._delegates; _i < _a.length; _i++) {\r\n            var delegate = _a[_i];\r\n            var value = delegate.resolve(variable);\r\n            if (value !== undefined) {\r\n                return value;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return CompositeSnippetVariableResolver;\r\n}());\r\nexport { CompositeSnippetVariableResolver };\r\nvar SelectionBasedVariableResolver = /** @class */ (function () {\r\n    function SelectionBasedVariableResolver(_model, _selection) {\r\n        this._model = _model;\r\n        this._selection = _selection;\r\n        //\r\n    }\r\n    SelectionBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\r\n            var value = this._model.getValueInRange(this._selection) || undefined;\r\n            if (value && this._selection.startLineNumber !== this._selection.endLineNumber && variable.snippet) {\r\n                // Selection is a multiline string which we indentation we now\r\n                // need to adjust. We compare the indentation of this variable\r\n                // with the indentation at the editor position and add potential\r\n                // extra indentation to the value\r\n                var line = this._model.getLineContent(this._selection.startLineNumber);\r\n                var lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\r\n                var varLeadingWhitespace_1 = lineLeadingWhitespace;\r\n                variable.snippet.walk(function (marker) {\r\n                    if (marker === variable) {\r\n                        return false;\r\n                    }\r\n                    if (marker instanceof Text) {\r\n                        varLeadingWhitespace_1 = getLeadingWhitespace(marker.value.split(/\\r\\n|\\r|\\n/).pop());\r\n                    }\r\n                    return true;\r\n                });\r\n                var whitespaceCommonLength_1 = commonPrefixLength(varLeadingWhitespace_1, lineLeadingWhitespace);\r\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, function (m, newline, rest) { return \"\" + newline + varLeadingWhitespace_1.substr(whitespaceCommonLength_1) + rest; });\r\n            }\r\n            return value;\r\n        }\r\n        else if (name === 'TM_CURRENT_LINE') {\r\n            return this._model.getLineContent(this._selection.positionLineNumber);\r\n        }\r\n        else if (name === 'TM_CURRENT_WORD') {\r\n            var info = this._model.getWordAtPosition({\r\n                lineNumber: this._selection.positionLineNumber,\r\n                column: this._selection.positionColumn\r\n            });\r\n            return info && info.word || undefined;\r\n        }\r\n        else if (name === 'TM_LINE_INDEX') {\r\n            return String(this._selection.positionLineNumber - 1);\r\n        }\r\n        else if (name === 'TM_LINE_NUMBER') {\r\n            return String(this._selection.positionLineNumber);\r\n        }\r\n        return undefined;\r\n    };\r\n    return SelectionBasedVariableResolver;\r\n}());\r\nexport { SelectionBasedVariableResolver };\r\nvar ModelBasedVariableResolver = /** @class */ (function () {\r\n    function ModelBasedVariableResolver(_labelService, _model) {\r\n        this._labelService = _labelService;\r\n        this._model = _model;\r\n        //\r\n    }\r\n    ModelBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'TM_FILENAME') {\r\n            return path.basename(this._model.uri.fsPath);\r\n        }\r\n        else if (name === 'TM_FILENAME_BASE') {\r\n            var name_1 = path.basename(this._model.uri.fsPath);\r\n            var idx = name_1.lastIndexOf('.');\r\n            if (idx <= 0) {\r\n                return name_1;\r\n            }\r\n            else {\r\n                return name_1.slice(0, idx);\r\n            }\r\n        }\r\n        else if (name === 'TM_DIRECTORY' && this._labelService) {\r\n            if (path.dirname(this._model.uri.fsPath) === '.') {\r\n                return '';\r\n            }\r\n            return this._labelService.getUriLabel(dirname(this._model.uri));\r\n        }\r\n        else if (name === 'TM_FILEPATH' && this._labelService) {\r\n            return this._labelService.getUriLabel(this._model.uri);\r\n        }\r\n        return undefined;\r\n    };\r\n    return ModelBasedVariableResolver;\r\n}());\r\nexport { ModelBasedVariableResolver };\r\nvar ClipboardBasedVariableResolver = /** @class */ (function () {\r\n    function ClipboardBasedVariableResolver(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\r\n        this._readClipboardText = _readClipboardText;\r\n        this._selectionIdx = _selectionIdx;\r\n        this._selectionCount = _selectionCount;\r\n        this._spread = _spread;\r\n        //\r\n    }\r\n    ClipboardBasedVariableResolver.prototype.resolve = function (variable) {\r\n        if (variable.name !== 'CLIPBOARD') {\r\n            return undefined;\r\n        }\r\n        var clipboardText = this._readClipboardText();\r\n        if (!clipboardText) {\r\n            return undefined;\r\n        }\r\n        // `spread` is assigning each cursor a line of the clipboard\r\n        // text whenever there the line count equals the cursor count\r\n        // and when enabled\r\n        if (this._spread) {\r\n            var lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(function (s) { return !isFalsyOrWhitespace(s); });\r\n            if (lines.length === this._selectionCount) {\r\n                return lines[this._selectionIdx];\r\n            }\r\n        }\r\n        return clipboardText;\r\n    };\r\n    return ClipboardBasedVariableResolver;\r\n}());\r\nexport { ClipboardBasedVariableResolver };\r\nvar CommentBasedVariableResolver = /** @class */ (function () {\r\n    function CommentBasedVariableResolver(_model) {\r\n        this._model = _model;\r\n        //\r\n    }\r\n    CommentBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        var language = this._model.getLanguageIdentifier();\r\n        var config = LanguageConfigurationRegistry.getComments(language.id);\r\n        if (!config) {\r\n            return undefined;\r\n        }\r\n        if (name === 'LINE_COMMENT') {\r\n            return config.lineCommentToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_START') {\r\n            return config.blockCommentStartToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_END') {\r\n            return config.blockCommentEndToken || undefined;\r\n        }\r\n        return undefined;\r\n    };\r\n    return CommentBasedVariableResolver;\r\n}());\r\nexport { CommentBasedVariableResolver };\r\nvar TimeBasedVariableResolver = /** @class */ (function () {\r\n    function TimeBasedVariableResolver() {\r\n    }\r\n    TimeBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'CURRENT_YEAR') {\r\n            return String(new Date().getFullYear());\r\n        }\r\n        else if (name === 'CURRENT_YEAR_SHORT') {\r\n            return String(new Date().getFullYear()).slice(-2);\r\n        }\r\n        else if (name === 'CURRENT_MONTH') {\r\n            return pad((new Date().getMonth().valueOf() + 1), 2);\r\n        }\r\n        else if (name === 'CURRENT_DATE') {\r\n            return pad(new Date().getDate().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_HOUR') {\r\n            return pad(new Date().getHours().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_MINUTE') {\r\n            return pad(new Date().getMinutes().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_SECOND') {\r\n            return pad(new Date().getSeconds().valueOf(), 2);\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME') {\r\n            return TimeBasedVariableResolver.dayNames[new Date().getDay()];\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.dayNamesShort[new Date().getDay()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME') {\r\n            return TimeBasedVariableResolver.monthNames[new Date().getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.monthNamesShort[new Date().getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_SECONDS_UNIX') {\r\n            return String(Math.floor(Date.now() / 1000));\r\n        }\r\n        return undefined;\r\n    };\r\n    TimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\r\n    TimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\r\n    TimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\r\n    TimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\r\n    return TimeBasedVariableResolver;\r\n}());\r\nexport { TimeBasedVariableResolver };\r\nvar WorkspaceBasedVariableResolver = /** @class */ (function () {\r\n    function WorkspaceBasedVariableResolver(_workspaceService) {\r\n        this._workspaceService = _workspaceService;\r\n        //\r\n    }\r\n    WorkspaceBasedVariableResolver.prototype.resolve = function (variable) {\r\n        if (!this._workspaceService) {\r\n            return undefined;\r\n        }\r\n        var workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\r\n        if (!workspaceIdentifier) {\r\n            return undefined;\r\n        }\r\n        if (variable.name === 'WORKSPACE_NAME') {\r\n            return this._resolveWorkspaceName(workspaceIdentifier);\r\n        }\r\n        else if (variable.name === 'WORKSPACE_FOLDER') {\r\n            return this._resoveWorkspacePath(workspaceIdentifier);\r\n        }\r\n        return undefined;\r\n    };\r\n    WorkspaceBasedVariableResolver.prototype._resolveWorkspaceName = function (workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return path.basename(workspaceIdentifier.path);\r\n        }\r\n        var filename = path.basename(workspaceIdentifier.configPath.path);\r\n        if (endsWith(filename, WORKSPACE_EXTENSION)) {\r\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\r\n        }\r\n        return filename;\r\n    };\r\n    WorkspaceBasedVariableResolver.prototype._resoveWorkspacePath = function (workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return normalizeDriveLetter(workspaceIdentifier.fsPath);\r\n        }\r\n        var filename = path.basename(workspaceIdentifier.configPath.path);\r\n        var folderpath = workspaceIdentifier.configPath.fsPath;\r\n        if (endsWith(folderpath, filename)) {\r\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\r\n        }\r\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\r\n    };\r\n    return WorkspaceBasedVariableResolver;\r\n}());\r\nexport { WorkspaceBasedVariableResolver };\r\nvar RandomBasedVariableResolver = /** @class */ (function () {\r\n    function RandomBasedVariableResolver() {\r\n    }\r\n    RandomBasedVariableResolver.prototype.resolve = function (variable) {\r\n        var name = variable.name;\r\n        if (name === 'RANDOM') {\r\n            return Math.random().toString().slice(-6);\r\n        }\r\n        else if (name === 'RANDOM_HEX') {\r\n            return Math.random().toString(16).slice(-6);\r\n        }\r\n        return undefined;\r\n    };\r\n    return RandomBasedVariableResolver;\r\n}());\r\nexport { RandomBasedVariableResolver };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { groupBy } from '../../../base/common/arrays.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { getLeadingWhitespace } from '../../../base/common/strings.js';\r\nimport './snippetSession.css';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Choice, Placeholder, SnippetParser, Text } from './snippetParser.js';\r\nimport { ClipboardBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, CommentBasedVariableResolver, WorkspaceBasedVariableResolver, RandomBasedVariableResolver } from './snippetVariables.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport * as colors from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ILabelService } from '../../../platform/label/common/label.js';\r\nregisterThemingParticipant(function (theme, collector) {\r\n    function getColorGraceful(name) {\r\n        var color = theme.getColor(name);\r\n        return color ? color.toString() : 'transparent';\r\n    }\r\n    collector.addRule(\".monaco-editor .snippet-placeholder { background-color: \" + getColorGraceful(colors.snippetTabstopHighlightBackground) + \"; outline-color: \" + getColorGraceful(colors.snippetTabstopHighlightBorder) + \"; }\");\r\n    collector.addRule(\".monaco-editor .finish-snippet-placeholder { background-color: \" + getColorGraceful(colors.snippetFinalTabstopHighlightBackground) + \"; outline-color: \" + getColorGraceful(colors.snippetFinalTabstopHighlightBorder) + \"; }\");\r\n});\r\nvar OneSnippet = /** @class */ (function () {\r\n    function OneSnippet(editor, snippet, offset) {\r\n        this._nestingLevel = 1;\r\n        this._editor = editor;\r\n        this._snippet = snippet;\r\n        this._offset = offset;\r\n        this._placeholderGroups = groupBy(snippet.placeholders, Placeholder.compareByIndex);\r\n        this._placeholderGroupsIdx = -1;\r\n    }\r\n    OneSnippet.prototype.dispose = function () {\r\n        if (this._placeholderDecorations) {\r\n            var toRemove_1 = [];\r\n            this._placeholderDecorations.forEach(function (handle) { return toRemove_1.push(handle); });\r\n            this._editor.deltaDecorations(toRemove_1, []);\r\n        }\r\n        this._placeholderGroups.length = 0;\r\n    };\r\n    OneSnippet.prototype._initDecorations = function () {\r\n        var _this = this;\r\n        if (this._placeholderDecorations) {\r\n            // already initialized\r\n            return;\r\n        }\r\n        this._placeholderDecorations = new Map();\r\n        var model = this._editor.getModel();\r\n        this._editor.changeDecorations(function (accessor) {\r\n            // create a decoration for each placeholder\r\n            for (var _i = 0, _a = _this._snippet.placeholders; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var placeholderOffset = _this._snippet.offset(placeholder);\r\n                var placeholderLen = _this._snippet.fullLen(placeholder);\r\n                var range = Range.fromPositions(model.getPositionAt(_this._offset + placeholderOffset), model.getPositionAt(_this._offset + placeholderOffset + placeholderLen));\r\n                var options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\r\n                var handle = accessor.addDecoration(range, options);\r\n                _this._placeholderDecorations.set(placeholder, handle);\r\n            }\r\n        });\r\n    };\r\n    OneSnippet.prototype.move = function (fwd) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this._initDecorations();\r\n        // Transform placeholder text if necessary\r\n        if (this._placeholderGroupsIdx >= 0) {\r\n            var operations = [];\r\n            for (var _i = 0, _a = this._placeholderGroups[this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                // Check if the placeholder has a transformation\r\n                if (placeholder.transform) {\r\n                    var id = this._placeholderDecorations.get(placeholder);\r\n                    var range = this._editor.getModel().getDecorationRange(id);\r\n                    var currentValue = this._editor.getModel().getValueInRange(range);\r\n                    operations.push(EditOperation.replaceMove(range, placeholder.transform.resolve(currentValue)));\r\n                }\r\n            }\r\n            if (operations.length > 0) {\r\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\r\n            }\r\n        }\r\n        var couldSkipThisPlaceholder = false;\r\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\r\n            this._placeholderGroupsIdx += 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\r\n            this._placeholderGroupsIdx -= 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else {\r\n            // the selection of the current placeholder might\r\n            // not acurate any more -> simply restore it\r\n        }\r\n        var newSelections = this._editor.getModel().changeDecorations(function (accessor) {\r\n            var activePlaceholders = new Set();\r\n            // change stickiness to always grow when typing at its edges\r\n            // because these decorations represent the currently active\r\n            // tabstop.\r\n            // Special case #1: reaching the final tabstop\r\n            // Special case #2: placeholders enclosing active placeholders\r\n            var selections = [];\r\n            for (var _i = 0, _a = _this._placeholderGroups[_this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var id = _this._placeholderDecorations.get(placeholder);\r\n                var range = _this._editor.getModel().getDecorationRange(id);\r\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\r\n                // consider to skip this placeholder index when the decoration\r\n                // range is empty but when the placeholder wasn't. that's a strong\r\n                // hint that the placeholder has been deleted. (all placeholder must match this)\r\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && _this._hasPlaceholderBeenCollapsed(placeholder);\r\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                activePlaceholders.add(placeholder);\r\n                for (var _b = 0, _c = _this._snippet.enclosingPlaceholders(placeholder); _b < _c.length; _b++) {\r\n                    var enclosingPlaceholder = _c[_b];\r\n                    var id_1 = _this._placeholderDecorations.get(enclosingPlaceholder);\r\n                    accessor.changeDecorationOptions(id_1, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                    activePlaceholders.add(enclosingPlaceholder);\r\n                }\r\n            }\r\n            // change stickness to never grow when typing at its edges\r\n            // so that in-active tabstops never grow\r\n            _this._placeholderDecorations.forEach(function (id, placeholder) {\r\n                if (!activePlaceholders.has(placeholder)) {\r\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\r\n                }\r\n            });\r\n            return selections;\r\n        });\r\n        return !couldSkipThisPlaceholder ? newSelections : this.move(fwd);\r\n    };\r\n    OneSnippet.prototype._hasPlaceholderBeenCollapsed = function (placeholder) {\r\n        // A placeholder is empty when it wasn't empty when authored but\r\n        // when its tracking decoration is empty. This also applies to all\r\n        // potential parent placeholders\r\n        var marker = placeholder;\r\n        while (marker) {\r\n            if (marker instanceof Placeholder) {\r\n                var id = this._placeholderDecorations.get(marker);\r\n                var range = this._editor.getModel().getDecorationRange(id);\r\n                if (range.isEmpty() && marker.toString().length > 0) {\r\n                    return true;\r\n                }\r\n            }\r\n            marker = marker.parent;\r\n        }\r\n        return false;\r\n    };\r\n    Object.defineProperty(OneSnippet.prototype, \"isAtFirstPlaceholder\", {\r\n        get: function () {\r\n            return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneSnippet.prototype, \"isAtLastPlaceholder\", {\r\n        get: function () {\r\n            return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneSnippet.prototype, \"hasPlaceholder\", {\r\n        get: function () {\r\n            return this._snippet.placeholders.length > 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    OneSnippet.prototype.computePossibleSelections = function () {\r\n        var result = new Map();\r\n        for (var _i = 0, _a = this._placeholderGroups; _i < _a.length; _i++) {\r\n            var placeholdersWithEqualIndex = _a[_i];\r\n            var ranges = void 0;\r\n            for (var _b = 0, placeholdersWithEqualIndex_1 = placeholdersWithEqualIndex; _b < placeholdersWithEqualIndex_1.length; _b++) {\r\n                var placeholder = placeholdersWithEqualIndex_1[_b];\r\n                if (placeholder.isFinalTabstop) {\r\n                    // ignore those\r\n                    break;\r\n                }\r\n                if (!ranges) {\r\n                    ranges = [];\r\n                    result.set(placeholder.index, ranges);\r\n                }\r\n                var id = this._placeholderDecorations.get(placeholder);\r\n                var range = this._editor.getModel().getDecorationRange(id);\r\n                if (!range) {\r\n                    // one of the placeholder lost its decoration and\r\n                    // therefore we bail out and pretend the placeholder\r\n                    // (with its mirrors) doesn't exist anymore.\r\n                    result.delete(placeholder.index);\r\n                    break;\r\n                }\r\n                ranges.push(range);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Object.defineProperty(OneSnippet.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._placeholderGroups[this._placeholderGroupsIdx][0].choice;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    OneSnippet.prototype.merge = function (others) {\r\n        var _this = this;\r\n        var model = this._editor.getModel();\r\n        this._nestingLevel *= 10;\r\n        this._editor.changeDecorations(function (accessor) {\r\n            // For each active placeholder take one snippet and merge it\r\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\r\n            // everything is sorted by editor selection we can simply remove\r\n            // elements from the beginning of the array\r\n            for (var _i = 0, _a = _this._placeholderGroups[_this._placeholderGroupsIdx]; _i < _a.length; _i++) {\r\n                var placeholder = _a[_i];\r\n                var nested = others.shift();\r\n                console.assert(!nested._placeholderDecorations);\r\n                // Massage placeholder-indicies of the nested snippet to be\r\n                // sorted right after the insertion point. This ensures we move\r\n                // through the placeholders in the correct order\r\n                var indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\r\n                for (var _b = 0, _c = nested._snippet.placeholderInfo.all; _b < _c.length; _b++) {\r\n                    var nestedPlaceholder = _c[_b];\r\n                    if (nestedPlaceholder.isFinalTabstop) {\r\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / _this._nestingLevel);\r\n                    }\r\n                    else {\r\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / _this._nestingLevel);\r\n                    }\r\n                }\r\n                _this._snippet.replace(placeholder, nested._snippet.children);\r\n                // Remove the placeholder at which position are inserting\r\n                // the snippet and also remove its decoration.\r\n                var id = _this._placeholderDecorations.get(placeholder);\r\n                accessor.removeDecoration(id);\r\n                _this._placeholderDecorations.delete(placeholder);\r\n                // For each *new* placeholder we create decoration to monitor\r\n                // how and if it grows/shrinks.\r\n                for (var _d = 0, _e = nested._snippet.placeholders; _d < _e.length; _d++) {\r\n                    var placeholder_1 = _e[_d];\r\n                    var placeholderOffset = nested._snippet.offset(placeholder_1);\r\n                    var placeholderLen = nested._snippet.fullLen(placeholder_1);\r\n                    var range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\r\n                    var handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\r\n                    _this._placeholderDecorations.set(placeholder_1, handle);\r\n                }\r\n            }\r\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\r\n            _this._placeholderGroups = groupBy(_this._snippet.placeholders, Placeholder.compareByIndex);\r\n        });\r\n    };\r\n    OneSnippet._decor = {\r\n        active: ModelDecorationOptions.register({ stickiness: 0 /* AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n        inactive: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n        activeFinal: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n        inactiveFinal: ModelDecorationOptions.register({ stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n    };\r\n    return OneSnippet;\r\n}());\r\nexport { OneSnippet };\r\nvar _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined\r\n};\r\nvar SnippetSession = /** @class */ (function () {\r\n    function SnippetSession(editor, template, options) {\r\n        if (options === void 0) { options = _defaultOptions; }\r\n        this._templateMerges = [];\r\n        this._snippets = [];\r\n        this._editor = editor;\r\n        this._template = template;\r\n        this._options = options;\r\n    }\r\n    SnippetSession.adjustWhitespace = function (model, position, snippet, adjustIndentation, adjustNewlines) {\r\n        var line = model.getLineContent(position.lineNumber);\r\n        var lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\r\n        snippet.walk(function (marker) {\r\n            if (marker instanceof Text && !(marker.parent instanceof Choice)) {\r\n                // adjust indentation of text markers, except for choise elements\r\n                // which get adjusted when being selected\r\n                var lines = marker.value.split(/\\r\\n|\\r|\\n/);\r\n                if (adjustIndentation) {\r\n                    for (var i = 1; i < lines.length; i++) {\r\n                        var templateLeadingWhitespace = getLeadingWhitespace(lines[i]);\r\n                        lines[i] = model.normalizeIndentation(lineLeadingWhitespace + templateLeadingWhitespace) + lines[i].substr(templateLeadingWhitespace.length);\r\n                    }\r\n                }\r\n                if (adjustNewlines) {\r\n                    var newValue = lines.join(model.getEOL());\r\n                    if (newValue !== marker.value) {\r\n                        marker.parent.replace(marker, [new Text(newValue)]);\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n    };\r\n    SnippetSession.adjustSelection = function (model, selection, overwriteBefore, overwriteAfter) {\r\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\r\n            // overwrite[Before|After] is compute using the position, not the whole\r\n            // selection. therefore we adjust the selection around that position\r\n            var positionLineNumber = selection.positionLineNumber, positionColumn = selection.positionColumn;\r\n            var positionColumnBefore = positionColumn - overwriteBefore;\r\n            var positionColumnAfter = positionColumn + overwriteAfter;\r\n            var range = model.validateRange({\r\n                startLineNumber: positionLineNumber,\r\n                startColumn: positionColumnBefore,\r\n                endLineNumber: positionLineNumber,\r\n                endColumn: positionColumnAfter\r\n            });\r\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\r\n        }\r\n        return selection;\r\n    };\r\n    SnippetSession.createEditsAndSnippets = function (editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText) {\r\n        var edits = [];\r\n        var snippets = [];\r\n        if (!editor.hasModel()) {\r\n            return { edits: edits, snippets: snippets };\r\n        }\r\n        var model = editor.getModel();\r\n        var workspaceService = editor.invokeWithinContext(function (accessor) { return accessor.get(IWorkspaceContextService, optional); });\r\n        var modelBasedVariableResolver = editor.invokeWithinContext(function (accessor) { return new ModelBasedVariableResolver(accessor.get(ILabelService, optional), model); });\r\n        var clipboardService = editor.invokeWithinContext(function (accessor) { return accessor.get(IClipboardService, optional); });\r\n        var readClipboardText = function () { return clipboardText || clipboardService && clipboardService.readTextSync(); };\r\n        var delta = 0;\r\n        // know what text the overwrite[Before|After] extensions\r\n        // of the primary curser have selected because only when\r\n        // secondary selections extend to the same text we can grow them\r\n        var firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\r\n        var firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\r\n        // remember the first non-whitespace column to decide if\r\n        // `keepWhitespace` should be overruled for secondary selections\r\n        var firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\r\n        // sort selections by their start position but remeber\r\n        // the original index. that allows you to create correct\r\n        // offset-based selection logic without changing the\r\n        // primary selection\r\n        var indexedSelections = editor.getSelections()\r\n            .map(function (selection, idx) { return ({ selection: selection, idx: idx }); })\r\n            .sort(function (a, b) { return Range.compareRangesUsingStarts(a.selection, b.selection); });\r\n        for (var _i = 0, indexedSelections_1 = indexedSelections; _i < indexedSelections_1.length; _i++) {\r\n            var _a = indexedSelections_1[_i], selection = _a.selection, idx = _a.idx;\r\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\r\n            // compare if this matches the extensions of the primary selection\r\n            var extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\r\n            var extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\r\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\r\n                extensionBefore = selection;\r\n            }\r\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\r\n                extensionAfter = selection;\r\n            }\r\n            // merge the before and after selection into one\r\n            var snippetSelection = selection\r\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\r\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\r\n            var snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\r\n            // adjust the template string to match the indentation and\r\n            // whitespace rules of this insert location (can be different for each cursor)\r\n            // happens when being asked for (default) or when this is a secondary\r\n            // cursor and the leading whitespace is different\r\n            var start = snippetSelection.getStartPosition();\r\n            SnippetSession.adjustWhitespace(model, start, snippet, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), true);\r\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\r\n                modelBasedVariableResolver,\r\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(60 /* multiCursorPaste */) === 'spread'),\r\n                new SelectionBasedVariableResolver(model, selection),\r\n                new CommentBasedVariableResolver(model),\r\n                new TimeBasedVariableResolver,\r\n                new WorkspaceBasedVariableResolver(workspaceService),\r\n                new RandomBasedVariableResolver,\r\n            ]));\r\n            var offset = model.getOffsetAt(start) + delta;\r\n            delta += snippet.toString().length - model.getValueLengthInRange(snippetSelection);\r\n            // store snippets with the index of their originating selection.\r\n            // that ensures the primiary cursor stays primary despite not being\r\n            // the one with lowest start position\r\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\r\n            snippets[idx] = new OneSnippet(editor, snippet, offset);\r\n        }\r\n        return { edits: edits, snippets: snippets };\r\n    };\r\n    SnippetSession.prototype.dispose = function () {\r\n        dispose(this._snippets);\r\n    };\r\n    SnippetSession.prototype._logInfo = function () {\r\n        return \"template=\\\"\" + this._template + \"\\\", merged_templates=\\\"\" + this._templateMerges.join(' -> ') + \"\\\"\";\r\n    };\r\n    SnippetSession.prototype.insert = function () {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // make insert edit and start with first selections\r\n        var _a = SnippetSession.createEditsAndSnippets(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText), edits = _a.edits, snippets = _a.snippets;\r\n        this._snippets = snippets;\r\n        this._editor.executeEdits('snippet', edits, function (undoEdits) {\r\n            if (_this._snippets[0].hasPlaceholder) {\r\n                return _this._move(true);\r\n            }\r\n            else {\r\n                return undoEdits.map(function (edit) { return Selection.fromPositions(edit.range.getEndPosition()); });\r\n            }\r\n        });\r\n        this._editor.revealRange(this._editor.getSelections()[0]);\r\n    };\r\n    SnippetSession.prototype.merge = function (template, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = _defaultOptions; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\r\n        var _a = SnippetSession.createEditsAndSnippets(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText), edits = _a.edits, snippets = _a.snippets;\r\n        this._editor.executeEdits('snippet', edits, function (undoEdits) {\r\n            for (var _i = 0, _a = _this._snippets; _i < _a.length; _i++) {\r\n                var snippet = _a[_i];\r\n                snippet.merge(snippets);\r\n            }\r\n            console.assert(snippets.length === 0);\r\n            if (_this._snippets[0].hasPlaceholder) {\r\n                return _this._move(undefined);\r\n            }\r\n            else {\r\n                return undoEdits.map(function (edit) { return Selection.fromPositions(edit.range.getEndPosition()); });\r\n            }\r\n        });\r\n    };\r\n    SnippetSession.prototype.next = function () {\r\n        var newSelections = this._move(true);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    };\r\n    SnippetSession.prototype.prev = function () {\r\n        var newSelections = this._move(false);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    };\r\n    SnippetSession.prototype._move = function (fwd) {\r\n        var selections = [];\r\n        for (var _i = 0, _a = this._snippets; _i < _a.length; _i++) {\r\n            var snippet = _a[_i];\r\n            var oneSelection = snippet.move(fwd);\r\n            selections.push.apply(selections, oneSelection);\r\n        }\r\n        return selections;\r\n    };\r\n    Object.defineProperty(SnippetSession.prototype, \"isAtFirstPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].isAtFirstPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"isAtLastPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].isAtLastPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"hasPlaceholder\", {\r\n        get: function () {\r\n            return this._snippets[0].hasPlaceholder;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SnippetSession.prototype, \"choice\", {\r\n        get: function () {\r\n            return this._snippets[0].choice;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SnippetSession.prototype.isSelectionWithinPlaceholders = function () {\r\n        if (!this.hasPlaceholder) {\r\n            return false;\r\n        }\r\n        var selections = this._editor.getSelections();\r\n        if (selections.length < this._snippets.length) {\r\n            // this means we started snippet mode with N\r\n            // selections and have M (N > M) selections.\r\n            // So one snippet is without selection -> cancel\r\n            return false;\r\n        }\r\n        var allPossibleSelections = new Map();\r\n        var _loop_1 = function (snippet) {\r\n            var possibleSelections = snippet.computePossibleSelections();\r\n            // for the first snippet find the placeholder (and its ranges)\r\n            // that contain at least one selection. for all remaining snippets\r\n            // the same placeholder (and their ranges) must be used.\r\n            if (allPossibleSelections.size === 0) {\r\n                possibleSelections.forEach(function (ranges, index) {\r\n                    ranges.sort(Range.compareRangesUsingStarts);\r\n                    for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n                        var selection = selections_1[_i];\r\n                        if (ranges[0].containsRange(selection)) {\r\n                            allPossibleSelections.set(index, []);\r\n                            break;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            if (allPossibleSelections.size === 0) {\r\n                return { value: false };\r\n            }\r\n            // add selections from 'this' snippet so that we know all\r\n            // selections for this placeholder\r\n            allPossibleSelections.forEach(function (array, index) {\r\n                array.push.apply(array, possibleSelections.get(index));\r\n            });\r\n        };\r\n        for (var _i = 0, _a = this._snippets; _i < _a.length; _i++) {\r\n            var snippet = _a[_i];\r\n            var state_1 = _loop_1(snippet);\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        // sort selections (and later placeholder-ranges). then walk both\r\n        // arrays and make sure the placeholder-ranges contain the corresponding\r\n        // selection\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        allPossibleSelections.forEach(function (ranges, index) {\r\n            if (ranges.length !== selections.length) {\r\n                allPossibleSelections.delete(index);\r\n                return;\r\n            }\r\n            ranges.sort(Range.compareRangesUsingStarts);\r\n            for (var i = 0; i < ranges.length; i++) {\r\n                if (!ranges[i].containsRange(selections[i])) {\r\n                    allPossibleSelections.delete(index);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        // from all possible selections we have deleted those\r\n        // that don't match with the current selection. if we don't\r\n        // have any left, we don't have a selection anymore\r\n        return allPossibleSelections.size > 0;\r\n    };\r\n    return SnippetSession;\r\n}());\r\nexport { SnippetSession };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { repeat } from '../../../base/common/strings.js';\r\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { showSimpleSuggestions } from '../suggest/suggest.js';\r\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { SnippetSession } from './snippetSession.js';\r\nvar _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    undoStopBefore: true,\r\n    undoStopAfter: true,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined\r\n};\r\nvar SnippetController2 = /** @class */ (function () {\r\n    function SnippetController2(_editor, _logService, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._logService = _logService;\r\n        this._snippetListener = new DisposableStore();\r\n        this._modelVersionId = -1;\r\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\r\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\r\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\r\n    }\r\n    SnippetController2.get = function (editor) {\r\n        return editor.getContribution(SnippetController2.ID);\r\n    };\r\n    SnippetController2.prototype.dispose = function () {\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        dispose(this._session);\r\n        this._snippetListener.dispose();\r\n    };\r\n    SnippetController2.prototype.insert = function (template, opts) {\r\n        // this is here to find out more about the yet-not-understood\r\n        // error that sometimes happens when we fail to inserted a nested\r\n        // snippet\r\n        try {\r\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : __assign(__assign({}, _defaultOptions), opts));\r\n        }\r\n        catch (e) {\r\n            this.cancel();\r\n            this._logService.error(e);\r\n            this._logService.error('snippet_error');\r\n            this._logService.error('insert_template=', template);\r\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\r\n        }\r\n    };\r\n    SnippetController2.prototype._doInsert = function (template, opts) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // don't listen while inserting the snippet\r\n        // as that is the inflight state causing cancelation\r\n        this._snippetListener.clear();\r\n        if (opts.undoStopBefore) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        if (!this._session) {\r\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\r\n            this._session = new SnippetSession(this._editor, template, opts);\r\n            this._session.insert();\r\n        }\r\n        else {\r\n            this._session.merge(template, opts);\r\n        }\r\n        if (opts.undoStopAfter) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        this._updateState();\r\n        this._snippetListener.add(this._editor.onDidChangeModelContent(function (e) { return e.isFlush && _this.cancel(); }));\r\n        this._snippetListener.add(this._editor.onDidChangeModel(function () { return _this.cancel(); }));\r\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(function () { return _this._updateState(); }));\r\n    };\r\n    SnippetController2.prototype._updateState = function () {\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            // canceled in the meanwhile\r\n            return;\r\n        }\r\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\r\n            // undo until the 'before' state happened\r\n            // and makes use cancel snippet mode\r\n            return this.cancel();\r\n        }\r\n        if (!this._session.hasPlaceholder) {\r\n            // don't listen for selection changes and don't\r\n            // update context keys when the snippet is plain text\r\n            return this.cancel();\r\n        }\r\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\r\n            return this.cancel();\r\n        }\r\n        this._inSnippet.set(true);\r\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\r\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\r\n        this._handleChoice();\r\n    };\r\n    SnippetController2.prototype._handleChoice = function () {\r\n        var _this = this;\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        var choice = this._session.choice;\r\n        if (!choice) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        if (this._currentChoice !== choice) {\r\n            this._currentChoice = choice;\r\n            this._editor.setSelections(this._editor.getSelections()\r\n                .map(function (s) { return Selection.fromPositions(s.getStartPosition()); }));\r\n            var first_1 = choice.options[0];\r\n            showSimpleSuggestions(this._editor, choice.options.map(function (option, i) {\r\n                // let before = choice.options.slice(0, i);\r\n                // let after = choice.options.slice(i);\r\n                return {\r\n                    kind: 13 /* Value */,\r\n                    label: option.value,\r\n                    insertText: option.value,\r\n                    // insertText: `\\${1|${after.concat(before).join(',')}|}$0`,\r\n                    // snippetType: 'textmate',\r\n                    sortText: repeat('a', i + 1),\r\n                    range: Range.fromPositions(_this._editor.getPosition(), _this._editor.getPosition().delta(0, first_1.value.length))\r\n                };\r\n            }));\r\n        }\r\n    };\r\n    SnippetController2.prototype.finish = function () {\r\n        while (this._inSnippet.get()) {\r\n            this.next();\r\n        }\r\n    };\r\n    SnippetController2.prototype.cancel = function (resetSelection) {\r\n        if (resetSelection === void 0) { resetSelection = false; }\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        this._snippetListener.clear();\r\n        dispose(this._session);\r\n        this._session = undefined;\r\n        this._modelVersionId = -1;\r\n        if (resetSelection) {\r\n            // reset selection to the primary cursor when being asked\r\n            // for. this happens when explicitly cancelling snippet mode,\r\n            // e.g. when pressing ESC\r\n            this._editor.setSelections([this._editor.getSelection()]);\r\n        }\r\n    };\r\n    SnippetController2.prototype.prev = function () {\r\n        if (this._session) {\r\n            this._session.prev();\r\n        }\r\n        this._updateState();\r\n    };\r\n    SnippetController2.prototype.next = function () {\r\n        if (this._session) {\r\n            this._session.next();\r\n        }\r\n        this._updateState();\r\n    };\r\n    SnippetController2.prototype.isInSnippet = function () {\r\n        return Boolean(this._inSnippet.get());\r\n    };\r\n    SnippetController2.ID = 'snippetController2';\r\n    SnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false);\r\n    SnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false);\r\n    SnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false);\r\n    SnippetController2 = __decorate([\r\n        __param(1, ILogService),\r\n        __param(2, IContextKeyService)\r\n    ], SnippetController2);\r\n    return SnippetController2;\r\n}());\r\nexport { SnippetController2 };\r\nregisterEditorContribution(SnippetController2.ID, SnippetController2);\r\nvar CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToNextSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\r\n    handler: function (ctrl) { return ctrl.next(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToPrevSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\r\n    handler: function (ctrl) { return ctrl.prev(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'leaveSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: function (ctrl) { return ctrl.cancel(true); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'acceptSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: function (ctrl) { return ctrl.finish(); },\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { LRUCache, TernarySearchTree } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { completionKindFromString } from '../../common/modes.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nvar Memory = /** @class */ (function () {\r\n    function Memory() {\r\n    }\r\n    Memory.prototype.select = function (model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        var topScore = items[0].score[0];\r\n        for (var i = 1; i < items.length; i++) {\r\n            var _a = items[i], score = _a.score, suggestion = _a.completion;\r\n            if (score[0] !== topScore) {\r\n                // stop when leaving the group of top matches\r\n                break;\r\n            }\r\n            if (suggestion.preselect) {\r\n                // stop when seeing an auto-select-item\r\n                return i;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    return Memory;\r\n}());\r\nexport { Memory };\r\nvar NoMemory = /** @class */ (function (_super) {\r\n    __extends(NoMemory, _super);\r\n    function NoMemory() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    NoMemory.prototype.memorize = function (model, pos, item) {\r\n        // no-op\r\n    };\r\n    NoMemory.prototype.toJSON = function () {\r\n        return undefined;\r\n    };\r\n    NoMemory.prototype.fromJSON = function () {\r\n        //\r\n    };\r\n    return NoMemory;\r\n}(Memory));\r\nexport { NoMemory };\r\nvar LRUMemory = /** @class */ (function (_super) {\r\n    __extends(LRUMemory, _super);\r\n    function LRUMemory() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._cache = new LRUCache(300, 0.66);\r\n        _this._seq = 0;\r\n        return _this;\r\n    }\r\n    LRUMemory.prototype.memorize = function (model, pos, item) {\r\n        var label = item.completion.label;\r\n        var key = model.getLanguageIdentifier().language + \"/\" + label;\r\n        this._cache.set(key, {\r\n            touch: this._seq++,\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText\r\n        });\r\n    };\r\n    LRUMemory.prototype.select = function (model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        var lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\r\n        if (/\\s$/.test(lineSuffix)) {\r\n            return _super.prototype.select.call(this, model, pos, items);\r\n        }\r\n        var topScore = items[0].score[0];\r\n        var indexPreselect = -1;\r\n        var indexRecency = -1;\r\n        var seq = -1;\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (items[i].score[0] !== topScore) {\r\n                // consider only top items\r\n                break;\r\n            }\r\n            var key = model.getLanguageIdentifier().language + \"/\" + items[i].completion.label;\r\n            var item = this._cache.peek(key);\r\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\r\n                seq = item.touch;\r\n                indexRecency = i;\r\n            }\r\n            if (items[i].completion.preselect && indexPreselect === -1) {\r\n                // stop when seeing an auto-select-item\r\n                return indexPreselect = i;\r\n            }\r\n        }\r\n        if (indexRecency !== -1) {\r\n            return indexRecency;\r\n        }\r\n        else if (indexPreselect !== -1) {\r\n            return indexPreselect;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    LRUMemory.prototype.toJSON = function () {\r\n        var data = [];\r\n        this._cache.forEach(function (value, key) {\r\n            data.push([key, value]);\r\n        });\r\n        return data;\r\n    };\r\n    LRUMemory.prototype.fromJSON = function (data) {\r\n        this._cache.clear();\r\n        var seq = 0;\r\n        for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\r\n            var _a = data_1[_i], key = _a[0], value = _a[1];\r\n            value.touch = seq;\r\n            value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n            this._cache.set(key, value);\r\n        }\r\n        this._seq = this._cache.size;\r\n    };\r\n    return LRUMemory;\r\n}(Memory));\r\nexport { LRUMemory };\r\nvar PrefixMemory = /** @class */ (function (_super) {\r\n    __extends(PrefixMemory, _super);\r\n    function PrefixMemory() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._trie = TernarySearchTree.forStrings();\r\n        _this._seq = 0;\r\n        return _this;\r\n    }\r\n    PrefixMemory.prototype.memorize = function (model, pos, item) {\r\n        var word = model.getWordUntilPosition(pos).word;\r\n        var key = model.getLanguageIdentifier().language + \"/\" + word;\r\n        this._trie.set(key, {\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText,\r\n            touch: this._seq++\r\n        });\r\n    };\r\n    PrefixMemory.prototype.select = function (model, pos, items) {\r\n        var word = model.getWordUntilPosition(pos).word;\r\n        if (!word) {\r\n            return _super.prototype.select.call(this, model, pos, items);\r\n        }\r\n        var key = model.getLanguageIdentifier().language + \"/\" + word;\r\n        var item = this._trie.get(key);\r\n        if (!item) {\r\n            item = this._trie.findSubstr(key);\r\n        }\r\n        if (item) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var _a = items[i].completion, kind = _a.kind, insertText = _a.insertText;\r\n                if (kind === item.type && insertText === item.insertText) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return _super.prototype.select.call(this, model, pos, items);\r\n    };\r\n    PrefixMemory.prototype.toJSON = function () {\r\n        var entries = [];\r\n        this._trie.forEach(function (value, key) { return entries.push([key, value]); });\r\n        // sort by last recently used (touch), then\r\n        // take the top 200 item and normalize their\r\n        // touch\r\n        entries\r\n            .sort(function (a, b) { return -(a[1].touch - b[1].touch); })\r\n            .forEach(function (value, i) { return value[1].touch = i; });\r\n        return entries.slice(0, 200);\r\n    };\r\n    PrefixMemory.prototype.fromJSON = function (data) {\r\n        this._trie.clear();\r\n        if (data.length > 0) {\r\n            this._seq = data[0][1].touch + 1;\r\n            for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\r\n                var _a = data_2[_i], key = _a[0], value = _a[1];\r\n                value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n                this._trie.set(key, value);\r\n            }\r\n        }\r\n    };\r\n    return PrefixMemory;\r\n}(Memory));\r\nexport { PrefixMemory };\r\nvar SuggestMemoryService = /** @class */ (function (_super) {\r\n    __extends(SuggestMemoryService, _super);\r\n    function SuggestMemoryService(_storageService, _configService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._storageService = _storageService;\r\n        _this._configService = _configService;\r\n        _this._storagePrefix = 'suggest/memories';\r\n        var update = function () {\r\n            var mode = _this._configService.getValue('editor.suggestSelection');\r\n            var share = _this._configService.getValue('editor.suggest.shareSuggestSelections');\r\n            _this._update(mode, share, false);\r\n        };\r\n        _this._persistSoon = _this._register(new RunOnceScheduler(function () { return _this._saveState(); }, 500));\r\n        _this._register(_storageService.onWillSaveState(function (e) {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                _this._saveState();\r\n            }\r\n        }));\r\n        _this._register(_this._configService.onDidChangeConfiguration(function (e) {\r\n            if (e.affectsConfiguration('editor.suggestSelection') || e.affectsConfiguration('editor.suggest.shareSuggestSelections')) {\r\n                update();\r\n            }\r\n        }));\r\n        _this._register(_this._storageService.onDidChangeStorage(function (e) {\r\n            if (e.scope === 0 /* GLOBAL */ && e.key.indexOf(_this._storagePrefix) === 0) {\r\n                if (!document.hasFocus()) {\r\n                    // windows that aren't focused have to drop their current\r\n                    // storage value and accept what's stored now\r\n                    _this._update(_this._mode, _this._shareMem, true);\r\n                }\r\n            }\r\n        }));\r\n        update();\r\n        return _this;\r\n    }\r\n    SuggestMemoryService.prototype._update = function (mode, shareMem, force) {\r\n        if (!force && this._mode === mode && this._shareMem === shareMem) {\r\n            return;\r\n        }\r\n        this._shareMem = shareMem;\r\n        this._mode = mode;\r\n        this._strategy = mode === 'recentlyUsedByPrefix' ? new PrefixMemory() : mode === 'recentlyUsed' ? new LRUMemory() : new NoMemory();\r\n        try {\r\n            var scope = shareMem ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n            var raw = this._storageService.get(this._storagePrefix + \"/\" + this._mode, scope);\r\n            if (raw) {\r\n                this._strategy.fromJSON(JSON.parse(raw));\r\n            }\r\n        }\r\n        catch (e) {\r\n            // things can go wrong with JSON...\r\n        }\r\n    };\r\n    SuggestMemoryService.prototype.memorize = function (model, pos, item) {\r\n        this._strategy.memorize(model, pos, item);\r\n        this._persistSoon.schedule();\r\n    };\r\n    SuggestMemoryService.prototype.select = function (model, pos, items) {\r\n        return this._strategy.select(model, pos, items);\r\n    };\r\n    SuggestMemoryService.prototype._saveState = function () {\r\n        var raw = JSON.stringify(this._strategy);\r\n        var scope = this._shareMem ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n        this._storageService.store(this._storagePrefix + \"/\" + this._mode, raw, scope);\r\n    };\r\n    SuggestMemoryService = __decorate([\r\n        __param(0, IStorageService),\r\n        __param(1, IConfigurationService)\r\n    ], SuggestMemoryService);\r\n    return SuggestMemoryService;\r\n}(Disposable));\r\nexport { SuggestMemoryService };\r\nexport var ISuggestMemoryService = createDecorator('ISuggestMemories');\r\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, true);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nvar SuggestAlternatives = /** @class */ (function () {\r\n    function SuggestAlternatives(_editor, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._index = 0;\r\n        this._ckOtherSuggestions = SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\r\n    }\r\n    SuggestAlternatives.prototype.dispose = function () {\r\n        this.reset();\r\n    };\r\n    SuggestAlternatives.prototype.reset = function () {\r\n        this._ckOtherSuggestions.reset();\r\n        dispose(this._listener);\r\n        this._model = undefined;\r\n        this._acceptNext = undefined;\r\n        this._ignore = false;\r\n    };\r\n    SuggestAlternatives.prototype.set = function (_a, acceptNext) {\r\n        var _this = this;\r\n        var model = _a.model, index = _a.index;\r\n        // no suggestions -> nothing to do\r\n        if (model.items.length === 0) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        // no alternative suggestions -> nothing to do\r\n        var nextIndex = SuggestAlternatives._moveIndex(true, model, index);\r\n        if (nextIndex === index) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._acceptNext = acceptNext;\r\n        this._model = model;\r\n        this._index = index;\r\n        this._listener = this._editor.onDidChangeCursorPosition(function () {\r\n            if (!_this._ignore) {\r\n                _this.reset();\r\n            }\r\n        });\r\n        this._ckOtherSuggestions.set(true);\r\n    };\r\n    SuggestAlternatives._moveIndex = function (fwd, model, index) {\r\n        var newIndex = index;\r\n        while (true) {\r\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\r\n            if (newIndex === index) {\r\n                break;\r\n            }\r\n            if (!model.items[newIndex].completion.additionalTextEdits) {\r\n                break;\r\n            }\r\n        }\r\n        return newIndex;\r\n    };\r\n    SuggestAlternatives.prototype.next = function () {\r\n        this._move(true);\r\n    };\r\n    SuggestAlternatives.prototype.prev = function () {\r\n        this._move(false);\r\n    };\r\n    SuggestAlternatives.prototype._move = function (fwd) {\r\n        if (!this._model) {\r\n            // nothing to reason about\r\n            return;\r\n        }\r\n        try {\r\n            this._ignore = true;\r\n            this._index = SuggestAlternatives._moveIndex(fwd, this._model, this._index);\r\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\r\n        }\r\n        finally {\r\n            this._ignore = false;\r\n        }\r\n    };\r\n    SuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\r\n    SuggestAlternatives = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], SuggestAlternatives);\r\n    return SuggestAlternatives;\r\n}());\r\nexport { SuggestAlternatives };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { fuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScore, anyScore } from '../../../base/common/filters.js';\r\nimport { compareIgnoreCase } from '../../../base/common/strings.js';\r\nvar LineContext = /** @class */ (function () {\r\n    function LineContext(leadingLineContent, characterCountDelta) {\r\n        this.leadingLineContent = leadingLineContent;\r\n        this.characterCountDelta = characterCountDelta;\r\n    }\r\n    return LineContext;\r\n}());\r\nexport { LineContext };\r\nvar CompletionModel = /** @class */ (function () {\r\n    function CompletionModel(items, column, lineContext, wordDistance, options, snippetSuggestions) {\r\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\r\n        this._items = items;\r\n        this._column = column;\r\n        this._wordDistance = wordDistance;\r\n        this._options = options;\r\n        this._refilterKind = 1 /* All */;\r\n        this._lineContext = lineContext;\r\n        if (snippetSuggestions === 'top') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\r\n        }\r\n        else if (snippetSuggestions === 'bottom') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\r\n        }\r\n    }\r\n    Object.defineProperty(CompletionModel.prototype, \"lineContext\", {\r\n        get: function () {\r\n            return this._lineContext;\r\n        },\r\n        set: function (value) {\r\n            if (this._lineContext.leadingLineContent !== value.leadingLineContent\r\n                || this._lineContext.characterCountDelta !== value.characterCountDelta) {\r\n                this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Incr */ : 1 /* All */;\r\n                this._lineContext = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompletionModel.prototype, \"items\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._filteredItems;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompletionModel.prototype, \"incomplete\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._isIncomplete;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CompletionModel.prototype.adopt = function (except) {\r\n        var res = new Array();\r\n        for (var i = 0; i < this._items.length;) {\r\n            if (!except.has(this._items[i].provider)) {\r\n                res.push(this._items[i]);\r\n                // unordered removed\r\n                this._items[i] = this._items[this._items.length - 1];\r\n                this._items.pop();\r\n            }\r\n            else {\r\n                // continue with next item\r\n                i++;\r\n            }\r\n        }\r\n        this._refilterKind = 1 /* All */;\r\n        return res;\r\n    };\r\n    Object.defineProperty(CompletionModel.prototype, \"stats\", {\r\n        get: function () {\r\n            this._ensureCachedState();\r\n            return this._stats;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CompletionModel.prototype._ensureCachedState = function () {\r\n        if (this._refilterKind !== 0 /* Nothing */) {\r\n            this._createCachedState();\r\n        }\r\n    };\r\n    CompletionModel.prototype._createCachedState = function () {\r\n        this._isIncomplete = new Set();\r\n        this._stats = { suggestionCount: 0, snippetCount: 0, textCount: 0 };\r\n        var _a = this._lineContext, leadingLineContent = _a.leadingLineContent, characterCountDelta = _a.characterCountDelta;\r\n        var word = '';\r\n        var wordLow = '';\r\n        // incrementally filter less\r\n        var source = this._refilterKind === 1 /* All */ ? this._items : this._filteredItems;\r\n        var target = [];\r\n        // picks a score function based on the number of\r\n        // items that we have to score/filter and based on the\r\n        // user-configuration\r\n        var scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\r\n        for (var i = 0; i < source.length; i++) {\r\n            var item = source[i];\r\n            // collect those supports that signaled having\r\n            // an incomplete result\r\n            if (item.container.incomplete) {\r\n                this._isIncomplete.add(item.provider);\r\n            }\r\n            // 'word' is that remainder of the current line that we\r\n            // filter and score against. In theory each suggestion uses a\r\n            // different word, but in practice not - that's why we cache\r\n            var overwriteBefore = item.position.column - item.editStart.column;\r\n            var wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\r\n            if (word.length !== wordLen) {\r\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\r\n                wordLow = word.toLowerCase();\r\n            }\r\n            // remember the word against which this item was\r\n            // scored\r\n            item.word = word;\r\n            if (wordLen === 0) {\r\n                // when there is nothing to score against, don't\r\n                // event try to do. Use a const rank and rely on\r\n                // the fallback-sort using the initial sort order.\r\n                // use a score of `-100` because that is out of the\r\n                // bound of values `fuzzyScore` will return\r\n                item.score = FuzzyScore.Default;\r\n            }\r\n            else {\r\n                // skip word characters that are whitespace until\r\n                // we have hit the replace range (overwriteBefore)\r\n                var wordPos = 0;\r\n                while (wordPos < overwriteBefore) {\r\n                    var ch = word.charCodeAt(wordPos);\r\n                    if (ch === 32 /* Space */ || ch === 9 /* Tab */) {\r\n                        wordPos += 1;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n                var textLabel = typeof item.completion.label === 'string' ? item.completion.label : item.completion.label.name;\r\n                if (wordPos >= wordLen) {\r\n                    // the wordPos at which scoring starts is the whole word\r\n                    // and therefore the same rules as not having a word apply\r\n                    item.score = FuzzyScore.Default;\r\n                }\r\n                else if (typeof item.completion.filterText === 'string') {\r\n                    // when there is a `filterText` it must match the `word`.\r\n                    // if it matches we check with the label to compute highlights\r\n                    // and if that doesn't yield a result we have no highlights,\r\n                    // despite having the match\r\n                    var match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    if (compareIgnoreCase(item.completion.filterText, textLabel) === 0) {\r\n                        // filterText and label are actually the same -> use good highlights\r\n                        item.score = match;\r\n                    }\r\n                    else {\r\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\r\n                        // of the filterText-match\r\n                        item.score = anyScore(word, wordLow, wordPos, textLabel, item.labelLow, 0);\r\n                        item.score[0] = match[0]; // use score from filterText\r\n                    }\r\n                }\r\n                else {\r\n                    // by default match `word` against the `label`\r\n                    var match = scoreFn(word, wordLow, wordPos, textLabel, item.labelLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    item.score = match;\r\n                }\r\n            }\r\n            item.idx = i;\r\n            item.distance = this._wordDistance.distance(item.position, item.completion);\r\n            target.push(item);\r\n            // update stats\r\n            this._stats.suggestionCount++;\r\n            switch (item.completion.kind) {\r\n                case 25 /* Snippet */:\r\n                    this._stats.snippetCount++;\r\n                    break;\r\n                case 18 /* Text */:\r\n                    this._stats.textCount++;\r\n                    break;\r\n            }\r\n        }\r\n        this._filteredItems = target.sort(this._snippetCompareFn);\r\n        this._refilterKind = 0 /* Nothing */;\r\n    };\r\n    CompletionModel._compareCompletionItems = function (a, b) {\r\n        if (a.score[0] > b.score[0]) {\r\n            return -1;\r\n        }\r\n        else if (a.score[0] < b.score[0]) {\r\n            return 1;\r\n        }\r\n        else if (a.distance < b.distance) {\r\n            return -1;\r\n        }\r\n        else if (a.distance > b.distance) {\r\n            return 1;\r\n        }\r\n        else if (a.idx < b.idx) {\r\n            return -1;\r\n        }\r\n        else if (a.idx > b.idx) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    CompletionModel._compareCompletionItemsSnippetsDown = function (a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 25 /* Snippet */) {\r\n                return 1;\r\n            }\r\n            else if (b.completion.kind === 25 /* Snippet */) {\r\n                return -1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    };\r\n    CompletionModel._compareCompletionItemsSnippetsUp = function (a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 25 /* Snippet */) {\r\n                return -1;\r\n            }\r\n            else if (b.completion.kind === 25 /* Snippet */) {\r\n                return 1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    };\r\n    return CompletionModel;\r\n}());\r\nexport { CompletionModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { binarySearch, isFalsyOrEmpty } from '../../../base/common/arrays.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { BracketSelectionRangeProvider } from '../smartSelect/bracketSelections.js';\r\nvar WordDistance = /** @class */ (function () {\r\n    function WordDistance() {\r\n    }\r\n    WordDistance.create = function (service, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var model, position, ranges, wordRanges;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.getOption(89 /* suggest */).localityBonus) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        if (!editor.hasModel()) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        model = editor.getModel();\r\n                        position = editor.getPosition();\r\n                        if (!service.canComputeWordRanges(model.uri)) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        return [4 /*yield*/, new BracketSelectionRangeProvider().provideSelectionRanges(model, [position])];\r\n                    case 1:\r\n                        ranges = _a.sent();\r\n                        if (!ranges || ranges.length === 0 || ranges[0].length === 0) {\r\n                            return [2 /*return*/, WordDistance.None];\r\n                        }\r\n                        return [4 /*yield*/, service.computeWordRanges(model.uri, ranges[0][0].range)];\r\n                    case 2:\r\n                        wordRanges = _a.sent();\r\n                        return [2 /*return*/, new /** @class */ (function (_super) {\r\n                                __extends(class_1, _super);\r\n                                function class_1() {\r\n                                    return _super !== null && _super.apply(this, arguments) || this;\r\n                                }\r\n                                class_1.prototype.distance = function (anchor, suggestion) {\r\n                                    if (!wordRanges || !position.equals(editor.getPosition())) {\r\n                                        return 0;\r\n                                    }\r\n                                    if (suggestion.kind === 17 /* Keyword */) {\r\n                                        return 2 << 20;\r\n                                    }\r\n                                    var word = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.name;\r\n                                    var wordLines = wordRanges[word];\r\n                                    if (isFalsyOrEmpty(wordLines)) {\r\n                                        return 2 << 20;\r\n                                    }\r\n                                    var idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\r\n                                    var bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\r\n                                    var blockDistance = ranges.length;\r\n                                    for (var _i = 0, _a = ranges[0]; _i < _a.length; _i++) {\r\n                                        var range = _a[_i];\r\n                                        if (!Range.containsRange(range.range, bestWordRange)) {\r\n                                            break;\r\n                                        }\r\n                                        blockDistance -= 1;\r\n                                    }\r\n                                    return blockDistance;\r\n                                };\r\n                                return class_1;\r\n                            }(WordDistance))];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    WordDistance.None = new /** @class */ (function (_super) {\r\n        __extends(class_2, _super);\r\n        function class_2() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        class_2.prototype.distance = function () { return 0; };\r\n        return class_2;\r\n    }(WordDistance));\r\n    return WordDistance;\r\n}());\r\nexport { WordDistance };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { dispose, DisposableStore, isDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { CompletionProviderRegistry } from '../../common/modes.js';\r\nimport { CompletionModel } from './completionModel.js';\r\nimport { getSuggestionComparator, provideSuggestionItems, getSnippetSuggestSupport, CompletionOptions } from './suggest.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { WordDistance } from './wordDistance.js';\r\nimport { isLowSurrogate, isHighSurrogate } from '../../../base/common/strings.js';\r\nvar LineContext = /** @class */ (function () {\r\n    function LineContext(model, position, auto, shy) {\r\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\r\n        this.leadingWord = model.getWordUntilPosition(position);\r\n        this.lineNumber = position.lineNumber;\r\n        this.column = position.column;\r\n        this.auto = auto;\r\n        this.shy = shy;\r\n    }\r\n    LineContext.shouldAutoTrigger = function (editor) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        var model = editor.getModel();\r\n        var pos = editor.getPosition();\r\n        model.tokenizeIfCheap(pos.lineNumber);\r\n        var word = model.getWordAtPosition(pos);\r\n        if (!word) {\r\n            return false;\r\n        }\r\n        if (word.endColumn !== pos.column) {\r\n            return false;\r\n        }\r\n        if (!isNaN(Number(word.word))) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    return LineContext;\r\n}());\r\nexport { LineContext };\r\nvar SuggestModel = /** @class */ (function () {\r\n    function SuggestModel(_editor, _editorWorker) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._editorWorker = _editorWorker;\r\n        this._toDispose = new DisposableStore();\r\n        this._quickSuggestDelay = 10;\r\n        this._triggerCharacterListener = new DisposableStore();\r\n        this._triggerQuickSuggest = new TimeoutTimer();\r\n        this._state = 0 /* Idle */;\r\n        this._completionDisposables = new DisposableStore();\r\n        this._onDidCancel = new Emitter();\r\n        this._onDidTrigger = new Emitter();\r\n        this._onDidSuggest = new Emitter();\r\n        this.onDidCancel = this._onDidCancel.event;\r\n        this.onDidTrigger = this._onDidTrigger.event;\r\n        this.onDidSuggest = this._onDidSuggest.event;\r\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\r\n        // wire up various listeners\r\n        this._toDispose.add(this._editor.onDidChangeModel(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeConfiguration(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this._updateQuickSuggest();\r\n        }));\r\n        this._toDispose.add(CompletionProviderRegistry.onDidChange(function () {\r\n            _this._updateTriggerCharacters();\r\n            _this._updateActiveSuggestSession();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(function (e) {\r\n            _this._onCursorChange(e);\r\n        }));\r\n        var editorIsComposing = false;\r\n        this._toDispose.add(this._editor.onDidCompositionStart(function () {\r\n            editorIsComposing = true;\r\n        }));\r\n        this._toDispose.add(this._editor.onDidCompositionEnd(function () {\r\n            // refilter when composition ends\r\n            editorIsComposing = false;\r\n            _this._refilterCompletionItems();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelContent(function () {\r\n            // only filter completions when the editor isn't\r\n            // composing a character, e.g. ¨ + u makes ü but just\r\n            // ¨ cannot be used for filtering\r\n            if (!editorIsComposing) {\r\n                _this._refilterCompletionItems();\r\n            }\r\n        }));\r\n        this._updateTriggerCharacters();\r\n        this._updateQuickSuggest();\r\n    }\r\n    SuggestModel.prototype.dispose = function () {\r\n        dispose(this._triggerCharacterListener);\r\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\r\n        this._toDispose.dispose();\r\n        this._completionDisposables.dispose();\r\n        this.cancel();\r\n    };\r\n    // --- handle configuration & precondition changes\r\n    SuggestModel.prototype._updateQuickSuggest = function () {\r\n        this._quickSuggestDelay = this._editor.getOption(67 /* quickSuggestionsDelay */);\r\n        if (isNaN(this._quickSuggestDelay) || (!this._quickSuggestDelay && this._quickSuggestDelay !== 0) || this._quickSuggestDelay < 0) {\r\n            this._quickSuggestDelay = 10;\r\n        }\r\n    };\r\n    SuggestModel.prototype._updateTriggerCharacters = function () {\r\n        var _this = this;\r\n        this._triggerCharacterListener.clear();\r\n        if (this._editor.getOption(68 /* readOnly */)\r\n            || !this._editor.hasModel()\r\n            || !this._editor.getOption(92 /* suggestOnTriggerCharacters */)) {\r\n            return;\r\n        }\r\n        var supportsByTriggerCharacter = new Map();\r\n        for (var _i = 0, _a = CompletionProviderRegistry.all(this._editor.getModel()); _i < _a.length; _i++) {\r\n            var support = _a[_i];\r\n            for (var _b = 0, _c = support.triggerCharacters || []; _b < _c.length; _b++) {\r\n                var ch = _c[_b];\r\n                var set = supportsByTriggerCharacter.get(ch);\r\n                if (!set) {\r\n                    set = new Set();\r\n                    set.add(getSnippetSuggestSupport());\r\n                    supportsByTriggerCharacter.set(ch, set);\r\n                }\r\n                set.add(support);\r\n            }\r\n        }\r\n        var checkTriggerCharacter = function (text) {\r\n            if (!text) {\r\n                // came here from the compositionEnd-event\r\n                var position = _this._editor.getPosition();\r\n                var model = _this._editor.getModel();\r\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\r\n            }\r\n            var lastChar = '';\r\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\r\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\r\n                    lastChar = text.substr(text.length - 2);\r\n                }\r\n            }\r\n            else {\r\n                lastChar = text.charAt(text.length - 1);\r\n            }\r\n            var supports = supportsByTriggerCharacter.get(lastChar);\r\n            if (supports) {\r\n                // keep existing items that where not computed by the\r\n                // supports/providers that want to trigger now\r\n                var items = _this._completionModel ? _this._completionModel.adopt(supports) : undefined;\r\n                _this.trigger({ auto: true, shy: false, triggerCharacter: lastChar }, Boolean(_this._completionModel), supports, items);\r\n            }\r\n        };\r\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\r\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(checkTriggerCharacter));\r\n    };\r\n    Object.defineProperty(SuggestModel.prototype, \"state\", {\r\n        // --- trigger/retrigger/cancel suggest\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SuggestModel.prototype.cancel = function (retrigger) {\r\n        if (retrigger === void 0) { retrigger = false; }\r\n        if (this._state !== 0 /* Idle */) {\r\n            this._triggerQuickSuggest.cancel();\r\n            if (this._requestToken) {\r\n                this._requestToken.cancel();\r\n                this._requestToken = undefined;\r\n            }\r\n            this._state = 0 /* Idle */;\r\n            this._completionModel = undefined;\r\n            this._context = undefined;\r\n            this._onDidCancel.fire({ retrigger: retrigger });\r\n        }\r\n    };\r\n    SuggestModel.prototype.clear = function () {\r\n        this._completionDisposables.clear();\r\n    };\r\n    SuggestModel.prototype._updateActiveSuggestSession = function () {\r\n        if (this._state !== 0 /* Idle */) {\r\n            if (!this._editor.hasModel() || !CompletionProviderRegistry.has(this._editor.getModel())) {\r\n                this.cancel();\r\n            }\r\n            else {\r\n                this.trigger({ auto: this._state === 2 /* Auto */, shy: false }, true);\r\n            }\r\n        }\r\n    };\r\n    SuggestModel.prototype._onCursorChange = function (e) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var prevSelection = this._currentSelection;\r\n        this._currentSelection = this._editor.getSelection();\r\n        if (!e.selection.isEmpty()\r\n            || e.reason !== 0 /* NotSet */\r\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\r\n            // Early exit if nothing needs to be done!\r\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (!CompletionProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        if (this._state === 0 /* Idle */) {\r\n            if (this._editor.getOption(66 /* quickSuggestions */) === false) {\r\n                // not enabled\r\n                return;\r\n            }\r\n            if (!prevSelection.containsRange(this._currentSelection) && !prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\r\n                // cursor didn't move RIGHT\r\n                return;\r\n            }\r\n            if (this._editor.getOption(89 /* suggest */).snippetsPreventQuickSuggestions && SnippetController2.get(this._editor).isInSnippet()) {\r\n                // no quick suggestion when in snippet mode\r\n                return;\r\n            }\r\n            this.cancel();\r\n            this._triggerQuickSuggest.cancelAndSet(function () {\r\n                if (_this._state !== 0 /* Idle */) {\r\n                    return;\r\n                }\r\n                if (!LineContext.shouldAutoTrigger(_this._editor)) {\r\n                    return;\r\n                }\r\n                if (!_this._editor.hasModel()) {\r\n                    return;\r\n                }\r\n                var model = _this._editor.getModel();\r\n                var pos = _this._editor.getPosition();\r\n                // validate enabled now\r\n                var quickSuggestions = _this._editor.getOption(66 /* quickSuggestions */);\r\n                if (quickSuggestions === false) {\r\n                    return;\r\n                }\r\n                else if (quickSuggestions === true) {\r\n                    // all good\r\n                }\r\n                else {\r\n                    // Check the type of the token that triggered this\r\n                    model.tokenizeIfCheap(pos.lineNumber);\r\n                    var lineTokens = model.getLineTokens(pos.lineNumber);\r\n                    var tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\r\n                    var inValidScope = quickSuggestions.other && tokenType === 0 /* Other */\r\n                        || quickSuggestions.comments && tokenType === 1 /* Comment */\r\n                        || quickSuggestions.strings && tokenType === 2 /* String */;\r\n                    if (!inValidScope) {\r\n                        return;\r\n                    }\r\n                }\r\n                // we made it till here -> trigger now\r\n                _this.trigger({ auto: true, shy: false });\r\n            }, this._quickSuggestDelay);\r\n        }\r\n    };\r\n    SuggestModel.prototype._refilterCompletionItems = function () {\r\n        var _this = this;\r\n        // Re-filter suggestions. This MUST run async because filtering/scoring\r\n        // uses the model content AND the cursor position. The latter is NOT\r\n        // updated when the document has changed (the event which drives this method)\r\n        // and therefore a little pause (next mirco task) is needed. See:\r\n        // https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context#25933985\r\n        Promise.resolve().then(function () {\r\n            if (_this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            if (!_this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            var model = _this._editor.getModel();\r\n            var position = _this._editor.getPosition();\r\n            var ctx = new LineContext(model, position, _this._state === 2 /* Auto */, false);\r\n            _this._onNewContext(ctx);\r\n        });\r\n    };\r\n    SuggestModel.prototype.trigger = function (context, retrigger, onlyFrom, existingItems) {\r\n        var _this = this;\r\n        if (retrigger === void 0) { retrigger = false; }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var auto = context.auto;\r\n        var ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy);\r\n        // Cancel previous requests, change state & update UI\r\n        this.cancel(retrigger);\r\n        this._state = auto ? 2 /* Auto */ : 1 /* Manual */;\r\n        this._onDidTrigger.fire({ auto: auto, shy: context.shy, position: this._editor.getPosition() });\r\n        // Capture context when request was sent\r\n        this._context = ctx;\r\n        // Build context for request\r\n        var suggestCtx;\r\n        if (context.triggerCharacter) {\r\n            suggestCtx = {\r\n                triggerKind: 1 /* TriggerCharacter */,\r\n                triggerCharacter: context.triggerCharacter\r\n            };\r\n        }\r\n        else if (onlyFrom && onlyFrom.size > 0) {\r\n            suggestCtx = { triggerKind: 2 /* TriggerForIncompleteCompletions */ };\r\n        }\r\n        else {\r\n            suggestCtx = { triggerKind: 0 /* Invoke */ };\r\n        }\r\n        this._requestToken = new CancellationTokenSource();\r\n        // kind filter and snippet sort rules\r\n        var snippetSuggestions = this._editor.getOption(86 /* snippetSuggestions */);\r\n        var snippetSortOrder = 1 /* Inline */;\r\n        switch (snippetSuggestions) {\r\n            case 'top':\r\n                snippetSortOrder = 0 /* Top */;\r\n                break;\r\n            // \t↓ that's the default anyways...\r\n            // case 'inline':\r\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\r\n            // \tbreak;\r\n            case 'bottom':\r\n                snippetSortOrder = 2 /* Bottom */;\r\n                break;\r\n        }\r\n        var itemKindFilter = SuggestModel._createItemKindFilter(this._editor);\r\n        var wordDistance = WordDistance.create(this._editorWorker, this._editor);\r\n        var items = provideSuggestionItems(model, this._editor.getPosition(), new CompletionOptions(snippetSortOrder, itemKindFilter, onlyFrom), suggestCtx, this._requestToken.token);\r\n        Promise.all([items, wordDistance]).then(function (_a) {\r\n            var items = _a[0], wordDistance = _a[1];\r\n            dispose(_this._requestToken);\r\n            if (_this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            if (!_this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            var model = _this._editor.getModel();\r\n            if (isNonEmptyArray(existingItems)) {\r\n                var cmpFn = getSuggestionComparator(snippetSortOrder);\r\n                items = items.concat(existingItems).sort(cmpFn);\r\n            }\r\n            var ctx = new LineContext(model, _this._editor.getPosition(), auto, context.shy);\r\n            _this._completionModel = new CompletionModel(items, _this._context.column, {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - _this._context.column\r\n            }, wordDistance, _this._editor.getOption(89 /* suggest */), _this._editor.getOption(86 /* snippetSuggestions */));\r\n            // store containers so that they can be disposed later\r\n            for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n                var item = items_1[_i];\r\n                if (isDisposable(item.container)) {\r\n                    _this._completionDisposables.add(item.container);\r\n                }\r\n            }\r\n            _this._onNewContext(ctx);\r\n        }).catch(onUnexpectedError);\r\n    };\r\n    SuggestModel._createItemKindFilter = function (editor) {\r\n        // kind filter and snippet sort rules\r\n        var result = new Set();\r\n        // snippet setting\r\n        var snippetSuggestions = editor.getOption(86 /* snippetSuggestions */);\r\n        if (snippetSuggestions === 'none') {\r\n            result.add(25 /* Snippet */);\r\n        }\r\n        // type setting\r\n        var suggestOptions = editor.getOption(89 /* suggest */);\r\n        if (!suggestOptions.showMethods) {\r\n            result.add(0 /* Method */);\r\n        }\r\n        if (!suggestOptions.showFunctions) {\r\n            result.add(1 /* Function */);\r\n        }\r\n        if (!suggestOptions.showConstructors) {\r\n            result.add(2 /* Constructor */);\r\n        }\r\n        if (!suggestOptions.showFields) {\r\n            result.add(3 /* Field */);\r\n        }\r\n        if (!suggestOptions.showVariables) {\r\n            result.add(4 /* Variable */);\r\n        }\r\n        if (!suggestOptions.showClasses) {\r\n            result.add(5 /* Class */);\r\n        }\r\n        if (!suggestOptions.showStructs) {\r\n            result.add(6 /* Struct */);\r\n        }\r\n        if (!suggestOptions.showInterfaces) {\r\n            result.add(7 /* Interface */);\r\n        }\r\n        if (!suggestOptions.showModules) {\r\n            result.add(8 /* Module */);\r\n        }\r\n        if (!suggestOptions.showProperties) {\r\n            result.add(9 /* Property */);\r\n        }\r\n        if (!suggestOptions.showEvents) {\r\n            result.add(10 /* Event */);\r\n        }\r\n        if (!suggestOptions.showOperators) {\r\n            result.add(11 /* Operator */);\r\n        }\r\n        if (!suggestOptions.showUnits) {\r\n            result.add(12 /* Unit */);\r\n        }\r\n        if (!suggestOptions.showValues) {\r\n            result.add(13 /* Value */);\r\n        }\r\n        if (!suggestOptions.showConstants) {\r\n            result.add(14 /* Constant */);\r\n        }\r\n        if (!suggestOptions.showEnums) {\r\n            result.add(15 /* Enum */);\r\n        }\r\n        if (!suggestOptions.showEnumMembers) {\r\n            result.add(16 /* EnumMember */);\r\n        }\r\n        if (!suggestOptions.showKeywords) {\r\n            result.add(17 /* Keyword */);\r\n        }\r\n        if (!suggestOptions.showWords) {\r\n            result.add(18 /* Text */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(19 /* Color */);\r\n        }\r\n        if (!suggestOptions.showFiles) {\r\n            result.add(20 /* File */);\r\n        }\r\n        if (!suggestOptions.showReferences) {\r\n            result.add(21 /* Reference */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(22 /* Customcolor */);\r\n        }\r\n        if (!suggestOptions.showFolders) {\r\n            result.add(23 /* Folder */);\r\n        }\r\n        if (!suggestOptions.showTypeParameters) {\r\n            result.add(24 /* TypeParameter */);\r\n        }\r\n        if (!suggestOptions.showSnippets) {\r\n            result.add(25 /* Snippet */);\r\n        }\r\n        return result;\r\n    };\r\n    SuggestModel.prototype._onNewContext = function (ctx) {\r\n        if (!this._context) {\r\n            // happens when 24x7 IntelliSense is enabled and still in its delay\r\n            return;\r\n        }\r\n        if (ctx.lineNumber !== this._context.lineNumber) {\r\n            // e.g. happens when pressing Enter while IntelliSense is computed\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (ctx.leadingWord.startColumn < this._context.leadingWord.startColumn) {\r\n            // happens when the current word gets outdented\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (ctx.column < this._context.column) {\r\n            // typed -> moved cursor LEFT -> retrigger if still on a word\r\n            if (ctx.leadingWord.word) {\r\n                this.trigger({ auto: this._context.auto, shy: false }, true);\r\n            }\r\n            else {\r\n                this.cancel();\r\n            }\r\n            return;\r\n        }\r\n        if (!this._completionModel) {\r\n            // happens when IntelliSense is not yet computed\r\n            return;\r\n        }\r\n        if (ctx.column > this._context.column && this._completionModel.incomplete.size > 0 && ctx.leadingWord.word.length !== 0) {\r\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\r\n            var incomplete = this._completionModel.incomplete;\r\n            var adopted = this._completionModel.adopt(incomplete);\r\n            this.trigger({ auto: this._state === 2 /* Auto */, shy: false }, true, incomplete, adopted);\r\n        }\r\n        else {\r\n            // typed -> moved cursor RIGHT -> update UI\r\n            var oldLineContext = this._completionModel.lineContext;\r\n            var isFrozen = false;\r\n            this._completionModel.lineContext = {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - this._context.column\r\n            };\r\n            if (this._completionModel.items.length === 0) {\r\n                if (LineContext.shouldAutoTrigger(this._editor) && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\r\n                    // retrigger when heading into a new word\r\n                    this.trigger({ auto: this._context.auto, shy: false }, true);\r\n                    return;\r\n                }\r\n                if (!this._context.auto) {\r\n                    // freeze when IntelliSense was manually requested\r\n                    this._completionModel.lineContext = oldLineContext;\r\n                    isFrozen = this._completionModel.items.length > 0;\r\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\r\n                        // there were results before but now there aren't\r\n                        // and also we are not on a word anymore -> cancel\r\n                        this.cancel();\r\n                        return;\r\n                    }\r\n                }\r\n                else {\r\n                    // nothing left\r\n                    this.cancel();\r\n                    return;\r\n                }\r\n            }\r\n            this._onDidSuggest.fire({\r\n                completionModel: this._completionModel,\r\n                auto: this._context.auto,\r\n                shy: this._context.shy,\r\n                isFrozen: isFrozen,\r\n            });\r\n        }\r\n    };\r\n    return SuggestModel;\r\n}());\r\nexport { SuggestModel };\r\n","import './media/outlineTree.css';\r\nimport './media/symbol-icons.css';\r\nimport { localize } from '../../../nls.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, foreground } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport var SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var symbolIconArrayColor = theme.getColor(SYMBOL_ICON_ARRAY_FOREGROUND);\r\n    if (symbolIconArrayColor) {\r\n        collector.addRule(\".codicon-symbol-array { color: \" + symbolIconArrayColor + \" !important; }\");\r\n    }\r\n    var symbolIconBooleanColor = theme.getColor(SYMBOL_ICON_BOOLEAN_FOREGROUND);\r\n    if (symbolIconBooleanColor) {\r\n        collector.addRule(\".codicon-symbol-boolean { color: \" + symbolIconBooleanColor + \" !important; }\");\r\n    }\r\n    var symbolIconClassColor = theme.getColor(SYMBOL_ICON_CLASS_FOREGROUND);\r\n    if (symbolIconClassColor) {\r\n        collector.addRule(\".codicon-symbol-class { color: \" + symbolIconClassColor + \" !important; }\");\r\n    }\r\n    var symbolIconMethodColor = theme.getColor(SYMBOL_ICON_METHOD_FOREGROUND);\r\n    if (symbolIconMethodColor) {\r\n        collector.addRule(\".codicon-symbol-method { color: \" + symbolIconMethodColor + \" !important; }\");\r\n    }\r\n    var symbolIconColorColor = theme.getColor(SYMBOL_ICON_COLOR_FOREGROUND);\r\n    if (symbolIconColorColor) {\r\n        collector.addRule(\".codicon-symbol-color { color: \" + symbolIconColorColor + \" !important; }\");\r\n    }\r\n    var symbolIconConstantColor = theme.getColor(SYMBOL_ICON_CONSTANT_FOREGROUND);\r\n    if (symbolIconConstantColor) {\r\n        collector.addRule(\".codicon-symbol-constant { color: \" + symbolIconConstantColor + \" !important; }\");\r\n    }\r\n    var symbolIconConstructorColor = theme.getColor(SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);\r\n    if (symbolIconConstructorColor) {\r\n        collector.addRule(\".codicon-symbol-constructor { color: \" + symbolIconConstructorColor + \" !important; }\");\r\n    }\r\n    var symbolIconEnumeratorColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_FOREGROUND);\r\n    if (symbolIconEnumeratorColor) {\r\n        collector.addRule(\"\\n\\t\\t\\t.codicon-symbol-value,.codicon-symbol-enum { color: \" + symbolIconEnumeratorColor + \" !important; }\");\r\n    }\r\n    var symbolIconEnumeratorMemberColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);\r\n    if (symbolIconEnumeratorMemberColor) {\r\n        collector.addRule(\".codicon-symbol-enum-member { color: \" + symbolIconEnumeratorMemberColor + \" !important; }\");\r\n    }\r\n    var symbolIconEventColor = theme.getColor(SYMBOL_ICON_EVENT_FOREGROUND);\r\n    if (symbolIconEventColor) {\r\n        collector.addRule(\".codicon-symbol-event { color: \" + symbolIconEventColor + \" !important; }\");\r\n    }\r\n    var symbolIconFieldColor = theme.getColor(SYMBOL_ICON_FIELD_FOREGROUND);\r\n    if (symbolIconFieldColor) {\r\n        collector.addRule(\".codicon-symbol-field { color: \" + symbolIconFieldColor + \" !important; }\");\r\n    }\r\n    var symbolIconFileColor = theme.getColor(SYMBOL_ICON_FILE_FOREGROUND);\r\n    if (symbolIconFileColor) {\r\n        collector.addRule(\".codicon-symbol-file { color: \" + symbolIconFileColor + \" !important; }\");\r\n    }\r\n    var symbolIconFolderColor = theme.getColor(SYMBOL_ICON_FOLDER_FOREGROUND);\r\n    if (symbolIconFolderColor) {\r\n        collector.addRule(\".codicon-symbol-folder { color: \" + symbolIconFolderColor + \" !important; }\");\r\n    }\r\n    var symbolIconFunctionColor = theme.getColor(SYMBOL_ICON_FUNCTION_FOREGROUND);\r\n    if (symbolIconFunctionColor) {\r\n        collector.addRule(\".codicon-symbol-function { color: \" + symbolIconFunctionColor + \" !important; }\");\r\n    }\r\n    var symbolIconInterfaceColor = theme.getColor(SYMBOL_ICON_INTERFACE_FOREGROUND);\r\n    if (symbolIconInterfaceColor) {\r\n        collector.addRule(\".codicon-symbol-interface { color: \" + symbolIconInterfaceColor + \" !important; }\");\r\n    }\r\n    var symbolIconKeyColor = theme.getColor(SYMBOL_ICON_KEY_FOREGROUND);\r\n    if (symbolIconKeyColor) {\r\n        collector.addRule(\".codicon-symbol-key { color: \" + symbolIconKeyColor + \" !important; }\");\r\n    }\r\n    var symbolIconKeywordColor = theme.getColor(SYMBOL_ICON_KEYWORD_FOREGROUND);\r\n    if (symbolIconKeywordColor) {\r\n        collector.addRule(\".codicon-symbol-keyword { color: \" + symbolIconKeywordColor + \" !important; }\");\r\n    }\r\n    var symbolIconModuleColor = theme.getColor(SYMBOL_ICON_MODULE_FOREGROUND);\r\n    if (symbolIconModuleColor) {\r\n        collector.addRule(\".codicon-symbol-module { color: \" + symbolIconModuleColor + \" !important; }\");\r\n    }\r\n    var outlineNamespaceColor = theme.getColor(SYMBOL_ICON_NAMESPACE_FOREGROUND);\r\n    if (outlineNamespaceColor) {\r\n        collector.addRule(\".codicon-symbol-namespace { color: \" + outlineNamespaceColor + \" !important; }\");\r\n    }\r\n    var symbolIconNullColor = theme.getColor(SYMBOL_ICON_NULL_FOREGROUND);\r\n    if (symbolIconNullColor) {\r\n        collector.addRule(\".codicon-symbol-null { color: \" + symbolIconNullColor + \" !important; }\");\r\n    }\r\n    var symbolIconNumberColor = theme.getColor(SYMBOL_ICON_NUMBER_FOREGROUND);\r\n    if (symbolIconNumberColor) {\r\n        collector.addRule(\".codicon-symbol-number { color: \" + symbolIconNumberColor + \" !important; }\");\r\n    }\r\n    var symbolIconObjectColor = theme.getColor(SYMBOL_ICON_OBJECT_FOREGROUND);\r\n    if (symbolIconObjectColor) {\r\n        collector.addRule(\".codicon-symbol-object { color: \" + symbolIconObjectColor + \" !important; }\");\r\n    }\r\n    var symbolIconOperatorColor = theme.getColor(SYMBOL_ICON_OPERATOR_FOREGROUND);\r\n    if (symbolIconOperatorColor) {\r\n        collector.addRule(\".codicon-symbol-operator { color: \" + symbolIconOperatorColor + \" !important; }\");\r\n    }\r\n    var symbolIconPackageColor = theme.getColor(SYMBOL_ICON_PACKAGE_FOREGROUND);\r\n    if (symbolIconPackageColor) {\r\n        collector.addRule(\".codicon-symbol-package { color: \" + symbolIconPackageColor + \" !important; }\");\r\n    }\r\n    var symbolIconPropertyColor = theme.getColor(SYMBOL_ICON_PROPERTY_FOREGROUND);\r\n    if (symbolIconPropertyColor) {\r\n        collector.addRule(\".codicon-symbol-property { color: \" + symbolIconPropertyColor + \" !important; }\");\r\n    }\r\n    var symbolIconReferenceColor = theme.getColor(SYMBOL_ICON_REFERENCE_FOREGROUND);\r\n    if (symbolIconReferenceColor) {\r\n        collector.addRule(\".codicon-symbol-reference { color: \" + symbolIconReferenceColor + \" !important; }\");\r\n    }\r\n    var symbolIconSnippetColor = theme.getColor(SYMBOL_ICON_SNIPPET_FOREGROUND);\r\n    if (symbolIconSnippetColor) {\r\n        collector.addRule(\".codicon-symbol-snippet { color: \" + symbolIconSnippetColor + \" !important; }\");\r\n    }\r\n    var symbolIconStringColor = theme.getColor(SYMBOL_ICON_STRING_FOREGROUND);\r\n    if (symbolIconStringColor) {\r\n        collector.addRule(\".codicon-symbol-string { color: \" + symbolIconStringColor + \" !important; }\");\r\n    }\r\n    var symbolIconStructColor = theme.getColor(SYMBOL_ICON_STRUCT_FOREGROUND);\r\n    if (symbolIconStructColor) {\r\n        collector.addRule(\".codicon-symbol-struct { color: \" + symbolIconStructColor + \" !important; }\");\r\n    }\r\n    var symbolIconTextColor = theme.getColor(SYMBOL_ICON_TEXT_FOREGROUND);\r\n    if (symbolIconTextColor) {\r\n        collector.addRule(\".codicon-symbol-text { color: \" + symbolIconTextColor + \" !important; }\");\r\n    }\r\n    var symbolIconTypeParameterColor = theme.getColor(SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);\r\n    if (symbolIconTypeParameterColor) {\r\n        collector.addRule(\".codicon-symbol-type-parameter { color: \" + symbolIconTypeParameterColor + \" !important; }\");\r\n    }\r\n    var symbolIconUnitColor = theme.getColor(SYMBOL_ICON_UNIT_FOREGROUND);\r\n    if (symbolIconUnitColor) {\r\n        collector.addRule(\".codicon-symbol-unit { color: \" + symbolIconUnitColor + \" !important; }\");\r\n    }\r\n    var symbolIconVariableColor = theme.getColor(SYMBOL_ICON_VARIABLE_FOREGROUND);\r\n    if (symbolIconVariableColor) {\r\n        collector.addRule(\".codicon-symbol-variable { color: \" + symbolIconVariableColor + \" !important; }\");\r\n    }\r\n});\r\n","export var FileKind;\r\n(function (FileKind) {\r\n    FileKind[FileKind[\"FILE\"] = 0] = \"FILE\";\r\n    FileKind[FileKind[\"FOLDER\"] = 1] = \"FOLDER\";\r\n    FileKind[FileKind[\"ROOT_FOLDER\"] = 2] = \"ROOT_FOLDER\";\r\n})(FileKind || (FileKind = {}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { DataUri, basenameOrAuthority } from '../../../base/common/resources.js';\r\nimport { PLAINTEXT_MODE_ID } from '../modes/modesRegistry.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nexport function getIconClasses(modelService, modeService, resource, fileKind) {\r\n    // we always set these base classes even if we do not have a path\r\n    var classes = fileKind === FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];\r\n    if (resource) {\r\n        // Get the path and name of the resource. For data-URIs, we need to parse specially\r\n        var name_1;\r\n        if (resource.scheme === Schemas.data) {\r\n            var metadata = DataUri.parseMetaData(resource);\r\n            name_1 = metadata.get(DataUri.META_DATA_LABEL);\r\n        }\r\n        else {\r\n            name_1 = cssEscape(basenameOrAuthority(resource).toLowerCase());\r\n        }\r\n        // Folders\r\n        if (fileKind === FileKind.FOLDER) {\r\n            classes.push(name_1 + \"-name-folder-icon\");\r\n        }\r\n        // Files\r\n        else {\r\n            // Name & Extension(s)\r\n            if (name_1) {\r\n                classes.push(name_1 + \"-name-file-icon\");\r\n                var dotSegments = name_1.split('.');\r\n                for (var i = 1; i < dotSegments.length; i++) {\r\n                    classes.push(dotSegments.slice(i).join('.') + \"-ext-file-icon\"); // add each combination of all found extensions if more than one\r\n                }\r\n                classes.push(\"ext-file-icon\"); // extra segment to increase file-ext score\r\n            }\r\n            // Detected Mode\r\n            var detectedModeId = detectModeId(modelService, modeService, resource);\r\n            if (detectedModeId) {\r\n                classes.push(cssEscape(detectedModeId) + \"-lang-file-icon\");\r\n            }\r\n        }\r\n    }\r\n    return classes;\r\n}\r\nexport function detectModeId(modelService, modeService, resource) {\r\n    if (!resource) {\r\n        return null; // we need a resource at least\r\n    }\r\n    var modeId = null;\r\n    // Data URI: check for encoded metadata\r\n    if (resource.scheme === Schemas.data) {\r\n        var metadata = DataUri.parseMetaData(resource);\r\n        var mime = metadata.get(DataUri.META_DATA_MIME);\r\n        if (mime) {\r\n            modeId = modeService.getModeId(mime);\r\n        }\r\n    }\r\n    // Any other URI: check for model if existing\r\n    else {\r\n        var model = modelService.getModel(resource);\r\n        if (model) {\r\n            modeId = model.getModeId();\r\n        }\r\n    }\r\n    // only take if the mode is specific (aka no just plain text)\r\n    if (modeId && modeId !== PLAINTEXT_MODE_ID) {\r\n        return modeId;\r\n    }\r\n    // otherwise fallback to path based detection\r\n    return modeService.getModeIdByFilepathOrFirstLine(resource);\r\n}\r\nexport function cssEscape(val) {\r\n    return val.replace(/\\s/g, '\\\\$&'); // make sure to not introduce CSS classes from files that contain whitespace\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './media/suggest.css';\r\nimport './media/suggestStatusBar.css';\r\nimport '../../../base/browser/ui/codiconLabel/codiconLabel.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../documentSymbols/outlineTree.js'; // The codicon symbol colors are defined here and must be loaded\r\nimport * as nls from '../../../nls.js';\r\nimport { createMatches } from '../../../base/common/filters.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Event, Emitter } from '../../../base/common/event.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { dispose, toDisposable, DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { addClass, append, $, hide, removeClass, show, toggleClass, getDomNodePagePosition, hasClass, addDisposableListener, addStandardDisposableListener, addClasses } from '../../../base/browser/dom.js';\r\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { attachListStyler } from '../../../platform/theme/common/styler.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorWidgetBackground, listFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { TimeoutTimer, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { completionKindToCssClass } from '../../common/modes.js';\r\nimport { IconLabel } from '../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { getIconClasses } from '../../common/services/getIconClasses.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { flatten } from '../../../base/common/arrays.js';\r\nimport { Position } from '../../common/core/position.js';\r\nvar expandSuggestionDocsByDefault = false;\r\n/**\r\n * Suggest widget colors\r\n */\r\nexport var editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\r\nexport var editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\r\nexport var editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\r\nexport var editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: listFocusBackground, light: listFocusBackground, hc: listFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\r\nexport var editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\r\nvar colorRegExp = /^(#([\\da-f]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))$/i;\r\nfunction extractColor(item, out) {\r\n    var label = typeof item.completion.label === 'string'\r\n        ? item.completion.label\r\n        : item.completion.label.name;\r\n    if (label.match(colorRegExp)) {\r\n        out[0] = label;\r\n        return true;\r\n    }\r\n    if (typeof item.completion.documentation === 'string' && item.completion.documentation.match(colorRegExp)) {\r\n        out[0] = item.completion.documentation;\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction canExpandCompletionItem(item) {\r\n    if (!item) {\r\n        return false;\r\n    }\r\n    var suggestion = item.completion;\r\n    if (suggestion.documentation) {\r\n        return true;\r\n    }\r\n    return (suggestion.detail && suggestion.detail !== suggestion.label);\r\n}\r\nfunction getAriaId(index) {\r\n    return \"suggest-aria-id:\" + index;\r\n}\r\nvar ItemRenderer = /** @class */ (function () {\r\n    function ItemRenderer(widget, editor, triggerKeybindingLabel, _modelService, _modeService, _themeService) {\r\n        this.widget = widget;\r\n        this.editor = editor;\r\n        this.triggerKeybindingLabel = triggerKeybindingLabel;\r\n        this._modelService = _modelService;\r\n        this._modeService = _modeService;\r\n        this._themeService = _themeService;\r\n    }\r\n    Object.defineProperty(ItemRenderer.prototype, \"templateId\", {\r\n        get: function () {\r\n            return 'suggestion';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ItemRenderer.prototype.renderTemplate = function (container) {\r\n        var _this = this;\r\n        var data = Object.create(null);\r\n        data.disposables = new DisposableStore();\r\n        data.root = container;\r\n        addClass(data.root, 'show-file-icons');\r\n        data.icon = append(container, $('.icon'));\r\n        data.colorspan = append(data.icon, $('span.colorspan'));\r\n        var text = append(container, $('.contents'));\r\n        var main = append(text, $('.main'));\r\n        data.left = append(main, $('span.left'));\r\n        data.right = append(main, $('span.right'));\r\n        data.iconContainer = append(data.left, $('.icon-label.codicon'));\r\n        data.iconLabel = new IconLabel(data.left, { supportHighlights: true, supportCodicons: true });\r\n        data.disposables.add(data.iconLabel);\r\n        data.signatureLabel = append(data.left, $('span.signature-label'));\r\n        data.qualifierLabel = append(data.left, $('span.qualifier-label'));\r\n        data.detailsLabel = append(data.right, $('span.details-label'));\r\n        data.readMore = append(data.right, $('span.readMore.codicon.codicon-info'));\r\n        data.readMore.title = nls.localize('readMore', \"Read More...{0}\", this.triggerKeybindingLabel);\r\n        var configureFont = function () {\r\n            var options = _this.editor.getOptions();\r\n            var fontInfo = options.get(34 /* fontInfo */);\r\n            var fontFamily = fontInfo.fontFamily;\r\n            var fontFeatureSettings = fontInfo.fontFeatureSettings;\r\n            var fontSize = options.get(90 /* suggestFontSize */) || fontInfo.fontSize;\r\n            var lineHeight = options.get(91 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n            var fontWeight = fontInfo.fontWeight;\r\n            var fontSizePx = fontSize + \"px\";\r\n            var lineHeightPx = lineHeight + \"px\";\r\n            data.root.style.fontSize = fontSizePx;\r\n            data.root.style.fontWeight = fontWeight;\r\n            main.style.fontFamily = fontFamily;\r\n            main.style.fontFeatureSettings = fontFeatureSettings;\r\n            main.style.lineHeight = lineHeightPx;\r\n            data.icon.style.height = lineHeightPx;\r\n            data.icon.style.width = lineHeightPx;\r\n            data.readMore.style.height = lineHeightPx;\r\n            data.readMore.style.width = lineHeightPx;\r\n        };\r\n        configureFont();\r\n        data.disposables.add(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(34 /* fontInfo */) || e.hasChanged(90 /* suggestFontSize */) || e.hasChanged(91 /* suggestLineHeight */); })\r\n            .on(configureFont, null));\r\n        return data;\r\n    };\r\n    ItemRenderer.prototype.renderElement = function (element, index, templateData) {\r\n        var _this = this;\r\n        var data = templateData;\r\n        var suggestion = element.completion;\r\n        var textLabel = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.name;\r\n        data.root.id = getAriaId(index);\r\n        data.icon.className = 'icon ' + completionKindToCssClass(suggestion.kind);\r\n        data.colorspan.style.backgroundColor = '';\r\n        var labelOptions = {\r\n            labelEscapeNewLines: true,\r\n            matches: createMatches(element.score)\r\n        };\r\n        var color = [];\r\n        if (suggestion.kind === 19 /* Color */ && extractColor(element, color)) {\r\n            // special logic for 'color' completion items\r\n            data.icon.className = 'icon customcolor';\r\n            data.iconContainer.className = 'icon hide';\r\n            data.colorspan.style.backgroundColor = color[0];\r\n        }\r\n        else if (suggestion.kind === 20 /* File */ && this._themeService.getIconTheme().hasFileIcons) {\r\n            // special logic for 'file' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            var labelClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: textLabel }), FileKind.FILE);\r\n            var detailClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FILE);\r\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\r\n        }\r\n        else if (suggestion.kind === 23 /* Folder */ && this._themeService.getIconTheme().hasFolderIcons) {\r\n            // special logic for 'folder' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            labelOptions.extraClasses = flatten([\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: textLabel }), FileKind.FOLDER),\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: suggestion.detail }), FileKind.FOLDER)\r\n            ]);\r\n        }\r\n        else {\r\n            // normal icon\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = '';\r\n            addClasses(data.iconContainer, \"suggest-icon codicon codicon-symbol-\" + completionKindToCssClass(suggestion.kind));\r\n        }\r\n        if (suggestion.tags && suggestion.tags.indexOf(1 /* Deprecated */) >= 0) {\r\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\r\n            labelOptions.matches = [];\r\n        }\r\n        data.iconLabel.setLabel(textLabel, undefined, labelOptions);\r\n        if (typeof suggestion.label === 'string') {\r\n            data.signatureLabel.textContent = '';\r\n            data.qualifierLabel.textContent = '';\r\n            data.detailsLabel.textContent = (suggestion.detail || '').replace(/\\n.*$/m, '');\r\n            removeClass(data.right, 'always-show-details');\r\n        }\r\n        else {\r\n            data.signatureLabel.textContent = (suggestion.label.signature || '').replace(/\\n.*$/m, '');\r\n            data.qualifierLabel.textContent = (suggestion.label.qualifier || '').replace(/\\n.*$/m, '');\r\n            data.detailsLabel.textContent = (suggestion.label.type || '').replace(/\\n.*$/m, '');\r\n            addClass(data.right, 'always-show-details');\r\n        }\r\n        if (canExpandCompletionItem(element)) {\r\n            addClass(data.right, 'can-expand-details');\r\n            show(data.readMore);\r\n            data.readMore.onmousedown = function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            };\r\n            data.readMore.onclick = function (e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                _this.widget.toggleDetails();\r\n            };\r\n        }\r\n        else {\r\n            removeClass(data.right, 'can-expand-details');\r\n            hide(data.readMore);\r\n            data.readMore.onmousedown = null;\r\n            data.readMore.onclick = null;\r\n        }\r\n    };\r\n    ItemRenderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.disposables.dispose();\r\n    };\r\n    ItemRenderer = __decorate([\r\n        __param(3, IModelService),\r\n        __param(4, IModeService),\r\n        __param(5, IThemeService)\r\n    ], ItemRenderer);\r\n    return ItemRenderer;\r\n}());\r\nvar SuggestionDetails = /** @class */ (function () {\r\n    function SuggestionDetails(container, widget, editor, markdownRenderer, kbToggleDetails) {\r\n        var _this = this;\r\n        this.widget = widget;\r\n        this.editor = editor;\r\n        this.markdownRenderer = markdownRenderer;\r\n        this.kbToggleDetails = kbToggleDetails;\r\n        this.borderWidth = 1;\r\n        this.disposables = new DisposableStore();\r\n        this.el = append(container, $('.details'));\r\n        this.disposables.add(toDisposable(function () { return container.removeChild(_this.el); }));\r\n        this.body = $('.body');\r\n        this.scrollbar = new DomScrollableElement(this.body, {});\r\n        append(this.el, this.scrollbar.getDomNode());\r\n        this.disposables.add(this.scrollbar);\r\n        this.header = append(this.body, $('.header'));\r\n        this.close = append(this.header, $('span.codicon.codicon-close'));\r\n        this.close.title = nls.localize('readLess', \"Read less...{0}\", this.kbToggleDetails);\r\n        this.type = append(this.header, $('p.type'));\r\n        this.docs = append(this.body, $('p.docs'));\r\n        this.configureFont();\r\n        Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(34 /* fontInfo */); })\r\n            .on(this.configureFont, this, this.disposables);\r\n        markdownRenderer.onDidRenderCodeBlock(function () { return _this.scrollbar.scanDomNode(); }, this, this.disposables);\r\n    }\r\n    Object.defineProperty(SuggestionDetails.prototype, \"element\", {\r\n        get: function () {\r\n            return this.el;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SuggestionDetails.prototype.renderLoading = function () {\r\n        this.type.textContent = nls.localize('loading', \"Loading...\");\r\n        this.docs.textContent = '';\r\n    };\r\n    SuggestionDetails.prototype.renderItem = function (item, explainMode) {\r\n        var _this = this;\r\n        this.renderDisposeable = dispose(this.renderDisposeable);\r\n        var _a = item.completion, documentation = _a.documentation, detail = _a.detail;\r\n        // --- documentation\r\n        if (explainMode) {\r\n            var md = '';\r\n            md += \"score: \" + item.score[0] + (item.word ? \", compared '\" + (item.completion.filterText && (item.completion.filterText + ' (filterText)') || item.completion.label) + \"' with '\" + item.word + \"'\" : ' (no prefix)') + \"\\n\";\r\n            md += \"distance: \" + item.distance + \", see localityBonus-setting\\n\";\r\n            md += \"index: \" + item.idx + \", based on \" + (item.completion.sortText && \"sortText: \\\"\" + item.completion.sortText + \"\\\"\" || 'label') + \"\\n\";\r\n            documentation = new MarkdownString().appendCodeblock('empty', md);\r\n            detail = \"Provider: \" + item.provider._debugDisplayName;\r\n        }\r\n        if (!explainMode && !canExpandCompletionItem(item)) {\r\n            this.type.textContent = '';\r\n            this.docs.textContent = '';\r\n            addClass(this.el, 'no-docs');\r\n            return;\r\n        }\r\n        removeClass(this.el, 'no-docs');\r\n        if (typeof documentation === 'string') {\r\n            removeClass(this.docs, 'markdown-docs');\r\n            this.docs.textContent = documentation;\r\n        }\r\n        else {\r\n            addClass(this.docs, 'markdown-docs');\r\n            this.docs.innerHTML = '';\r\n            var renderedContents = this.markdownRenderer.render(documentation);\r\n            this.renderDisposeable = renderedContents;\r\n            this.docs.appendChild(renderedContents.element);\r\n        }\r\n        // --- details\r\n        if (detail) {\r\n            this.type.innerText = detail;\r\n            show(this.type);\r\n        }\r\n        else {\r\n            this.type.innerText = '';\r\n            hide(this.type);\r\n        }\r\n        this.el.style.height = this.header.offsetHeight + this.docs.offsetHeight + (this.borderWidth * 2) + 'px';\r\n        this.el.style.userSelect = 'text';\r\n        this.el.tabIndex = -1;\r\n        this.close.onmousedown = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        };\r\n        this.close.onclick = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            _this.widget.toggleDetails();\r\n        };\r\n        this.body.scrollTop = 0;\r\n        this.scrollbar.scanDomNode();\r\n    };\r\n    SuggestionDetails.prototype.scrollDown = function (much) {\r\n        if (much === void 0) { much = 8; }\r\n        this.body.scrollTop += much;\r\n    };\r\n    SuggestionDetails.prototype.scrollUp = function (much) {\r\n        if (much === void 0) { much = 8; }\r\n        this.body.scrollTop -= much;\r\n    };\r\n    SuggestionDetails.prototype.scrollTop = function () {\r\n        this.body.scrollTop = 0;\r\n    };\r\n    SuggestionDetails.prototype.scrollBottom = function () {\r\n        this.body.scrollTop = this.body.scrollHeight;\r\n    };\r\n    SuggestionDetails.prototype.pageDown = function () {\r\n        this.scrollDown(80);\r\n    };\r\n    SuggestionDetails.prototype.pageUp = function () {\r\n        this.scrollUp(80);\r\n    };\r\n    SuggestionDetails.prototype.setBorderWidth = function (width) {\r\n        this.borderWidth = width;\r\n    };\r\n    SuggestionDetails.prototype.configureFont = function () {\r\n        var options = this.editor.getOptions();\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var fontFamily = fontInfo.fontFamily;\r\n        var fontSize = options.get(90 /* suggestFontSize */) || fontInfo.fontSize;\r\n        var lineHeight = options.get(91 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n        var fontWeight = fontInfo.fontWeight;\r\n        var fontSizePx = fontSize + \"px\";\r\n        var lineHeightPx = lineHeight + \"px\";\r\n        this.el.style.fontSize = fontSizePx;\r\n        this.el.style.fontWeight = fontWeight;\r\n        this.el.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\r\n        this.type.style.fontFamily = fontFamily;\r\n        this.close.style.height = lineHeightPx;\r\n        this.close.style.width = lineHeightPx;\r\n    };\r\n    SuggestionDetails.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n        this.renderDisposeable = dispose(this.renderDisposeable);\r\n    };\r\n    return SuggestionDetails;\r\n}());\r\nvar SuggestWidget = /** @class */ (function () {\r\n    function SuggestWidget(editor, telemetryService, keybindingService, contextKeyService, themeService, storageService, modeService, openerService, instantiationService) {\r\n        var _this = this;\r\n        var _a, _b;\r\n        this.editor = editor;\r\n        this.telemetryService = telemetryService;\r\n        this.keybindingService = keybindingService;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this.state = null;\r\n        this.isAuto = false;\r\n        this.loadingTimeout = Disposable.None;\r\n        this.currentSuggestionDetails = null;\r\n        this.ignoreFocusEvents = false;\r\n        this.completionModel = null;\r\n        this.showTimeout = new TimeoutTimer();\r\n        this.toDispose = new DisposableStore();\r\n        this.onDidSelectEmitter = new Emitter();\r\n        this.onDidFocusEmitter = new Emitter();\r\n        this.onDidHideEmitter = new Emitter();\r\n        this.onDidShowEmitter = new Emitter();\r\n        this.onDidSelect = this.onDidSelectEmitter.event;\r\n        this.onDidFocus = this.onDidFocusEmitter.event;\r\n        this.onDidHide = this.onDidHideEmitter.event;\r\n        this.onDidShow = this.onDidShowEmitter.event;\r\n        this.maxWidgetWidth = 660;\r\n        this.listWidth = 330;\r\n        this.firstFocusInCurrentList = false;\r\n        this.preferDocPositionTop = false;\r\n        this.docsPositionPreviousWidgetY = null;\r\n        this.explainMode = false;\r\n        this._onDetailsKeydown = new Emitter();\r\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\r\n        var markdownRenderer = this.toDispose.add(new MarkdownRenderer(editor, modeService, openerService));\r\n        var kbToggleDetails = (_b = (_a = keybindingService.lookupKeybinding('toggleSuggestionDetails')) === null || _a === void 0 ? void 0 : _a.getLabel()) !== null && _b !== void 0 ? _b : '';\r\n        this.msgDetailsLess = nls.localize('detail.less', \"{0} for less...\", kbToggleDetails);\r\n        this.msgDetailMore = nls.localize('detail.more', \"{0} for more...\", kbToggleDetails);\r\n        this.isAuto = false;\r\n        this.focusedItem = null;\r\n        this.storageService = storageService;\r\n        this.element = $('.editor-widget.suggest-widget');\r\n        this.toDispose.add(addDisposableListener(this.element, 'click', function (e) {\r\n            if (e.target === _this.element) {\r\n                _this.hideWidget();\r\n            }\r\n        }));\r\n        this.messageElement = append(this.element, $('.message'));\r\n        this.listElement = append(this.element, $('.tree'));\r\n        var applyStatusBarStyle = function () { return toggleClass(_this.element, 'with-status-bar', !_this.editor.getOption(89 /* suggest */).hideStatusBar); };\r\n        applyStatusBarStyle();\r\n        this.statusBarElement = append(this.element, $('.suggest-status-bar'));\r\n        this.statusBarLeftSpan = append(this.statusBarElement, $('span'));\r\n        this.statusBarRightSpan = append(this.statusBarElement, $('span'));\r\n        this.setStatusBarLeftText('');\r\n        this.setStatusBarRightText('');\r\n        this.details = instantiationService.createInstance(SuggestionDetails, this.element, this, this.editor, markdownRenderer, kbToggleDetails);\r\n        var applyIconStyle = function () { return toggleClass(_this.element, 'no-icons', !_this.editor.getOption(89 /* suggest */).showIcons); };\r\n        applyIconStyle();\r\n        var renderer = instantiationService.createInstance(ItemRenderer, this, this.editor, kbToggleDetails);\r\n        this.list = new List('SuggestWidget', this.listElement, this, [renderer], {\r\n            useShadows: false,\r\n            openController: { shouldOpen: function () { return false; } },\r\n            mouseSupport: false,\r\n            accessibilityProvider: {\r\n                getAriaLabel: function (item) {\r\n                    var textLabel = typeof item.completion.label === 'string' ? item.completion.label : item.completion.label.name;\r\n                    if (item.isResolved && _this.expandDocsSettingFromStorage()) {\r\n                        var _a = item.completion, documentation = _a.documentation, detail = _a.detail;\r\n                        var docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\r\n                        return nls.localize('ariaCurrenttSuggestionReadDetails', \"Item {0}, docs: {1}\", textLabel, docs);\r\n                    }\r\n                    else {\r\n                        return textLabel;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this.toDispose.add(attachListStyler(this.list, themeService, {\r\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\r\n            listInactiveFocusOutline: activeContrastBorder\r\n        }));\r\n        this.toDispose.add(themeService.onThemeChange(function (t) { return _this.onThemeChange(t); }));\r\n        this.toDispose.add(editor.onDidLayoutChange(function () { return _this.onEditorLayoutChange(); }));\r\n        this.toDispose.add(this.list.onMouseDown(function (e) { return _this.onListMouseDownOrTap(e); }));\r\n        this.toDispose.add(this.list.onTap(function (e) { return _this.onListMouseDownOrTap(e); }));\r\n        this.toDispose.add(this.list.onSelectionChange(function (e) { return _this.onListSelection(e); }));\r\n        this.toDispose.add(this.list.onFocusChange(function (e) { return _this.onListFocus(e); }));\r\n        this.toDispose.add(this.editor.onDidChangeCursorSelection(function () { return _this.onCursorSelectionChanged(); }));\r\n        this.toDispose.add(this.editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(89 /* suggest */)) {\r\n                applyStatusBarStyle();\r\n                applyIconStyle();\r\n            }\r\n        }));\r\n        this.suggestWidgetVisible = SuggestContext.Visible.bindTo(contextKeyService);\r\n        this.suggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(contextKeyService);\r\n        this.editor.addContentWidget(this);\r\n        this.setState(0 /* Hidden */);\r\n        this.onThemeChange(themeService.getTheme());\r\n        this.toDispose.add(addStandardDisposableListener(this.details.element, 'keydown', function (e) {\r\n            _this._onDetailsKeydown.fire(e);\r\n        }));\r\n        this.toDispose.add(this.editor.onMouseDown(function (e) { return _this.onEditorMouseDown(e); }));\r\n    }\r\n    SuggestWidget.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // Clicking inside details\r\n        if (this.details.element.contains(mouseEvent.target.element)) {\r\n            this.details.element.focus();\r\n        }\r\n        // Clicking outside details and inside suggest\r\n        else {\r\n            if (this.element.contains(mouseEvent.target.element)) {\r\n                this.editor.focus();\r\n            }\r\n        }\r\n    };\r\n    SuggestWidget.prototype.onCursorSelectionChanged = function () {\r\n        if (this.state === 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    SuggestWidget.prototype.onEditorLayoutChange = function () {\r\n        if ((this.state === 3 /* Open */ || this.state === 5 /* Details */) && this.expandDocsSettingFromStorage()) {\r\n            this.expandSideOrBelow();\r\n        }\r\n    };\r\n    SuggestWidget.prototype.onListMouseDownOrTap = function (e) {\r\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\r\n            return;\r\n        }\r\n        // prevent stealing browser focus from the editor\r\n        e.browserEvent.preventDefault();\r\n        e.browserEvent.stopPropagation();\r\n        this.select(e.element, e.index);\r\n    };\r\n    SuggestWidget.prototype.onListSelection = function (e) {\r\n        if (!e.elements.length) {\r\n            return;\r\n        }\r\n        this.select(e.elements[0], e.indexes[0]);\r\n    };\r\n    SuggestWidget.prototype.select = function (item, index) {\r\n        var completionModel = this.completionModel;\r\n        if (!completionModel) {\r\n            return;\r\n        }\r\n        this.onDidSelectEmitter.fire({ item: item, index: index, model: completionModel });\r\n        this.editor.focus();\r\n    };\r\n    SuggestWidget.prototype.onThemeChange = function (theme) {\r\n        var backgroundColor = theme.getColor(editorSuggestWidgetBackground);\r\n        if (backgroundColor) {\r\n            this.listElement.style.backgroundColor = backgroundColor.toString();\r\n            this.statusBarElement.style.backgroundColor = backgroundColor.toString();\r\n            this.details.element.style.backgroundColor = backgroundColor.toString();\r\n            this.messageElement.style.backgroundColor = backgroundColor.toString();\r\n        }\r\n        var borderColor = theme.getColor(editorSuggestWidgetBorder);\r\n        if (borderColor) {\r\n            this.listElement.style.borderColor = borderColor.toString();\r\n            this.statusBarElement.style.borderColor = borderColor.toString();\r\n            this.details.element.style.borderColor = borderColor.toString();\r\n            this.messageElement.style.borderColor = borderColor.toString();\r\n            this.detailsBorderColor = borderColor.toString();\r\n        }\r\n        var focusBorderColor = theme.getColor(focusBorder);\r\n        if (focusBorderColor) {\r\n            this.detailsFocusBorderColor = focusBorderColor.toString();\r\n        }\r\n        this.details.setBorderWidth(theme.type === 'hc' ? 2 : 1);\r\n    };\r\n    SuggestWidget.prototype.onListFocus = function (e) {\r\n        var _this = this;\r\n        var _a, _b;\r\n        if (this.ignoreFocusEvents) {\r\n            return;\r\n        }\r\n        if (!e.elements.length) {\r\n            if (this.currentSuggestionDetails) {\r\n                this.currentSuggestionDetails.cancel();\r\n                this.currentSuggestionDetails = null;\r\n                this.focusedItem = null;\r\n            }\r\n            this.editor.setAriaOptions({ activeDescendant: undefined });\r\n            return;\r\n        }\r\n        if (!this.completionModel) {\r\n            return;\r\n        }\r\n        var item = e.elements[0];\r\n        var index = e.indexes[0];\r\n        this.firstFocusInCurrentList = !this.focusedItem;\r\n        if (item !== this.focusedItem) {\r\n            // update statusbar\r\n            // todo@joh,pine -> this should a toolbar with actions so that these things become\r\n            // mouse clickable and fit for accessibility...\r\n            var wantsInsert = this.editor.getOption(89 /* suggest */).insertMode === 'insert';\r\n            var kbAccept = (_a = this.keybindingService.lookupKeybinding('acceptSelectedSuggestion')) === null || _a === void 0 ? void 0 : _a.getLabel();\r\n            var kbAcceptAlt = (_b = this.keybindingService.lookupKeybinding('acceptAlternativeSelectedSuggestion')) === null || _b === void 0 ? void 0 : _b.getLabel();\r\n            if (!Position.equals(item.editInsertEnd, item.editReplaceEnd)) {\r\n                // insert AND replace\r\n                if (wantsInsert) {\r\n                    this.setStatusBarLeftText(nls.localize('insert', \"{0} to insert, {1} to replace\", kbAccept, kbAcceptAlt));\r\n                }\r\n                else {\r\n                    this.setStatusBarLeftText(nls.localize('replace', \"{0} to replace, {1} to insert\", kbAccept, kbAcceptAlt));\r\n                }\r\n            }\r\n            else {\r\n                this.setStatusBarLeftText(nls.localize('accept', \"{0} to accept\", kbAccept));\r\n            }\r\n            if (this.currentSuggestionDetails) {\r\n                this.currentSuggestionDetails.cancel();\r\n                this.currentSuggestionDetails = null;\r\n            }\r\n            this.focusedItem = item;\r\n            this.list.reveal(index);\r\n            this.currentSuggestionDetails = createCancelablePromise(function (token) { return __awaiter(_this, void 0, void 0, function () {\r\n                var loading, result;\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            loading = disposableTimeout(function () { return _this.showDetails(true); }, 250);\r\n                            token.onCancellationRequested(function () { return loading.dispose(); });\r\n                            return [4 /*yield*/, item.resolve(token)];\r\n                        case 1:\r\n                            result = _a.sent();\r\n                            loading.dispose();\r\n                            return [2 /*return*/, result];\r\n                    }\r\n                });\r\n            }); });\r\n            this.currentSuggestionDetails.then(function () {\r\n                if (index >= _this.list.length || item !== _this.list.element(index)) {\r\n                    return;\r\n                }\r\n                // item can have extra information, so re-render\r\n                _this.ignoreFocusEvents = true;\r\n                _this.list.splice(index, 1, [item]);\r\n                _this.list.setFocus([index]);\r\n                _this.ignoreFocusEvents = false;\r\n                if (_this.expandDocsSettingFromStorage()) {\r\n                    _this.showDetails(false);\r\n                }\r\n                else {\r\n                    removeClass(_this.element, 'docs-side');\r\n                }\r\n                if (canExpandCompletionItem(_this.focusedItem)) {\r\n                    if (_this.expandDocsSettingFromStorage()) {\r\n                        _this.setStatusBarRightText(_this.msgDetailsLess);\r\n                    }\r\n                    else {\r\n                        _this.setStatusBarRightText(_this.msgDetailMore);\r\n                    }\r\n                }\r\n                else {\r\n                    _this.statusBarRightSpan.innerText = '';\r\n                }\r\n                _this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\r\n            }).catch(onUnexpectedError);\r\n        }\r\n        // emit an event\r\n        this.onDidFocusEmitter.fire({ item: item, index: index, model: this.completionModel });\r\n    };\r\n    SuggestWidget.prototype.setState = function (state) {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n        var stateChanged = this.state !== state;\r\n        this.state = state;\r\n        toggleClass(this.element, 'frozen', state === 4 /* Frozen */);\r\n        switch (state) {\r\n            case 0 /* Hidden */:\r\n                hide(this.messageElement, this.details.element, this.listElement, this.statusBarElement);\r\n                this.hide();\r\n                this.listHeight = 0;\r\n                if (stateChanged) {\r\n                    this.list.splice(0, this.list.length);\r\n                }\r\n                this.focusedItem = null;\r\n                break;\r\n            case 1 /* Loading */:\r\n                this.messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\r\n                hide(this.listElement, this.details.element, this.statusBarElement);\r\n                show(this.messageElement);\r\n                removeClass(this.element, 'docs-side');\r\n                this.show();\r\n                this.focusedItem = null;\r\n                break;\r\n            case 2 /* Empty */:\r\n                this.messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\r\n                hide(this.listElement, this.details.element, this.statusBarElement);\r\n                show(this.messageElement);\r\n                removeClass(this.element, 'docs-side');\r\n                this.show();\r\n                this.focusedItem = null;\r\n                break;\r\n            case 3 /* Open */:\r\n                hide(this.messageElement);\r\n                show(this.listElement, this.statusBarElement);\r\n                this.show();\r\n                break;\r\n            case 4 /* Frozen */:\r\n                hide(this.messageElement);\r\n                show(this.listElement);\r\n                this.show();\r\n                break;\r\n            case 5 /* Details */:\r\n                hide(this.messageElement);\r\n                show(this.details.element, this.listElement, this.statusBarElement);\r\n                this.show();\r\n                break;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showTriggered = function (auto, delay) {\r\n        var _this = this;\r\n        if (this.state !== 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this.isAuto = !!auto;\r\n        if (!this.isAuto) {\r\n            this.loadingTimeout = disposableTimeout(function () { return _this.setState(1 /* Loading */); }, delay);\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showSuggestions = function (completionModel, selectionIndex, isFrozen, isAuto) {\r\n        this.preferDocPositionTop = false;\r\n        this.docsPositionPreviousWidgetY = null;\r\n        this.loadingTimeout.dispose();\r\n        if (this.currentSuggestionDetails) {\r\n            this.currentSuggestionDetails.cancel();\r\n            this.currentSuggestionDetails = null;\r\n        }\r\n        if (this.completionModel !== completionModel) {\r\n            this.completionModel = completionModel;\r\n        }\r\n        if (isFrozen && this.state !== 2 /* Empty */ && this.state !== 0 /* Hidden */) {\r\n            this.setState(4 /* Frozen */);\r\n            return;\r\n        }\r\n        var visibleCount = this.completionModel.items.length;\r\n        var isEmpty = visibleCount === 0;\r\n        this.suggestWidgetMultipleSuggestions.set(visibleCount > 1);\r\n        if (isEmpty) {\r\n            if (isAuto) {\r\n                this.setState(0 /* Hidden */);\r\n            }\r\n            else {\r\n                this.setState(2 /* Empty */);\r\n            }\r\n            this.completionModel = null;\r\n        }\r\n        else {\r\n            if (this.state !== 3 /* Open */) {\r\n                var stats = this.completionModel.stats;\r\n                stats['wasAutomaticallyTriggered'] = !!isAuto;\r\n                /* __GDPR__\r\n                    \"suggestWidget\" : {\r\n                        \"wasAutomaticallyTriggered\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\r\n                        \"${include}\": [\r\n                            \"${ICompletionStats}\"\r\n                        ]\r\n                    }\r\n                */\r\n                this.telemetryService.publicLog('suggestWidget', __assign({}, stats));\r\n            }\r\n            this.focusedItem = null;\r\n            this.list.splice(0, this.list.length, this.completionModel.items);\r\n            if (isFrozen) {\r\n                this.setState(4 /* Frozen */);\r\n            }\r\n            else {\r\n                this.setState(3 /* Open */);\r\n            }\r\n            this.list.reveal(selectionIndex, 0);\r\n            this.list.setFocus([selectionIndex]);\r\n            // Reset focus border\r\n            if (this.detailsBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsBorderColor;\r\n            }\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectNextPage = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.pageDown();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusNextPage();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectNext = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusNext(1, true);\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectLast = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.scrollBottom();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusLast();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectPreviousPage = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.pageUp();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusPreviousPage();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectPrevious = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusPrevious(1, true);\r\n                return false;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.selectFirst = function () {\r\n        switch (this.state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this.details.scrollTop();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this.isAuto;\r\n            default:\r\n                this.list.focusFirst();\r\n                return true;\r\n        }\r\n    };\r\n    SuggestWidget.prototype.getFocusedItem = function () {\r\n        if (this.state !== 0 /* Hidden */\r\n            && this.state !== 2 /* Empty */\r\n            && this.state !== 1 /* Loading */\r\n            && this.completionModel) {\r\n            return {\r\n                item: this.list.getFocusedElements()[0],\r\n                index: this.list.getFocus()[0],\r\n                model: this.completionModel\r\n            };\r\n        }\r\n        return undefined;\r\n    };\r\n    SuggestWidget.prototype.toggleDetailsFocus = function () {\r\n        if (this.state === 5 /* Details */) {\r\n            this.setState(3 /* Open */);\r\n            if (this.detailsBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsBorderColor;\r\n            }\r\n        }\r\n        else if (this.state === 3 /* Open */ && this.expandDocsSettingFromStorage()) {\r\n            this.setState(5 /* Details */);\r\n            if (this.detailsFocusBorderColor) {\r\n                this.details.element.style.borderColor = this.detailsFocusBorderColor;\r\n            }\r\n        }\r\n        this.telemetryService.publicLog2('suggestWidget:toggleDetailsFocus');\r\n    };\r\n    SuggestWidget.prototype.toggleDetails = function () {\r\n        if (!canExpandCompletionItem(this.list.getFocusedElements()[0])) {\r\n            return;\r\n        }\r\n        if (this.expandDocsSettingFromStorage()) {\r\n            this.updateExpandDocsSetting(false);\r\n            hide(this.details.element);\r\n            removeClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n            this.editor.layoutContentWidget(this);\r\n            this.setStatusBarRightText(this.msgDetailMore);\r\n            this.telemetryService.publicLog2('suggestWidget:collapseDetails');\r\n        }\r\n        else {\r\n            if (this.state !== 3 /* Open */ && this.state !== 5 /* Details */ && this.state !== 4 /* Frozen */) {\r\n                return;\r\n            }\r\n            this.updateExpandDocsSetting(true);\r\n            this.showDetails(false);\r\n            this.setStatusBarRightText(this.msgDetailsLess);\r\n            this.telemetryService.publicLog2('suggestWidget:expandDetails');\r\n        }\r\n    };\r\n    SuggestWidget.prototype.showDetails = function (loading) {\r\n        if (!loading) {\r\n            // When loading, don't re-layout docs, as item is not resolved yet #88731\r\n            this.expandSideOrBelow();\r\n        }\r\n        show(this.details.element);\r\n        this.details.element.style.maxHeight = this.maxWidgetHeight + 'px';\r\n        if (loading) {\r\n            this.details.renderLoading();\r\n        }\r\n        else {\r\n            this.details.renderItem(this.list.getFocusedElements()[0], this.explainMode);\r\n        }\r\n        // Reset margin-top that was set as Fix for #26416\r\n        this.listElement.style.marginTop = '0px';\r\n        // with docs showing up widget width/height may change, so reposition the widget\r\n        this.editor.layoutContentWidget(this);\r\n        this.adjustDocsPosition();\r\n        this.editor.focus();\r\n    };\r\n    SuggestWidget.prototype.toggleExplainMode = function () {\r\n        if (this.list.getFocusedElements()[0] && this.expandDocsSettingFromStorage()) {\r\n            this.explainMode = !this.explainMode;\r\n            this.showDetails(false);\r\n        }\r\n    };\r\n    SuggestWidget.prototype.show = function () {\r\n        var _this = this;\r\n        var newHeight = this.updateListHeight();\r\n        if (newHeight !== this.listHeight) {\r\n            this.editor.layoutContentWidget(this);\r\n            this.listHeight = newHeight;\r\n        }\r\n        this.suggestWidgetVisible.set(true);\r\n        this.showTimeout.cancelAndSet(function () {\r\n            addClass(_this.element, 'visible');\r\n            _this.onDidShowEmitter.fire(_this);\r\n        }, 100);\r\n    };\r\n    SuggestWidget.prototype.hide = function () {\r\n        this.suggestWidgetVisible.reset();\r\n        this.suggestWidgetMultipleSuggestions.reset();\r\n        removeClass(this.element, 'visible');\r\n    };\r\n    SuggestWidget.prototype.hideWidget = function () {\r\n        this.loadingTimeout.dispose();\r\n        this.setState(0 /* Hidden */);\r\n        this.onDidHideEmitter.fire(this);\r\n    };\r\n    SuggestWidget.prototype.getPosition = function () {\r\n        if (this.state === 0 /* Hidden */) {\r\n            return null;\r\n        }\r\n        var preference = [2 /* BELOW */, 1 /* ABOVE */];\r\n        if (this.preferDocPositionTop) {\r\n            preference = [1 /* ABOVE */];\r\n        }\r\n        return {\r\n            position: this.editor.getPosition(),\r\n            preference: preference\r\n        };\r\n    };\r\n    SuggestWidget.prototype.getDomNode = function () {\r\n        return this.element;\r\n    };\r\n    SuggestWidget.prototype.getId = function () {\r\n        return SuggestWidget.ID;\r\n    };\r\n    SuggestWidget.prototype.isFrozen = function () {\r\n        return this.state === 4 /* Frozen */;\r\n    };\r\n    SuggestWidget.prototype.updateListHeight = function () {\r\n        var height = 0;\r\n        if (this.state === 2 /* Empty */ || this.state === 1 /* Loading */) {\r\n            height = this.unfocusedHeight;\r\n        }\r\n        else {\r\n            var suggestionCount = this.list.contentHeight / this.unfocusedHeight;\r\n            var maxVisibleSuggestions = this.editor.getOption(89 /* suggest */).maxVisibleSuggestions;\r\n            height = Math.min(suggestionCount, maxVisibleSuggestions) * this.unfocusedHeight;\r\n        }\r\n        this.element.style.lineHeight = this.unfocusedHeight + \"px\";\r\n        this.listElement.style.height = height + \"px\";\r\n        this.statusBarElement.style.top = height + \"px\";\r\n        this.list.layout(height);\r\n        return height;\r\n    };\r\n    /**\r\n     * Adds the propert classes, margins when positioning the docs to the side\r\n     */\r\n    SuggestWidget.prototype.adjustDocsPosition = function () {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var lineHeight = this.editor.getOption(49 /* lineHeight */);\r\n        var cursorCoords = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\r\n        var editorCoords = getDomNodePagePosition(this.editor.getDomNode());\r\n        var cursorX = editorCoords.left + cursorCoords.left;\r\n        var cursorY = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n        var widgetCoords = getDomNodePagePosition(this.element);\r\n        var widgetX = widgetCoords.left;\r\n        var widgetY = widgetCoords.top;\r\n        // Fixes #27649\r\n        // Check if the Y changed to the top of the cursor and keep the widget flagged to prefer top\r\n        if (this.docsPositionPreviousWidgetY &&\r\n            this.docsPositionPreviousWidgetY < widgetY &&\r\n            !this.preferDocPositionTop) {\r\n            this.preferDocPositionTop = true;\r\n            this.adjustDocsPosition();\r\n            return;\r\n        }\r\n        this.docsPositionPreviousWidgetY = widgetY;\r\n        if (widgetX < cursorX - this.listWidth) {\r\n            // Widget is too far to the left of cursor, swap list and docs\r\n            addClass(this.element, 'list-right');\r\n        }\r\n        else {\r\n            removeClass(this.element, 'list-right');\r\n        }\r\n        // Compare top of the cursor (cursorY - lineheight) with widgetTop to determine if\r\n        // margin-top needs to be applied on list to make it appear right above the cursor\r\n        // Cannot compare cursorY directly as it may be a few decimals off due to zoooming\r\n        if (hasClass(this.element, 'docs-side')\r\n            && cursorY - lineHeight > widgetY\r\n            && this.details.element.offsetHeight > this.listElement.offsetHeight) {\r\n            // Fix for #26416\r\n            // Docs is bigger than list and widget is above cursor, apply margin-top so that list appears right above cursor\r\n            this.listElement.style.marginTop = this.details.element.offsetHeight - this.listElement.offsetHeight + \"px\";\r\n        }\r\n    };\r\n    /**\r\n     * Adds the proper classes for positioning the docs to the side or below depending on item\r\n     */\r\n    SuggestWidget.prototype.expandSideOrBelow = function () {\r\n        if (!canExpandCompletionItem(this.focusedItem) && this.firstFocusInCurrentList) {\r\n            removeClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n            return;\r\n        }\r\n        var matches = this.element.style.maxWidth.match(/(\\d+)px/);\r\n        if (!matches || Number(matches[1]) < this.maxWidgetWidth) {\r\n            addClass(this.element, 'docs-below');\r\n            removeClass(this.element, 'docs-side');\r\n        }\r\n        else if (canExpandCompletionItem(this.focusedItem)) {\r\n            addClass(this.element, 'docs-side');\r\n            removeClass(this.element, 'docs-below');\r\n        }\r\n    };\r\n    Object.defineProperty(SuggestWidget.prototype, \"maxWidgetHeight\", {\r\n        // Heights\r\n        get: function () {\r\n            return this.unfocusedHeight * this.editor.getOption(89 /* suggest */).maxVisibleSuggestions;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SuggestWidget.prototype, \"unfocusedHeight\", {\r\n        get: function () {\r\n            var options = this.editor.getOptions();\r\n            return options.get(91 /* suggestLineHeight */) || options.get(34 /* fontInfo */).lineHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // IDelegate\r\n    SuggestWidget.prototype.getHeight = function (element) {\r\n        return this.unfocusedHeight;\r\n    };\r\n    SuggestWidget.prototype.getTemplateId = function (element) {\r\n        return 'suggestion';\r\n    };\r\n    SuggestWidget.prototype.expandDocsSettingFromStorage = function () {\r\n        return this.storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, expandSuggestionDocsByDefault);\r\n    };\r\n    SuggestWidget.prototype.updateExpandDocsSetting = function (value) {\r\n        this.storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */);\r\n    };\r\n    SuggestWidget.prototype.setStatusBarLeftText = function (s) {\r\n        this.statusBarLeftSpan.innerText = s;\r\n    };\r\n    SuggestWidget.prototype.setStatusBarRightText = function (s) {\r\n        this.statusBarRightSpan.innerText = s;\r\n    };\r\n    SuggestWidget.prototype.dispose = function () {\r\n        this.details.dispose();\r\n        this.list.dispose();\r\n        this.toDispose.dispose();\r\n        this.loadingTimeout.dispose();\r\n        this.showTimeout.dispose();\r\n    };\r\n    SuggestWidget.ID = 'editor.widget.suggestWidget';\r\n    SuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\r\n    SuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\r\n    SuggestWidget = __decorate([\r\n        __param(1, ITelemetryService),\r\n        __param(2, IKeybindingService),\r\n        __param(3, IContextKeyService),\r\n        __param(4, IThemeService),\r\n        __param(5, IStorageService),\r\n        __param(6, IModeService),\r\n        __param(7, IOpenerService),\r\n        __param(8, IInstantiationService)\r\n    ], SuggestWidget);\r\n    return SuggestWidget;\r\n}());\r\nexport { SuggestWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\r\n    if (matchHighlight) {\r\n        collector.addRule(\".monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: \" + matchHighlight + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorSuggestWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .suggest-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .suggest-widget a { color: \" + link + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .suggest-widget code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { dispose, Disposable } from '../../../base/common/lifecycle.js';\r\nvar WordContextKey = /** @class */ (function (_super) {\r\n    __extends(WordContextKey, _super);\r\n    function WordContextKey(_editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._enabled = false;\r\n        _this._ckAtEnd = WordContextKey.AtEnd.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) { return e.hasChanged(94 /* tabCompletion */) && _this._update(); }));\r\n        _this._update();\r\n        return _this;\r\n    }\r\n    WordContextKey.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        dispose(this._selectionListener);\r\n        this._ckAtEnd.reset();\r\n    };\r\n    WordContextKey.prototype._update = function () {\r\n        var _this = this;\r\n        // only update this when tab completions are enabled\r\n        var enabled = this._editor.getOption(94 /* tabCompletion */) === 'on';\r\n        if (this._enabled === enabled) {\r\n            return;\r\n        }\r\n        this._enabled = enabled;\r\n        if (this._enabled) {\r\n            var checkForWordEnd = function () {\r\n                if (!_this._editor.hasModel()) {\r\n                    _this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                var model = _this._editor.getModel();\r\n                var selection = _this._editor.getSelection();\r\n                var word = model.getWordAtPosition(selection.getStartPosition());\r\n                if (!word) {\r\n                    _this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                _this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\r\n            };\r\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\r\n            checkForWordEnd();\r\n        }\r\n        else if (this._selectionListener) {\r\n            this._ckAtEnd.reset();\r\n            this._selectionListener.dispose();\r\n            this._selectionListener = undefined;\r\n        }\r\n    };\r\n    WordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\r\n    WordContextKey = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], WordContextKey);\r\n    return WordContextKey;\r\n}(Disposable));\r\nexport { WordContextKey };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nvar CommitCharacterController = /** @class */ (function () {\r\n    function CommitCharacterController(editor, widget, accept) {\r\n        var _this = this;\r\n        this._disposables = new DisposableStore();\r\n        this._disposables.add(widget.onDidShow(function () { return _this._onItem(widget.getFocusedItem()); }));\r\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\r\n        this._disposables.add(widget.onDidHide(this.reset, this));\r\n        this._disposables.add(editor.onWillType(function (text) {\r\n            if (_this._active && !widget.isFrozen()) {\r\n                var ch = text.charCodeAt(text.length - 1);\r\n                if (_this._active.acceptCharacters.has(ch) && editor.getOption(0 /* acceptSuggestionOnCommitCharacter */)) {\r\n                    accept(_this._active.item);\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    CommitCharacterController.prototype._onItem = function (selected) {\r\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\r\n            // no item or no commit characters\r\n            this.reset();\r\n            return;\r\n        }\r\n        if (this._active && this._active.item.item === selected.item) {\r\n            // still the same item\r\n            return;\r\n        }\r\n        // keep item and its commit characters\r\n        var acceptCharacters = new CharacterSet();\r\n        for (var _i = 0, _a = selected.item.completion.commitCharacters; _i < _a.length; _i++) {\r\n            var ch = _a[_i];\r\n            if (ch.length > 0) {\r\n                acceptCharacters.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n        this._active = { acceptCharacters: acceptCharacters, item: selected };\r\n    };\r\n    CommitCharacterController.prototype.reset = function () {\r\n        this._active = undefined;\r\n    };\r\n    CommitCharacterController.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n    };\r\n    return CommitCharacterController;\r\n}());\r\nexport { CommitCharacterController };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { DisposableStore, dispose } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { domEvent } from '../../../base/browser/event.js';\r\nvar SuggestRangeHighlighter = /** @class */ (function () {\r\n    function SuggestRangeHighlighter(_controller) {\r\n        var _this = this;\r\n        this._controller = _controller;\r\n        this._disposables = new DisposableStore();\r\n        this._decorations = [];\r\n        this._disposables.add(_controller.model.onDidSuggest(function (e) {\r\n            if (!e.shy) {\r\n                var widget = _this._controller.widget.getValue();\r\n                var focused = widget.getFocusedItem();\r\n                if (focused) {\r\n                    _this._highlight(focused.item);\r\n                }\r\n                if (!_this._widgetListener) {\r\n                    _this._widgetListener = widget.onDidFocus(function (e) { return _this._highlight(e.item); });\r\n                }\r\n            }\r\n        }));\r\n        this._disposables.add(_controller.model.onDidCancel(function () {\r\n            _this._reset();\r\n        }));\r\n    }\r\n    SuggestRangeHighlighter.prototype.dispose = function () {\r\n        this._reset();\r\n        this._disposables.dispose();\r\n        dispose(this._widgetListener);\r\n        dispose(this._shiftKeyListener);\r\n    };\r\n    SuggestRangeHighlighter.prototype._reset = function () {\r\n        this._decorations = this._controller.editor.deltaDecorations(this._decorations, []);\r\n        if (this._shiftKeyListener) {\r\n            this._shiftKeyListener.dispose();\r\n            this._shiftKeyListener = undefined;\r\n        }\r\n    };\r\n    SuggestRangeHighlighter.prototype._highlight = function (item) {\r\n        var _this = this;\r\n        var _a;\r\n        this._currentItem = item;\r\n        var opts = this._controller.editor.getOption(89 /* suggest */);\r\n        var newDeco = [];\r\n        if (opts.insertHighlight) {\r\n            if (!this._shiftKeyListener) {\r\n                this._shiftKeyListener = shiftKey.event(function () { return _this._highlight(_this._currentItem); });\r\n            }\r\n            var info = this._controller.getOverwriteInfo(item, shiftKey.isPressed);\r\n            var position = this._controller.editor.getPosition();\r\n            if (opts.insertMode === 'insert' && info.overwriteAfter > 0) {\r\n                // wants inserts but got replace-mode -> highlight AFTER range\r\n                newDeco = [{\r\n                        range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + info.overwriteAfter),\r\n                        options: { inlineClassName: 'suggest-insert-unexpected' }\r\n                    }];\r\n            }\r\n            else if (opts.insertMode === 'replace' && info.overwriteAfter === 0) {\r\n                // want replace but likely got insert -> highlight AFTER range\r\n                var wordInfo = (_a = this._controller.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position);\r\n                if (wordInfo && wordInfo.endColumn > position.column) {\r\n                    newDeco = [{\r\n                            range: new Range(position.lineNumber, position.column, position.lineNumber, wordInfo.endColumn),\r\n                            options: { inlineClassName: 'suggest-insert-unexpected' }\r\n                        }];\r\n                }\r\n            }\r\n        }\r\n        // update editor decorations\r\n        this._decorations = this._controller.editor.deltaDecorations(this._decorations, newDeco);\r\n    };\r\n    return SuggestRangeHighlighter;\r\n}());\r\nexport { SuggestRangeHighlighter };\r\nvar shiftKey = new /** @class */ (function (_super) {\r\n    __extends(ShiftKey, _super);\r\n    function ShiftKey() {\r\n        var _this = _super.call(this) || this;\r\n        _this._subscriptions = new DisposableStore();\r\n        _this._isPressed = false;\r\n        _this._subscriptions.add(domEvent(document.body, 'keydown')(function (e) { return _this.isPressed = e.shiftKey; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'keyup')(function () { return _this.isPressed = false; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'mouseleave')(function () { return _this.isPressed = false; }));\r\n        _this._subscriptions.add(domEvent(document.body, 'blur')(function () { return _this.isPressed = false; }));\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ShiftKey.prototype, \"isPressed\", {\r\n        get: function () {\r\n            return this._isPressed;\r\n        },\r\n        set: function (value) {\r\n            if (this._isPressed !== value) {\r\n                this._isPressed = value;\r\n                this.fire(value);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ShiftKey.prototype.dispose = function () {\r\n        this._subscriptions.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    return ShiftKey;\r\n}(Emitter));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { SimpleKeybinding } from '../../../base/common/keyCodes.js';\r\nimport { dispose, DisposableStore, toDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { SnippetParser } from '../snippet/snippetParser.js';\r\nimport { ISuggestMemoryService } from './suggestMemory.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService, CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { SuggestAlternatives } from './suggestAlternatives.js';\r\nimport { SuggestModel } from './suggestModel.js';\r\nimport { SuggestWidget } from './suggestWidget.js';\r\nimport { WordContextKey } from './wordContextKey.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IdleValue } from '../../../base/common/async.js';\r\nimport { isObject, assertType } from '../../../base/common/types.js';\r\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { SuggestRangeHighlighter } from './suggestRangeHighlighter.js';\r\n/**\r\n * Stop suggest widget from disappearing when clicking into other areas\r\n * For development purpose only\r\n */\r\nvar _sticky = false;\r\nvar LineSuffix = /** @class */ (function () {\r\n    function LineSuffix(_model, _position) {\r\n        this._model = _model;\r\n        this._position = _position;\r\n        // spy on what's happening right of the cursor. two cases:\r\n        // 1. end of line -> check that it's still end of line\r\n        // 2. mid of line -> add a marker and compute the delta\r\n        var maxColumn = _model.getLineMaxColumn(_position.lineNumber);\r\n        if (maxColumn !== _position.column) {\r\n            var offset = _model.getOffsetAt(_position);\r\n            var end = _model.getPositionAt(offset + 1);\r\n            this._marker = _model.deltaDecorations([], [{\r\n                    range: Range.fromPositions(_position, end),\r\n                    options: { stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ }\r\n                }]);\r\n        }\r\n    }\r\n    LineSuffix.prototype.dispose = function () {\r\n        if (this._marker && !this._model.isDisposed()) {\r\n            this._model.deltaDecorations(this._marker, []);\r\n        }\r\n    };\r\n    LineSuffix.prototype.delta = function (position) {\r\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\r\n            // bail out early if things seems fishy\r\n            return 0;\r\n        }\r\n        // read the marker (in case suggest was triggered at line end) or compare\r\n        // the cursor to the line end.\r\n        if (this._marker) {\r\n            var range = this._model.getDecorationRange(this._marker[0]);\r\n            var end = this._model.getOffsetAt(range.getStartPosition());\r\n            return end - this._model.getOffsetAt(position);\r\n        }\r\n        else {\r\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\r\n        }\r\n    };\r\n    return LineSuffix;\r\n}());\r\nvar SuggestController = /** @class */ (function () {\r\n    function SuggestController(editor, editorWorker, _memoryService, _commandService, _contextKeyService, _instantiationService) {\r\n        var _this = this;\r\n        this._memoryService = _memoryService;\r\n        this._commandService = _commandService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._instantiationService = _instantiationService;\r\n        this._lineSuffix = new MutableDisposable();\r\n        this._toDispose = new DisposableStore();\r\n        this.editor = editor;\r\n        this.model = new SuggestModel(this.editor, editorWorker);\r\n        this.widget = this._toDispose.add(new IdleValue(function () {\r\n            var widget = _this._instantiationService.createInstance(SuggestWidget, _this.editor);\r\n            _this._toDispose.add(widget);\r\n            _this._toDispose.add(widget.onDidSelect(function (item) { return _this._insertSuggestion(item, 0); }, _this));\r\n            // Wire up logic to accept a suggestion on certain characters\r\n            var commitCharacterController = new CommitCharacterController(_this.editor, widget, function (item) { return _this._insertSuggestion(item, 2 /* NoAfterUndoStop */); });\r\n            _this._toDispose.add(commitCharacterController);\r\n            _this._toDispose.add(_this.model.onDidSuggest(function (e) {\r\n                if (e.completionModel.items.length === 0) {\r\n                    commitCharacterController.reset();\r\n                }\r\n            }));\r\n            // Wire up makes text edit context key\r\n            var makesTextEdit = SuggestContext.MakesTextEdit.bindTo(_this._contextKeyService);\r\n            _this._toDispose.add(widget.onDidFocus(function (_a) {\r\n                var item = _a.item;\r\n                var position = _this.editor.getPosition();\r\n                var startColumn = item.editStart.column;\r\n                var endColumn = position.column;\r\n                var value = true;\r\n                if (_this.editor.getOption(1 /* acceptSuggestionOnEnter */) === 'smart'\r\n                    && _this.model.state === 2 /* Auto */\r\n                    && !item.completion.command\r\n                    && !item.completion.additionalTextEdits\r\n                    && !(item.completion.insertTextRules & 4 /* InsertAsSnippet */)\r\n                    && endColumn - startColumn === item.completion.insertText.length) {\r\n                    var oldText = _this.editor.getModel().getValueInRange({\r\n                        startLineNumber: position.lineNumber,\r\n                        startColumn: startColumn,\r\n                        endLineNumber: position.lineNumber,\r\n                        endColumn: endColumn\r\n                    });\r\n                    value = oldText !== item.completion.insertText;\r\n                }\r\n                makesTextEdit.set(value);\r\n            }));\r\n            _this._toDispose.add(toDisposable(function () { return makesTextEdit.reset(); }));\r\n            _this._toDispose.add(widget.onDetailsKeyDown(function (e) {\r\n                // cmd + c on macOS, ctrl + c on Win / Linux\r\n                if (e.toKeybinding().equals(new SimpleKeybinding(true, false, false, false, 33 /* KEY_C */)) ||\r\n                    (platform.isMacintosh && e.toKeybinding().equals(new SimpleKeybinding(false, false, false, true, 33 /* KEY_C */)))) {\r\n                    e.stopPropagation();\r\n                    return;\r\n                }\r\n                if (!e.toKeybinding().isModifierKey()) {\r\n                    _this.editor.focus();\r\n                }\r\n            }));\r\n            return widget;\r\n        }));\r\n        this._alternatives = this._toDispose.add(new IdleValue(function () {\r\n            return _this._toDispose.add(new SuggestAlternatives(_this.editor, _this._contextKeyService));\r\n        }));\r\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\r\n        this._toDispose.add(this.model.onDidTrigger(function (e) {\r\n            _this.widget.getValue().showTriggered(e.auto, e.shy ? 250 : 50);\r\n            _this._lineSuffix.value = new LineSuffix(_this.editor.getModel(), e.position);\r\n        }));\r\n        this._toDispose.add(this.model.onDidSuggest(function (e) {\r\n            if (!e.shy) {\r\n                var index = _this._memoryService.select(_this.editor.getModel(), _this.editor.getPosition(), e.completionModel.items);\r\n                _this.widget.getValue().showSuggestions(e.completionModel, index, e.isFrozen, e.auto);\r\n            }\r\n        }));\r\n        this._toDispose.add(this.model.onDidCancel(function (e) {\r\n            if (!e.retrigger) {\r\n                _this.widget.getValue().hideWidget();\r\n            }\r\n        }));\r\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(function () {\r\n            if (!_sticky) {\r\n                _this.model.cancel();\r\n                _this.model.clear();\r\n            }\r\n        }));\r\n        // Manage the acceptSuggestionsOnEnter context key\r\n        var acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\r\n        var updateFromConfig = function () {\r\n            var acceptSuggestionOnEnter = _this.editor.getOption(1 /* acceptSuggestionOnEnter */);\r\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\r\n        };\r\n        this._toDispose.add(this.editor.onDidChangeConfiguration(function () { return updateFromConfig(); }));\r\n        updateFromConfig();\r\n        // create range highlighter\r\n        this._toDispose.add(new SuggestRangeHighlighter(this));\r\n    }\r\n    SuggestController.get = function (editor) {\r\n        return editor.getContribution(SuggestController.ID);\r\n    };\r\n    SuggestController.prototype.dispose = function () {\r\n        this._alternatives.dispose();\r\n        this._toDispose.dispose();\r\n        this.widget.dispose();\r\n        this.model.dispose();\r\n        this._lineSuffix.dispose();\r\n    };\r\n    SuggestController.prototype._insertSuggestion = function (event, flags) {\r\n        var _a;\r\n        var _this = this;\r\n        if (!event || !event.item) {\r\n            this._alternatives.getValue().reset();\r\n            this.model.cancel();\r\n            this.model.clear();\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this.editor.getModel();\r\n        var modelVersionNow = model.getAlternativeVersionId();\r\n        var item = event.item;\r\n        var suggestion = item.completion;\r\n        // pushing undo stops *before* additional text edits and\r\n        // *after* the main edit\r\n        if (!(flags & 1 /* NoBeforeUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\r\n        var info = this.getOverwriteInfo(item, Boolean(flags & 8 /* AlternativeOverwriteConfig */));\r\n        // keep item in memory\r\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\r\n        if (Array.isArray(suggestion.additionalTextEdits)) {\r\n            this.editor.executeEdits('suggestController.additionalTextEdits', suggestion.additionalTextEdits.map(function (edit) { return EditOperation.replace(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        var insertText = suggestion.insertText;\r\n        if (!(suggestion.insertTextRules & 4 /* InsertAsSnippet */)) {\r\n            insertText = SnippetParser.escape(insertText);\r\n        }\r\n        SnippetController2.get(this.editor).insert(insertText, {\r\n            overwriteBefore: info.overwriteBefore,\r\n            overwriteAfter: info.overwriteAfter,\r\n            undoStopBefore: false,\r\n            undoStopAfter: false,\r\n            adjustWhitespace: !(suggestion.insertTextRules & 1 /* KeepWhitespace */)\r\n        });\r\n        if (!(flags & 2 /* NoAfterUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        if (!suggestion.command) {\r\n            // done\r\n            this.model.cancel();\r\n            this.model.clear();\r\n        }\r\n        else if (suggestion.command.id === TriggerSuggestAction.id) {\r\n            // retigger\r\n            this.model.trigger({ auto: true, shy: false }, true);\r\n        }\r\n        else {\r\n            // exec command, done\r\n            (_a = this._commandService).executeCommand.apply(_a, __spreadArrays([suggestion.command.id], (suggestion.command.arguments ? __spreadArrays(suggestion.command.arguments) : []))).catch(onUnexpectedError)\r\n                .finally(function () { return _this.model.clear(); }); // <- clear only now, keep commands alive\r\n            this.model.cancel();\r\n        }\r\n        if (flags & 4 /* KeepAlternativeSuggestions */) {\r\n            this._alternatives.getValue().set(event, function (next) {\r\n                // this is not so pretty. when inserting the 'next'\r\n                // suggestion we undo until we are at the state at\r\n                // which we were before inserting the previous suggestion...\r\n                while (model.canUndo()) {\r\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\r\n                        model.undo();\r\n                    }\r\n                    _this._insertSuggestion(next, 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */ | (flags & 8 /* AlternativeOverwriteConfig */ ? 8 /* AlternativeOverwriteConfig */ : 0));\r\n                    break;\r\n                }\r\n            });\r\n        }\r\n        this._alertCompletionItem(event.item);\r\n    };\r\n    SuggestController.prototype.getOverwriteInfo = function (item, toggleMode) {\r\n        assertType(this.editor.hasModel());\r\n        var replace = this.editor.getOption(89 /* suggest */).insertMode === 'replace';\r\n        if (toggleMode) {\r\n            replace = !replace;\r\n        }\r\n        var overwriteBefore = item.position.column - item.editStart.column;\r\n        var overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\r\n        var columnDelta = this.editor.getPosition().column - item.position.column;\r\n        var suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\r\n        return {\r\n            overwriteBefore: overwriteBefore + columnDelta,\r\n            overwriteAfter: overwriteAfter + suffixDelta\r\n        };\r\n    };\r\n    SuggestController.prototype._alertCompletionItem = function (_a) {\r\n        var suggestion = _a.completion;\r\n        var textLabel = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.name;\r\n        if (isNonEmptyArray(suggestion.additionalTextEdits)) {\r\n            var msg = nls.localize('arai.alert.snippet', \"Accepting '{0}' made {1} additional edits\", textLabel, suggestion.additionalTextEdits.length);\r\n            alert(msg);\r\n        }\r\n    };\r\n    SuggestController.prototype.triggerSuggest = function (onlyFrom) {\r\n        if (this.editor.hasModel()) {\r\n            this.model.trigger({ auto: false, shy: false }, false, onlyFrom);\r\n            this.editor.revealLine(this.editor.getPosition().lineNumber, 0 /* Smooth */);\r\n            this.editor.focus();\r\n        }\r\n    };\r\n    SuggestController.prototype.triggerSuggestAndAcceptBest = function (arg) {\r\n        var _this = this;\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var positionNow = this.editor.getPosition();\r\n        var fallback = function () {\r\n            if (positionNow.equals(_this.editor.getPosition())) {\r\n                _this._commandService.executeCommand(arg.fallback);\r\n            }\r\n        };\r\n        var makesTextEdit = function (item) {\r\n            if (item.completion.insertTextRules & 4 /* InsertAsSnippet */ || item.completion.additionalTextEdits) {\r\n                // snippet, other editor -> makes edit\r\n                return true;\r\n            }\r\n            var position = _this.editor.getPosition();\r\n            var startColumn = item.editStart.column;\r\n            var endColumn = position.column;\r\n            if (endColumn - startColumn !== item.completion.insertText.length) {\r\n                // unequal lengths -> makes edit\r\n                return true;\r\n            }\r\n            var textNow = _this.editor.getModel().getValueInRange({\r\n                startLineNumber: position.lineNumber,\r\n                startColumn: startColumn,\r\n                endLineNumber: position.lineNumber,\r\n                endColumn: endColumn\r\n            });\r\n            // unequal text -> makes edit\r\n            return textNow !== item.completion.insertText;\r\n        };\r\n        Event.once(this.model.onDidTrigger)(function (_) {\r\n            // wait for trigger because only then the cancel-event is trustworthy\r\n            var listener = [];\r\n            Event.any(_this.model.onDidTrigger, _this.model.onDidCancel)(function () {\r\n                // retrigger or cancel -> try to type default text\r\n                dispose(listener);\r\n                fallback();\r\n            }, undefined, listener);\r\n            _this.model.onDidSuggest(function (_a) {\r\n                var completionModel = _a.completionModel;\r\n                dispose(listener);\r\n                if (completionModel.items.length === 0) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                var index = _this._memoryService.select(_this.editor.getModel(), _this.editor.getPosition(), completionModel.items);\r\n                var item = completionModel.items[index];\r\n                if (!makesTextEdit(item)) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                _this.editor.pushUndoStop();\r\n                _this._insertSuggestion({ index: index, item: item, model: completionModel }, 4 /* KeepAlternativeSuggestions */ | 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */);\r\n            }, undefined, listener);\r\n        });\r\n        this.model.trigger({ auto: false, shy: true });\r\n        this.editor.revealLine(positionNow.lineNumber, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    };\r\n    SuggestController.prototype.acceptSelectedSuggestion = function (keepAlternativeSuggestions, alternativeOverwriteConfig) {\r\n        var item = this.widget.getValue().getFocusedItem();\r\n        var flags = 0;\r\n        if (keepAlternativeSuggestions) {\r\n            flags |= 4 /* KeepAlternativeSuggestions */;\r\n        }\r\n        if (alternativeOverwriteConfig) {\r\n            flags |= 8 /* AlternativeOverwriteConfig */;\r\n        }\r\n        this._insertSuggestion(item, flags);\r\n    };\r\n    SuggestController.prototype.acceptNextSuggestion = function () {\r\n        this._alternatives.getValue().next();\r\n    };\r\n    SuggestController.prototype.acceptPrevSuggestion = function () {\r\n        this._alternatives.getValue().prev();\r\n    };\r\n    SuggestController.prototype.cancelSuggestWidget = function () {\r\n        this.model.cancel();\r\n        this.model.clear();\r\n        this.widget.getValue().hideWidget();\r\n    };\r\n    SuggestController.prototype.selectNextSuggestion = function () {\r\n        this.widget.getValue().selectNext();\r\n    };\r\n    SuggestController.prototype.selectNextPageSuggestion = function () {\r\n        this.widget.getValue().selectNextPage();\r\n    };\r\n    SuggestController.prototype.selectLastSuggestion = function () {\r\n        this.widget.getValue().selectLast();\r\n    };\r\n    SuggestController.prototype.selectPrevSuggestion = function () {\r\n        this.widget.getValue().selectPrevious();\r\n    };\r\n    SuggestController.prototype.selectPrevPageSuggestion = function () {\r\n        this.widget.getValue().selectPreviousPage();\r\n    };\r\n    SuggestController.prototype.selectFirstSuggestion = function () {\r\n        this.widget.getValue().selectFirst();\r\n    };\r\n    SuggestController.prototype.toggleSuggestionDetails = function () {\r\n        this.widget.getValue().toggleDetails();\r\n    };\r\n    SuggestController.prototype.toggleExplainMode = function () {\r\n        this.widget.getValue().toggleExplainMode();\r\n    };\r\n    SuggestController.prototype.toggleSuggestionFocus = function () {\r\n        this.widget.getValue().toggleDetailsFocus();\r\n    };\r\n    SuggestController.ID = 'editor.contrib.suggestController';\r\n    SuggestController = __decorate([\r\n        __param(1, IEditorWorkerService),\r\n        __param(2, ISuggestMemoryService),\r\n        __param(3, ICommandService),\r\n        __param(4, IContextKeyService),\r\n        __param(5, IInstantiationService)\r\n    ], SuggestController);\r\n    return SuggestController;\r\n}());\r\nexport { SuggestController };\r\nvar TriggerSuggestAction = /** @class */ (function (_super) {\r\n    __extends(TriggerSuggestAction, _super);\r\n    function TriggerSuggestAction() {\r\n        return _super.call(this, {\r\n            id: TriggerSuggestAction.id,\r\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\r\n            alias: 'Trigger Suggest',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n                mac: { primary: 256 /* WinCtrl */ | 10 /* Space */, secondary: [512 /* Alt */ | 9 /* Escape */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerSuggestAction.prototype.run = function (accessor, editor) {\r\n        var controller = SuggestController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.triggerSuggest();\r\n    };\r\n    TriggerSuggestAction.id = 'editor.action.triggerSuggest';\r\n    return TriggerSuggestAction;\r\n}(EditorAction));\r\nexport { TriggerSuggestAction };\r\nregisterEditorContribution(SuggestController.ID, SuggestController);\r\nregisterEditorAction(TriggerSuggestAction);\r\nvar weight = 100 /* EditorContrib */ + 90;\r\nvar SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'acceptSelectedSuggestion',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) {\r\n        x.acceptSelectedSuggestion(true, false);\r\n    }\r\n}));\r\n// normal tab\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    primary: 2 /* Tab */,\r\n    weight: weight\r\n});\r\n// accept on enter has special rules\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\r\n    primary: 3 /* Enter */,\r\n    weight: weight\r\n});\r\n// todo@joh control enablement via context key\r\n// shift+enter and shift+tab use the alternative-flag so that the suggest controller\r\n// is doing the opposite of the editor.suggest.overwriteOnAccept-configuration\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'acceptAlternativeSelectedSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 1024 /* Shift */ | 3 /* Enter */,\r\n        secondary: [1024 /* Shift */ | 2 /* Tab */],\r\n    },\r\n    handler: function (x) {\r\n        x.acceptSelectedSuggestion(false, true);\r\n    },\r\n}));\r\n// continue to support the old command\r\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'hideSuggestWidget',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.cancelSuggestWidget(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectNextSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectNextPageSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 12 /* PageDown */,\r\n        secondary: [2048 /* CtrlCmd */ | 12 /* PageDown */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectLastSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectLastSuggestion(); }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectPrevSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectPrevPageSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 11 /* PageUp */,\r\n        secondary: [2048 /* CtrlCmd */ | 11 /* PageUp */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectFirstSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: function (c) { return c.selectFirstSuggestion(); }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionDetails',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleSuggestionDetails(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 10 /* Space */ }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleExplainMode',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleExplainMode(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */,\r\n        primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionFocus',\r\n    precondition: SuggestContext.Visible,\r\n    handler: function (x) { return x.toggleSuggestionFocus(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 10 /* Space */ }\r\n    }\r\n}));\r\n//#region tab completions\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertBestCompletion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x, arg) {\r\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? __assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\r\n    },\r\n    kbOpts: {\r\n        weight: weight,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertNextSuggestion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x) { return x.acceptNextSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: function (x) { return x.acceptPrevSuggestion(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\nvar ForceRetokenizeAction = /** @class */ (function (_super) {\r\n    __extends(ForceRetokenizeAction, _super);\r\n    function ForceRetokenizeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.forceRetokenize',\r\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\r\n            alias: 'Developer: Force Retokenize',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    ForceRetokenizeAction.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        model.resetTokenization();\r\n        var sw = new StopWatch(true);\r\n        model.forceTokenization(model.getLineCount());\r\n        sw.stop();\r\n        console.log(\"tokenization took \" + sw.elapsed());\r\n    };\r\n    return ForceRetokenizeAction;\r\n}(EditorAction));\r\nregisterEditorAction(ForceRetokenizeAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { TabFocus } from '../../common/config/commonEditorConfig.js';\r\nvar ToggleTabFocusModeAction = /** @class */ (function (_super) {\r\n    __extends(ToggleTabFocusModeAction, _super);\r\n    function ToggleTabFocusModeAction() {\r\n        return _super.call(this, {\r\n            id: ToggleTabFocusModeAction.ID,\r\n            label: nls.localize({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, \"Toggle Tab Key Moves Focus\"),\r\n            alias: 'Toggle Tab Key Moves Focus',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 43 /* KEY_M */,\r\n                mac: { primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 43 /* KEY_M */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ToggleTabFocusModeAction.prototype.run = function (accessor, editor) {\r\n        var oldValue = TabFocus.getTabFocusMode();\r\n        var newValue = !oldValue;\r\n        TabFocus.setTabFocusMode(newValue);\r\n        if (newValue) {\r\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\r\n        }\r\n        else {\r\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\r\n        }\r\n    };\r\n    ToggleTabFocusModeAction.ID = 'editor.action.toggleTabFocusMode';\r\n    return ToggleTabFocusModeAction;\r\n}(EditorAction));\r\nexport { ToggleTabFocusModeAction };\r\nregisterEditorAction(ToggleTabFocusModeAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { createCancelablePromise, first, timeout } from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightKind, DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { activeContrastBorder, editorSelectionHighlight, editorSelectionHighlightBorder, overviewRulerSelectionHighlightForeground, registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nvar editorWordHighlight = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hc: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar editorWordHighlightStrong = registerColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hc: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar editorWordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\r\nvar editorWordHighlightStrongBorder = registerColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\r\nvar overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hc: '#A0A0A0CC' }, nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', { dark: '#C0A0C0CC', light: '#C0A0C0CC', hc: '#C0A0C0CC' }, nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nvar ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\r\nexport function getOccurrencesAtPosition(model, position, token) {\r\n    var orderedByScore = DocumentHighlightProviderRegistry.ordered(model);\r\n    // in order of score ask the occurrences provider\r\n    // until someone response with a good result\r\n    // (good = none empty array)\r\n    return first(orderedByScore.map(function (provider) { return function () {\r\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\r\n            .then(undefined, onUnexpectedExternalError);\r\n    }; }), arrays.isNonEmptyArray);\r\n}\r\nvar OccurenceAtPositionRequest = /** @class */ (function () {\r\n    function OccurenceAtPositionRequest(model, selection, wordSeparators) {\r\n        var _this = this;\r\n        this._wordRange = this._getCurrentWordRange(model, selection);\r\n        this.result = createCancelablePromise(function (token) { return _this._compute(model, selection, wordSeparators, token); });\r\n    }\r\n    OccurenceAtPositionRequest.prototype._getCurrentWordRange = function (model, selection) {\r\n        var word = model.getWordAtPosition(selection.getPosition());\r\n        if (word) {\r\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n        }\r\n        return null;\r\n    };\r\n    OccurenceAtPositionRequest.prototype.isValid = function (model, selection, decorationIds) {\r\n        var lineNumber = selection.startLineNumber;\r\n        var startColumn = selection.startColumn;\r\n        var endColumn = selection.endColumn;\r\n        var currentWordRange = this._getCurrentWordRange(model, selection);\r\n        var requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\r\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\r\n        // (Same symbol)\r\n        for (var i = 0, len = decorationIds.length; !requestIsValid && i < len; i++) {\r\n            var range = model.getDecorationRange(decorationIds[i]);\r\n            if (range && range.startLineNumber === lineNumber) {\r\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\r\n                    requestIsValid = true;\r\n                }\r\n            }\r\n        }\r\n        return requestIsValid;\r\n    };\r\n    OccurenceAtPositionRequest.prototype.cancel = function () {\r\n        this.result.cancel();\r\n    };\r\n    return OccurenceAtPositionRequest;\r\n}());\r\nvar SemanticOccurenceAtPositionRequest = /** @class */ (function (_super) {\r\n    __extends(SemanticOccurenceAtPositionRequest, _super);\r\n    function SemanticOccurenceAtPositionRequest() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SemanticOccurenceAtPositionRequest.prototype._compute = function (model, selection, wordSeparators, token) {\r\n        return getOccurrencesAtPosition(model, selection.getPosition(), token).then(function (value) { return value || []; });\r\n    };\r\n    return SemanticOccurenceAtPositionRequest;\r\n}(OccurenceAtPositionRequest));\r\nvar TextualOccurenceAtPositionRequest = /** @class */ (function (_super) {\r\n    __extends(TextualOccurenceAtPositionRequest, _super);\r\n    function TextualOccurenceAtPositionRequest(model, selection, wordSeparators) {\r\n        var _this = _super.call(this, model, selection, wordSeparators) || this;\r\n        _this._selectionIsEmpty = selection.isEmpty();\r\n        return _this;\r\n    }\r\n    TextualOccurenceAtPositionRequest.prototype._compute = function (model, selection, wordSeparators, token) {\r\n        return timeout(250, token).then(function () {\r\n            if (!selection.isEmpty()) {\r\n                return [];\r\n            }\r\n            var word = model.getWordAtPosition(selection.getPosition());\r\n            if (!word) {\r\n                return [];\r\n            }\r\n            var matches = model.findMatches(word.word, true, false, true, wordSeparators, false);\r\n            return matches.map(function (m) {\r\n                return {\r\n                    range: m.range,\r\n                    kind: DocumentHighlightKind.Text\r\n                };\r\n            });\r\n        });\r\n    };\r\n    TextualOccurenceAtPositionRequest.prototype.isValid = function (model, selection, decorationIds) {\r\n        var currentSelectionIsEmpty = selection.isEmpty();\r\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\r\n            return false;\r\n        }\r\n        return _super.prototype.isValid.call(this, model, selection, decorationIds);\r\n    };\r\n    return TextualOccurenceAtPositionRequest;\r\n}(OccurenceAtPositionRequest));\r\nfunction computeOccurencesAtPosition(model, selection, wordSeparators) {\r\n    if (DocumentHighlightProviderRegistry.has(model)) {\r\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n    }\r\n    return new TextualOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n}\r\nregisterModelAndPositionCommand('_executeDocumentHighlights', function (model, position) { return getOccurrencesAtPosition(model, position, CancellationToken.None); });\r\nvar WordHighlighter = /** @class */ (function () {\r\n    function WordHighlighter(editor, contextKeyService) {\r\n        var _this = this;\r\n        this.toUnhook = new DisposableStore();\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequestCompleted = false;\r\n        this.workerRequestValue = [];\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n        this.editor = editor;\r\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\r\n        this._ignorePositionChangeEvent = false;\r\n        this.occurrencesHighlight = this.editor.getOption(61 /* occurrencesHighlight */);\r\n        this.model = this.editor.getModel();\r\n        this.toUnhook.add(editor.onDidChangeCursorPosition(function (e) {\r\n            if (_this._ignorePositionChangeEvent) {\r\n                // We are changing the position => ignore this event\r\n                return;\r\n            }\r\n            if (!_this.occurrencesHighlight) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            _this._onPositionChanged(e);\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeModelContent(function (e) {\r\n            _this._stopAll();\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeConfiguration(function (e) {\r\n            var newValue = _this.editor.getOption(61 /* occurrencesHighlight */);\r\n            if (_this.occurrencesHighlight !== newValue) {\r\n                _this.occurrencesHighlight = newValue;\r\n                _this._stopAll();\r\n            }\r\n        }));\r\n        this._decorationIds = [];\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequest = null;\r\n        this.workerRequestCompleted = false;\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n    }\r\n    WordHighlighter.prototype.hasDecorations = function () {\r\n        return (this._decorationIds.length > 0);\r\n    };\r\n    WordHighlighter.prototype.restore = function () {\r\n        if (!this.occurrencesHighlight) {\r\n            return;\r\n        }\r\n        this._run();\r\n    };\r\n    WordHighlighter.prototype._getSortedHighlights = function () {\r\n        var _this = this;\r\n        return arrays.coalesce(this._decorationIds\r\n            .map(function (id) { return _this.model.getDecorationRange(id); })\r\n            .sort(Range.compareRangesUsingStarts));\r\n    };\r\n    WordHighlighter.prototype.moveNext = function () {\r\n        var _this = this;\r\n        var highlights = this._getSortedHighlights();\r\n        var index = arrays.firstIndex(highlights, function (range) { return range.containsPosition(_this.editor.getPosition()); });\r\n        var newIndex = ((index + 1) % highlights.length);\r\n        var dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    };\r\n    WordHighlighter.prototype.moveBack = function () {\r\n        var _this = this;\r\n        var highlights = this._getSortedHighlights();\r\n        var index = arrays.firstIndex(highlights, function (range) { return range.containsPosition(_this.editor.getPosition()); });\r\n        var newIndex = ((index - 1 + highlights.length) % highlights.length);\r\n        var dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    };\r\n    WordHighlighter.prototype._removeDecorations = function () {\r\n        if (this._decorationIds.length > 0) {\r\n            // remove decorations\r\n            this._decorationIds = this.editor.deltaDecorations(this._decorationIds, []);\r\n            this._hasWordHighlights.set(false);\r\n        }\r\n    };\r\n    WordHighlighter.prototype._stopAll = function () {\r\n        // Remove any existing decorations\r\n        this._removeDecorations();\r\n        // Cancel any renderDecorationsTimer\r\n        if (this.renderDecorationsTimer !== -1) {\r\n            clearTimeout(this.renderDecorationsTimer);\r\n            this.renderDecorationsTimer = -1;\r\n        }\r\n        // Cancel any worker request\r\n        if (this.workerRequest !== null) {\r\n            this.workerRequest.cancel();\r\n            this.workerRequest = null;\r\n        }\r\n        // Invalidate any worker request callback\r\n        if (!this.workerRequestCompleted) {\r\n            this.workerRequestTokenId++;\r\n            this.workerRequestCompleted = true;\r\n        }\r\n    };\r\n    WordHighlighter.prototype._onPositionChanged = function (e) {\r\n        // disabled\r\n        if (!this.occurrencesHighlight) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // ignore typing & other\r\n        if (e.reason !== 3 /* Explicit */) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        this._run();\r\n    };\r\n    WordHighlighter.prototype._run = function () {\r\n        var _this = this;\r\n        var editorSelection = this.editor.getSelection();\r\n        // ignore multiline selection\r\n        if (editorSelection.startLineNumber !== editorSelection.endLineNumber) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        var lineNumber = editorSelection.startLineNumber;\r\n        var startColumn = editorSelection.startColumn;\r\n        var endColumn = editorSelection.endColumn;\r\n        var word = this.model.getWordAtPosition({\r\n            lineNumber: lineNumber,\r\n            column: startColumn\r\n        });\r\n        // The selection must be inside a word or surround one word at most\r\n        if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // All the effort below is trying to achieve this:\r\n        // - when cursor is moved to a word, trigger immediately a findOccurrences request\r\n        // - 250ms later after the last cursor move event, render the occurrences\r\n        // - no flickering!\r\n        var workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this._decorationIds));\r\n        // There are 4 cases:\r\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\r\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\r\n        // c) old workerRequest is valid, but not completed\r\n        // d) old workerRequest is not valid\r\n        // For a) no action is needed\r\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\r\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\r\n        if (workerRequestIsValid) {\r\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\r\n                // case b)\r\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\r\n                clearTimeout(this.renderDecorationsTimer);\r\n                this.renderDecorationsTimer = -1;\r\n                this._beginRenderDecorations();\r\n            }\r\n        }\r\n        else {\r\n            // case d)\r\n            // Stop all previous actions and start fresh\r\n            this._stopAll();\r\n            var myRequestId_1 = ++this.workerRequestTokenId;\r\n            this.workerRequestCompleted = false;\r\n            this.workerRequest = computeOccurencesAtPosition(this.model, this.editor.getSelection(), this.editor.getOption(96 /* wordSeparators */));\r\n            this.workerRequest.result.then(function (data) {\r\n                if (myRequestId_1 === _this.workerRequestTokenId) {\r\n                    _this.workerRequestCompleted = true;\r\n                    _this.workerRequestValue = data || [];\r\n                    _this._beginRenderDecorations();\r\n                }\r\n            }, onUnexpectedError);\r\n        }\r\n    };\r\n    WordHighlighter.prototype._beginRenderDecorations = function () {\r\n        var _this = this;\r\n        var currentTime = (new Date()).getTime();\r\n        var minimumRenderTime = this.lastCursorPositionChangeTime + 250;\r\n        if (currentTime >= minimumRenderTime) {\r\n            // Synchronous\r\n            this.renderDecorationsTimer = -1;\r\n            this.renderDecorations();\r\n        }\r\n        else {\r\n            // Asynchronous\r\n            this.renderDecorationsTimer = setTimeout(function () {\r\n                _this.renderDecorations();\r\n            }, (minimumRenderTime - currentTime));\r\n        }\r\n    };\r\n    WordHighlighter.prototype.renderDecorations = function () {\r\n        this.renderDecorationsTimer = -1;\r\n        var decorations = [];\r\n        for (var i = 0, len = this.workerRequestValue.length; i < len; i++) {\r\n            var info = this.workerRequestValue[i];\r\n            decorations.push({\r\n                range: info.range,\r\n                options: WordHighlighter._getDecorationOptions(info.kind)\r\n            });\r\n        }\r\n        this._decorationIds = this.editor.deltaDecorations(this._decorationIds, decorations);\r\n        this._hasWordHighlights.set(this.hasDecorations());\r\n    };\r\n    WordHighlighter._getDecorationOptions = function (kind) {\r\n        if (kind === DocumentHighlightKind.Write) {\r\n            return this._WRITE_OPTIONS;\r\n        }\r\n        else if (kind === DocumentHighlightKind.Text) {\r\n            return this._TEXT_OPTIONS;\r\n        }\r\n        else {\r\n            return this._REGULAR_OPTIONS;\r\n        }\r\n    };\r\n    WordHighlighter.prototype.dispose = function () {\r\n        this._stopAll();\r\n        this.toUnhook.dispose();\r\n    };\r\n    WordHighlighter._WRITE_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'wordHighlightStrong',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    WordHighlighter._TEXT_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    WordHighlighter._REGULAR_OPTIONS = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'wordHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerWordHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    return WordHighlighter;\r\n}());\r\nvar WordHighlighterContribution = /** @class */ (function (_super) {\r\n    __extends(WordHighlighterContribution, _super);\r\n    function WordHighlighterContribution(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.wordHighligher = null;\r\n        var createWordHighlighterIfPossible = function () {\r\n            if (editor.hasModel()) {\r\n                _this.wordHighligher = new WordHighlighter(editor, contextKeyService);\r\n            }\r\n        };\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            if (_this.wordHighligher) {\r\n                _this.wordHighligher.dispose();\r\n                _this.wordHighligher = null;\r\n            }\r\n            createWordHighlighterIfPossible();\r\n        }));\r\n        createWordHighlighterIfPossible();\r\n        return _this;\r\n    }\r\n    WordHighlighterContribution.get = function (editor) {\r\n        return editor.getContribution(WordHighlighterContribution.ID);\r\n    };\r\n    WordHighlighterContribution.prototype.saveViewState = function () {\r\n        if (this.wordHighligher && this.wordHighligher.hasDecorations()) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    WordHighlighterContribution.prototype.moveNext = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.moveNext();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.moveBack = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.moveBack();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.restoreViewState = function (state) {\r\n        if (this.wordHighligher && state) {\r\n            this.wordHighligher.restore();\r\n        }\r\n    };\r\n    WordHighlighterContribution.prototype.dispose = function () {\r\n        if (this.wordHighligher) {\r\n            this.wordHighligher.dispose();\r\n            this.wordHighligher = null;\r\n        }\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    WordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\r\n    WordHighlighterContribution = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], WordHighlighterContribution);\r\n    return WordHighlighterContribution;\r\n}(Disposable));\r\nvar WordHighlightNavigationAction = /** @class */ (function (_super) {\r\n    __extends(WordHighlightNavigationAction, _super);\r\n    function WordHighlightNavigationAction(next, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        return _this;\r\n    }\r\n    WordHighlightNavigationAction.prototype.run = function (accessor, editor) {\r\n        var controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        if (this._isNext) {\r\n            controller.moveNext();\r\n        }\r\n        else {\r\n            controller.moveBack();\r\n        }\r\n    };\r\n    return WordHighlightNavigationAction;\r\n}(EditorAction));\r\nvar NextWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(NextWordHighlightAction, _super);\r\n    function NextWordHighlightAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.wordHighlight.next',\r\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\r\n            alias: 'Go to Next Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextWordHighlightAction;\r\n}(WordHighlightNavigationAction));\r\nvar PrevWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(PrevWordHighlightAction, _super);\r\n    function PrevWordHighlightAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.wordHighlight.prev',\r\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\r\n            alias: 'Go to Previous Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevWordHighlightAction;\r\n}(WordHighlightNavigationAction));\r\nvar TriggerWordHighlightAction = /** @class */ (function (_super) {\r\n    __extends(TriggerWordHighlightAction, _super);\r\n    function TriggerWordHighlightAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.wordHighlight.trigger',\r\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\r\n            alias: 'Trigger Symbol Highlight',\r\n            precondition: ctxHasWordHighlights.toNegated(),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerWordHighlightAction.prototype.run = function (accessor, editor, args) {\r\n        var controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.restoreViewState(true);\r\n    };\r\n    return TriggerWordHighlightAction;\r\n}(EditorAction));\r\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution);\r\nregisterEditorAction(NextWordHighlightAction);\r\nregisterEditorAction(PrevWordHighlightAction);\r\nregisterEditorAction(TriggerWordHighlightAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var selectionHighlight = theme.getColor(editorSelectionHighlight);\r\n    if (selectionHighlight) {\r\n        collector.addRule(\".monaco-editor .focused .selectionHighlight { background-color: \" + selectionHighlight + \"; }\");\r\n        collector.addRule(\".monaco-editor .selectionHighlight { background-color: \" + selectionHighlight.transparent(0.5) + \"; }\");\r\n    }\r\n    var wordHighlight = theme.getColor(editorWordHighlight);\r\n    if (wordHighlight) {\r\n        collector.addRule(\".monaco-editor .wordHighlight { background-color: \" + wordHighlight + \"; }\");\r\n    }\r\n    var wordHighlightStrong = theme.getColor(editorWordHighlightStrong);\r\n    if (wordHighlightStrong) {\r\n        collector.addRule(\".monaco-editor .wordHighlightStrong { background-color: \" + wordHighlightStrong + \"; }\");\r\n    }\r\n    var selectionHighlightBorder = theme.getColor(editorSelectionHighlightBorder);\r\n    if (selectionHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .selectionHighlight { border: 1px \" + (theme.type === 'hc' ? 'dotted' : 'solid') + \" \" + selectionHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var wordHighlightBorder = theme.getColor(editorWordHighlightBorder);\r\n    if (wordHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .wordHighlight { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + wordHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var wordHighlightStrongBorder = theme.getColor(editorWordHighlightStrongBorder);\r\n    if (wordHighlightStrongBorder) {\r\n        collector.addRule(\".monaco-editor .wordHighlightStrong { border: 1px \" + (theme.type === 'hc' ? 'dashed' : 'solid') + \" \" + wordHighlightStrongBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand } from '../../common/commands/replaceCommand.js';\r\nimport { CursorState } from '../../common/controller/cursorCommon.js';\r\nimport { WordOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { getMapForWordSeparators } from '../../common/controller/wordCharacterClassifier.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { EditorOptions } from '../../common/config/editorOptions.js';\r\nvar MoveWordCommand = /** @class */ (function (_super) {\r\n    __extends(MoveWordCommand, _super);\r\n    function MoveWordCommand(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._inSelectionMode = opts.inSelectionMode;\r\n        _this._wordNavigationType = opts.wordNavigationType;\r\n        return _this;\r\n    }\r\n    MoveWordCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var wordSeparators = getMapForWordSeparators(editor.getOption(96 /* wordSeparators */));\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var result = selections.map(function (sel) {\r\n            var inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\r\n            var outPosition = _this._move(wordSeparators, model, inPosition, _this._wordNavigationType);\r\n            return _this._moveTo(sel, outPosition, _this._inSelectionMode);\r\n        });\r\n        editor._getCursors().setStates('moveWordCommand', 0 /* NotSet */, result.map(function (r) { return CursorState.fromModelSelection(r); }));\r\n        if (result.length === 1) {\r\n            var pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\r\n            editor.revealPosition(pos, 0 /* Smooth */);\r\n        }\r\n    };\r\n    MoveWordCommand.prototype._moveTo = function (from, to, inSelectionMode) {\r\n        if (inSelectionMode) {\r\n            // move just position\r\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\r\n        }\r\n        else {\r\n            // move everything\r\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\r\n        }\r\n    };\r\n    return MoveWordCommand;\r\n}(EditorCommand));\r\nexport { MoveWordCommand };\r\nvar WordLeftCommand = /** @class */ (function (_super) {\r\n    __extends(WordLeftCommand, _super);\r\n    function WordLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordLeftCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType);\r\n    };\r\n    return WordLeftCommand;\r\n}(MoveWordCommand));\r\nexport { WordLeftCommand };\r\nvar WordRightCommand = /** @class */ (function (_super) {\r\n    __extends(WordRightCommand, _super);\r\n    function WordRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordRightCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\r\n    };\r\n    return WordRightCommand;\r\n}(MoveWordCommand));\r\nexport { WordRightCommand };\r\nvar CursorWordStartLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartLeft, _super);\r\n    function CursorWordStartLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordStartLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordStartLeft };\r\nvar CursorWordEndLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndLeft, _super);\r\n    function CursorWordEndLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeft',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordEndLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordEndLeft };\r\nvar CursorWordLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordLeft, _super);\r\n    function CursorWordLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeft',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordLeft };\r\nvar CursorWordStartLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartLeftSelect, _super);\r\n    function CursorWordStartLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordStartLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordStartLeftSelect };\r\nvar CursorWordEndLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndLeftSelect, _super);\r\n    function CursorWordEndLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeftSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordEndLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordEndLeftSelect };\r\nvar CursorWordLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordLeftSelect, _super);\r\n    function CursorWordLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeftSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordLeftSelect };\r\n// Accessibility navigation commands should only be enabled on windows since they are tuned to what NVDA expects\r\nvar CursorWordAccessibilityLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityLeft, _super);\r\n    function CursorWordAccessibilityLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                win: { primary: 2048 /* CtrlCmd */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityLeft.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityLeft;\r\n}(WordLeftCommand));\r\nexport { CursorWordAccessibilityLeft };\r\nvar CursorWordAccessibilityLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityLeftSelect, _super);\r\n    function CursorWordAccessibilityLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                win: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityLeftSelect.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityLeftSelect;\r\n}(WordLeftCommand));\r\nexport { CursorWordAccessibilityLeftSelect };\r\nvar CursorWordStartRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartRight, _super);\r\n    function CursorWordStartRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRight',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordStartRight;\r\n}(WordRightCommand));\r\nexport { CursorWordStartRight };\r\nvar CursorWordEndRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndRight, _super);\r\n    function CursorWordEndRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordEndRight;\r\n}(WordRightCommand));\r\nexport { CursorWordEndRight };\r\nvar CursorWordRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordRight, _super);\r\n    function CursorWordRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRight',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordRight;\r\n}(WordRightCommand));\r\nexport { CursorWordRight };\r\nvar CursorWordStartRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordStartRightSelect, _super);\r\n    function CursorWordStartRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRightSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordStartRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordStartRightSelect };\r\nvar CursorWordEndRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordEndRightSelect, _super);\r\n    function CursorWordEndRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordEndRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordEndRightSelect };\r\nvar CursorWordRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordRightSelect, _super);\r\n    function CursorWordRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRightSelect',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    return CursorWordRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordRightSelect };\r\nvar CursorWordAccessibilityRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityRight, _super);\r\n    function CursorWordAccessibilityRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                win: { primary: 2048 /* CtrlCmd */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityRight.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityRight;\r\n}(WordRightCommand));\r\nexport { CursorWordAccessibilityRight };\r\nvar CursorWordAccessibilityRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordAccessibilityRightSelect, _super);\r\n    function CursorWordAccessibilityRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, CONTEXT_ACCESSIBILITY_MODE_ENABLED),\r\n                win: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */ + 1\r\n            }\r\n        }) || this;\r\n    }\r\n    CursorWordAccessibilityRightSelect.prototype._move = function (_, model, position, wordNavigationType) {\r\n        return _super.prototype._move.call(this, getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    };\r\n    return CursorWordAccessibilityRightSelect;\r\n}(WordRightCommand));\r\nexport { CursorWordAccessibilityRightSelect };\r\nvar DeleteWordCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordCommand, _super);\r\n    function DeleteWordCommand(opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._whitespaceHeuristics = opts.whitespaceHeuristics;\r\n        _this._wordNavigationType = opts.wordNavigationType;\r\n        return _this;\r\n    }\r\n    DeleteWordCommand.prototype.runEditorCommand = function (accessor, editor, args) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var wordSeparators = getMapForWordSeparators(editor.getOption(96 /* wordSeparators */));\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var commands = selections.map(function (sel) {\r\n            var deleteRange = _this._delete(wordSeparators, model, sel, _this._whitespaceHeuristics, _this._wordNavigationType);\r\n            return new ReplaceCommand(deleteRange, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return DeleteWordCommand;\r\n}(EditorCommand));\r\nexport { DeleteWordCommand };\r\nvar DeleteWordLeftCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordLeftCommand, _super);\r\n    function DeleteWordLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeleteWordLeftCommand.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordOperations.deleteWordLeft(wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    };\r\n    return DeleteWordLeftCommand;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordLeftCommand };\r\nvar DeleteWordRightCommand = /** @class */ (function (_super) {\r\n    __extends(DeleteWordRightCommand, _super);\r\n    function DeleteWordRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeleteWordRightCommand.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordOperations.deleteWordRight(wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        var lineCount = model.getLineCount();\r\n        var maxColumn = model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    };\r\n    return DeleteWordRightCommand;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordRightCommand };\r\nvar DeleteWordStartLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordStartLeft, _super);\r\n    function DeleteWordStartLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartLeft',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordStartLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordStartLeft };\r\nvar DeleteWordEndLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordEndLeft, _super);\r\n    function DeleteWordEndLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndLeft',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordEndLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordEndLeft };\r\nvar DeleteWordLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordLeft, _super);\r\n    function DeleteWordLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1 /* Backspace */,\r\n                mac: { primary: 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return DeleteWordLeft;\r\n}(DeleteWordLeftCommand));\r\nexport { DeleteWordLeft };\r\nvar DeleteWordStartRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordStartRight, _super);\r\n    function DeleteWordStartRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartRight',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordStartRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordStartRight };\r\nvar DeleteWordEndRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordEndRight, _super);\r\n    function DeleteWordEndRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndRight',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return DeleteWordEndRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordEndRight };\r\nvar DeleteWordRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordRight, _super);\r\n    function DeleteWordRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 20 /* Delete */,\r\n                mac: { primary: 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return DeleteWordRight;\r\n}(DeleteWordRightCommand));\r\nexport { DeleteWordRight };\r\nregisterEditorCommand(new CursorWordStartLeft());\r\nregisterEditorCommand(new CursorWordEndLeft());\r\nregisterEditorCommand(new CursorWordLeft());\r\nregisterEditorCommand(new CursorWordStartLeftSelect());\r\nregisterEditorCommand(new CursorWordEndLeftSelect());\r\nregisterEditorCommand(new CursorWordLeftSelect());\r\nregisterEditorCommand(new CursorWordStartRight());\r\nregisterEditorCommand(new CursorWordEndRight());\r\nregisterEditorCommand(new CursorWordRight());\r\nregisterEditorCommand(new CursorWordStartRightSelect());\r\nregisterEditorCommand(new CursorWordEndRightSelect());\r\nregisterEditorCommand(new CursorWordRightSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityLeft());\r\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityRight());\r\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\r\nregisterEditorCommand(new DeleteWordStartLeft());\r\nregisterEditorCommand(new DeleteWordEndLeft());\r\nregisterEditorCommand(new DeleteWordLeft());\r\nregisterEditorCommand(new DeleteWordStartRight());\r\nregisterEditorCommand(new DeleteWordEndRight());\r\nregisterEditorCommand(new DeleteWordRight());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { WordPartOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DeleteWordCommand, MoveWordCommand } from '../wordOperations/wordOperations.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nvar DeleteWordPartLeft = /** @class */ (function (_super) {\r\n    __extends(DeleteWordPartLeft, _super);\r\n    function DeleteWordPartLeft() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordPartLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteWordPartLeft.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordPartOperations.deleteWordPartLeft(wordSeparators, model, selection, whitespaceHeuristics);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    };\r\n    return DeleteWordPartLeft;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordPartLeft };\r\nvar DeleteWordPartRight = /** @class */ (function (_super) {\r\n    __extends(DeleteWordPartRight, _super);\r\n    function DeleteWordPartRight() {\r\n        return _super.call(this, {\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordPartRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteWordPartRight.prototype._delete = function (wordSeparators, model, selection, whitespaceHeuristics, wordNavigationType) {\r\n        var r = WordPartOperations.deleteWordPartRight(wordSeparators, model, selection, whitespaceHeuristics);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        var lineCount = model.getLineCount();\r\n        var maxColumn = model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    };\r\n    return DeleteWordPartRight;\r\n}(DeleteWordCommand));\r\nexport { DeleteWordPartRight };\r\nvar WordPartLeftCommand = /** @class */ (function (_super) {\r\n    __extends(WordPartLeftCommand, _super);\r\n    function WordPartLeftCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordPartLeftCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position);\r\n    };\r\n    return WordPartLeftCommand;\r\n}(MoveWordCommand));\r\nexport { WordPartLeftCommand };\r\nvar CursorWordPartLeft = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartLeft, _super);\r\n    function CursorWordPartLeft() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartLeft;\r\n}(WordPartLeftCommand));\r\nexport { CursorWordPartLeft };\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\r\nvar CursorWordPartLeftSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartLeftSelect, _super);\r\n    function CursorWordPartLeftSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartLeftSelect;\r\n}(WordPartLeftCommand));\r\nexport { CursorWordPartLeftSelect };\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\r\nvar WordPartRightCommand = /** @class */ (function (_super) {\r\n    __extends(WordPartRightCommand, _super);\r\n    function WordPartRightCommand() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WordPartRightCommand.prototype._move = function (wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\r\n    };\r\n    return WordPartRightCommand;\r\n}(MoveWordCommand));\r\nexport { WordPartRightCommand };\r\nvar CursorWordPartRight = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartRight, _super);\r\n    function CursorWordPartRight() {\r\n        return _super.call(this, {\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartRight;\r\n}(WordPartRightCommand));\r\nexport { CursorWordPartRight };\r\nvar CursorWordPartRightSelect = /** @class */ (function (_super) {\r\n    __extends(CursorWordPartRightSelect, _super);\r\n    function CursorWordPartRightSelect() {\r\n        return _super.call(this, {\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return CursorWordPartRightSelect;\r\n}(WordPartRightCommand));\r\nexport { CursorWordPartRightSelect };\r\nregisterEditorCommand(new DeleteWordPartLeft());\r\nregisterEditorCommand(new DeleteWordPartRight());\r\nregisterEditorCommand(new CursorWordPartLeft());\r\nregisterEditorCommand(new CursorWordPartLeftSelect());\r\nregisterEditorCommand(new CursorWordPartRight());\r\nregisterEditorCommand(new CursorWordPartRightSelect());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './accessibilityHelp.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { renderFormattedText } from '../../../../base/browser/formattedTextRenderer.js';\r\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\r\nimport { Widget } from '../../../../base/browser/ui/widget.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { URI } from '../../../../base/common/uri.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { ToggleTabFocusModeAction } from '../../../contrib/toggleTabFocusMode/toggleTabFocusMode.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\r\nimport { contrastBorder, editorWidgetBackground, widgetShadow, editorWidgetForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { AccessibilityHelpNLS } from '../../../common/standaloneStrings.js';\r\nvar CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE = new RawContextKey('accessibilityHelpWidgetVisible', false);\r\nvar AccessibilityHelpController = /** @class */ (function (_super) {\r\n    __extends(AccessibilityHelpController, _super);\r\n    function AccessibilityHelpController(editor, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._widget = _this._register(instantiationService.createInstance(AccessibilityHelpWidget, _this._editor));\r\n        return _this;\r\n    }\r\n    AccessibilityHelpController.get = function (editor) {\r\n        return editor.getContribution(AccessibilityHelpController.ID);\r\n    };\r\n    AccessibilityHelpController.prototype.show = function () {\r\n        this._widget.show();\r\n    };\r\n    AccessibilityHelpController.prototype.hide = function () {\r\n        this._widget.hide();\r\n    };\r\n    AccessibilityHelpController.ID = 'editor.contrib.accessibilityHelpController';\r\n    AccessibilityHelpController = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], AccessibilityHelpController);\r\n    return AccessibilityHelpController;\r\n}(Disposable));\r\nfunction getSelectionLabel(selections, charactersSelected) {\r\n    if (!selections || selections.length === 0) {\r\n        return AccessibilityHelpNLS.noSelection;\r\n    }\r\n    if (selections.length === 1) {\r\n        if (charactersSelected) {\r\n            return strings.format(AccessibilityHelpNLS.singleSelectionRange, selections[0].positionLineNumber, selections[0].positionColumn, charactersSelected);\r\n        }\r\n        return strings.format(AccessibilityHelpNLS.singleSelection, selections[0].positionLineNumber, selections[0].positionColumn);\r\n    }\r\n    if (charactersSelected) {\r\n        return strings.format(AccessibilityHelpNLS.multiSelectionRange, selections.length, charactersSelected);\r\n    }\r\n    if (selections.length > 0) {\r\n        return strings.format(AccessibilityHelpNLS.multiSelection, selections.length);\r\n    }\r\n    return '';\r\n}\r\nvar AccessibilityHelpWidget = /** @class */ (function (_super) {\r\n    __extends(AccessibilityHelpWidget, _super);\r\n    function AccessibilityHelpWidget(editor, _contextKeyService, _keybindingService, _openerService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._contextKeyService = _contextKeyService;\r\n        _this._keybindingService = _keybindingService;\r\n        _this._openerService = _openerService;\r\n        _this._editor = editor;\r\n        _this._isVisibleKey = CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE.bindTo(_this._contextKeyService);\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setClassName('accessibilityHelpWidget');\r\n        _this._domNode.setDisplay('none');\r\n        _this._domNode.setAttribute('role', 'dialog');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._contentDomNode = createFastDomNode(document.createElement('div'));\r\n        _this._contentDomNode.setAttribute('role', 'document');\r\n        _this._domNode.appendChild(_this._contentDomNode);\r\n        _this._isVisible = false;\r\n        _this._register(_this._editor.onDidLayoutChange(function () {\r\n            if (_this._isVisible) {\r\n                _this._layout();\r\n            }\r\n        }));\r\n        // Intentionally not configurable!\r\n        _this._register(dom.addStandardDisposableListener(_this._contentDomNode.domNode, 'keydown', function (e) {\r\n            if (!_this._isVisible) {\r\n                return;\r\n            }\r\n            if (e.equals(2048 /* CtrlCmd */ | 35 /* KEY_E */)) {\r\n                alert(AccessibilityHelpNLS.emergencyConfOn);\r\n                _this._editor.updateOptions({\r\n                    accessibilitySupport: 'on'\r\n                });\r\n                dom.clearNode(_this._contentDomNode.domNode);\r\n                _this._buildContent();\r\n                _this._contentDomNode.domNode.focus();\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n            if (e.equals(2048 /* CtrlCmd */ | 38 /* KEY_H */)) {\r\n                alert(AccessibilityHelpNLS.openingDocs);\r\n                var url = _this._editor.getRawOptions().accessibilityHelpUrl;\r\n                if (typeof url === 'undefined') {\r\n                    url = 'https://go.microsoft.com/fwlink/?linkid=852450';\r\n                }\r\n                _this._openerService.open(URI.parse(url));\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n        }));\r\n        _this.onblur(_this._contentDomNode.domNode, function () {\r\n            _this.hide();\r\n        });\r\n        _this._editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    AccessibilityHelpWidget.prototype.dispose = function () {\r\n        this._editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    AccessibilityHelpWidget.prototype.getId = function () {\r\n        return AccessibilityHelpWidget.ID;\r\n    };\r\n    AccessibilityHelpWidget.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    AccessibilityHelpWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: null\r\n        };\r\n    };\r\n    AccessibilityHelpWidget.prototype.show = function () {\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        this._isVisibleKey.set(true);\r\n        this._layout();\r\n        this._domNode.setDisplay('block');\r\n        this._domNode.setAttribute('aria-hidden', 'false');\r\n        this._contentDomNode.domNode.tabIndex = 0;\r\n        this._buildContent();\r\n        this._contentDomNode.domNode.focus();\r\n    };\r\n    AccessibilityHelpWidget.prototype._descriptionForCommand = function (commandId, msg, noKbMsg) {\r\n        var kb = this._keybindingService.lookupKeybinding(commandId);\r\n        if (kb) {\r\n            return strings.format(msg, kb.getAriaLabel());\r\n        }\r\n        return strings.format(noKbMsg, commandId);\r\n    };\r\n    AccessibilityHelpWidget.prototype._buildContent = function () {\r\n        var options = this._editor.getOptions();\r\n        var selections = this._editor.getSelections();\r\n        var charactersSelected = 0;\r\n        if (selections) {\r\n            var model_1 = this._editor.getModel();\r\n            if (model_1) {\r\n                selections.forEach(function (selection) {\r\n                    charactersSelected += model_1.getValueLengthInRange(selection);\r\n                });\r\n            }\r\n        }\r\n        var text = getSelectionLabel(selections, charactersSelected);\r\n        if (options.get(45 /* inDiffEditor */)) {\r\n            if (options.get(68 /* readOnly */)) {\r\n                text += AccessibilityHelpNLS.readonlyDiffEditor;\r\n            }\r\n            else {\r\n                text += AccessibilityHelpNLS.editableDiffEditor;\r\n            }\r\n        }\r\n        else {\r\n            if (options.get(68 /* readOnly */)) {\r\n                text += AccessibilityHelpNLS.readonlyEditor;\r\n            }\r\n            else {\r\n                text += AccessibilityHelpNLS.editableEditor;\r\n            }\r\n        }\r\n        var turnOnMessage = (platform.isMacintosh\r\n            ? AccessibilityHelpNLS.changeConfigToOnMac\r\n            : AccessibilityHelpNLS.changeConfigToOnWinLinux);\r\n        switch (options.get(2 /* accessibilitySupport */)) {\r\n            case 0 /* Unknown */:\r\n                text += '\\n\\n - ' + turnOnMessage;\r\n                break;\r\n            case 2 /* Enabled */:\r\n                text += '\\n\\n - ' + AccessibilityHelpNLS.auto_on;\r\n                break;\r\n            case 1 /* Disabled */:\r\n                text += '\\n\\n - ' + AccessibilityHelpNLS.auto_off;\r\n                text += ' ' + turnOnMessage;\r\n                break;\r\n        }\r\n        if (options.get(106 /* tabFocusMode */)) {\r\n            text += '\\n\\n - ' + this._descriptionForCommand(ToggleTabFocusModeAction.ID, AccessibilityHelpNLS.tabFocusModeOnMsg, AccessibilityHelpNLS.tabFocusModeOnMsgNoKb);\r\n        }\r\n        else {\r\n            text += '\\n\\n - ' + this._descriptionForCommand(ToggleTabFocusModeAction.ID, AccessibilityHelpNLS.tabFocusModeOffMsg, AccessibilityHelpNLS.tabFocusModeOffMsgNoKb);\r\n        }\r\n        var openDocMessage = (platform.isMacintosh\r\n            ? AccessibilityHelpNLS.openDocMac\r\n            : AccessibilityHelpNLS.openDocWinLinux);\r\n        text += '\\n\\n - ' + openDocMessage;\r\n        text += '\\n\\n' + AccessibilityHelpNLS.outroMsg;\r\n        this._contentDomNode.domNode.appendChild(renderFormattedText(text));\r\n        // Per https://www.w3.org/TR/wai-aria/roles#document, Authors SHOULD provide a title or label for documents\r\n        this._contentDomNode.domNode.setAttribute('aria-label', text);\r\n    };\r\n    AccessibilityHelpWidget.prototype.hide = function () {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        this._isVisibleKey.reset();\r\n        this._domNode.setDisplay('none');\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        this._contentDomNode.domNode.tabIndex = -1;\r\n        dom.clearNode(this._contentDomNode.domNode);\r\n        this._editor.focus();\r\n    };\r\n    AccessibilityHelpWidget.prototype._layout = function () {\r\n        var editorLayout = this._editor.getLayoutInfo();\r\n        var w = Math.max(5, Math.min(AccessibilityHelpWidget.WIDTH, editorLayout.width - 40));\r\n        var h = Math.max(5, Math.min(AccessibilityHelpWidget.HEIGHT, editorLayout.height - 40));\r\n        this._domNode.setWidth(w);\r\n        this._domNode.setHeight(h);\r\n        var top = Math.round((editorLayout.height - h) / 2);\r\n        this._domNode.setTop(top);\r\n        var left = Math.round((editorLayout.width - w) / 2);\r\n        this._domNode.setLeft(left);\r\n    };\r\n    AccessibilityHelpWidget.ID = 'editor.contrib.accessibilityHelpWidget';\r\n    AccessibilityHelpWidget.WIDTH = 500;\r\n    AccessibilityHelpWidget.HEIGHT = 300;\r\n    AccessibilityHelpWidget = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IKeybindingService),\r\n        __param(3, IOpenerService)\r\n    ], AccessibilityHelpWidget);\r\n    return AccessibilityHelpWidget;\r\n}(Widget));\r\nvar ShowAccessibilityHelpAction = /** @class */ (function (_super) {\r\n    __extends(ShowAccessibilityHelpAction, _super);\r\n    function ShowAccessibilityHelpAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.showAccessibilityHelp',\r\n            label: AccessibilityHelpNLS.showAccessibilityHelpAction,\r\n            alias: 'Show Accessibility Help',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: (browser.isIE ? 2048 /* CtrlCmd */ | 59 /* F1 */ : 512 /* Alt */ | 59 /* F1 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    ShowAccessibilityHelpAction.prototype.run = function (accessor, editor) {\r\n        var controller = AccessibilityHelpController.get(editor);\r\n        if (controller) {\r\n            controller.show();\r\n        }\r\n    };\r\n    return ShowAccessibilityHelpAction;\r\n}(EditorAction));\r\nregisterEditorContribution(AccessibilityHelpController.ID, AccessibilityHelpController);\r\nregisterEditorAction(ShowAccessibilityHelpAction);\r\nvar AccessibilityHelpCommand = EditorCommand.bindToContribution(AccessibilityHelpController.get);\r\nregisterEditorCommand(new AccessibilityHelpCommand({\r\n    id: 'closeAccessibilityHelp',\r\n    precondition: CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE,\r\n    handler: function (x) { return x.hide(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 100,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var widgetBackground = theme.getColor(editorWidgetBackground);\r\n    if (widgetBackground) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { background-color: \" + widgetBackground + \"; }\");\r\n    }\r\n    var widgetForeground = theme.getColor(editorWidgetForeground);\r\n    if (widgetForeground) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { color: \" + widgetForeground + \"; }\");\r\n    }\r\n    var widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px \" + widgetShadowColor + \"; }\");\r\n    }\r\n    var hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(\".monaco-editor .accessibilityHelpWidget { border: 2px solid \" + hcBorder + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './iPadShowKeyboard.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nvar IPadShowKeyboard = /** @class */ (function (_super) {\r\n    __extends(IPadShowKeyboard, _super);\r\n    function IPadShowKeyboard(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.widget = null;\r\n        if (browser.isIPad) {\r\n            _this._register(editor.onDidChangeConfiguration(function () { return _this.update(); }));\r\n            _this.update();\r\n        }\r\n        return _this;\r\n    }\r\n    IPadShowKeyboard.prototype.update = function () {\r\n        var shouldHaveWidget = (!this.editor.getOption(68 /* readOnly */));\r\n        if (!this.widget && shouldHaveWidget) {\r\n            this.widget = new ShowKeyboardWidget(this.editor);\r\n        }\r\n        else if (this.widget && !shouldHaveWidget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    IPadShowKeyboard.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        if (this.widget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    IPadShowKeyboard.ID = 'editor.contrib.iPadShowKeyboard';\r\n    return IPadShowKeyboard;\r\n}(Disposable));\r\nexport { IPadShowKeyboard };\r\nvar ShowKeyboardWidget = /** @class */ (function (_super) {\r\n    __extends(ShowKeyboardWidget, _super);\r\n    function ShowKeyboardWidget(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this._domNode = document.createElement('textarea');\r\n        _this._domNode.className = 'iPadShowKeyboard';\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'touchstart', function (e) {\r\n            _this.editor.focus();\r\n        }));\r\n        _this._register(dom.addDisposableListener(_this._domNode, 'focus', function (e) {\r\n            _this.editor.focus();\r\n        }));\r\n        _this.editor.addOverlayWidget(_this);\r\n        return _this;\r\n    }\r\n    ShowKeyboardWidget.prototype.dispose = function () {\r\n        this.editor.removeOverlayWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ----- IOverlayWidget API\r\n    ShowKeyboardWidget.prototype.getId = function () {\r\n        return ShowKeyboardWidget.ID;\r\n    };\r\n    ShowKeyboardWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ShowKeyboardWidget.prototype.getPosition = function () {\r\n        return {\r\n            preference: 1 /* BOTTOM_RIGHT_CORNER */\r\n        };\r\n    };\r\n    ShowKeyboardWidget.ID = 'editor.contrib.ShowKeyboardWidget';\r\n    return ShowKeyboardWidget;\r\n}(Disposable));\r\nregisterEditorContribution(IPadShowKeyboard.ID, IPadShowKeyboard);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './inspectTokens.css';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { escape } from '../../../../base/common/strings.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { TokenMetadata, TokenizationRegistry } from '../../../common/modes.js';\r\nimport { NULL_STATE, nullTokenize, nullTokenize2 } from '../../../common/modes/nullMode.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { IStandaloneThemeService } from '../../common/standaloneThemeService.js';\r\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { HIGH_CONTRAST, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { InspectTokensNLS } from '../../../common/standaloneStrings.js';\r\nvar InspectTokensController = /** @class */ (function (_super) {\r\n    __extends(InspectTokensController, _super);\r\n    function InspectTokensController(editor, standaloneColorService, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = editor;\r\n        _this._modeService = modeService;\r\n        _this._widget = null;\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.stop(); }));\r\n        _this._register(_this._editor.onDidChangeModelLanguage(function (e) { return _this.stop(); }));\r\n        _this._register(TokenizationRegistry.onDidChange(function (e) { return _this.stop(); }));\r\n        return _this;\r\n    }\r\n    InspectTokensController.get = function (editor) {\r\n        return editor.getContribution(InspectTokensController.ID);\r\n    };\r\n    InspectTokensController.prototype.dispose = function () {\r\n        this.stop();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    InspectTokensController.prototype.launch = function () {\r\n        if (this._widget) {\r\n            return;\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._widget = new InspectTokensWidget(this._editor, this._modeService);\r\n    };\r\n    InspectTokensController.prototype.stop = function () {\r\n        if (this._widget) {\r\n            this._widget.dispose();\r\n            this._widget = null;\r\n        }\r\n    };\r\n    InspectTokensController.ID = 'editor.contrib.inspectTokens';\r\n    InspectTokensController = __decorate([\r\n        __param(1, IStandaloneThemeService),\r\n        __param(2, IModeService)\r\n    ], InspectTokensController);\r\n    return InspectTokensController;\r\n}(Disposable));\r\nvar InspectTokens = /** @class */ (function (_super) {\r\n    __extends(InspectTokens, _super);\r\n    function InspectTokens() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inspectTokens',\r\n            label: InspectTokensNLS.inspectTokensAction,\r\n            alias: 'Developer: Inspect Tokens',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InspectTokens.prototype.run = function (accessor, editor) {\r\n        var controller = InspectTokensController.get(editor);\r\n        if (controller) {\r\n            controller.launch();\r\n        }\r\n    };\r\n    return InspectTokens;\r\n}(EditorAction));\r\nfunction renderTokenText(tokenText) {\r\n    var result = '';\r\n    for (var charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\r\n        var charCode = tokenText.charCodeAt(charIndex);\r\n        switch (charCode) {\r\n            case 9 /* Tab */:\r\n                result += '&rarr;';\r\n                break;\r\n            case 32 /* Space */:\r\n                result += '&middot;';\r\n                break;\r\n            case 60 /* LessThan */:\r\n                result += '&lt;';\r\n                break;\r\n            case 62 /* GreaterThan */:\r\n                result += '&gt;';\r\n                break;\r\n            case 38 /* Ampersand */:\r\n                result += '&amp;';\r\n                break;\r\n            default:\r\n                result += String.fromCharCode(charCode);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction getSafeTokenizationSupport(languageIdentifier) {\r\n    var tokenizationSupport = TokenizationRegistry.get(languageIdentifier.language);\r\n    if (tokenizationSupport) {\r\n        return tokenizationSupport;\r\n    }\r\n    return {\r\n        getInitialState: function () { return NULL_STATE; },\r\n        tokenize: function (line, state, deltaOffset) { return nullTokenize(languageIdentifier.language, line, state, deltaOffset); },\r\n        tokenize2: function (line, state, deltaOffset) { return nullTokenize2(languageIdentifier.id, line, state, deltaOffset); }\r\n    };\r\n}\r\nvar InspectTokensWidget = /** @class */ (function (_super) {\r\n    __extends(InspectTokensWidget, _super);\r\n    function InspectTokensWidget(editor, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this._editor = editor;\r\n        _this._modeService = modeService;\r\n        _this._model = _this._editor.getModel();\r\n        _this._domNode = document.createElement('div');\r\n        _this._domNode.className = 'tokens-inspect-widget';\r\n        _this._tokenizationSupport = getSafeTokenizationSupport(_this._model.getLanguageIdentifier());\r\n        _this._compute(_this._editor.getPosition());\r\n        _this._register(_this._editor.onDidChangeCursorPosition(function (e) { return _this._compute(_this._editor.getPosition()); }));\r\n        _this._editor.addContentWidget(_this);\r\n        return _this;\r\n    }\r\n    InspectTokensWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    InspectTokensWidget.prototype.getId = function () {\r\n        return InspectTokensWidget._ID;\r\n    };\r\n    InspectTokensWidget.prototype._compute = function (position) {\r\n        var data = this._getTokensAtLine(position.lineNumber);\r\n        var token1Index = 0;\r\n        for (var i = data.tokens1.length - 1; i >= 0; i--) {\r\n            var t = data.tokens1[i];\r\n            if (position.column - 1 >= t.offset) {\r\n                token1Index = i;\r\n                break;\r\n            }\r\n        }\r\n        var token2Index = 0;\r\n        for (var i = (data.tokens2.length >>> 1); i >= 0; i--) {\r\n            if (position.column - 1 >= data.tokens2[(i << 1)]) {\r\n                token2Index = i;\r\n                break;\r\n            }\r\n        }\r\n        var result = '';\r\n        var lineContent = this._model.getLineContent(position.lineNumber);\r\n        var tokenText = '';\r\n        if (token1Index < data.tokens1.length) {\r\n            var tokenStartIndex = data.tokens1[token1Index].offset;\r\n            var tokenEndIndex = token1Index + 1 < data.tokens1.length ? data.tokens1[token1Index + 1].offset : lineContent.length;\r\n            tokenText = lineContent.substring(tokenStartIndex, tokenEndIndex);\r\n        }\r\n        result += \"<h2 class=\\\"tm-token\\\">\" + renderTokenText(tokenText) + \"<span class=\\\"tm-token-length\\\">(\" + tokenText.length + \" \" + (tokenText.length === 1 ? 'char' : 'chars') + \")</span></h2>\";\r\n        result += \"<hr class=\\\"tokens-inspect-separator\\\" style=\\\"clear:both\\\"/>\";\r\n        var metadata = this._decodeMetadata(data.tokens2[(token2Index << 1) + 1]);\r\n        result += \"<table class=\\\"tm-metadata-table\\\"><tbody>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">language</td><td class=\\\"tm-metadata-value\\\">\" + escape(metadata.languageIdentifier.language) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">token type</td><td class=\\\"tm-metadata-value\\\">\" + this._tokenTypeToString(metadata.tokenType) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">font style</td><td class=\\\"tm-metadata-value\\\">\" + this._fontStyleToString(metadata.fontStyle) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">foreground</td><td class=\\\"tm-metadata-value\\\">\" + Color.Format.CSS.formatHex(metadata.foreground) + \"</td>\";\r\n        result += \"<tr><td class=\\\"tm-metadata-key\\\">background</td><td class=\\\"tm-metadata-value\\\">\" + Color.Format.CSS.formatHex(metadata.background) + \"</td>\";\r\n        result += \"</tbody></table>\";\r\n        result += \"<hr class=\\\"tokens-inspect-separator\\\"/>\";\r\n        if (token1Index < data.tokens1.length) {\r\n            result += \"<span class=\\\"tm-token-type\\\">\" + escape(data.tokens1[token1Index].type) + \"</span>\";\r\n        }\r\n        this._domNode.innerHTML = result;\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    InspectTokensWidget.prototype._decodeMetadata = function (metadata) {\r\n        var colorMap = TokenizationRegistry.getColorMap();\r\n        var languageId = TokenMetadata.getLanguageId(metadata);\r\n        var tokenType = TokenMetadata.getTokenType(metadata);\r\n        var fontStyle = TokenMetadata.getFontStyle(metadata);\r\n        var foreground = TokenMetadata.getForeground(metadata);\r\n        var background = TokenMetadata.getBackground(metadata);\r\n        return {\r\n            languageIdentifier: this._modeService.getLanguageIdentifier(languageId),\r\n            tokenType: tokenType,\r\n            fontStyle: fontStyle,\r\n            foreground: colorMap[foreground],\r\n            background: colorMap[background]\r\n        };\r\n    };\r\n    InspectTokensWidget.prototype._tokenTypeToString = function (tokenType) {\r\n        switch (tokenType) {\r\n            case 0 /* Other */: return 'Other';\r\n            case 1 /* Comment */: return 'Comment';\r\n            case 2 /* String */: return 'String';\r\n            case 4 /* RegEx */: return 'RegEx';\r\n        }\r\n        return '??';\r\n    };\r\n    InspectTokensWidget.prototype._fontStyleToString = function (fontStyle) {\r\n        var r = '';\r\n        if (fontStyle & 1 /* Italic */) {\r\n            r += 'italic ';\r\n        }\r\n        if (fontStyle & 2 /* Bold */) {\r\n            r += 'bold ';\r\n        }\r\n        if (fontStyle & 4 /* Underline */) {\r\n            r += 'underline ';\r\n        }\r\n        if (r.length === 0) {\r\n            r = '---';\r\n        }\r\n        return r;\r\n    };\r\n    InspectTokensWidget.prototype._getTokensAtLine = function (lineNumber) {\r\n        var stateBeforeLine = this._getStateBeforeLine(lineNumber);\r\n        var tokenizationResult1 = this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber), stateBeforeLine, 0);\r\n        var tokenizationResult2 = this._tokenizationSupport.tokenize2(this._model.getLineContent(lineNumber), stateBeforeLine, 0);\r\n        return {\r\n            startState: stateBeforeLine,\r\n            tokens1: tokenizationResult1.tokens,\r\n            tokens2: tokenizationResult2.tokens,\r\n            endState: tokenizationResult1.endState\r\n        };\r\n    };\r\n    InspectTokensWidget.prototype._getStateBeforeLine = function (lineNumber) {\r\n        var state = this._tokenizationSupport.getInitialState();\r\n        for (var i = 1; i < lineNumber; i++) {\r\n            var tokenizationResult = this._tokenizationSupport.tokenize(this._model.getLineContent(i), state, 0);\r\n            state = tokenizationResult.endState;\r\n        }\r\n        return state;\r\n    };\r\n    InspectTokensWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    InspectTokensWidget.prototype.getPosition = function () {\r\n        return {\r\n            position: this._editor.getPosition(),\r\n            preference: [2 /* BELOW */, 1 /* ABOVE */]\r\n        };\r\n    };\r\n    InspectTokensWidget._ID = 'editor.contrib.inspectTokensWidget';\r\n    return InspectTokensWidget;\r\n}(Disposable));\r\nregisterEditorContribution(InspectTokensController.ID, InspectTokensController);\r\nregisterEditorAction(InspectTokens);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .tokens-inspect-widget { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './keybindingLabel.css';\r\nimport { equals } from '../../../common/objects.js';\r\nimport { UILabelProvider } from '../../../common/keybindingLabels.js';\r\nimport * as dom from '../../dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nvar $ = dom.$;\r\nvar KeybindingLabel = /** @class */ (function () {\r\n    function KeybindingLabel(container, os, options) {\r\n        this.os = os;\r\n        this.options = options;\r\n        this.domNode = dom.append(container, $('.monaco-keybinding'));\r\n        this.didEverRender = false;\r\n        container.appendChild(this.domNode);\r\n    }\r\n    KeybindingLabel.prototype.set = function (keybinding, matches) {\r\n        if (this.didEverRender && this.keybinding === keybinding && KeybindingLabel.areSame(this.matches, matches)) {\r\n            return;\r\n        }\r\n        this.keybinding = keybinding;\r\n        this.matches = matches;\r\n        this.render();\r\n    };\r\n    KeybindingLabel.prototype.render = function () {\r\n        dom.clearNode(this.domNode);\r\n        if (this.keybinding) {\r\n            var _a = this.keybinding.getParts(), firstPart = _a[0], chordPart = _a[1];\r\n            if (firstPart) {\r\n                this.renderPart(this.domNode, firstPart, this.matches ? this.matches.firstPart : null);\r\n            }\r\n            if (chordPart) {\r\n                dom.append(this.domNode, $('span.monaco-keybinding-key-chord-separator', undefined, ' '));\r\n                this.renderPart(this.domNode, chordPart, this.matches ? this.matches.chordPart : null);\r\n            }\r\n            this.domNode.title = this.keybinding.getAriaLabel() || '';\r\n        }\r\n        else if (this.options && this.options.renderUnboundKeybindings) {\r\n            this.renderUnbound(this.domNode);\r\n        }\r\n        this.didEverRender = true;\r\n    };\r\n    KeybindingLabel.prototype.renderPart = function (parent, part, match) {\r\n        var modifierLabels = UILabelProvider.modifierLabels[this.os];\r\n        if (part.ctrlKey) {\r\n            this.renderKey(parent, modifierLabels.ctrlKey, Boolean(match === null || match === void 0 ? void 0 : match.ctrlKey), modifierLabels.separator);\r\n        }\r\n        if (part.shiftKey) {\r\n            this.renderKey(parent, modifierLabels.shiftKey, Boolean(match === null || match === void 0 ? void 0 : match.shiftKey), modifierLabels.separator);\r\n        }\r\n        if (part.altKey) {\r\n            this.renderKey(parent, modifierLabels.altKey, Boolean(match === null || match === void 0 ? void 0 : match.altKey), modifierLabels.separator);\r\n        }\r\n        if (part.metaKey) {\r\n            this.renderKey(parent, modifierLabels.metaKey, Boolean(match === null || match === void 0 ? void 0 : match.metaKey), modifierLabels.separator);\r\n        }\r\n        var keyLabel = part.keyLabel;\r\n        if (keyLabel) {\r\n            this.renderKey(parent, keyLabel, Boolean(match === null || match === void 0 ? void 0 : match.keyCode), '');\r\n        }\r\n    };\r\n    KeybindingLabel.prototype.renderKey = function (parent, label, highlight, separator) {\r\n        dom.append(parent, $('span.monaco-keybinding-key' + (highlight ? '.highlight' : ''), undefined, label));\r\n        if (separator) {\r\n            dom.append(parent, $('span.monaco-keybinding-key-separator', undefined, separator));\r\n        }\r\n    };\r\n    KeybindingLabel.prototype.renderUnbound = function (parent) {\r\n        dom.append(parent, $('span.monaco-keybinding-key', undefined, localize('unbound', \"Unbound\")));\r\n    };\r\n    KeybindingLabel.areSame = function (a, b) {\r\n        if (a === b || (!a && !b)) {\r\n            return true;\r\n        }\r\n        return !!a && !!b && equals(a.firstPart, b.firstPart) && equals(a.chordPart, b.chordPart);\r\n    };\r\n    return KeybindingLabel;\r\n}());\r\nexport { KeybindingLabel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../../nls.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { IconLabel } from '../../../browser/ui/iconLabel/iconLabel.js';\r\nimport { ActionBar } from '../../../browser/ui/actionbar/actionbar.js';\r\nimport { HighlightedLabel } from '../../../browser/ui/highlightedlabel/highlightedLabel.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport { KeybindingLabel } from '../../../browser/ui/keybindingLabel/keybindingLabel.js';\r\nimport { OS } from '../../../common/platform.js';\r\nimport { coalesce } from '../../../common/arrays.js';\r\nvar IDS = 0;\r\nvar QuickOpenEntry = /** @class */ (function () {\r\n    function QuickOpenEntry(highlights) {\r\n        if (highlights === void 0) { highlights = []; }\r\n        this.id = (IDS++).toString();\r\n        this.labelHighlights = highlights;\r\n        this.descriptionHighlights = [];\r\n    }\r\n    /**\r\n     * A unique identifier for the entry\r\n     */\r\n    QuickOpenEntry.prototype.getId = function () {\r\n        return this.id;\r\n    };\r\n    /**\r\n     * The label of the entry to identify it from others in the list\r\n     */\r\n    QuickOpenEntry.prototype.getLabel = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The options for the label to use for this entry\r\n     */\r\n    QuickOpenEntry.prototype.getLabelOptions = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The label of the entry to use when a screen reader wants to read about the entry\r\n     */\r\n    QuickOpenEntry.prototype.getAriaLabel = function () {\r\n        return coalesce([this.getLabel(), this.getDescription(), this.getDetail()])\r\n            .join(', ');\r\n    };\r\n    /**\r\n     * Detail information about the entry that is optional and can be shown below the label\r\n     */\r\n    QuickOpenEntry.prototype.getDetail = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * The icon of the entry to identify it from others in the list\r\n     */\r\n    QuickOpenEntry.prototype.getIcon = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A secondary description that is optional and can be shown right to the label\r\n     */\r\n    QuickOpenEntry.prototype.getDescription = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A tooltip to show when hovering over the entry.\r\n     */\r\n    QuickOpenEntry.prototype.getTooltip = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * A tooltip to show when hovering over the description portion of the entry.\r\n     */\r\n    QuickOpenEntry.prototype.getDescriptionTooltip = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * An optional keybinding to show for an entry.\r\n     */\r\n    QuickOpenEntry.prototype.getKeybinding = function () {\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Allows to reuse the same model while filtering. Hidden entries will not show up in the viewer.\r\n     */\r\n    QuickOpenEntry.prototype.isHidden = function () {\r\n        return !!this.hidden;\r\n    };\r\n    /**\r\n     * Allows to set highlight ranges that should show up for the entry label and optionally description if set.\r\n     */\r\n    QuickOpenEntry.prototype.setHighlights = function (labelHighlights, descriptionHighlights, detailHighlights) {\r\n        this.labelHighlights = labelHighlights;\r\n        this.descriptionHighlights = descriptionHighlights;\r\n        this.detailHighlights = detailHighlights;\r\n    };\r\n    /**\r\n     * Allows to return highlight ranges that should show up for the entry label and description.\r\n     */\r\n    QuickOpenEntry.prototype.getHighlights = function () {\r\n        return [this.labelHighlights, this.descriptionHighlights, this.detailHighlights];\r\n    };\r\n    /**\r\n     * Called when the entry is selected for opening. Returns a boolean value indicating if an action was performed or not.\r\n     * The mode parameter gives an indication if the element is previewed (using arrow keys) or opened.\r\n     *\r\n     * The context parameter provides additional context information how the run was triggered.\r\n     */\r\n    QuickOpenEntry.prototype.run = function (mode, context) {\r\n        return false;\r\n    };\r\n    return QuickOpenEntry;\r\n}());\r\nexport { QuickOpenEntry };\r\nvar QuickOpenEntryGroup = /** @class */ (function (_super) {\r\n    __extends(QuickOpenEntryGroup, _super);\r\n    function QuickOpenEntryGroup(entry, groupLabel, withBorder) {\r\n        var _this = _super.call(this) || this;\r\n        _this.entry = entry;\r\n        _this.groupLabel = groupLabel;\r\n        _this.withBorder = withBorder;\r\n        return _this;\r\n    }\r\n    /**\r\n     * The label of the group or null if none.\r\n     */\r\n    QuickOpenEntryGroup.prototype.getGroupLabel = function () {\r\n        return this.groupLabel;\r\n    };\r\n    QuickOpenEntryGroup.prototype.setGroupLabel = function (groupLabel) {\r\n        this.groupLabel = groupLabel;\r\n    };\r\n    /**\r\n     * Whether to show a border on top of the group entry or not.\r\n     */\r\n    QuickOpenEntryGroup.prototype.showBorder = function () {\r\n        return !!this.withBorder;\r\n    };\r\n    QuickOpenEntryGroup.prototype.setShowBorder = function (showBorder) {\r\n        this.withBorder = showBorder;\r\n    };\r\n    QuickOpenEntryGroup.prototype.getLabel = function () {\r\n        return this.entry ? this.entry.getLabel() : _super.prototype.getLabel.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getLabelOptions = function () {\r\n        return this.entry ? this.entry.getLabelOptions() : _super.prototype.getLabelOptions.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getAriaLabel = function () {\r\n        return this.entry ? this.entry.getAriaLabel() : _super.prototype.getAriaLabel.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getDetail = function () {\r\n        return this.entry ? this.entry.getDetail() : _super.prototype.getDetail.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getIcon = function () {\r\n        return this.entry ? this.entry.getIcon() : _super.prototype.getIcon.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getDescription = function () {\r\n        return this.entry ? this.entry.getDescription() : _super.prototype.getDescription.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.getHighlights = function () {\r\n        return this.entry ? this.entry.getHighlights() : _super.prototype.getHighlights.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.isHidden = function () {\r\n        return this.entry ? this.entry.isHidden() : _super.prototype.isHidden.call(this);\r\n    };\r\n    QuickOpenEntryGroup.prototype.setHighlights = function (labelHighlights, descriptionHighlights, detailHighlights) {\r\n        this.entry ? this.entry.setHighlights(labelHighlights, descriptionHighlights, detailHighlights) : _super.prototype.setHighlights.call(this, labelHighlights, descriptionHighlights, detailHighlights);\r\n    };\r\n    QuickOpenEntryGroup.prototype.run = function (mode, context) {\r\n        return this.entry ? this.entry.run(mode, context) : _super.prototype.run.call(this, mode, context);\r\n    };\r\n    return QuickOpenEntryGroup;\r\n}(QuickOpenEntry));\r\nexport { QuickOpenEntryGroup };\r\nvar NoActionProvider = /** @class */ (function () {\r\n    function NoActionProvider() {\r\n    }\r\n    NoActionProvider.prototype.hasActions = function (tree, element) {\r\n        return false;\r\n    };\r\n    NoActionProvider.prototype.getActions = function (tree, element) {\r\n        return null;\r\n    };\r\n    return NoActionProvider;\r\n}());\r\nvar templateEntry = 'quickOpenEntry';\r\nvar templateEntryGroup = 'quickOpenEntryGroup';\r\nvar Renderer = /** @class */ (function () {\r\n    function Renderer(actionProvider, actionRunner) {\r\n        if (actionProvider === void 0) { actionProvider = new NoActionProvider(); }\r\n        this.actionProvider = actionProvider;\r\n        this.actionRunner = actionRunner;\r\n    }\r\n    Renderer.prototype.getHeight = function (entry) {\r\n        if (entry.getDetail()) {\r\n            return 44;\r\n        }\r\n        return 22;\r\n    };\r\n    Renderer.prototype.getTemplateId = function (entry) {\r\n        if (entry instanceof QuickOpenEntryGroup) {\r\n            return templateEntryGroup;\r\n        }\r\n        return templateEntry;\r\n    };\r\n    Renderer.prototype.renderTemplate = function (templateId, container, styles) {\r\n        var entryContainer = document.createElement('div');\r\n        DOM.addClass(entryContainer, 'sub-content');\r\n        container.appendChild(entryContainer);\r\n        // Entry\r\n        var row1 = DOM.$('.quick-open-row');\r\n        var row2 = DOM.$('.quick-open-row');\r\n        var entry = DOM.$('.quick-open-entry', undefined, row1, row2);\r\n        entryContainer.appendChild(entry);\r\n        // Icon\r\n        var icon = document.createElement('span');\r\n        row1.appendChild(icon);\r\n        // Label\r\n        var label = new IconLabel(row1, { supportHighlights: true, supportDescriptionHighlights: true, supportCodicons: true });\r\n        // Keybinding\r\n        var keybindingContainer = document.createElement('span');\r\n        row1.appendChild(keybindingContainer);\r\n        DOM.addClass(keybindingContainer, 'quick-open-entry-keybinding');\r\n        var keybinding = new KeybindingLabel(keybindingContainer, OS);\r\n        // Detail\r\n        var detailContainer = document.createElement('div');\r\n        row2.appendChild(detailContainer);\r\n        DOM.addClass(detailContainer, 'quick-open-entry-meta');\r\n        var detail = new HighlightedLabel(detailContainer, true);\r\n        // Entry Group\r\n        var group;\r\n        if (templateId === templateEntryGroup) {\r\n            group = document.createElement('div');\r\n            DOM.addClass(group, 'results-group');\r\n            container.appendChild(group);\r\n        }\r\n        // Actions\r\n        DOM.addClass(container, 'actions');\r\n        var actionBarContainer = document.createElement('div');\r\n        DOM.addClass(actionBarContainer, 'primary-action-bar');\r\n        container.appendChild(actionBarContainer);\r\n        var actionBar = new ActionBar(actionBarContainer, {\r\n            actionRunner: this.actionRunner\r\n        });\r\n        return {\r\n            container: container,\r\n            entry: entry,\r\n            icon: icon,\r\n            label: label,\r\n            detail: detail,\r\n            keybinding: keybinding,\r\n            group: group,\r\n            actionBar: actionBar\r\n        };\r\n    };\r\n    Renderer.prototype.renderElement = function (entry, templateId, data, styles) {\r\n        // Action Bar\r\n        if (this.actionProvider.hasActions(null, entry)) {\r\n            DOM.addClass(data.container, 'has-actions');\r\n        }\r\n        else {\r\n            DOM.removeClass(data.container, 'has-actions');\r\n        }\r\n        data.actionBar.context = entry; // make sure the context is the current element\r\n        var actions = this.actionProvider.getActions(null, entry);\r\n        if (data.actionBar.isEmpty() && actions && actions.length > 0) {\r\n            data.actionBar.push(actions, { icon: true, label: false });\r\n        }\r\n        else if (!data.actionBar.isEmpty() && (!actions || actions.length === 0)) {\r\n            data.actionBar.clear();\r\n        }\r\n        // Entry group class\r\n        if (entry instanceof QuickOpenEntryGroup && entry.getGroupLabel()) {\r\n            DOM.addClass(data.container, 'has-group-label');\r\n        }\r\n        else {\r\n            DOM.removeClass(data.container, 'has-group-label');\r\n        }\r\n        // Entry group\r\n        if (entry instanceof QuickOpenEntryGroup) {\r\n            var group = entry;\r\n            var groupData = data;\r\n            // Border\r\n            if (group.showBorder()) {\r\n                DOM.addClass(groupData.container, 'results-group-separator');\r\n                if (styles.pickerGroupBorder) {\r\n                    groupData.container.style.borderTopColor = styles.pickerGroupBorder.toString();\r\n                }\r\n            }\r\n            else {\r\n                DOM.removeClass(groupData.container, 'results-group-separator');\r\n                groupData.container.style.borderTopColor = '';\r\n            }\r\n            // Group Label\r\n            var groupLabel = group.getGroupLabel() || '';\r\n            if (groupData.group) {\r\n                groupData.group.textContent = groupLabel;\r\n                if (styles.pickerGroupForeground) {\r\n                    groupData.group.style.color = styles.pickerGroupForeground.toString();\r\n                }\r\n            }\r\n        }\r\n        // Normal Entry\r\n        if (entry instanceof QuickOpenEntry) {\r\n            var _a = entry.getHighlights(), labelHighlights = _a[0], descriptionHighlights = _a[1], detailHighlights = _a[2];\r\n            // Icon\r\n            var iconClass = entry.getIcon() ? ('quick-open-entry-icon ' + entry.getIcon()) : '';\r\n            data.icon.className = iconClass;\r\n            // Label\r\n            var options = entry.getLabelOptions() || Object.create(null);\r\n            options.matches = labelHighlights || [];\r\n            options.title = entry.getTooltip();\r\n            options.descriptionTitle = entry.getDescriptionTooltip() || entry.getDescription(); // tooltip over description because it could overflow\r\n            options.descriptionMatches = descriptionHighlights || [];\r\n            data.label.setLabel(entry.getLabel() || '', entry.getDescription(), options);\r\n            // Meta\r\n            data.detail.set(entry.getDetail(), detailHighlights);\r\n            // Keybinding\r\n            data.keybinding.set(entry.getKeybinding());\r\n        }\r\n    };\r\n    Renderer.prototype.disposeTemplate = function (templateId, templateData) {\r\n        templateData.actionBar.dispose();\r\n        templateData.actionBar = null;\r\n        templateData.container = null;\r\n        templateData.entry = null;\r\n        templateData.keybinding = null;\r\n        templateData.detail = null;\r\n        templateData.group = null;\r\n        templateData.icon = null;\r\n        templateData.label.dispose();\r\n        templateData.label = null;\r\n    };\r\n    return Renderer;\r\n}());\r\nvar QuickOpenModel = /** @class */ (function () {\r\n    function QuickOpenModel(entries, actionProvider) {\r\n        if (entries === void 0) { entries = []; }\r\n        if (actionProvider === void 0) { actionProvider = new NoActionProvider(); }\r\n        this._entries = entries;\r\n        this._dataSource = this;\r\n        this._renderer = new Renderer(actionProvider);\r\n        this._filter = this;\r\n        this._runner = this;\r\n        this._accessibilityProvider = this;\r\n    }\r\n    Object.defineProperty(QuickOpenModel.prototype, \"entries\", {\r\n        get: function () { return this._entries; },\r\n        set: function (entries) {\r\n            this._entries = entries;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"dataSource\", {\r\n        get: function () { return this._dataSource; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"renderer\", {\r\n        get: function () { return this._renderer; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"filter\", {\r\n        get: function () { return this._filter; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"runner\", {\r\n        get: function () { return this._runner; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(QuickOpenModel.prototype, \"accessibilityProvider\", {\r\n        get: function () { return this._accessibilityProvider; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    QuickOpenModel.prototype.getId = function (entry) {\r\n        return entry.getId();\r\n    };\r\n    QuickOpenModel.prototype.getLabel = function (entry) {\r\n        return types.withUndefinedAsNull(entry.getLabel());\r\n    };\r\n    QuickOpenModel.prototype.getAriaLabel = function (entry) {\r\n        var ariaLabel = entry.getAriaLabel();\r\n        if (ariaLabel) {\r\n            return nls.localize('quickOpenAriaLabelEntry', \"{0}, picker\", entry.getAriaLabel());\r\n        }\r\n        return nls.localize('quickOpenAriaLabel', \"picker\");\r\n    };\r\n    QuickOpenModel.prototype.isVisible = function (entry) {\r\n        return !entry.isHidden();\r\n    };\r\n    QuickOpenModel.prototype.run = function (entry, mode, context) {\r\n        return entry.run(mode, context);\r\n    };\r\n    return QuickOpenModel;\r\n}());\r\nexport { QuickOpenModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isFunction } from '../../../common/types.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(arg) {\r\n        this.modelProvider = isFunction(arg.getModel) ? arg : { getModel: function () { return arg; } };\r\n    }\r\n    DataSource.prototype.getId = function (tree, element) {\r\n        if (!element) {\r\n            return null;\r\n        }\r\n        var model = this.modelProvider.getModel();\r\n        return model === element ? '__root__' : model.dataSource.getId(element);\r\n    };\r\n    DataSource.prototype.hasChildren = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return !!(model && model === element && model.entries.length > 0);\r\n    };\r\n    DataSource.prototype.getChildren = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return Promise.resolve(model === element ? model.entries : []);\r\n    };\r\n    DataSource.prototype.getParent = function (tree, element) {\r\n        return Promise.resolve(null);\r\n    };\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\nvar AccessibilityProvider = /** @class */ (function () {\r\n    function AccessibilityProvider(modelProvider) {\r\n        this.modelProvider = modelProvider;\r\n    }\r\n    AccessibilityProvider.prototype.getAriaLabel = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.accessibilityProvider ? model.accessibilityProvider.getAriaLabel(element) : null;\r\n    };\r\n    AccessibilityProvider.prototype.getPosInSet = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        var i = 0;\r\n        if (model.filter) {\r\n            for (var _i = 0, _a = model.entries; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                if (model.filter.isVisible(entry)) {\r\n                    i++;\r\n                }\r\n                if (entry === element) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            i = model.entries.indexOf(element) + 1;\r\n        }\r\n        return String(i);\r\n    };\r\n    AccessibilityProvider.prototype.getSetSize = function () {\r\n        var model = this.modelProvider.getModel();\r\n        var n = 0;\r\n        if (model.filter) {\r\n            for (var _i = 0, _a = model.entries; _i < _a.length; _i++) {\r\n                var entry = _a[_i];\r\n                if (model.filter.isVisible(entry)) {\r\n                    n++;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            n = model.entries.length;\r\n        }\r\n        return String(n);\r\n    };\r\n    return AccessibilityProvider;\r\n}());\r\nexport { AccessibilityProvider };\r\nvar Filter = /** @class */ (function () {\r\n    function Filter(modelProvider) {\r\n        this.modelProvider = modelProvider;\r\n    }\r\n    Filter.prototype.isVisible = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        if (!model.filter) {\r\n            return true;\r\n        }\r\n        return model.filter.isVisible(element);\r\n    };\r\n    return Filter;\r\n}());\r\nexport { Filter };\r\nvar Renderer = /** @class */ (function () {\r\n    function Renderer(modelProvider, styles) {\r\n        this.modelProvider = modelProvider;\r\n        this.styles = styles;\r\n    }\r\n    Renderer.prototype.updateStyles = function (styles) {\r\n        this.styles = styles;\r\n    };\r\n    Renderer.prototype.getHeight = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.getHeight(element);\r\n    };\r\n    Renderer.prototype.getTemplateId = function (tree, element) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.getTemplateId(element);\r\n    };\r\n    Renderer.prototype.renderTemplate = function (tree, templateId, container) {\r\n        var model = this.modelProvider.getModel();\r\n        return model.renderer.renderTemplate(templateId, container, this.styles);\r\n    };\r\n    Renderer.prototype.renderElement = function (tree, element, templateId, templateData) {\r\n        var model = this.modelProvider.getModel();\r\n        model.renderer.renderElement(element, templateId, templateData, this.styles);\r\n    };\r\n    Renderer.prototype.disposeTemplate = function (tree, templateId, templateData) {\r\n        var model = this.modelProvider.getModel();\r\n        model.renderer.disposeTemplate(templateId, templateData);\r\n    };\r\n    return Renderer;\r\n}());\r\nexport { Renderer };\r\n","import * as platform from '../../../common/platform.js';\r\nimport * as errors from '../../../common/errors.js';\r\nimport * as dom from '../../../browser/dom.js';\r\nimport { createKeybinding } from '../../../common/keyCodes.js';\r\nvar KeybindingDispatcher = /** @class */ (function () {\r\n    function KeybindingDispatcher() {\r\n        this._arr = [];\r\n    }\r\n    KeybindingDispatcher.prototype.set = function (keybinding, callback) {\r\n        this._arr.push({\r\n            keybinding: createKeybinding(keybinding, platform.OS),\r\n            callback: callback\r\n        });\r\n    };\r\n    KeybindingDispatcher.prototype.dispatch = function (keybinding) {\r\n        // Loop from the last to the first to handle overwrites\r\n        for (var i = this._arr.length - 1; i >= 0; i--) {\r\n            var item = this._arr[i];\r\n            if (keybinding.toChord().equals(item.keybinding)) {\r\n                return item.callback;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return KeybindingDispatcher;\r\n}());\r\nexport { KeybindingDispatcher };\r\nvar DefaultController = /** @class */ (function () {\r\n    function DefaultController(options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = { clickBehavior: 0 /* ON_MOUSE_DOWN */, keyboardSupport: true, openMode: 0 /* SINGLE_CLICK */ }; }\r\n        this.options = options;\r\n        this.downKeyBindingDispatcher = new KeybindingDispatcher();\r\n        this.upKeyBindingDispatcher = new KeybindingDispatcher();\r\n        if (typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport) {\r\n            this.downKeyBindingDispatcher.set(16 /* UpArrow */, function (t, e) { return _this.onUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(18 /* DownArrow */, function (t, e) { return _this.onDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(15 /* LeftArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n            this.downKeyBindingDispatcher.set(17 /* RightArrow */, function (t, e) { return _this.onRight(t, e); });\r\n            if (platform.isMacintosh) {\r\n                this.downKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 16 /* UpArrow */, function (t, e) { return _this.onLeft(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 44 /* KEY_N */, function (t, e) { return _this.onDown(t, e); });\r\n                this.downKeyBindingDispatcher.set(256 /* WinCtrl */ | 46 /* KEY_P */, function (t, e) { return _this.onUp(t, e); });\r\n            }\r\n            this.downKeyBindingDispatcher.set(11 /* PageUp */, function (t, e) { return _this.onPageUp(t, e); });\r\n            this.downKeyBindingDispatcher.set(12 /* PageDown */, function (t, e) { return _this.onPageDown(t, e); });\r\n            this.downKeyBindingDispatcher.set(14 /* Home */, function (t, e) { return _this.onHome(t, e); });\r\n            this.downKeyBindingDispatcher.set(13 /* End */, function (t, e) { return _this.onEnd(t, e); });\r\n            this.downKeyBindingDispatcher.set(10 /* Space */, function (t, e) { return _this.onSpace(t, e); });\r\n            this.downKeyBindingDispatcher.set(9 /* Escape */, function (t, e) { return _this.onEscape(t, e); });\r\n            this.upKeyBindingDispatcher.set(3 /* Enter */, this.onEnter.bind(this));\r\n            this.upKeyBindingDispatcher.set(2048 /* CtrlCmd */ | 3 /* Enter */, this.onEnter.bind(this));\r\n        }\r\n    }\r\n    DefaultController.prototype.onMouseDown = function (tree, element, event, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            if (event.target) {\r\n                if (event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n                    return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'scrollbar', 'monaco-tree')) {\r\n                    return false;\r\n                }\r\n                if (dom.findParentWithClass(event.target, 'monaco-action-bar', 'row')) { // TODO@Joao not very nice way of checking for the action bar (implicit knowledge)\r\n                    return false; // Ignore event if target is over an action bar of the row\r\n                }\r\n            }\r\n            // Propagate to onLeftClick now\r\n            return this.onLeftClick(tree, element, event, origin);\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onClick = function (tree, element, event) {\r\n        var isMac = platform.isMacintosh;\r\n        // A Ctrl click on the Mac is a context menu event\r\n        if (isMac && event.ctrlKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            return false;\r\n        }\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.options.clickBehavior === 0 /* ON_MOUSE_DOWN */ && (event.leftButton || event.middleButton)) {\r\n            return false; // Already handled by onMouseDown\r\n        }\r\n        return this.onLeftClick(tree, element, event);\r\n    };\r\n    DefaultController.prototype.onLeftClick = function (tree, element, eventish, origin) {\r\n        if (origin === void 0) { origin = 'mouse'; }\r\n        var event = eventish;\r\n        var payload = { origin: origin, originalEvent: eventish, didClickOnTwistie: this.isClickOnTwistie(event) };\r\n        if (tree.getInput() === element) {\r\n            tree.clearFocus(payload);\r\n            tree.clearSelection(payload);\r\n        }\r\n        else {\r\n            var isSingleMouseDown = eventish && event.browserEvent && event.browserEvent.type === 'mousedown' && event.browserEvent.detail === 1;\r\n            if (!isSingleMouseDown) {\r\n                eventish.preventDefault(); // we cannot preventDefault onMouseDown with single click because this would break DND otherwise\r\n            }\r\n            eventish.stopPropagation();\r\n            tree.domFocus();\r\n            tree.setSelection([element], payload);\r\n            tree.setFocus(element, payload);\r\n            if (this.shouldToggleExpansion(element, event, origin)) {\r\n                if (tree.isExpanded(element)) {\r\n                    tree.collapse(element).then(undefined, errors.onUnexpectedError);\r\n                }\r\n                else {\r\n                    tree.expand(element).then(undefined, errors.onUnexpectedError);\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.shouldToggleExpansion = function (element, event, origin) {\r\n        var isDoubleClick = (origin === 'mouse' && event.detail === 2);\r\n        return this.openOnSingleClick || isDoubleClick || this.isClickOnTwistie(event);\r\n    };\r\n    Object.defineProperty(DefaultController.prototype, \"openOnSingleClick\", {\r\n        get: function () {\r\n            return this.options.openMode === 0 /* SINGLE_CLICK */;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DefaultController.prototype.isClickOnTwistie = function (event) {\r\n        var element = event.target;\r\n        if (!dom.hasClass(element, 'content')) {\r\n            return false;\r\n        }\r\n        var twistieStyle = window.getComputedStyle(element, ':before');\r\n        if (twistieStyle.backgroundImage === 'none' || twistieStyle.display === 'none') {\r\n            return false;\r\n        }\r\n        var twistieWidth = parseInt(twistieStyle.width) + parseInt(twistieStyle.paddingRight);\r\n        return event.browserEvent.offsetX <= twistieWidth;\r\n    };\r\n    DefaultController.prototype.onContextMenu = function (tree, element, event) {\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return false; // allow context menu on input fields\r\n        }\r\n        // Prevent native context menu from showing up\r\n        if (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onTap = function (tree, element, event) {\r\n        var target = event.initialTarget;\r\n        if (target && target.tagName && target.tagName.toLowerCase() === 'input') {\r\n            return false; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        return this.onLeftClick(tree, element, event, 'touch');\r\n    };\r\n    DefaultController.prototype.onKeyDown = function (tree, event) {\r\n        return this.onKey(this.downKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKeyUp = function (tree, event) {\r\n        return this.onKey(this.upKeyBindingDispatcher, tree, event);\r\n    };\r\n    DefaultController.prototype.onKey = function (bindings, tree, event) {\r\n        var handler = bindings.dispatch(event.toKeybinding());\r\n        if (handler) {\r\n            // TODO: TS 3.1 upgrade. Why are we checking against void?\r\n            if (handler(tree, event)) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    DefaultController.prototype.onUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPrevious(1, payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageUp = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusPreviousPage(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNext(1, payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onPageDown = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusNextPage(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onHome = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusFirst(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnd = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            tree.focusLast(payload);\r\n            tree.reveal(tree.getFocus()).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onLeft = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_1 = tree.getFocus();\r\n            tree.collapse(focus_1).then(function (didCollapse) {\r\n                if (focus_1 && !didCollapse) {\r\n                    tree.focusParent(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onRight = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n        }\r\n        else {\r\n            var focus_2 = tree.getFocus();\r\n            tree.expand(focus_2).then(function (didExpand) {\r\n                if (focus_2 && !didExpand) {\r\n                    tree.focusFirstChild(payload);\r\n                    return tree.reveal(tree.getFocus());\r\n                }\r\n                return undefined;\r\n            }).then(undefined, errors.onUnexpectedError);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEnter = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.setSelection([focus], payload);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onSpace = function (tree, event) {\r\n        if (tree.getHighlight()) {\r\n            return false;\r\n        }\r\n        var focus = tree.getFocus();\r\n        if (focus) {\r\n            tree.toggleExpansion(focus);\r\n        }\r\n        return true;\r\n    };\r\n    DefaultController.prototype.onEscape = function (tree, event) {\r\n        var payload = { origin: 'keyboard', originalEvent: event };\r\n        if (tree.getHighlight()) {\r\n            tree.clearHighlight(payload);\r\n            return true;\r\n        }\r\n        if (tree.getSelection().length) {\r\n            tree.clearSelection(payload);\r\n            return true;\r\n        }\r\n        if (tree.getFocus()) {\r\n            tree.clearFocus(payload);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return DefaultController;\r\n}());\r\nexport { DefaultController };\r\nvar DefaultDragAndDrop = /** @class */ (function () {\r\n    function DefaultDragAndDrop() {\r\n    }\r\n    DefaultDragAndDrop.prototype.getDragURI = function (tree, element) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragStart = function (tree, data, originalEvent) {\r\n        return;\r\n    };\r\n    DefaultDragAndDrop.prototype.onDragOver = function (tree, data, targetElement, originalEvent) {\r\n        return null;\r\n    };\r\n    DefaultDragAndDrop.prototype.drop = function (tree, data, targetElement, originalEvent) {\r\n        return;\r\n    };\r\n    return DefaultDragAndDrop;\r\n}());\r\nexport { DefaultDragAndDrop };\r\nvar DefaultFilter = /** @class */ (function () {\r\n    function DefaultFilter() {\r\n    }\r\n    DefaultFilter.prototype.isVisible = function (tree, element) {\r\n        return true;\r\n    };\r\n    return DefaultFilter;\r\n}());\r\nexport { DefaultFilter };\r\nvar DefaultAccessibilityProvider = /** @class */ (function () {\r\n    function DefaultAccessibilityProvider() {\r\n    }\r\n    DefaultAccessibilityProvider.prototype.getAriaLabel = function (tree, element) {\r\n        return null;\r\n    };\r\n    return DefaultAccessibilityProvider;\r\n}());\r\nexport { DefaultAccessibilityProvider };\r\nvar DefaultTreestyler = /** @class */ (function () {\r\n    function DefaultTreestyler(styleElement, selectorSuffix) {\r\n        this.styleElement = styleElement;\r\n        this.selectorSuffix = selectorSuffix;\r\n    }\r\n    DefaultTreestyler.prototype.style = function (styles) {\r\n        var suffix = this.selectorSuffix ? \".\" + this.selectorSuffix : '';\r\n        var content = [];\r\n        if (styles.listFocusBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { background-color: \" + styles.listFocusBackground + \"; }\");\r\n        }\r\n        if (styles.listFocusForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { color: \" + styles.listFocusForeground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listActiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listActiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listActiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listFocusAndSelectionBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { background-color: \" + styles.listFocusAndSelectionBackground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusAndSelectionForeground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { color: \" + styles.listFocusAndSelectionForeground + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listInactiveSelectionBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: \" + styles.listInactiveSelectionBackground + \"; }\");\r\n        }\r\n        if (styles.listInactiveSelectionForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: \" + styles.listInactiveSelectionForeground + \"; }\");\r\n        }\r\n        if (styles.listHoverBackground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { background-color: \" + styles.listHoverBackground + \"; }\");\r\n        }\r\n        if (styles.listHoverForeground) {\r\n            content.push(\".monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { color: \" + styles.listHoverForeground + \"; }\");\r\n        }\r\n        if (styles.listDropBackground) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target { background-color: \" + styles.listDropBackground + \" !important; color: inherit !important; }\\n\\t\\t\\t\");\r\n        }\r\n        if (styles.listFocusOutline) {\r\n            content.push(\"\\n\\t\\t\\t\\t.monaco-tree-drag-image\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; background: #000; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px solid transparent; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px dotted \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \".focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) \\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted)  \\t\\t\\t\\t\\t\\t\\t{ border: 1px solid \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused)  \\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-wrapper.drop-target,\\n\\t\\t\\t\\t.monaco-tree\" + suffix + \" .monaco-tree-rows > .monaco-tree-row.drop-target\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{ border: 1px dashed \" + styles.listFocusOutline + \"; }\\n\\t\\t\\t\");\r\n        }\r\n        var newStyles = content.join('\\n');\r\n        if (newStyles !== this.styleElement.innerHTML) {\r\n            this.styleElement.innerHTML = newStyles;\r\n        }\r\n    };\r\n    return DefaultTreestyler;\r\n}());\r\nexport { DefaultTreestyler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Assert from '../../../common/assert.js';\r\nimport { onUnexpectedError } from '../../../common/errors.js';\r\nimport { combinedDisposable, Disposable } from '../../../common/lifecycle.js';\r\nimport { Event, Emitter, EventMultiplexer, Relay } from '../../../common/event.js';\r\nvar LockData = /** @class */ (function () {\r\n    function LockData(item) {\r\n        this._onDispose = new Emitter();\r\n        this.onDispose = this._onDispose.event;\r\n        this._item = item;\r\n    }\r\n    Object.defineProperty(LockData.prototype, \"item\", {\r\n        get: function () {\r\n            return this._item;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LockData.prototype.dispose = function () {\r\n        if (this._onDispose) {\r\n            this._onDispose.fire();\r\n            this._onDispose.dispose();\r\n            this._onDispose = undefined;\r\n        }\r\n    };\r\n    return LockData;\r\n}());\r\nexport { LockData };\r\nvar Lock = /** @class */ (function () {\r\n    function Lock() {\r\n        this.locks = Object.create({});\r\n    }\r\n    Lock.prototype.isLocked = function (item) {\r\n        return !!this.locks[item.id];\r\n    };\r\n    Lock.prototype.run = function (item, fn) {\r\n        var _this = this;\r\n        var lock = this.getLock(item);\r\n        if (lock) {\r\n            return new Promise(function (c, e) {\r\n                Event.once(lock.onDispose)(function () {\r\n                    return _this.run(item, fn).then(c, e);\r\n                });\r\n            });\r\n        }\r\n        var result;\r\n        return new Promise(function (c, e) {\r\n            if (item.isDisposed()) {\r\n                return e(new Error('Item is disposed.'));\r\n            }\r\n            var lock = _this.locks[item.id] = new LockData(item);\r\n            result = fn().then(function (r) {\r\n                delete _this.locks[item.id];\r\n                lock.dispose();\r\n                return r;\r\n            }).then(c, e);\r\n            return result;\r\n        });\r\n    };\r\n    Lock.prototype.getLock = function (item) {\r\n        var key;\r\n        for (key in this.locks) {\r\n            var lock = this.locks[key];\r\n            if (item.intersects(lock.item)) {\r\n                return lock;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return Lock;\r\n}());\r\nexport { Lock };\r\nvar ItemRegistry = /** @class */ (function () {\r\n    function ItemRegistry() {\r\n        this._isDisposed = false;\r\n        this._onDidRevealItem = new EventMultiplexer();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new EventMultiplexer();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new EventMultiplexer();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new EventMultiplexer();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new EventMultiplexer();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new EventMultiplexer();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new EventMultiplexer();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new EventMultiplexer();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new EventMultiplexer();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new EventMultiplexer();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new EventMultiplexer();\r\n        this.onDidDisposeItem = this._onDidDisposeItem.event;\r\n        this.items = {};\r\n    }\r\n    ItemRegistry.prototype.register = function (item) {\r\n        Assert.ok(!this.isRegistered(item.id), 'item already registered: ' + item.id);\r\n        var disposable = combinedDisposable(this._onDidRevealItem.add(item.onDidReveal), this._onExpandItem.add(item.onExpand), this._onDidExpandItem.add(item.onDidExpand), this._onCollapseItem.add(item.onCollapse), this._onDidCollapseItem.add(item.onDidCollapse), this._onDidAddTraitItem.add(item.onDidAddTrait), this._onDidRemoveTraitItem.add(item.onDidRemoveTrait), this._onDidRefreshItem.add(item.onDidRefresh), this._onRefreshItemChildren.add(item.onRefreshChildren), this._onDidRefreshItemChildren.add(item.onDidRefreshChildren), this._onDidDisposeItem.add(item.onDidDispose));\r\n        this.items[item.id] = { item: item, disposable: disposable };\r\n    };\r\n    ItemRegistry.prototype.deregister = function (item) {\r\n        Assert.ok(this.isRegistered(item.id), 'item not registered: ' + item.id);\r\n        this.items[item.id].disposable.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    ItemRegistry.prototype.isRegistered = function (id) {\r\n        return this.items.hasOwnProperty(id);\r\n    };\r\n    ItemRegistry.prototype.getItem = function (id) {\r\n        var result = this.items[id];\r\n        return result ? result.item : null;\r\n    };\r\n    ItemRegistry.prototype.dispose = function () {\r\n        this.items = {};\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    ItemRegistry.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    return ItemRegistry;\r\n}());\r\nexport { ItemRegistry };\r\nvar Item = /** @class */ (function () {\r\n    function Item(id, registry, context, lock, element) {\r\n        this._onDidCreate = new Emitter();\r\n        this._onDidReveal = new Emitter();\r\n        this.onDidReveal = this._onDidReveal.event;\r\n        this._onExpand = new Emitter();\r\n        this.onExpand = this._onExpand.event;\r\n        this._onDidExpand = new Emitter();\r\n        this.onDidExpand = this._onDidExpand.event;\r\n        this._onCollapse = new Emitter();\r\n        this.onCollapse = this._onCollapse.event;\r\n        this._onDidCollapse = new Emitter();\r\n        this.onDidCollapse = this._onDidCollapse.event;\r\n        this._onDidAddTrait = new Emitter();\r\n        this.onDidAddTrait = this._onDidAddTrait.event;\r\n        this._onDidRemoveTrait = new Emitter();\r\n        this.onDidRemoveTrait = this._onDidRemoveTrait.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onRefreshChildren = new Emitter();\r\n        this.onRefreshChildren = this._onRefreshChildren.event;\r\n        this._onDidRefreshChildren = new Emitter();\r\n        this.onDidRefreshChildren = this._onDidRefreshChildren.event;\r\n        this._onDidDispose = new Emitter();\r\n        this.onDidDispose = this._onDidDispose.event;\r\n        this.registry = registry;\r\n        this.context = context;\r\n        this.lock = lock;\r\n        this.element = element;\r\n        this.id = id;\r\n        this.registry.register(this);\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.needsChildrenRefresh = true;\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this.traits = {};\r\n        this.depth = 0;\r\n        this.expanded = !!(this.context.dataSource.shouldAutoexpand && this.context.dataSource.shouldAutoexpand(this.context.tree, element));\r\n        this._onDidCreate.fire(this);\r\n        this.visible = this._isVisible();\r\n        this.height = this._getHeight();\r\n        this._isDisposed = false;\r\n    }\r\n    Item.prototype.getElement = function () {\r\n        return this.element;\r\n    };\r\n    Item.prototype.hasChildren = function () {\r\n        return this.doesHaveChildren;\r\n    };\r\n    Item.prototype.getDepth = function () {\r\n        return this.depth;\r\n    };\r\n    Item.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n    Item.prototype.setVisible = function (value) {\r\n        this.visible = value;\r\n    };\r\n    Item.prototype.isExpanded = function () {\r\n        return this.expanded;\r\n    };\r\n    /* protected */ Item.prototype._setExpanded = function (value) {\r\n        this.expanded = value;\r\n    };\r\n    Item.prototype.reveal = function (relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        var eventData = { item: this, relativeTop: relativeTop };\r\n        this._onDidReveal.fire(eventData);\r\n    };\r\n    Item.prototype.expand = function () {\r\n        var _this = this;\r\n        if (this.isExpanded() || !this.doesHaveChildren || this.lock.isLocked(this)) {\r\n            return Promise.resolve(false);\r\n        }\r\n        var result = this.lock.run(this, function () {\r\n            if (_this.isExpanded() || !_this.doesHaveChildren) {\r\n                return Promise.resolve(false);\r\n            }\r\n            var eventData = { item: _this };\r\n            var result;\r\n            _this._onExpand.fire(eventData);\r\n            if (_this.needsChildrenRefresh) {\r\n                result = _this.refreshChildren(false, true, true);\r\n            }\r\n            else {\r\n                result = Promise.resolve(null);\r\n            }\r\n            return result.then(function () {\r\n                _this._setExpanded(true);\r\n                _this._onDidExpand.fire(eventData);\r\n                return true;\r\n            });\r\n        });\r\n        return result.then(function (r) {\r\n            if (_this.isDisposed()) {\r\n                return false;\r\n            }\r\n            // Auto expand single child folders\r\n            if (_this.context.options.autoExpandSingleChildren && r && _this.firstChild !== null && _this.firstChild === _this.lastChild && _this.firstChild.isVisible()) {\r\n                return _this.firstChild.expand().then(function () { return true; });\r\n            }\r\n            return r;\r\n        });\r\n    };\r\n    Item.prototype.collapse = function (recursive) {\r\n        var _this = this;\r\n        if (recursive === void 0) { recursive = false; }\r\n        if (recursive) {\r\n            var collapseChildrenPromise_1 = Promise.resolve(null);\r\n            this.forEachChild(function (child) {\r\n                collapseChildrenPromise_1 = collapseChildrenPromise_1.then(function () { return child.collapse(true); });\r\n            });\r\n            return collapseChildrenPromise_1.then(function () {\r\n                return _this.collapse(false);\r\n            });\r\n        }\r\n        else {\r\n            if (!this.isExpanded() || this.lock.isLocked(this)) {\r\n                return Promise.resolve(false);\r\n            }\r\n            return this.lock.run(this, function () {\r\n                var eventData = { item: _this };\r\n                _this._onCollapse.fire(eventData);\r\n                _this._setExpanded(false);\r\n                _this._onDidCollapse.fire(eventData);\r\n                return Promise.resolve(true);\r\n            });\r\n        }\r\n    };\r\n    Item.prototype.addTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        this.traits[trait] = true;\r\n        this._onDidAddTrait.fire(eventData);\r\n    };\r\n    Item.prototype.removeTrait = function (trait) {\r\n        var eventData = { item: this, trait: trait };\r\n        delete this.traits[trait];\r\n        this._onDidRemoveTrait.fire(eventData);\r\n    };\r\n    Item.prototype.hasTrait = function (trait) {\r\n        return this.traits[trait] || false;\r\n    };\r\n    Item.prototype.getAllTraits = function () {\r\n        var result = [];\r\n        var trait;\r\n        for (trait in this.traits) {\r\n            if (this.traits.hasOwnProperty(trait) && this.traits[trait]) {\r\n                result.push(trait);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Item.prototype.getHeight = function () {\r\n        return this.height;\r\n    };\r\n    Item.prototype.refreshChildren = function (recursive, safe, force) {\r\n        var _this = this;\r\n        if (safe === void 0) { safe = false; }\r\n        if (force === void 0) { force = false; }\r\n        if (!force && !this.isExpanded()) {\r\n            var setNeedsChildrenRefresh_1 = function (item) {\r\n                item.needsChildrenRefresh = true;\r\n                item.forEachChild(setNeedsChildrenRefresh_1);\r\n            };\r\n            setNeedsChildrenRefresh_1(this);\r\n            return Promise.resolve(this);\r\n        }\r\n        this.needsChildrenRefresh = false;\r\n        var doRefresh = function () {\r\n            var eventData = { item: _this, isNested: safe };\r\n            _this._onRefreshChildren.fire(eventData);\r\n            var childrenPromise;\r\n            if (_this.doesHaveChildren) {\r\n                childrenPromise = _this.context.dataSource.getChildren(_this.context.tree, _this.element);\r\n            }\r\n            else {\r\n                childrenPromise = Promise.resolve([]);\r\n            }\r\n            var result = childrenPromise.then(function (elements) {\r\n                if (_this.isDisposed() || _this.registry.isDisposed()) {\r\n                    return Promise.resolve(null);\r\n                }\r\n                if (!Array.isArray(elements)) {\r\n                    return Promise.reject(new Error('Please return an array of children.'));\r\n                }\r\n                elements = !elements ? [] : elements.slice(0);\r\n                elements = _this.sort(elements);\r\n                var staleItems = {};\r\n                while (_this.firstChild !== null) {\r\n                    staleItems[_this.firstChild.id] = _this.firstChild;\r\n                    _this.removeChild(_this.firstChild);\r\n                }\r\n                for (var i = 0, len = elements.length; i < len; i++) {\r\n                    var element = elements[i];\r\n                    var id = _this.context.dataSource.getId(_this.context.tree, element);\r\n                    var item = staleItems[id] || new Item(id, _this.registry, _this.context, _this.lock, element);\r\n                    item.element = element;\r\n                    if (recursive) {\r\n                        item.needsChildrenRefresh = recursive;\r\n                    }\r\n                    delete staleItems[id];\r\n                    _this.addChild(item);\r\n                }\r\n                for (var staleItemId in staleItems) {\r\n                    if (staleItems.hasOwnProperty(staleItemId)) {\r\n                        staleItems[staleItemId].dispose();\r\n                    }\r\n                }\r\n                if (recursive) {\r\n                    return Promise.all(_this.mapEachChild(function (child) {\r\n                        return child.doRefresh(recursive, true);\r\n                    }));\r\n                }\r\n                else {\r\n                    return Promise.all(_this.mapEachChild(function (child) {\r\n                        if (child.isExpanded() && child.needsChildrenRefresh) {\r\n                            return child.doRefresh(recursive, true);\r\n                        }\r\n                        else {\r\n                            child.updateVisibility();\r\n                            return Promise.resolve(null);\r\n                        }\r\n                    }));\r\n                }\r\n            });\r\n            return result\r\n                .then(undefined, onUnexpectedError)\r\n                .then(function () { return _this._onDidRefreshChildren.fire(eventData); });\r\n        };\r\n        return safe ? doRefresh() : this.lock.run(this, doRefresh);\r\n    };\r\n    Item.prototype.doRefresh = function (recursive, safe) {\r\n        if (safe === void 0) { safe = false; }\r\n        this.doesHaveChildren = this.context.dataSource.hasChildren(this.context.tree, this.element);\r\n        this.height = this._getHeight();\r\n        this.updateVisibility();\r\n        this._onDidRefresh.fire(this);\r\n        return this.refreshChildren(recursive, safe);\r\n    };\r\n    Item.prototype.updateVisibility = function () {\r\n        this.setVisible(this._isVisible());\r\n    };\r\n    Item.prototype.refresh = function (recursive) {\r\n        return this.doRefresh(recursive);\r\n    };\r\n    Item.prototype.getNavigator = function () {\r\n        return new TreeNavigator(this);\r\n    };\r\n    Item.prototype.intersects = function (other) {\r\n        return this.isAncestorOf(other) || other.isAncestorOf(this);\r\n    };\r\n    Item.prototype.isAncestorOf = function (startItem) {\r\n        var item = startItem;\r\n        while (item) {\r\n            if (item.id === this.id) {\r\n                return true;\r\n            }\r\n            item = item.parent;\r\n        }\r\n        return false;\r\n    };\r\n    Item.prototype.addChild = function (item, afterItem) {\r\n        if (afterItem === void 0) { afterItem = this.lastChild; }\r\n        var isEmpty = this.firstChild === null;\r\n        var atHead = afterItem === null;\r\n        var atTail = afterItem === this.lastChild;\r\n        if (isEmpty) {\r\n            this.firstChild = this.lastChild = item;\r\n            item.next = item.previous = null;\r\n        }\r\n        else if (atHead) {\r\n            if (!this.firstChild) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            this.firstChild.previous = item;\r\n            item.next = this.firstChild;\r\n            item.previous = null;\r\n            this.firstChild = item;\r\n        }\r\n        else if (atTail) {\r\n            if (!this.lastChild) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            this.lastChild.next = item;\r\n            item.next = null;\r\n            item.previous = this.lastChild;\r\n            this.lastChild = item;\r\n        }\r\n        else {\r\n            item.previous = afterItem;\r\n            if (!afterItem) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next = afterItem.next;\r\n            if (!afterItem.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            afterItem.next.previous = item;\r\n            afterItem.next = item;\r\n        }\r\n        item.parent = this;\r\n        item.depth = this.depth + 1;\r\n    };\r\n    Item.prototype.removeChild = function (item) {\r\n        var isFirstChild = this.firstChild === item;\r\n        var isLastChild = this.lastChild === item;\r\n        if (isFirstChild && isLastChild) {\r\n            this.firstChild = this.lastChild = null;\r\n        }\r\n        else if (isFirstChild) {\r\n            if (!item.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next.previous = null;\r\n            this.firstChild = item.next;\r\n        }\r\n        else if (isLastChild) {\r\n            if (!item.previous) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.previous.next = null;\r\n            this.lastChild = item.previous;\r\n        }\r\n        else {\r\n            if (!item.next) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.next.previous = item.previous;\r\n            if (!item.previous) {\r\n                throw new Error('Invalid tree state');\r\n            }\r\n            item.previous.next = item.next;\r\n        }\r\n        item.parent = null;\r\n        item.depth = NaN;\r\n    };\r\n    Item.prototype.forEachChild = function (fn) {\r\n        var child = this.firstChild;\r\n        var next;\r\n        while (child) {\r\n            next = child.next;\r\n            fn(child);\r\n            child = next;\r\n        }\r\n    };\r\n    Item.prototype.mapEachChild = function (fn) {\r\n        var result = [];\r\n        this.forEachChild(function (child) {\r\n            result.push(fn(child));\r\n        });\r\n        return result;\r\n    };\r\n    Item.prototype.sort = function (elements) {\r\n        var _this = this;\r\n        var sorter = this.context.sorter;\r\n        if (sorter) {\r\n            return elements.sort(function (element, otherElement) {\r\n                return sorter.compare(_this.context.tree, element, otherElement);\r\n            });\r\n        }\r\n        return elements;\r\n    };\r\n    /* protected */ Item.prototype._getHeight = function () {\r\n        if (!this.context.renderer) {\r\n            return 0;\r\n        }\r\n        return this.context.renderer.getHeight(this.context.tree, this.element);\r\n    };\r\n    /* protected */ Item.prototype._isVisible = function () {\r\n        if (!this.context.filter) {\r\n            return false;\r\n        }\r\n        return this.context.filter.isVisible(this.context.tree, this.element);\r\n    };\r\n    Item.prototype.isDisposed = function () {\r\n        return this._isDisposed;\r\n    };\r\n    Item.prototype.dispose = function () {\r\n        this.forEachChild(function (child) { return child.dispose(); });\r\n        this.parent = null;\r\n        this.previous = null;\r\n        this.next = null;\r\n        this.firstChild = null;\r\n        this.lastChild = null;\r\n        this._onDidDispose.fire(this);\r\n        this.registry.deregister(this);\r\n        this._onDidCreate.dispose();\r\n        this._onDidReveal.dispose();\r\n        this._onExpand.dispose();\r\n        this._onDidExpand.dispose();\r\n        this._onCollapse.dispose();\r\n        this._onDidCollapse.dispose();\r\n        this._onDidAddTrait.dispose();\r\n        this._onDidRemoveTrait.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onRefreshChildren.dispose();\r\n        this._onDidRefreshChildren.dispose();\r\n        this._onDidDispose.dispose();\r\n        this._isDisposed = true;\r\n    };\r\n    return Item;\r\n}());\r\nexport { Item };\r\nvar RootItem = /** @class */ (function (_super) {\r\n    __extends(RootItem, _super);\r\n    function RootItem(id, registry, context, lock, element) {\r\n        return _super.call(this, id, registry, context, lock, element) || this;\r\n    }\r\n    RootItem.prototype.isVisible = function () {\r\n        return false;\r\n    };\r\n    RootItem.prototype.setVisible = function (value) {\r\n        // no-op\r\n    };\r\n    RootItem.prototype.isExpanded = function () {\r\n        return true;\r\n    };\r\n    /* protected */ RootItem.prototype._setExpanded = function (value) {\r\n        // no-op\r\n    };\r\n    /* protected */ RootItem.prototype._getHeight = function () {\r\n        return 0;\r\n    };\r\n    /* protected */ RootItem.prototype._isVisible = function () {\r\n        return false;\r\n    };\r\n    return RootItem;\r\n}(Item));\r\nvar TreeNavigator = /** @class */ (function () {\r\n    function TreeNavigator(item, subTreeOnly) {\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        this.item = item;\r\n        this.start = subTreeOnly ? item : null;\r\n    }\r\n    TreeNavigator.lastDescendantOf = function (item) {\r\n        if (!item) {\r\n            return null;\r\n        }\r\n        if (item instanceof RootItem) {\r\n            return TreeNavigator.lastDescendantOf(item.lastChild);\r\n        }\r\n        if (!item.isVisible()) {\r\n            return TreeNavigator.lastDescendantOf(item.previous);\r\n        }\r\n        if (!item.isExpanded() || item.lastChild === null) {\r\n            return item;\r\n        }\r\n        return TreeNavigator.lastDescendantOf(item.lastChild);\r\n    };\r\n    TreeNavigator.prototype.current = function () {\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.next = function () {\r\n        if (this.item) {\r\n            do {\r\n                if ((this.item instanceof RootItem || (this.item.isVisible() && this.item.isExpanded())) && this.item.firstChild) {\r\n                    this.item = this.item.firstChild;\r\n                }\r\n                else if (this.item === this.start) {\r\n                    this.item = null;\r\n                }\r\n                else {\r\n                    // select next brother, next uncle, next great-uncle, etc...\r\n                    while (this.item && this.item !== this.start && !this.item.next) {\r\n                        this.item = this.item.parent;\r\n                    }\r\n                    if (this.item === this.start) {\r\n                        this.item = null;\r\n                    }\r\n                    this.item = !this.item ? null : this.item.next;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.previous = function () {\r\n        if (this.item) {\r\n            do {\r\n                var previous = TreeNavigator.lastDescendantOf(this.item.previous);\r\n                if (previous) {\r\n                    this.item = previous;\r\n                }\r\n                else if (this.item.parent && this.item.parent !== this.start && this.item.parent.isVisible()) {\r\n                    this.item = this.item.parent;\r\n                }\r\n                else {\r\n                    this.item = null;\r\n                }\r\n            } while (this.item && !this.item.isVisible());\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.parent = function () {\r\n        if (this.item) {\r\n            var parent_1 = this.item.parent;\r\n            if (parent_1 && parent_1 !== this.start && parent_1.isVisible()) {\r\n                this.item = parent_1;\r\n            }\r\n            else {\r\n                this.item = null;\r\n            }\r\n        }\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.first = function () {\r\n        this.item = this.start;\r\n        this.next();\r\n        return this.item || null;\r\n    };\r\n    TreeNavigator.prototype.last = function () {\r\n        return TreeNavigator.lastDescendantOf(this.start);\r\n    };\r\n    return TreeNavigator;\r\n}());\r\nexport { TreeNavigator };\r\nvar TreeModel = /** @class */ (function () {\r\n    function TreeModel(context) {\r\n        this.registry = new ItemRegistry();\r\n        this.registryDisposable = Disposable.None;\r\n        this._onSetInput = new Emitter();\r\n        this.onSetInput = this._onSetInput.event;\r\n        this._onDidSetInput = new Emitter();\r\n        this.onDidSetInput = this._onDidSetInput.event;\r\n        this._onRefresh = new Emitter();\r\n        this.onRefresh = this._onRefresh.event;\r\n        this._onDidRefresh = new Emitter();\r\n        this.onDidRefresh = this._onDidRefresh.event;\r\n        this._onDidHighlight = new Emitter();\r\n        this.onDidHighlight = this._onDidHighlight.event;\r\n        this._onDidSelect = new Emitter();\r\n        this.onDidSelect = this._onDidSelect.event;\r\n        this._onDidFocus = new Emitter();\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this._onDidRevealItem = new Relay();\r\n        this.onDidRevealItem = this._onDidRevealItem.event;\r\n        this._onExpandItem = new Relay();\r\n        this.onExpandItem = this._onExpandItem.event;\r\n        this._onDidExpandItem = new Relay();\r\n        this.onDidExpandItem = this._onDidExpandItem.event;\r\n        this._onCollapseItem = new Relay();\r\n        this.onCollapseItem = this._onCollapseItem.event;\r\n        this._onDidCollapseItem = new Relay();\r\n        this.onDidCollapseItem = this._onDidCollapseItem.event;\r\n        this._onDidAddTraitItem = new Relay();\r\n        this.onDidAddTraitItem = this._onDidAddTraitItem.event;\r\n        this._onDidRemoveTraitItem = new Relay();\r\n        this.onDidRemoveTraitItem = this._onDidRemoveTraitItem.event;\r\n        this._onDidRefreshItem = new Relay();\r\n        this.onDidRefreshItem = this._onDidRefreshItem.event;\r\n        this._onRefreshItemChildren = new Relay();\r\n        this.onRefreshItemChildren = this._onRefreshItemChildren.event;\r\n        this._onDidRefreshItemChildren = new Relay();\r\n        this.onDidRefreshItemChildren = this._onDidRefreshItemChildren.event;\r\n        this._onDidDisposeItem = new Relay();\r\n        this.context = context;\r\n        this.input = null;\r\n        this.traitsToItems = {};\r\n    }\r\n    TreeModel.prototype.setInput = function (element) {\r\n        var _this = this;\r\n        var eventData = { item: this.input };\r\n        this._onSetInput.fire(eventData);\r\n        this.setSelection([]);\r\n        this.setFocus();\r\n        this.setHighlight();\r\n        this.lock = new Lock();\r\n        if (this.input) {\r\n            this.input.dispose();\r\n        }\r\n        if (this.registry) {\r\n            this.registry.dispose();\r\n            this.registryDisposable.dispose();\r\n        }\r\n        this.registry = new ItemRegistry();\r\n        this._onDidRevealItem.input = this.registry.onDidRevealItem;\r\n        this._onExpandItem.input = this.registry.onExpandItem;\r\n        this._onDidExpandItem.input = this.registry.onDidExpandItem;\r\n        this._onCollapseItem.input = this.registry.onCollapseItem;\r\n        this._onDidCollapseItem.input = this.registry.onDidCollapseItem;\r\n        this._onDidAddTraitItem.input = this.registry.onDidAddTraitItem;\r\n        this._onDidRemoveTraitItem.input = this.registry.onDidRemoveTraitItem;\r\n        this._onDidRefreshItem.input = this.registry.onDidRefreshItem;\r\n        this._onRefreshItemChildren.input = this.registry.onRefreshItemChildren;\r\n        this._onDidRefreshItemChildren.input = this.registry.onDidRefreshItemChildren;\r\n        this._onDidDisposeItem.input = this.registry.onDidDisposeItem;\r\n        this.registryDisposable = this.registry\r\n            .onDidDisposeItem(function (item) { return item.getAllTraits().forEach(function (trait) { return delete _this.traitsToItems[trait][item.id]; }); });\r\n        var id = this.context.dataSource.getId(this.context.tree, element);\r\n        this.input = new RootItem(id, this.registry, this.context, this.lock, element);\r\n        eventData = { item: this.input };\r\n        this._onDidSetInput.fire(eventData);\r\n        return this.refresh(this.input);\r\n    };\r\n    TreeModel.prototype.getInput = function () {\r\n        return this.input ? this.input.getElement() : null;\r\n    };\r\n    TreeModel.prototype.refresh = function (element, recursive) {\r\n        var _this = this;\r\n        if (element === void 0) { element = null; }\r\n        if (recursive === void 0) { recursive = true; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(null);\r\n        }\r\n        var eventData = { item: item, recursive: recursive };\r\n        this._onRefresh.fire(eventData);\r\n        return item.refresh(recursive).then(function () {\r\n            _this._onDidRefresh.fire(eventData);\r\n        });\r\n    };\r\n    TreeModel.prototype.expand = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return item.expand();\r\n    };\r\n    TreeModel.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return item.collapse(recursive);\r\n    };\r\n    TreeModel.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.isExpanded(element) ? this.collapse(element, recursive) : this.expand(element);\r\n    };\r\n    TreeModel.prototype.isExpanded = function (element) {\r\n        var item = this.getItem(element);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        return item.isExpanded();\r\n    };\r\n    TreeModel.prototype.reveal = function (element, relativeTop) {\r\n        var _this = this;\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.resolveUnknownParentChain(element).then(function (chain) {\r\n            var result = Promise.resolve(null);\r\n            chain.forEach(function (e) {\r\n                result = result.then(function () { return _this.expand(e); });\r\n            });\r\n            return result;\r\n        }).then(function () {\r\n            var item = _this.getItem(element);\r\n            if (item) {\r\n                return item.reveal(relativeTop);\r\n            }\r\n        });\r\n    };\r\n    TreeModel.prototype.resolveUnknownParentChain = function (element) {\r\n        var _this = this;\r\n        return this.context.dataSource.getParent(this.context.tree, element).then(function (parent) {\r\n            if (!parent) {\r\n                return Promise.resolve([]);\r\n            }\r\n            return _this.resolveUnknownParentChain(parent).then(function (result) {\r\n                result.push(parent);\r\n                return result;\r\n            });\r\n        });\r\n    };\r\n    TreeModel.prototype.setHighlight = function (element, eventPayload) {\r\n        this.setTraits('highlighted', element ? [element] : []);\r\n        var eventData = { highlight: this.getHighlight(), payload: eventPayload };\r\n        this._onDidHighlight.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getHighlight = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        var result = this.getElementsWithTrait('highlighted', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.setSelection = function (elements, eventPayload) {\r\n        this.setTraits('selected', elements);\r\n        var eventData = { selection: this.getSelection(), payload: eventPayload };\r\n        this._onDidSelect.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getSelection = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        return this.getElementsWithTrait('selected', includeHidden);\r\n    };\r\n    TreeModel.prototype.setFocus = function (element, eventPayload) {\r\n        this.setTraits('focused', element ? [element] : []);\r\n        var eventData = { focus: this.getFocus(), payload: eventPayload };\r\n        this._onDidFocus.fire(eventData);\r\n    };\r\n    TreeModel.prototype.getFocus = function (includeHidden) {\r\n        if (includeHidden === void 0) { includeHidden = false; }\r\n        var result = this.getElementsWithTrait('focused', includeHidden);\r\n        return result.length === 0 ? null : result[0];\r\n    };\r\n    TreeModel.prototype.focusNext = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var nextItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            nextItem = nav.next();\r\n            if (!nextItem) {\r\n                break;\r\n            }\r\n            item = nextItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusPrevious = function (count, eventPayload) {\r\n        if (count === void 0) { count = 1; }\r\n        var item = this.getFocus() || this.input;\r\n        var previousItem;\r\n        var nav = this.getNavigator(item, false);\r\n        for (var i = 0; i < count; i++) {\r\n            previousItem = nav.previous();\r\n            if (!previousItem) {\r\n                break;\r\n            }\r\n            item = previousItem;\r\n        }\r\n        this.setFocus(item, eventPayload);\r\n    };\r\n    TreeModel.prototype.focusParent = function (eventPayload) {\r\n        var item = this.getFocus() || this.input;\r\n        var nav = this.getNavigator(item, false);\r\n        var parent = nav.parent();\r\n        if (parent) {\r\n            this.setFocus(parent, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirstChild = function (eventPayload) {\r\n        var item = this.getItem(this.getFocus() || this.input);\r\n        var nav = this.getNavigator(item, false);\r\n        var next = nav.next();\r\n        var parent = nav.parent();\r\n        if (parent === item) {\r\n            this.setFocus(next, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusFirst = function (eventPayload, from) {\r\n        this.focusNth(0, eventPayload, from);\r\n    };\r\n    TreeModel.prototype.focusNth = function (index, eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var nav = this.getNavigator(navItem);\r\n        var item = nav.first();\r\n        for (var i = 0; i < index; i++) {\r\n            item = nav.next();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.focusLast = function (eventPayload, from) {\r\n        var navItem = this.getParent(from);\r\n        var item;\r\n        if (from && navItem) {\r\n            item = navItem.lastChild;\r\n        }\r\n        else {\r\n            var nav = this.getNavigator(navItem);\r\n            item = nav.last();\r\n        }\r\n        if (item) {\r\n            this.setFocus(item, eventPayload);\r\n        }\r\n    };\r\n    TreeModel.prototype.getParent = function (from) {\r\n        if (from) {\r\n            var fromItem = this.getItem(from);\r\n            if (fromItem && fromItem.parent) {\r\n                return fromItem.parent;\r\n            }\r\n        }\r\n        return this.getItem(this.input);\r\n    };\r\n    TreeModel.prototype.getNavigator = function (element, subTreeOnly) {\r\n        if (element === void 0) { element = null; }\r\n        if (subTreeOnly === void 0) { subTreeOnly = true; }\r\n        return new TreeNavigator(this.getItem(element), subTreeOnly);\r\n    };\r\n    TreeModel.prototype.getItem = function (element) {\r\n        if (element === void 0) { element = null; }\r\n        if (element === null) {\r\n            return this.input;\r\n        }\r\n        else if (element instanceof Item) {\r\n            return element;\r\n        }\r\n        else if (typeof element === 'string') {\r\n            return this.registry.getItem(element);\r\n        }\r\n        else {\r\n            return this.registry.getItem(this.context.dataSource.getId(this.context.tree, element));\r\n        }\r\n    };\r\n    TreeModel.prototype.removeTraits = function (trait, elements) {\r\n        var items = this.traitsToItems[trait] || {};\r\n        var item;\r\n        var id;\r\n        if (elements.length === 0) {\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.removeTrait(trait);\r\n                }\r\n            }\r\n            delete this.traitsToItems[trait];\r\n        }\r\n        else {\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    item.removeTrait(trait);\r\n                    delete items[item.id];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeModel.prototype.setTraits = function (trait, elements) {\r\n        if (elements.length === 0) {\r\n            this.removeTraits(trait, elements);\r\n        }\r\n        else {\r\n            var items = {};\r\n            var item = void 0;\r\n            for (var i = 0, len = elements.length; i < len; i++) {\r\n                item = this.getItem(elements[i]);\r\n                if (item) {\r\n                    items[item.id] = item;\r\n                }\r\n            }\r\n            var traitItems = this.traitsToItems[trait] || {};\r\n            var itemsToRemoveTrait = [];\r\n            var id = void 0;\r\n            for (id in traitItems) {\r\n                if (traitItems.hasOwnProperty(id)) {\r\n                    if (items.hasOwnProperty(id)) {\r\n                        delete items[id];\r\n                    }\r\n                    else {\r\n                        itemsToRemoveTrait.push(traitItems[id]);\r\n                    }\r\n                }\r\n            }\r\n            for (var i = 0, len = itemsToRemoveTrait.length; i < len; i++) {\r\n                item = itemsToRemoveTrait[i];\r\n                item.removeTrait(trait);\r\n                delete traitItems[item.id];\r\n            }\r\n            for (id in items) {\r\n                if (items.hasOwnProperty(id)) {\r\n                    item = items[id];\r\n                    item.addTrait(trait);\r\n                    traitItems[id] = item;\r\n                }\r\n            }\r\n            this.traitsToItems[trait] = traitItems;\r\n        }\r\n    };\r\n    TreeModel.prototype.getElementsWithTrait = function (trait, includeHidden) {\r\n        var elements = [];\r\n        var items = this.traitsToItems[trait] || {};\r\n        var id;\r\n        for (id in items) {\r\n            if (items.hasOwnProperty(id) && (items[id].isVisible() || includeHidden)) {\r\n                elements.push(items[id].getElement());\r\n            }\r\n        }\r\n        return elements;\r\n    };\r\n    TreeModel.prototype.dispose = function () {\r\n        this.registry.dispose();\r\n        this._onSetInput.dispose();\r\n        this._onDidSetInput.dispose();\r\n        this._onRefresh.dispose();\r\n        this._onDidRefresh.dispose();\r\n        this._onDidHighlight.dispose();\r\n        this._onDidSelect.dispose();\r\n        this._onDidFocus.dispose();\r\n        this._onDidRevealItem.dispose();\r\n        this._onExpandItem.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onCollapseItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDidAddTraitItem.dispose();\r\n        this._onDidRemoveTraitItem.dispose();\r\n        this._onDidRefreshItem.dispose();\r\n        this._onRefreshItemChildren.dispose();\r\n        this._onDidRefreshItemChildren.dispose();\r\n        this._onDidDisposeItem.dispose();\r\n    };\r\n    return TreeModel;\r\n}());\r\nexport { TreeModel };\r\n","var ElementsDragAndDropData = /** @class */ (function () {\r\n    function ElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ElementsDragAndDropData.prototype.update = function (dataTransfer) {\r\n        // no-op\r\n    };\r\n    ElementsDragAndDropData.prototype.getData = function () {\r\n        return this.elements;\r\n    };\r\n    return ElementsDragAndDropData;\r\n}());\r\nexport { ElementsDragAndDropData };\r\nvar ExternalElementsDragAndDropData = /** @class */ (function () {\r\n    function ExternalElementsDragAndDropData(elements) {\r\n        this.elements = elements;\r\n    }\r\n    ExternalElementsDragAndDropData.prototype.update = function (dataTransfer) {\r\n        // no-op\r\n    };\r\n    ExternalElementsDragAndDropData.prototype.getData = function () {\r\n        return this.elements;\r\n    };\r\n    return ExternalElementsDragAndDropData;\r\n}());\r\nexport { ExternalElementsDragAndDropData };\r\nvar DesktopDragAndDropData = /** @class */ (function () {\r\n    function DesktopDragAndDropData() {\r\n        this.types = [];\r\n        this.files = [];\r\n    }\r\n    DesktopDragAndDropData.prototype.update = function (dataTransfer) {\r\n        if (dataTransfer.types) {\r\n            this.types = [];\r\n            Array.prototype.push.apply(this.types, dataTransfer.types);\r\n        }\r\n        if (dataTransfer.files) {\r\n            this.files = [];\r\n            Array.prototype.push.apply(this.files, dataTransfer.files);\r\n            this.files = this.files.filter(function (f) { return f.size || f.type; });\r\n        }\r\n    };\r\n    DesktopDragAndDropData.prototype.getData = function () {\r\n        return {\r\n            types: this.types,\r\n            files: this.files\r\n        };\r\n    };\r\n    return DesktopDragAndDropData;\r\n}());\r\nexport { DesktopDragAndDropData };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ArrayIterator } from '../../../common/iterator.js';\r\nvar HeightMap = /** @class */ (function () {\r\n    function HeightMap() {\r\n        this.heightMap = [];\r\n        this.indexes = {};\r\n    }\r\n    HeightMap.prototype.getContentHeight = function () {\r\n        var last = this.heightMap[this.heightMap.length - 1];\r\n        return !last ? 0 : last.top + last.height;\r\n    };\r\n    HeightMap.prototype.onInsertItems = function (iterator, afterItemId) {\r\n        if (afterItemId === void 0) { afterItemId = null; }\r\n        var item = null;\r\n        var viewItem;\r\n        var i, j;\r\n        var totalSize;\r\n        var sizeDiff = 0;\r\n        if (afterItemId === null) {\r\n            i = 0;\r\n            totalSize = 0;\r\n        }\r\n        else {\r\n            i = this.indexes[afterItemId] + 1;\r\n            viewItem = this.heightMap[i - 1];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return undefined;\r\n            }\r\n            totalSize = viewItem.top + viewItem.height;\r\n        }\r\n        var boundSplice = this.heightMap.splice.bind(this.heightMap, i, 0);\r\n        var itemsToInsert = [];\r\n        while (item = iterator.next()) {\r\n            viewItem = this.createViewItem(item);\r\n            viewItem.top = totalSize + sizeDiff;\r\n            this.indexes[item.id] = i++;\r\n            itemsToInsert.push(viewItem);\r\n            sizeDiff += viewItem.height;\r\n        }\r\n        boundSplice.apply(this.heightMap, itemsToInsert);\r\n        for (j = i; j < this.heightMap.length; j++) {\r\n            viewItem = this.heightMap[j];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = j;\r\n        }\r\n        for (j = itemsToInsert.length - 1; j >= 0; j--) {\r\n            this.onInsertItem(itemsToInsert[j]);\r\n        }\r\n        for (j = this.heightMap.length - 1; j >= i; j--) {\r\n            this.onRefreshItem(this.heightMap[j]);\r\n        }\r\n        return sizeDiff;\r\n    };\r\n    HeightMap.prototype.onInsertItem = function (item) {\r\n        // noop\r\n    };\r\n    // Contiguous items\r\n    HeightMap.prototype.onRemoveItems = function (iterator) {\r\n        var itemId = null;\r\n        var viewItem;\r\n        var startIndex = null;\r\n        var i = 0;\r\n        var sizeDiff = 0;\r\n        while (itemId = iterator.next()) {\r\n            i = this.indexes[itemId];\r\n            viewItem = this.heightMap[i];\r\n            if (!viewItem) {\r\n                console.error('view item doesnt exist');\r\n                return;\r\n            }\r\n            sizeDiff -= viewItem.height;\r\n            delete this.indexes[itemId];\r\n            this.onRemoveItem(viewItem);\r\n            if (startIndex === null) {\r\n                startIndex = i;\r\n            }\r\n        }\r\n        if (sizeDiff === 0 || startIndex === null) {\r\n            return;\r\n        }\r\n        this.heightMap.splice(startIndex, i - startIndex + 1);\r\n        for (i = startIndex; i < this.heightMap.length; i++) {\r\n            viewItem = this.heightMap[i];\r\n            viewItem.top += sizeDiff;\r\n            this.indexes[viewItem.model.id] = i;\r\n            this.onRefreshItem(viewItem);\r\n        }\r\n    };\r\n    HeightMap.prototype.onRemoveItem = function (item) {\r\n        // noop\r\n    };\r\n    HeightMap.prototype.onRefreshItemSet = function (items) {\r\n        var _this = this;\r\n        var sortedItems = items.sort(function (a, b) { return _this.indexes[a.id] - _this.indexes[b.id]; });\r\n        this.onRefreshItems(new ArrayIterator(sortedItems));\r\n    };\r\n    // Ordered, but not necessarily contiguous items\r\n    HeightMap.prototype.onRefreshItems = function (iterator) {\r\n        var item = null;\r\n        var viewItem;\r\n        var newHeight;\r\n        var i, j = null;\r\n        var cummDiff = 0;\r\n        while (item = iterator.next()) {\r\n            i = this.indexes[item.id];\r\n            for (; cummDiff !== 0 && j !== null && j < i; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n            viewItem = this.heightMap[i];\r\n            newHeight = item.getHeight();\r\n            viewItem.top += cummDiff;\r\n            cummDiff += newHeight - viewItem.height;\r\n            viewItem.height = newHeight;\r\n            this.onRefreshItem(viewItem, true);\r\n            j = i + 1;\r\n        }\r\n        if (cummDiff !== 0 && j !== null) {\r\n            for (; j < this.heightMap.length; j++) {\r\n                viewItem = this.heightMap[j];\r\n                viewItem.top += cummDiff;\r\n                this.onRefreshItem(viewItem);\r\n            }\r\n        }\r\n    };\r\n    HeightMap.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        // noop\r\n    };\r\n    HeightMap.prototype.indexAt = function (position) {\r\n        var left = 0;\r\n        var right = this.heightMap.length;\r\n        var center;\r\n        var item;\r\n        // Binary search\r\n        while (left < right) {\r\n            center = Math.floor((left + right) / 2);\r\n            item = this.heightMap[center];\r\n            if (position < item.top) {\r\n                right = center;\r\n            }\r\n            else if (position >= item.top + item.height) {\r\n                if (left === center) {\r\n                    break;\r\n                }\r\n                left = center;\r\n            }\r\n            else {\r\n                return center;\r\n            }\r\n        }\r\n        return this.heightMap.length;\r\n    };\r\n    HeightMap.prototype.indexAfter = function (position) {\r\n        return Math.min(this.indexAt(position) + 1, this.heightMap.length);\r\n    };\r\n    HeightMap.prototype.itemAtIndex = function (index) {\r\n        return this.heightMap[index];\r\n    };\r\n    HeightMap.prototype.itemAfter = function (item) {\r\n        return this.heightMap[this.indexes[item.model.id] + 1] || null;\r\n    };\r\n    HeightMap.prototype.createViewItem = function (item) {\r\n        throw new Error('not implemented');\r\n    };\r\n    HeightMap.prototype.dispose = function () {\r\n        this.heightMap = [];\r\n        this.indexes = {};\r\n    };\r\n    return HeightMap;\r\n}());\r\nexport { HeightMap };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar ContextMenuEvent = /** @class */ (function () {\r\n    function ContextMenuEvent(posx, posy, target) {\r\n        this._posx = posx;\r\n        this._posy = posy;\r\n        this._target = target;\r\n    }\r\n    ContextMenuEvent.prototype.preventDefault = function () {\r\n        // no-op\r\n    };\r\n    ContextMenuEvent.prototype.stopPropagation = function () {\r\n        // no-op\r\n    };\r\n    Object.defineProperty(ContextMenuEvent.prototype, \"target\", {\r\n        get: function () {\r\n            return this._target;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ContextMenuEvent;\r\n}());\r\nexport { ContextMenuEvent };\r\nvar MouseContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(MouseContextMenuEvent, _super);\r\n    function MouseContextMenuEvent(originalEvent) {\r\n        var _this = _super.call(this, originalEvent.posx, originalEvent.posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    MouseContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    MouseContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return MouseContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { MouseContextMenuEvent };\r\nvar KeyboardContextMenuEvent = /** @class */ (function (_super) {\r\n    __extends(KeyboardContextMenuEvent, _super);\r\n    function KeyboardContextMenuEvent(posx, posy, originalEvent) {\r\n        var _this = _super.call(this, posx, posy, originalEvent.target) || this;\r\n        _this.originalEvent = originalEvent;\r\n        return _this;\r\n    }\r\n    KeyboardContextMenuEvent.prototype.preventDefault = function () {\r\n        this.originalEvent.preventDefault();\r\n    };\r\n    KeyboardContextMenuEvent.prototype.stopPropagation = function () {\r\n        this.originalEvent.stopPropagation();\r\n    };\r\n    return KeyboardContextMenuEvent;\r\n}(ContextMenuEvent));\r\nexport { KeyboardContextMenuEvent };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as Platform from '../../../common/platform.js';\r\nimport * as Browser from '../../../browser/browser.js';\r\nimport * as Lifecycle from '../../../common/lifecycle.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport * as Diff from '../../../common/diff/diff.js';\r\nimport * as Touch from '../../../browser/touch.js';\r\nimport * as strings from '../../../common/strings.js';\r\nimport * as Mouse from '../../../browser/mouseEvent.js';\r\nimport * as Keyboard from '../../../browser/keyboardEvent.js';\r\nimport * as dnd from './treeDnd.js';\r\nimport { ArrayIterator, MappedIterator } from '../../../common/iterator.js';\r\nimport { ScrollableElement } from '../../../browser/ui/scrollbar/scrollableElement.js';\r\nimport { HeightMap } from './treeViewModel.js';\r\nimport * as _ from './tree.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { DataTransfers, StaticDND } from '../../../browser/dnd.js';\r\nimport { DefaultTreestyler } from './treeDefaults.js';\r\nimport { Delayer, timeout } from '../../../common/async.js';\r\nfunction removeFromParent(element) {\r\n    try {\r\n        element.parentElement.removeChild(element);\r\n    }\r\n    catch (e) {\r\n        // this will throw if this happens due to a blur event, nasty business\r\n    }\r\n}\r\nvar RowCache = /** @class */ (function () {\r\n    function RowCache(context) {\r\n        this.context = context;\r\n        this._cache = { '': [] };\r\n    }\r\n    RowCache.prototype.alloc = function (templateId) {\r\n        var result = this.cache(templateId).pop();\r\n        if (!result) {\r\n            var content = document.createElement('div');\r\n            content.className = 'content';\r\n            var row = document.createElement('div');\r\n            row.appendChild(content);\r\n            var templateData = null;\r\n            try {\r\n                templateData = this.context.renderer.renderTemplate(this.context.tree, templateId, content);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering template');\r\n                console.error(err);\r\n            }\r\n            result = {\r\n                element: row,\r\n                templateId: templateId,\r\n                templateData: templateData\r\n            };\r\n        }\r\n        return result;\r\n    };\r\n    RowCache.prototype.release = function (templateId, row) {\r\n        removeFromParent(row.element);\r\n        this.cache(templateId).push(row);\r\n    };\r\n    RowCache.prototype.cache = function (templateId) {\r\n        return this._cache[templateId] || (this._cache[templateId] = []);\r\n    };\r\n    RowCache.prototype.garbageCollect = function () {\r\n        var _this = this;\r\n        if (this._cache) {\r\n            Object.keys(this._cache).forEach(function (templateId) {\r\n                _this._cache[templateId].forEach(function (cachedRow) {\r\n                    _this.context.renderer.disposeTemplate(_this.context.tree, templateId, cachedRow.templateData);\r\n                    cachedRow.element = null;\r\n                    cachedRow.templateData = null;\r\n                });\r\n                delete _this._cache[templateId];\r\n            });\r\n        }\r\n    };\r\n    RowCache.prototype.dispose = function () {\r\n        this.garbageCollect();\r\n        this._cache = null;\r\n    };\r\n    return RowCache;\r\n}());\r\nexport { RowCache };\r\nvar ViewItem = /** @class */ (function () {\r\n    function ViewItem(context, model) {\r\n        var _this = this;\r\n        this.width = 0;\r\n        this.needsRender = false;\r\n        this.uri = null;\r\n        this.unbindDragStart = Lifecycle.Disposable.None;\r\n        this._draggable = false;\r\n        this.context = context;\r\n        this.model = model;\r\n        this.id = this.model.id;\r\n        this.row = null;\r\n        this.top = 0;\r\n        this.height = model.getHeight();\r\n        this._styles = {};\r\n        model.getAllTraits().forEach(function (t) { return _this._styles[t] = true; });\r\n        if (model.isExpanded()) {\r\n            this.addClass('expanded');\r\n        }\r\n    }\r\n    Object.defineProperty(ViewItem.prototype, \"expanded\", {\r\n        set: function (value) {\r\n            value ? this.addClass('expanded') : this.removeClass('expanded');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"loading\", {\r\n        set: function (value) {\r\n            value ? this.addClass('codicon-loading') : this.removeClass('codicon-loading');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"draggable\", {\r\n        get: function () {\r\n            return this._draggable;\r\n        },\r\n        set: function (value) {\r\n            this._draggable = value;\r\n            this.render(true);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"dropTarget\", {\r\n        set: function (value) {\r\n            value ? this.addClass('drop-target') : this.removeClass('drop-target');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"element\", {\r\n        get: function () {\r\n            return (this.row && this.row.element);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ViewItem.prototype, \"templateId\", {\r\n        get: function () {\r\n            return this._templateId || (this._templateId = (this.context.renderer.getTemplateId && this.context.renderer.getTemplateId(this.context.tree, this.model.getElement())));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ViewItem.prototype.addClass = function (name) {\r\n        this._styles[name] = true;\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.removeClass = function (name) {\r\n        delete this._styles[name]; // is this slow?\r\n        this.render(true);\r\n    };\r\n    ViewItem.prototype.render = function (skipUserRender) {\r\n        var _this = this;\r\n        if (skipUserRender === void 0) { skipUserRender = false; }\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-row'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n        this.element.draggable = this.draggable;\r\n        this.element.style.height = this.height + 'px';\r\n        // ARIA\r\n        this.element.setAttribute('role', 'treeitem');\r\n        var accessibility = this.context.accessibilityProvider;\r\n        var ariaLabel = accessibility.getAriaLabel(this.context.tree, this.model.getElement());\r\n        if (ariaLabel) {\r\n            this.element.setAttribute('aria-label', ariaLabel);\r\n        }\r\n        if (accessibility.getPosInSet && accessibility.getSetSize) {\r\n            this.element.setAttribute('aria-setsize', accessibility.getSetSize());\r\n            this.element.setAttribute('aria-posinset', accessibility.getPosInSet(this.context.tree, this.model.getElement()));\r\n        }\r\n        if (this.model.hasTrait('focused')) {\r\n            var base64Id = strings.safeBtoa(this.model.id);\r\n            this.element.setAttribute('aria-selected', 'true');\r\n            this.element.setAttribute('id', base64Id);\r\n        }\r\n        else {\r\n            this.element.setAttribute('aria-selected', 'false');\r\n            this.element.removeAttribute('id');\r\n        }\r\n        if (this.model.hasChildren()) {\r\n            this.element.setAttribute('aria-expanded', String(!!this._styles['expanded']));\r\n        }\r\n        else {\r\n            this.element.removeAttribute('aria-expanded');\r\n        }\r\n        this.element.setAttribute('aria-level', String(this.model.getDepth()));\r\n        if (this.context.options.paddingOnRow) {\r\n            this.element.style.paddingLeft = this.context.options.twistiePixels + ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n        }\r\n        else {\r\n            this.element.style.paddingLeft = ((this.model.getDepth() - 1) * this.context.options.indentPixels) + 'px';\r\n            this.row.element.firstElementChild.style.paddingLeft = this.context.options.twistiePixels + 'px';\r\n        }\r\n        var uri = this.context.dnd.getDragURI(this.context.tree, this.model.getElement());\r\n        if (uri !== this.uri) {\r\n            if (this.unbindDragStart) {\r\n                this.unbindDragStart.dispose();\r\n            }\r\n            if (uri) {\r\n                this.uri = uri;\r\n                this.draggable = true;\r\n                this.unbindDragStart = DOM.addDisposableListener(this.element, 'dragstart', function (e) {\r\n                    _this.onDragStart(e);\r\n                });\r\n            }\r\n            else {\r\n                this.uri = null;\r\n            }\r\n        }\r\n        if (!skipUserRender && this.element) {\r\n            var paddingLeft = 0;\r\n            if (this.context.horizontalScrolling) {\r\n                var style = window.getComputedStyle(this.element);\r\n                paddingLeft = parseFloat(style.paddingLeft);\r\n            }\r\n            if (this.context.horizontalScrolling) {\r\n                this.element.style.width = Browser.isFirefox ? '-moz-fit-content' : 'fit-content';\r\n            }\r\n            try {\r\n                this.context.renderer.renderElement(this.context.tree, this.model.getElement(), this.templateId, this.row.templateData);\r\n            }\r\n            catch (err) {\r\n                console.error('Tree usage error: exception while rendering element');\r\n                console.error(err);\r\n            }\r\n            if (this.context.horizontalScrolling) {\r\n                this.width = DOM.getContentWidth(this.element) + paddingLeft;\r\n                this.element.style.width = '';\r\n            }\r\n        }\r\n    };\r\n    ViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        if (!this.row) {\r\n            this.row = this.context.cache.alloc(this.templateId);\r\n            // used in reverse lookup from HTMLElement to Item\r\n            this.element[TreeView.BINDING] = this;\r\n        }\r\n        if (this.element.parentElement) {\r\n            return;\r\n        }\r\n        if (afterElement === null) {\r\n            container.appendChild(this.element);\r\n        }\r\n        else {\r\n            try {\r\n                container.insertBefore(this.element, afterElement);\r\n            }\r\n            catch (e) {\r\n                console.warn('Failed to locate previous tree element');\r\n                container.appendChild(this.element);\r\n            }\r\n        }\r\n        this.render();\r\n    };\r\n    ViewItem.prototype.removeFromDOM = function () {\r\n        if (!this.row) {\r\n            return;\r\n        }\r\n        this.unbindDragStart.dispose();\r\n        this.uri = null;\r\n        this.element[TreeView.BINDING] = null;\r\n        this.context.cache.release(this.templateId, this.row);\r\n        this.row = null;\r\n    };\r\n    ViewItem.prototype.dispose = function () {\r\n        this.row = null;\r\n    };\r\n    return ViewItem;\r\n}());\r\nexport { ViewItem };\r\nvar RootViewItem = /** @class */ (function (_super) {\r\n    __extends(RootViewItem, _super);\r\n    function RootViewItem(context, model, wrapper) {\r\n        var _this = _super.call(this, context, model) || this;\r\n        _this.row = {\r\n            element: wrapper,\r\n            templateData: null,\r\n            templateId: null\r\n        };\r\n        return _this;\r\n    }\r\n    RootViewItem.prototype.render = function () {\r\n        if (!this.model || !this.element) {\r\n            return;\r\n        }\r\n        var classes = ['monaco-tree-wrapper'];\r\n        classes.push.apply(classes, Object.keys(this._styles));\r\n        if (this.model.hasChildren()) {\r\n            classes.push('has-children');\r\n        }\r\n        this.element.className = classes.join(' ');\r\n    };\r\n    RootViewItem.prototype.insertInDOM = function (container, afterElement) {\r\n        // noop\r\n    };\r\n    RootViewItem.prototype.removeFromDOM = function () {\r\n        // noop\r\n    };\r\n    return RootViewItem;\r\n}(ViewItem));\r\nfunction reactionEquals(one, other) {\r\n    if (!one && !other) {\r\n        return true;\r\n    }\r\n    else if (!one || !other) {\r\n        return false;\r\n    }\r\n    else if (one.accept !== other.accept) {\r\n        return false;\r\n    }\r\n    else if (one.bubble !== other.bubble) {\r\n        return false;\r\n    }\r\n    else if (one.effect !== other.effect) {\r\n        return false;\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nvar TreeView = /** @class */ (function (_super) {\r\n    __extends(TreeView, _super);\r\n    function TreeView(context, container) {\r\n        var _this = _super.call(this) || this;\r\n        _this.model = null;\r\n        _this.lastPointerType = '';\r\n        _this.lastClickTimeStamp = 0;\r\n        _this.contentWidthUpdateDelayer = new Delayer(50);\r\n        _this.isRefreshing = false;\r\n        _this.refreshingPreviousChildrenIds = {};\r\n        _this.currentDragAndDropData = null;\r\n        _this.currentDropTarget = null;\r\n        _this.currentDropTargets = null;\r\n        _this.currentDropDisposable = Lifecycle.Disposable.None;\r\n        _this.gestureDisposable = Lifecycle.Disposable.None;\r\n        _this.dragAndDropScrollInterval = null;\r\n        _this.dragAndDropScrollTimeout = null;\r\n        _this.dragAndDropMouseY = null;\r\n        _this.highlightedItemWasDraggable = false;\r\n        _this.onHiddenScrollTop = null;\r\n        _this._onDOMFocus = new Emitter();\r\n        _this.onDOMFocus = _this._onDOMFocus.event;\r\n        _this._onDOMBlur = new Emitter();\r\n        _this._onDidScroll = new Emitter();\r\n        TreeView.counter++;\r\n        _this.instance = TreeView.counter;\r\n        var horizontalScrollMode = typeof context.options.horizontalScrollMode === 'undefined' ? 2 /* Hidden */ : context.options.horizontalScrollMode;\r\n        _this.horizontalScrolling = horizontalScrollMode !== 2 /* Hidden */;\r\n        _this.context = {\r\n            dataSource: context.dataSource,\r\n            renderer: context.renderer,\r\n            controller: context.controller,\r\n            dnd: context.dnd,\r\n            filter: context.filter,\r\n            sorter: context.sorter,\r\n            tree: context.tree,\r\n            accessibilityProvider: context.accessibilityProvider,\r\n            options: context.options,\r\n            cache: new RowCache(context),\r\n            horizontalScrolling: _this.horizontalScrolling\r\n        };\r\n        _this.modelListeners = [];\r\n        _this.viewListeners = [];\r\n        _this.items = {};\r\n        _this.domNode = document.createElement('div');\r\n        _this.domNode.className = \"monaco-tree no-focused-item monaco-tree-instance-\" + _this.instance;\r\n        // to allow direct tabbing into the tree instead of first focusing the tree\r\n        _this.domNode.tabIndex = context.options.preventRootFocus ? -1 : 0;\r\n        _this.styleElement = DOM.createStyleSheet(_this.domNode);\r\n        _this.treeStyler = context.styler || new DefaultTreestyler(_this.styleElement, \"monaco-tree-instance-\" + _this.instance);\r\n        // ARIA\r\n        _this.domNode.setAttribute('role', 'tree');\r\n        if (_this.context.options.ariaLabel) {\r\n            _this.domNode.setAttribute('aria-label', _this.context.options.ariaLabel);\r\n        }\r\n        if (_this.context.options.alwaysFocused) {\r\n            DOM.addClass(_this.domNode, 'focused');\r\n        }\r\n        if (!_this.context.options.paddingOnRow) {\r\n            DOM.addClass(_this.domNode, 'no-row-padding');\r\n        }\r\n        _this.wrapper = document.createElement('div');\r\n        _this.wrapper.className = 'monaco-tree-wrapper';\r\n        _this.scrollableElement = new ScrollableElement(_this.wrapper, {\r\n            alwaysConsumeMouseWheel: true,\r\n            horizontal: horizontalScrollMode,\r\n            vertical: (typeof context.options.verticalScrollMode !== 'undefined' ? context.options.verticalScrollMode : 1 /* Auto */),\r\n            useShadows: context.options.useShadows\r\n        });\r\n        _this.scrollableElement.onScroll(function (e) {\r\n            _this.render(e.scrollTop, e.height, e.scrollLeft, e.width, e.scrollWidth);\r\n            _this._onDidScroll.fire();\r\n        });\r\n        if (Browser.isIE) {\r\n            _this.wrapper.style.msTouchAction = 'none';\r\n            _this.wrapper.style.msContentZooming = 'none';\r\n        }\r\n        else {\r\n            _this.gestureDisposable = Touch.Gesture.addTarget(_this.wrapper);\r\n        }\r\n        _this.rowsContainer = document.createElement('div');\r\n        _this.rowsContainer.className = 'monaco-tree-rows';\r\n        if (context.options.showTwistie) {\r\n            _this.rowsContainer.className += ' show-twisties';\r\n        }\r\n        var focusTracker = DOM.trackFocus(_this.domNode);\r\n        _this.viewListeners.push(focusTracker.onDidFocus(function () { return _this.onFocus(); }));\r\n        _this.viewListeners.push(focusTracker.onDidBlur(function () { return _this.onBlur(); }));\r\n        _this.viewListeners.push(focusTracker);\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keydown', function (e) { return _this.onKeyDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'keyup', function (e) { return _this.onKeyUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mousedown', function (e) { return _this.onMouseDown(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'mouseup', function (e) { return _this.onMouseUp(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'auxclick', function (e) {\r\n            if (e && e.button === 1) {\r\n                _this.onMouseMiddleClick(e);\r\n            }\r\n        }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'click', function (e) { return _this.onClick(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.domNode, 'contextmenu', function (e) { return _this.onContextMenu(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Tap, function (e) { return _this.onTap(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, Touch.EventType.Change, function (e) { return _this.onTouchChange(e); }));\r\n        if (Browser.isIE) {\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSPointerDown', function (e) { return _this.onMsPointerDown(e); }));\r\n            _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'MSGestureTap', function (e) { return _this.onMsGestureTap(e); }));\r\n            // these events come too fast, we throttle them\r\n            _this.viewListeners.push(DOM.addDisposableThrottledListener(_this.wrapper, 'MSGestureChange', function (e) { return _this.onThrottledMsGestureChange(e); }, function (lastEvent, event) {\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n                var result = { translationY: event.translationY, translationX: event.translationX };\r\n                if (lastEvent) {\r\n                    result.translationY += lastEvent.translationY;\r\n                    result.translationX += lastEvent.translationX;\r\n                }\r\n                return result;\r\n            }));\r\n        }\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragover', function (e) { return _this.onDragOver(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(_this.wrapper, 'drop', function (e) { return _this.onDrop(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragend', function (e) { return _this.onDragEnd(e); }));\r\n        _this.viewListeners.push(DOM.addDisposableListener(window, 'dragleave', function (e) { return _this.onDragOver(e); }));\r\n        _this.wrapper.appendChild(_this.rowsContainer);\r\n        _this.domNode.appendChild(_this.scrollableElement.getDomNode());\r\n        container.appendChild(_this.domNode);\r\n        _this.lastRenderTop = 0;\r\n        _this.lastRenderHeight = 0;\r\n        _this.didJustPressContextMenuKey = false;\r\n        _this.currentDropTarget = null;\r\n        _this.currentDropTargets = [];\r\n        _this.shouldInvalidateDropReaction = false;\r\n        _this.dragAndDropScrollInterval = null;\r\n        _this.dragAndDropScrollTimeout = null;\r\n        _this.onRowsChanged();\r\n        _this.layout();\r\n        _this.setupMSGesture();\r\n        _this.applyStyles(context.options);\r\n        return _this;\r\n    }\r\n    TreeView.prototype.applyStyles = function (styles) {\r\n        this.treeStyler.style(styles);\r\n    };\r\n    TreeView.prototype.createViewItem = function (item) {\r\n        return new ViewItem(this.context, item);\r\n    };\r\n    TreeView.prototype.getHTMLElement = function () {\r\n        return this.domNode;\r\n    };\r\n    TreeView.prototype.focus = function () {\r\n        this.domNode.focus();\r\n    };\r\n    TreeView.prototype.isFocused = function () {\r\n        return document.activeElement === this.domNode;\r\n    };\r\n    TreeView.prototype.blur = function () {\r\n        this.domNode.blur();\r\n    };\r\n    TreeView.prototype.setupMSGesture = function () {\r\n        var _this = this;\r\n        if (window.MSGesture) {\r\n            this.msGesture = new MSGesture();\r\n            setTimeout(function () { return _this.msGesture.target = _this.wrapper; }, 100); // TODO@joh, TODO@IETeam\r\n        }\r\n    };\r\n    TreeView.prototype.isTreeVisible = function () {\r\n        return this.onHiddenScrollTop === null;\r\n    };\r\n    TreeView.prototype.layout = function (height, width) {\r\n        if (!this.isTreeVisible()) {\r\n            return;\r\n        }\r\n        this.viewHeight = height || DOM.getContentHeight(this.wrapper); // render\r\n        this.scrollHeight = this.getContentHeight();\r\n        if (this.horizontalScrolling) {\r\n            this.viewWidth = width || DOM.getContentWidth(this.wrapper);\r\n        }\r\n    };\r\n    TreeView.prototype.render = function (scrollTop, viewHeight, scrollLeft, viewWidth, scrollWidth) {\r\n        var i;\r\n        var stop;\r\n        var renderTop = scrollTop;\r\n        var renderBottom = scrollTop + viewHeight;\r\n        var thisRenderBottom = this.lastRenderTop + this.lastRenderHeight;\r\n        // when view scrolls down, start rendering from the renderBottom\r\n        for (i = this.indexAfter(renderBottom) - 1, stop = this.indexAt(Math.max(thisRenderBottom, renderTop)); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start rendering from either this.renderTop or renderBottom\r\n        for (i = Math.min(this.indexAt(this.lastRenderTop), this.indexAfter(renderBottom)) - 1, stop = this.indexAt(renderTop); i >= stop; i--) {\r\n            this.insertItemInDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls down, start unrendering from renderTop\r\n        for (i = this.indexAt(this.lastRenderTop), stop = Math.min(this.indexAt(renderTop), this.indexAfter(thisRenderBottom)); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        // when view scrolls up, start unrendering from either renderBottom this.renderTop\r\n        for (i = Math.max(this.indexAfter(renderBottom), this.indexAt(this.lastRenderTop)), stop = this.indexAfter(thisRenderBottom); i < stop; i++) {\r\n            this.removeItemFromDOM(this.itemAtIndex(i));\r\n        }\r\n        var topItem = this.itemAtIndex(this.indexAt(renderTop));\r\n        if (topItem) {\r\n            this.rowsContainer.style.top = (topItem.top - renderTop) + 'px';\r\n        }\r\n        if (this.horizontalScrolling) {\r\n            this.rowsContainer.style.left = -scrollLeft + 'px';\r\n            this.rowsContainer.style.width = Math.max(scrollWidth, viewWidth) + \"px\";\r\n        }\r\n        this.lastRenderTop = renderTop;\r\n        this.lastRenderHeight = renderBottom - renderTop;\r\n    };\r\n    TreeView.prototype.setModel = function (newModel) {\r\n        this.releaseModel();\r\n        this.model = newModel;\r\n        this.model.onRefresh(this.onRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefresh(this.onRefreshed, this, this.modelListeners);\r\n        this.model.onSetInput(this.onClearingInput, this, this.modelListeners);\r\n        this.model.onDidSetInput(this.onSetInput, this, this.modelListeners);\r\n        this.model.onDidFocus(this.onModelFocusChange, this, this.modelListeners);\r\n        this.model.onRefreshItemChildren(this.onItemChildrenRefreshing, this, this.modelListeners);\r\n        this.model.onDidRefreshItemChildren(this.onItemChildrenRefreshed, this, this.modelListeners);\r\n        this.model.onDidRefreshItem(this.onItemRefresh, this, this.modelListeners);\r\n        this.model.onExpandItem(this.onItemExpanding, this, this.modelListeners);\r\n        this.model.onDidExpandItem(this.onItemExpanded, this, this.modelListeners);\r\n        this.model.onCollapseItem(this.onItemCollapsing, this, this.modelListeners);\r\n        this.model.onDidRevealItem(this.onItemReveal, this, this.modelListeners);\r\n        this.model.onDidAddTraitItem(this.onItemAddTrait, this, this.modelListeners);\r\n        this.model.onDidRemoveTraitItem(this.onItemRemoveTrait, this, this.modelListeners);\r\n    };\r\n    TreeView.prototype.onRefreshing = function () {\r\n        this.isRefreshing = true;\r\n    };\r\n    TreeView.prototype.onRefreshed = function () {\r\n        this.isRefreshing = false;\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onRowsChanged = function (scrollTop) {\r\n        if (scrollTop === void 0) { scrollTop = this.scrollTop; }\r\n        if (this.isRefreshing) {\r\n            return;\r\n        }\r\n        this.scrollTop = scrollTop;\r\n        this.updateScrollWidth();\r\n    };\r\n    TreeView.prototype.updateScrollWidth = function () {\r\n        var _this = this;\r\n        if (!this.horizontalScrolling) {\r\n            return;\r\n        }\r\n        this.contentWidthUpdateDelayer.trigger(function () {\r\n            var keys = Object.keys(_this.items);\r\n            var scrollWidth = 0;\r\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n                var key = keys_1[_i];\r\n                scrollWidth = Math.max(scrollWidth, _this.items[key].width);\r\n            }\r\n            _this.scrollWidth = scrollWidth + 10 /* scrollbar */;\r\n        });\r\n    };\r\n    TreeView.prototype.focusNextPage = function (eventPayload) {\r\n        var _this = this;\r\n        var lastPageIndex = this.indexAt(this.scrollTop + this.viewHeight);\r\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\r\n        var lastPageElement = this.itemAtIndex(lastPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== lastPageElement) {\r\n            this.model.setFocus(lastPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop += this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusNextPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.focusPreviousPage = function (eventPayload) {\r\n        var _this = this;\r\n        var firstPageIndex;\r\n        if (this.scrollTop === 0) {\r\n            firstPageIndex = this.indexAt(this.scrollTop);\r\n        }\r\n        else {\r\n            firstPageIndex = this.indexAfter(this.scrollTop - 1);\r\n        }\r\n        var firstPageElement = this.itemAtIndex(firstPageIndex).model.getElement();\r\n        var currentlyFocusedElement = this.model.getFocus();\r\n        if (currentlyFocusedElement !== firstPageElement) {\r\n            this.model.setFocus(firstPageElement, eventPayload);\r\n        }\r\n        else {\r\n            var previousScrollTop = this.scrollTop;\r\n            this.scrollTop -= this.viewHeight;\r\n            if (this.scrollTop !== previousScrollTop) {\r\n                // Let the scroll event listener run\r\n                setTimeout(function () {\r\n                    _this.focusPreviousPage(eventPayload);\r\n                }, 0);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(TreeView.prototype, \"viewHeight\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.height;\r\n        },\r\n        set: function (height) {\r\n            this.scrollableElement.setScrollDimensions({ height: height });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollHeight\", {\r\n        set: function (scrollHeight) {\r\n            scrollHeight = scrollHeight + (this.horizontalScrolling ? 10 : 0);\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"viewWidth\", {\r\n        get: function () {\r\n            var scrollDimensions = this.scrollableElement.getScrollDimensions();\r\n            return scrollDimensions.width;\r\n        },\r\n        set: function (viewWidth) {\r\n            this.scrollableElement.setScrollDimensions({ width: viewWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollWidth\", {\r\n        set: function (scrollWidth) {\r\n            this.scrollableElement.setScrollDimensions({ scrollWidth: scrollWidth });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TreeView.prototype, \"scrollTop\", {\r\n        get: function () {\r\n            var scrollPosition = this.scrollableElement.getScrollPosition();\r\n            return scrollPosition.scrollTop;\r\n        },\r\n        set: function (scrollTop) {\r\n            var scrollHeight = this.getContentHeight() + (this.horizontalScrolling ? 10 : 0);\r\n            this.scrollableElement.setScrollDimensions({ scrollHeight: scrollHeight });\r\n            this.scrollableElement.setScrollPosition({ scrollTop: scrollTop });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // Events\r\n    TreeView.prototype.onClearingInput = function (e) {\r\n        var item = e.item;\r\n        if (item) {\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onSetInput = function (e) {\r\n        this.context.cache.garbageCollect();\r\n        this.inputItem = new RootViewItem(this.context, e.item, this.wrapper);\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem && this.context.options.showLoading) {\r\n            viewItem.loadingTimer = setTimeout(function () {\r\n                viewItem.loadingTimer = 0;\r\n                viewItem.loading = true;\r\n            }, TreeView.LOADING_DECORATION_DELAY);\r\n        }\r\n        if (!e.isNested) {\r\n            var childrenIds = [];\r\n            var navigator_1 = item.getNavigator();\r\n            var childItem = void 0;\r\n            while (childItem = navigator_1.next()) {\r\n                childrenIds.push(childItem.id);\r\n            }\r\n            this.refreshingPreviousChildrenIds[item.id] = childrenIds;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemChildrenRefreshed = function (e) {\r\n        var _this = this;\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (viewItem.loadingTimer) {\r\n                clearTimeout(viewItem.loadingTimer);\r\n                viewItem.loadingTimer = 0;\r\n            }\r\n            viewItem.loading = false;\r\n        }\r\n        if (!e.isNested) {\r\n            var previousChildrenIds_1 = this.refreshingPreviousChildrenIds[item.id];\r\n            var afterModelItems_1 = [];\r\n            var navigator_2 = item.getNavigator();\r\n            var childItem = void 0;\r\n            while (childItem = navigator_2.next()) {\r\n                afterModelItems_1.push(childItem);\r\n            }\r\n            var skipDiff = Math.abs(previousChildrenIds_1.length - afterModelItems_1.length) > 1000;\r\n            var diff = [];\r\n            var doToInsertItemsAlreadyExist = false;\r\n            if (!skipDiff) {\r\n                var lcs = new Diff.LcsDiff({\r\n                    getElements: function () { return previousChildrenIds_1; }\r\n                }, {\r\n                    getElements: function () { return afterModelItems_1.map(function (item) { return item.id; }); }\r\n                }, null);\r\n                diff = lcs.ComputeDiff(false).changes;\r\n                // this means that the result of the diff algorithm would result\r\n                // in inserting items that were already registered. this can only\r\n                // happen if the data provider returns bad ids OR if the sorting\r\n                // of the elements has changed\r\n                doToInsertItemsAlreadyExist = diff.some(function (d) {\r\n                    if (d.modifiedLength > 0) {\r\n                        for (var i = d.modifiedStart, len = d.modifiedStart + d.modifiedLength; i < len; i++) {\r\n                            if (_this.items.hasOwnProperty(afterModelItems_1[i].id)) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                });\r\n            }\r\n            // 50 is an optimization number, at some point we're better off\r\n            // just replacing everything\r\n            if (!skipDiff && !doToInsertItemsAlreadyExist && diff.length < 50) {\r\n                for (var _i = 0, diff_1 = diff; _i < diff_1.length; _i++) {\r\n                    var diffChange = diff_1[_i];\r\n                    if (diffChange.originalLength > 0) {\r\n                        this.onRemoveItems(new ArrayIterator(previousChildrenIds_1, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength));\r\n                    }\r\n                    if (diffChange.modifiedLength > 0) {\r\n                        var beforeItem = afterModelItems_1[diffChange.modifiedStart - 1] || item;\r\n                        beforeItem = beforeItem.getDepth() > 0 ? beforeItem : null;\r\n                        this.onInsertItems(new ArrayIterator(afterModelItems_1, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength), beforeItem ? beforeItem.id : null);\r\n                    }\r\n                }\r\n            }\r\n            else if (skipDiff || diff.length) {\r\n                this.onRemoveItems(new ArrayIterator(previousChildrenIds_1));\r\n                this.onInsertItems(new ArrayIterator(afterModelItems_1), item.getDepth() > 0 ? item.id : null);\r\n            }\r\n            if (skipDiff || diff.length) {\r\n                this.onRowsChanged();\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRefresh = function (item) {\r\n        this.onItemsRefresh([item]);\r\n    };\r\n    TreeView.prototype.onItemsRefresh = function (items) {\r\n        var _this = this;\r\n        this.onRefreshItemSet(items.filter(function (item) { return _this.items.hasOwnProperty(item.id); }));\r\n        this.onRowsChanged();\r\n    };\r\n    TreeView.prototype.onItemExpanding = function (e) {\r\n        var viewItem = this.items[e.item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n        }\r\n    };\r\n    TreeView.prototype.onItemExpanded = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = true;\r\n            var height = this.onInsertItems(item.getNavigator(), item.id) || 0;\r\n            var scrollTop = this.scrollTop;\r\n            if (viewItem.top + viewItem.height <= this.scrollTop) {\r\n                scrollTop += height;\r\n            }\r\n            this.onRowsChanged(scrollTop);\r\n        }\r\n    };\r\n    TreeView.prototype.onItemCollapsing = function (e) {\r\n        var item = e.item;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.expanded = false;\r\n            this.onRemoveItems(new MappedIterator(item.getNavigator(), function (item) { return item && item.id; }));\r\n            this.onRowsChanged();\r\n        }\r\n    };\r\n    TreeView.prototype.onItemReveal = function (e) {\r\n        var item = e.item;\r\n        var relativeTop = e.relativeTop;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            if (relativeTop !== null) {\r\n                relativeTop = relativeTop < 0 ? 0 : relativeTop;\r\n                relativeTop = relativeTop > 1 ? 1 : relativeTop;\r\n                // y = mx + b\r\n                var m = viewItem.height - this.viewHeight;\r\n                this.scrollTop = m * relativeTop + viewItem.top;\r\n            }\r\n            else {\r\n                var viewItemBottom = viewItem.top + viewItem.height;\r\n                var wrapperBottom = this.scrollTop + this.viewHeight;\r\n                if (viewItem.top < this.scrollTop) {\r\n                    this.scrollTop = viewItem.top;\r\n                }\r\n                else if (viewItemBottom >= wrapperBottom) {\r\n                    this.scrollTop = viewItemBottom - this.viewHeight;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemAddTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.addClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.addClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (viewItem) {\r\n                this.highlightedItemWasDraggable = !!viewItem.draggable;\r\n                if (viewItem.draggable) {\r\n                    viewItem.draggable = false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TreeView.prototype.onItemRemoveTrait = function (e) {\r\n        var item = e.item;\r\n        var trait = e.trait;\r\n        var viewItem = this.items[item.id];\r\n        if (viewItem) {\r\n            viewItem.removeClass(trait);\r\n        }\r\n        if (trait === 'highlighted') {\r\n            DOM.removeClass(this.domNode, trait);\r\n            // Ugly Firefox fix: input fields can't be selected if parent nodes are draggable\r\n            if (this.highlightedItemWasDraggable) {\r\n                viewItem.draggable = true;\r\n            }\r\n            this.highlightedItemWasDraggable = false;\r\n        }\r\n    };\r\n    TreeView.prototype.onModelFocusChange = function () {\r\n        var focus = this.model && this.model.getFocus();\r\n        DOM.toggleClass(this.domNode, 'no-focused-item', !focus);\r\n        // ARIA\r\n        if (focus) {\r\n            this.domNode.setAttribute('aria-activedescendant', strings.safeBtoa(this.context.dataSource.getId(this.context.tree, focus)));\r\n        }\r\n        else {\r\n            this.domNode.removeAttribute('aria-activedescendant');\r\n        }\r\n    };\r\n    // HeightMap \"events\"\r\n    TreeView.prototype.onInsertItem = function (item) {\r\n        var _this = this;\r\n        item.onDragStart = function (e) { _this.onDragStart(item, e); };\r\n        item.needsRender = true;\r\n        this.refreshViewItem(item);\r\n        this.items[item.id] = item;\r\n    };\r\n    TreeView.prototype.onRefreshItem = function (item, needsRender) {\r\n        if (needsRender === void 0) { needsRender = false; }\r\n        item.needsRender = item.needsRender || needsRender;\r\n        this.refreshViewItem(item);\r\n    };\r\n    TreeView.prototype.onRemoveItem = function (item) {\r\n        this.removeItemFromDOM(item);\r\n        item.dispose();\r\n        delete this.items[item.id];\r\n    };\r\n    // ViewItem refresh\r\n    TreeView.prototype.refreshViewItem = function (item) {\r\n        item.render();\r\n        if (this.shouldBeRendered(item)) {\r\n            this.insertItemInDOM(item);\r\n        }\r\n        else {\r\n            this.removeItemFromDOM(item);\r\n        }\r\n    };\r\n    // DOM Events\r\n    TreeView.prototype.onClick = function (e) {\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        if (Browser.isIE && Date.now() - this.lastClickTimeStamp < 300) {\r\n            // IE10+ doesn't set the detail property correctly. While IE10 simply\r\n            // counts the number of clicks, IE11 reports always 1. To align with\r\n            // other browser, we set the value to 2 if clicks events come in a 300ms\r\n            // sequence.\r\n            event.detail = 2;\r\n        }\r\n        this.lastClickTimeStamp = Date.now();\r\n        this.context.controller.onClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseMiddleClick = function (e) {\r\n        if (!this.context.controller.onMouseMiddleClick) {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseMiddleClick(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseDown = function (e) {\r\n        this.didJustPressContextMenuKey = false;\r\n        if (!this.context.controller.onMouseDown) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseDown(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onMouseUp = function (e) {\r\n        if (!this.context.controller.onMouseUp) {\r\n            return;\r\n        }\r\n        if (this.lastPointerType && this.lastPointerType !== 'mouse') {\r\n            return;\r\n        }\r\n        var event = new Mouse.StandardMouseEvent(e);\r\n        if (event.ctrlKey && Platform.isNative && Platform.isMacintosh) {\r\n            return;\r\n        }\r\n        var item = this.getItemAround(event.target);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onMouseUp(this.context.tree, item.model.getElement(), event);\r\n    };\r\n    TreeView.prototype.onTap = function (e) {\r\n        var item = this.getItemAround(e.initialTarget);\r\n        if (!item) {\r\n            return;\r\n        }\r\n        this.context.controller.onTap(this.context.tree, item.model.getElement(), e);\r\n    };\r\n    TreeView.prototype.onTouchChange = function (event) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onContextMenu = function (event) {\r\n        var resultEvent;\r\n        var element;\r\n        if (event instanceof KeyboardEvent || this.didJustPressContextMenuKey) {\r\n            this.didJustPressContextMenuKey = false;\r\n            var keyboardEvent = new Keyboard.StandardKeyboardEvent(event);\r\n            element = this.model.getFocus();\r\n            var position = void 0;\r\n            if (!element) {\r\n                element = this.model.getInput();\r\n                position = DOM.getDomNodePagePosition(this.inputItem.element);\r\n            }\r\n            else {\r\n                var id = this.context.dataSource.getId(this.context.tree, element);\r\n                var viewItem = this.items[id];\r\n                position = DOM.getDomNodePagePosition(viewItem.element);\r\n            }\r\n            resultEvent = new _.KeyboardContextMenuEvent(position.left + position.width, position.top, keyboardEvent);\r\n        }\r\n        else {\r\n            var mouseEvent = new Mouse.StandardMouseEvent(event);\r\n            var item = this.getItemAround(mouseEvent.target);\r\n            if (!item) {\r\n                return;\r\n            }\r\n            element = item.model.getElement();\r\n            resultEvent = new _.MouseContextMenuEvent(mouseEvent);\r\n        }\r\n        this.context.controller.onContextMenu(this.context.tree, element, resultEvent);\r\n    };\r\n    TreeView.prototype.onKeyDown = function (e) {\r\n        var event = new Keyboard.StandardKeyboardEvent(e);\r\n        this.didJustPressContextMenuKey = event.keyCode === 58 /* ContextMenu */ || (event.shiftKey && event.keyCode === 68 /* F10 */);\r\n        if (event.target && event.target.tagName && event.target.tagName.toLowerCase() === 'input') {\r\n            return; // Ignore event if target is a form input field (avoids browser specific issues)\r\n        }\r\n        if (this.didJustPressContextMenuKey) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n        this.context.controller.onKeyDown(this.context.tree, event);\r\n    };\r\n    TreeView.prototype.onKeyUp = function (e) {\r\n        if (this.didJustPressContextMenuKey) {\r\n            this.onContextMenu(e);\r\n        }\r\n        this.didJustPressContextMenuKey = false;\r\n        this.context.controller.onKeyUp(this.context.tree, new Keyboard.StandardKeyboardEvent(e));\r\n    };\r\n    TreeView.prototype.onDragStart = function (item, e) {\r\n        if (this.model.getHighlight()) {\r\n            return;\r\n        }\r\n        var element = item.model.getElement();\r\n        var selection = this.model.getSelection();\r\n        var elements;\r\n        if (selection.indexOf(element) > -1) {\r\n            elements = selection;\r\n        }\r\n        else {\r\n            elements = [element];\r\n        }\r\n        e.dataTransfer.effectAllowed = 'copyMove';\r\n        e.dataTransfer.setData(DataTransfers.RESOURCES, JSON.stringify([item.uri]));\r\n        if (e.dataTransfer.setDragImage) {\r\n            var label = void 0;\r\n            if (this.context.dnd.getDragLabel) {\r\n                label = this.context.dnd.getDragLabel(this.context.tree, elements);\r\n            }\r\n            else {\r\n                label = String(elements.length);\r\n            }\r\n            var dragImage_1 = document.createElement('div');\r\n            dragImage_1.className = 'monaco-tree-drag-image';\r\n            dragImage_1.textContent = label;\r\n            document.body.appendChild(dragImage_1);\r\n            e.dataTransfer.setDragImage(dragImage_1, -10, -10);\r\n            setTimeout(function () { return document.body.removeChild(dragImage_1); }, 0);\r\n        }\r\n        this.currentDragAndDropData = new dnd.ElementsDragAndDropData(elements);\r\n        StaticDND.CurrentDragAndDropData = new dnd.ExternalElementsDragAndDropData(elements);\r\n        this.context.dnd.onDragStart(this.context.tree, this.currentDragAndDropData, new Mouse.DragMouseEvent(e));\r\n    };\r\n    TreeView.prototype.setupDragAndDropScrollInterval = function () {\r\n        var _this = this;\r\n        var viewTop = DOM.getTopLeftOffset(this.wrapper).top;\r\n        if (!this.dragAndDropScrollInterval) {\r\n            this.dragAndDropScrollInterval = window.setInterval(function () {\r\n                if (_this.dragAndDropMouseY === null) {\r\n                    return;\r\n                }\r\n                var diff = _this.dragAndDropMouseY - viewTop;\r\n                var scrollDiff = 0;\r\n                var upperLimit = _this.viewHeight - 35;\r\n                if (diff < 35) {\r\n                    scrollDiff = Math.max(-14, 0.2 * (diff - 35));\r\n                }\r\n                else if (diff > upperLimit) {\r\n                    scrollDiff = Math.min(14, 0.2 * (diff - upperLimit));\r\n                }\r\n                _this.scrollTop += scrollDiff;\r\n            }, 10);\r\n            this.cancelDragAndDropScrollTimeout();\r\n            this.dragAndDropScrollTimeout = window.setTimeout(function () {\r\n                _this.cancelDragAndDropScrollInterval();\r\n                _this.dragAndDropScrollTimeout = null;\r\n            }, 1000);\r\n        }\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollInterval = function () {\r\n        if (this.dragAndDropScrollInterval) {\r\n            window.clearInterval(this.dragAndDropScrollInterval);\r\n            this.dragAndDropScrollInterval = null;\r\n        }\r\n        this.cancelDragAndDropScrollTimeout();\r\n    };\r\n    TreeView.prototype.cancelDragAndDropScrollTimeout = function () {\r\n        if (this.dragAndDropScrollTimeout) {\r\n            window.clearTimeout(this.dragAndDropScrollTimeout);\r\n            this.dragAndDropScrollTimeout = null;\r\n        }\r\n    };\r\n    TreeView.prototype.onDragOver = function (e) {\r\n        var _this = this;\r\n        e.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\r\n        var event = new Mouse.DragMouseEvent(e);\r\n        var viewItem = this.getItemAround(event.target);\r\n        if (!viewItem || (event.posx === 0 && event.posy === 0 && event.browserEvent.type === DOM.EventType.DRAG_LEAVE)) {\r\n            // dragging outside of tree\r\n            if (this.currentDropTarget) {\r\n                // clear previously hovered element feedback\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.cancelDragAndDropScrollInterval();\r\n            this.currentDropTarget = null;\r\n            this.currentDropElement = null;\r\n            this.dragAndDropMouseY = null;\r\n            return false;\r\n        }\r\n        // dragging inside the tree\r\n        this.setupDragAndDropScrollInterval();\r\n        this.dragAndDropMouseY = event.posy;\r\n        if (!this.currentDragAndDropData) {\r\n            // just started dragging\r\n            if (StaticDND.CurrentDragAndDropData) {\r\n                this.currentDragAndDropData = StaticDND.CurrentDragAndDropData;\r\n            }\r\n            else {\r\n                if (!event.dataTransfer.types) {\r\n                    return false;\r\n                }\r\n                this.currentDragAndDropData = new dnd.DesktopDragAndDropData();\r\n            }\r\n        }\r\n        this.currentDragAndDropData.update(event.browserEvent.dataTransfer);\r\n        var element;\r\n        var item = viewItem.model;\r\n        var reaction;\r\n        // check the bubble up behavior\r\n        do {\r\n            element = item ? item.getElement() : this.model.getInput();\r\n            reaction = this.context.dnd.onDragOver(this.context.tree, this.currentDragAndDropData, element, event);\r\n            if (!reaction || reaction.bubble !== 1 /* BUBBLE_UP */) {\r\n                break;\r\n            }\r\n            item = item && item.parent;\r\n        } while (item);\r\n        if (!item) {\r\n            this.currentDropElement = null;\r\n            return false;\r\n        }\r\n        var canDrop = reaction && reaction.accept;\r\n        if (canDrop) {\r\n            this.currentDropElement = item.getElement();\r\n            event.preventDefault();\r\n            event.dataTransfer.dropEffect = reaction.effect === 0 /* COPY */ ? 'copy' : 'move';\r\n        }\r\n        else {\r\n            this.currentDropElement = null;\r\n        }\r\n        // item is the model item where drop() should be called\r\n        // can be null\r\n        var currentDropTarget = item.id === this.inputItem.id ? this.inputItem : this.items[item.id];\r\n        if (this.shouldInvalidateDropReaction || this.currentDropTarget !== currentDropTarget || !reactionEquals(this.currentDropElementReaction, reaction)) {\r\n            this.shouldInvalidateDropReaction = false;\r\n            if (this.currentDropTarget) {\r\n                this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n                this.currentDropTargets = [];\r\n                this.currentDropDisposable.dispose();\r\n            }\r\n            this.currentDropTarget = currentDropTarget;\r\n            this.currentDropElementReaction = reaction;\r\n            if (canDrop) {\r\n                // setup hover feedback for drop target\r\n                if (this.currentDropTarget) {\r\n                    this.currentDropTarget.dropTarget = true;\r\n                    this.currentDropTargets.push(this.currentDropTarget);\r\n                }\r\n                if (reaction.bubble === 0 /* BUBBLE_DOWN */) {\r\n                    var nav = item.getNavigator();\r\n                    var child = void 0;\r\n                    while (child = nav.next()) {\r\n                        viewItem = this.items[child.id];\r\n                        if (viewItem) {\r\n                            viewItem.dropTarget = true;\r\n                            this.currentDropTargets.push(viewItem);\r\n                        }\r\n                    }\r\n                }\r\n                if (reaction.autoExpand) {\r\n                    var timeoutPromise_1 = timeout(500);\r\n                    this.currentDropDisposable = Lifecycle.toDisposable(function () { return timeoutPromise_1.cancel(); });\r\n                    timeoutPromise_1\r\n                        .then(function () { return _this.context.tree.expand(_this.currentDropElement); })\r\n                        .then(function () { return _this.shouldInvalidateDropReaction = true; });\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    TreeView.prototype.onDrop = function (e) {\r\n        if (this.currentDropElement) {\r\n            var event_1 = new Mouse.DragMouseEvent(e);\r\n            event_1.preventDefault();\r\n            this.currentDragAndDropData.update(event_1.browserEvent.dataTransfer);\r\n            this.context.dnd.drop(this.context.tree, this.currentDragAndDropData, this.currentDropElement, event_1);\r\n            this.onDragEnd(e);\r\n        }\r\n        this.cancelDragAndDropScrollInterval();\r\n    };\r\n    TreeView.prototype.onDragEnd = function (e) {\r\n        if (this.currentDropTarget) {\r\n            this.currentDropTargets.forEach(function (i) { return i.dropTarget = false; });\r\n            this.currentDropTargets = [];\r\n        }\r\n        this.currentDropDisposable.dispose();\r\n        this.cancelDragAndDropScrollInterval();\r\n        this.currentDragAndDropData = null;\r\n        StaticDND.CurrentDragAndDropData = undefined;\r\n        this.currentDropElement = null;\r\n        this.currentDropTarget = null;\r\n        this.dragAndDropMouseY = null;\r\n    };\r\n    TreeView.prototype.onFocus = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.addClass(this.domNode, 'focused');\r\n        }\r\n        this._onDOMFocus.fire();\r\n    };\r\n    TreeView.prototype.onBlur = function () {\r\n        if (!this.context.options.alwaysFocused) {\r\n            DOM.removeClass(this.domNode, 'focused');\r\n        }\r\n        this.domNode.removeAttribute('aria-activedescendant'); // ARIA\r\n        this._onDOMBlur.fire();\r\n    };\r\n    // MS specific DOM Events\r\n    TreeView.prototype.onMsPointerDown = function (event) {\r\n        if (!this.msGesture) {\r\n            return;\r\n        }\r\n        // Circumvent IE11 breaking change in e.pointerType & TypeScript's stale definitions\r\n        var pointerType = event.pointerType;\r\n        if (pointerType === (event.MSPOINTER_TYPE_MOUSE || 'mouse')) {\r\n            this.lastPointerType = 'mouse';\r\n            return;\r\n        }\r\n        else if (pointerType === (event.MSPOINTER_TYPE_TOUCH || 'touch')) {\r\n            this.lastPointerType = 'touch';\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        this.msGesture.addPointer(event.pointerId);\r\n    };\r\n    TreeView.prototype.onThrottledMsGestureChange = function (event) {\r\n        this.scrollTop -= event.translationY;\r\n    };\r\n    TreeView.prototype.onMsGestureTap = function (event) {\r\n        event.initialTarget = document.elementFromPoint(event.clientX, event.clientY);\r\n        this.onTap(event);\r\n    };\r\n    // DOM changes\r\n    TreeView.prototype.insertItemInDOM = function (item) {\r\n        var elementAfter = null;\r\n        var itemAfter = this.itemAfter(item);\r\n        if (itemAfter && itemAfter.element) {\r\n            elementAfter = itemAfter.element;\r\n        }\r\n        item.insertInDOM(this.rowsContainer, elementAfter);\r\n    };\r\n    TreeView.prototype.removeItemFromDOM = function (item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n        item.removeFromDOM();\r\n    };\r\n    // Helpers\r\n    TreeView.prototype.shouldBeRendered = function (item) {\r\n        return item.top < this.lastRenderTop + this.lastRenderHeight && item.top + item.height > this.lastRenderTop;\r\n    };\r\n    TreeView.prototype.getItemAround = function (element) {\r\n        var candidate = this.inputItem;\r\n        var el = element;\r\n        do {\r\n            if (el[TreeView.BINDING]) {\r\n                candidate = el[TreeView.BINDING];\r\n            }\r\n            if (el === this.wrapper || el === this.domNode) {\r\n                return candidate;\r\n            }\r\n            if (el === this.scrollableElement.getDomNode() || el === document.body) {\r\n                return undefined;\r\n            }\r\n        } while (el = el.parentElement);\r\n        return undefined;\r\n    };\r\n    // Cleanup\r\n    TreeView.prototype.releaseModel = function () {\r\n        if (this.model) {\r\n            this.modelListeners = Lifecycle.dispose(this.modelListeners);\r\n            this.model = null;\r\n        }\r\n    };\r\n    TreeView.prototype.dispose = function () {\r\n        var _this = this;\r\n        // TODO@joao: improve\r\n        this.scrollableElement.dispose();\r\n        this.releaseModel();\r\n        this.viewListeners = Lifecycle.dispose(this.viewListeners);\r\n        this._onDOMFocus.dispose();\r\n        this._onDOMBlur.dispose();\r\n        if (this.domNode.parentNode) {\r\n            this.domNode.parentNode.removeChild(this.domNode);\r\n        }\r\n        if (this.items) {\r\n            Object.keys(this.items).forEach(function (key) { return _this.items[key].removeFromDOM(); });\r\n        }\r\n        if (this.context.cache) {\r\n            this.context.cache.dispose();\r\n        }\r\n        this.gestureDisposable.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    TreeView.BINDING = 'monaco-tree-row';\r\n    TreeView.LOADING_DECORATION_DELAY = 800;\r\n    TreeView.counter = 0;\r\n    return TreeView;\r\n}(HeightMap));\r\nexport { TreeView };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './tree.css';\r\nimport * as TreeDefaults from './treeDefaults.js';\r\nimport * as Model from './treeModel.js';\r\nimport * as View from './treeView.js';\r\nimport { Emitter, Relay } from '../../../common/event.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nvar TreeContext = /** @class */ (function () {\r\n    function TreeContext(tree, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.tree = tree;\r\n        this.configuration = configuration;\r\n        this.options = options;\r\n        if (!configuration.dataSource) {\r\n            throw new Error('You must provide a Data Source to the tree.');\r\n        }\r\n        this.dataSource = configuration.dataSource;\r\n        this.renderer = configuration.renderer;\r\n        this.controller = configuration.controller || new TreeDefaults.DefaultController({ clickBehavior: 1 /* ON_MOUSE_UP */, keyboardSupport: typeof options.keyboardSupport !== 'boolean' || options.keyboardSupport });\r\n        this.dnd = configuration.dnd || new TreeDefaults.DefaultDragAndDrop();\r\n        this.filter = configuration.filter || new TreeDefaults.DefaultFilter();\r\n        this.sorter = configuration.sorter;\r\n        this.accessibilityProvider = configuration.accessibilityProvider || new TreeDefaults.DefaultAccessibilityProvider();\r\n        this.styler = configuration.styler;\r\n    }\r\n    return TreeContext;\r\n}());\r\nexport { TreeContext };\r\nvar defaultStyles = {\r\n    listFocusBackground: Color.fromHex('#073655'),\r\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\r\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\r\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\r\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\r\n    listHoverBackground: Color.fromHex('#2A2D2E'),\r\n    listDropBackground: Color.fromHex('#383B3D')\r\n};\r\nvar Tree = /** @class */ (function () {\r\n    function Tree(container, configuration, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this._onDidChangeFocus = new Relay();\r\n        this.onDidChangeFocus = this._onDidChangeFocus.event;\r\n        this._onDidChangeSelection = new Relay();\r\n        this.onDidChangeSelection = this._onDidChangeSelection.event;\r\n        this._onHighlightChange = new Relay();\r\n        this._onDidExpandItem = new Relay();\r\n        this._onDidCollapseItem = new Relay();\r\n        this._onDispose = new Emitter();\r\n        this.onDidDispose = this._onDispose.event;\r\n        this.container = container;\r\n        mixin(options, defaultStyles, false);\r\n        options.twistiePixels = typeof options.twistiePixels === 'number' ? options.twistiePixels : 32;\r\n        options.showTwistie = options.showTwistie === false ? false : true;\r\n        options.indentPixels = typeof options.indentPixels === 'number' ? options.indentPixels : 12;\r\n        options.alwaysFocused = options.alwaysFocused === true ? true : false;\r\n        options.useShadows = options.useShadows === false ? false : true;\r\n        options.paddingOnRow = options.paddingOnRow === false ? false : true;\r\n        options.showLoading = options.showLoading === false ? false : true;\r\n        this.context = new TreeContext(this, configuration, options);\r\n        this.model = new Model.TreeModel(this.context);\r\n        this.view = new View.TreeView(this.context, this.container);\r\n        this.view.setModel(this.model);\r\n        this._onDidChangeFocus.input = this.model.onDidFocus;\r\n        this._onDidChangeSelection.input = this.model.onDidSelect;\r\n        this._onHighlightChange.input = this.model.onDidHighlight;\r\n        this._onDidExpandItem.input = this.model.onDidExpandItem;\r\n        this._onDidCollapseItem.input = this.model.onDidCollapseItem;\r\n    }\r\n    Tree.prototype.style = function (styles) {\r\n        this.view.applyStyles(styles);\r\n    };\r\n    Object.defineProperty(Tree.prototype, \"onDidFocus\", {\r\n        get: function () {\r\n            return this.view.onDOMFocus;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Tree.prototype.getHTMLElement = function () {\r\n        return this.view.getHTMLElement();\r\n    };\r\n    Tree.prototype.layout = function (height, width) {\r\n        this.view.layout(height, width);\r\n    };\r\n    Tree.prototype.domFocus = function () {\r\n        this.view.focus();\r\n    };\r\n    Tree.prototype.isDOMFocused = function () {\r\n        return this.view.isFocused();\r\n    };\r\n    Tree.prototype.domBlur = function () {\r\n        this.view.blur();\r\n    };\r\n    Tree.prototype.setInput = function (element) {\r\n        return this.model.setInput(element);\r\n    };\r\n    Tree.prototype.getInput = function () {\r\n        return this.model.getInput();\r\n    };\r\n    Tree.prototype.expand = function (element) {\r\n        return this.model.expand(element);\r\n    };\r\n    Tree.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.collapse(element, recursive);\r\n    };\r\n    Tree.prototype.toggleExpansion = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return this.model.toggleExpansion(element, recursive);\r\n    };\r\n    Tree.prototype.isExpanded = function (element) {\r\n        return this.model.isExpanded(element);\r\n    };\r\n    Tree.prototype.reveal = function (element, relativeTop) {\r\n        if (relativeTop === void 0) { relativeTop = null; }\r\n        return this.model.reveal(element, relativeTop);\r\n    };\r\n    Tree.prototype.getHighlight = function () {\r\n        return this.model.getHighlight();\r\n    };\r\n    Tree.prototype.clearHighlight = function (eventPayload) {\r\n        this.model.setHighlight(null, eventPayload);\r\n    };\r\n    Tree.prototype.setSelection = function (elements, eventPayload) {\r\n        this.model.setSelection(elements, eventPayload);\r\n    };\r\n    Tree.prototype.getSelection = function () {\r\n        return this.model.getSelection();\r\n    };\r\n    Tree.prototype.clearSelection = function (eventPayload) {\r\n        this.model.setSelection([], eventPayload);\r\n    };\r\n    Tree.prototype.setFocus = function (element, eventPayload) {\r\n        this.model.setFocus(element, eventPayload);\r\n    };\r\n    Tree.prototype.getFocus = function () {\r\n        return this.model.getFocus();\r\n    };\r\n    Tree.prototype.focusNext = function (count, eventPayload) {\r\n        this.model.focusNext(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusPrevious = function (count, eventPayload) {\r\n        this.model.focusPrevious(count, eventPayload);\r\n    };\r\n    Tree.prototype.focusParent = function (eventPayload) {\r\n        this.model.focusParent(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirstChild = function (eventPayload) {\r\n        this.model.focusFirstChild(eventPayload);\r\n    };\r\n    Tree.prototype.focusFirst = function (eventPayload, from) {\r\n        this.model.focusFirst(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNth = function (index, eventPayload) {\r\n        this.model.focusNth(index, eventPayload);\r\n    };\r\n    Tree.prototype.focusLast = function (eventPayload, from) {\r\n        this.model.focusLast(eventPayload, from);\r\n    };\r\n    Tree.prototype.focusNextPage = function (eventPayload) {\r\n        this.view.focusNextPage(eventPayload);\r\n    };\r\n    Tree.prototype.focusPreviousPage = function (eventPayload) {\r\n        this.view.focusPreviousPage(eventPayload);\r\n    };\r\n    Tree.prototype.clearFocus = function (eventPayload) {\r\n        this.model.setFocus(null, eventPayload);\r\n    };\r\n    Tree.prototype.dispose = function () {\r\n        this._onDispose.fire();\r\n        this.model.dispose();\r\n        this.view.dispose();\r\n        this._onDidChangeFocus.dispose();\r\n        this._onDidChangeSelection.dispose();\r\n        this._onHighlightChange.dispose();\r\n        this._onDidExpandItem.dispose();\r\n        this._onDidCollapseItem.dispose();\r\n        this._onDispose.dispose();\r\n    };\r\n    return Tree;\r\n}());\r\nexport { Tree };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './progressbar.css';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { removeClasses, addClass, hasClass, hide, show } from '../../dom.js';\r\nimport { RunOnceScheduler } from '../../../common/async.js';\r\nvar css_done = 'done';\r\nvar css_active = 'active';\r\nvar css_infinite = 'infinite';\r\nvar css_discrete = 'discrete';\r\nvar css_progress_container = 'monaco-progress-container';\r\nvar css_progress_bit = 'progress-bit';\r\nvar defaultOpts = {\r\n    progressBarBackground: Color.fromHex('#0E70C0')\r\n};\r\n/**\r\n * A progress bar with support for infinite or discrete progress.\r\n */\r\nvar ProgressBar = /** @class */ (function (_super) {\r\n    __extends(ProgressBar, _super);\r\n    function ProgressBar(container, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.options = options || Object.create(null);\r\n        mixin(_this.options, defaultOpts, false);\r\n        _this.workedVal = 0;\r\n        _this.progressBarBackground = _this.options.progressBarBackground;\r\n        _this._register(_this.showDelayedScheduler = new RunOnceScheduler(function () { return show(_this.element); }, 0));\r\n        _this.create(container);\r\n        return _this;\r\n    }\r\n    ProgressBar.prototype.create = function (container) {\r\n        this.element = document.createElement('div');\r\n        addClass(this.element, css_progress_container);\r\n        container.appendChild(this.element);\r\n        this.bit = document.createElement('div');\r\n        addClass(this.bit, css_progress_bit);\r\n        this.element.appendChild(this.bit);\r\n        this.applyStyles();\r\n    };\r\n    ProgressBar.prototype.off = function () {\r\n        this.bit.style.width = 'inherit';\r\n        this.bit.style.opacity = '1';\r\n        removeClasses(this.element, css_active, css_infinite, css_discrete);\r\n        this.workedVal = 0;\r\n        this.totalWork = undefined;\r\n    };\r\n    /**\r\n     * Stops the progressbar from showing any progress instantly without fading out.\r\n     */\r\n    ProgressBar.prototype.stop = function () {\r\n        return this.doDone(false);\r\n    };\r\n    ProgressBar.prototype.doDone = function (delayed) {\r\n        var _this = this;\r\n        addClass(this.element, css_done);\r\n        // let it grow to 100% width and hide afterwards\r\n        if (!hasClass(this.element, css_infinite)) {\r\n            this.bit.style.width = 'inherit';\r\n            if (delayed) {\r\n                setTimeout(function () { return _this.off(); }, 200);\r\n            }\r\n            else {\r\n                this.off();\r\n            }\r\n        }\r\n        // let it fade out and hide afterwards\r\n        else {\r\n            this.bit.style.opacity = '0';\r\n            if (delayed) {\r\n                setTimeout(function () { return _this.off(); }, 200);\r\n            }\r\n            else {\r\n                this.off();\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    ProgressBar.prototype.hide = function () {\r\n        hide(this.element);\r\n        this.showDelayedScheduler.cancel();\r\n    };\r\n    ProgressBar.prototype.style = function (styles) {\r\n        this.progressBarBackground = styles.progressBarBackground;\r\n        this.applyStyles();\r\n    };\r\n    ProgressBar.prototype.applyStyles = function () {\r\n        if (this.bit) {\r\n            var background = this.progressBarBackground ? this.progressBarBackground.toString() : '';\r\n            this.bit.style.backgroundColor = background;\r\n        }\r\n    };\r\n    return ProgressBar;\r\n}(Disposable));\r\nexport { ProgressBar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './quickopen.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as platform from '../../../common/platform.js';\r\nimport * as types from '../../../common/types.js';\r\nimport { Filter, Renderer, DataSource, AccessibilityProvider } from './quickOpenViewer.js';\r\nimport { InputBox } from '../../../browser/ui/inputbox/inputBox.js';\r\nimport { Tree } from '../../tree/browser/treeImpl.js';\r\nimport { ProgressBar } from '../../../browser/ui/progressbar/progressbar.js';\r\nimport { StandardKeyboardEvent } from '../../../browser/keyboardEvent.js';\r\nimport { DefaultController } from '../../tree/browser/treeDefaults.js';\r\nimport * as DOM from '../../../browser/dom.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { mixin } from '../../../common/objects.js';\r\nimport { StandardMouseEvent } from '../../../browser/mouseEvent.js';\r\nvar QuickOpenController = /** @class */ (function (_super) {\r\n    __extends(QuickOpenController, _super);\r\n    function QuickOpenController() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    QuickOpenController.prototype.onContextMenu = function (tree, element, event) {\r\n        if (platform.isMacintosh) {\r\n            return this.onLeftClick(tree, element, event); // https://github.com/Microsoft/vscode/issues/1011\r\n        }\r\n        return _super.prototype.onContextMenu.call(this, tree, element, event);\r\n    };\r\n    return QuickOpenController;\r\n}(DefaultController));\r\nexport { QuickOpenController };\r\nvar defaultStyles = {\r\n    background: Color.fromHex('#1E1E1E'),\r\n    foreground: Color.fromHex('#CCCCCC'),\r\n    pickerGroupForeground: Color.fromHex('#0097FB'),\r\n    pickerGroupBorder: Color.fromHex('#3F3F46'),\r\n    widgetShadow: Color.fromHex('#000000'),\r\n    progressBarBackground: Color.fromHex('#0E70C0')\r\n};\r\nvar DEFAULT_INPUT_ARIA_LABEL = nls.localize('quickOpenAriaLabel', \"Quick picker. Type to narrow down results.\");\r\nvar QuickOpenWidget = /** @class */ (function (_super) {\r\n    __extends(QuickOpenWidget, _super);\r\n    function QuickOpenWidget(container, callbacks, options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isDisposed = false;\r\n        _this.container = container;\r\n        _this.callbacks = callbacks;\r\n        _this.options = options;\r\n        _this.styles = options || Object.create(null);\r\n        mixin(_this.styles, defaultStyles, false);\r\n        _this.model = null;\r\n        return _this;\r\n    }\r\n    QuickOpenWidget.prototype.getModel = function () {\r\n        return this.model;\r\n    };\r\n    QuickOpenWidget.prototype.create = function () {\r\n        var _this = this;\r\n        // Container\r\n        this.element = document.createElement('div');\r\n        DOM.addClass(this.element, 'monaco-quick-open-widget');\r\n        this.container.appendChild(this.element);\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.CONTEXT_MENU, function (e) { return DOM.EventHelper.stop(e, true); })); // Do this to fix an issue on Mac where the menu goes into the way\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.FOCUS, function (e) { return _this.gainingFocus(); }, true));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.BLUR, function (e) { return _this.loosingFocus(e); }, true));\r\n        this._register(DOM.addDisposableListener(this.element, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            if (keyboardEvent.keyCode === 9 /* Escape */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.hide(2 /* CANCELED */);\r\n            }\r\n            else if (keyboardEvent.keyCode === 2 /* Tab */ && !keyboardEvent.altKey && !keyboardEvent.ctrlKey && !keyboardEvent.metaKey) {\r\n                var stops = e.currentTarget.querySelectorAll('input, .monaco-tree, .monaco-tree-row.focused .action-label.icon');\r\n                if (keyboardEvent.shiftKey && keyboardEvent.target === stops[0]) {\r\n                    DOM.EventHelper.stop(e, true);\r\n                    stops[stops.length - 1].focus();\r\n                }\r\n                else if (!keyboardEvent.shiftKey && keyboardEvent.target === stops[stops.length - 1]) {\r\n                    DOM.EventHelper.stop(e, true);\r\n                    stops[0].focus();\r\n                }\r\n            }\r\n        }));\r\n        // Progress Bar\r\n        this.progressBar = this._register(new ProgressBar(this.element, { progressBarBackground: this.styles.progressBarBackground }));\r\n        this.progressBar.hide();\r\n        // Input Field\r\n        this.inputContainer = document.createElement('div');\r\n        DOM.addClass(this.inputContainer, 'quick-open-input');\r\n        this.element.appendChild(this.inputContainer);\r\n        this.inputBox = this._register(new InputBox(this.inputContainer, undefined, {\r\n            placeholder: this.options.inputPlaceHolder || '',\r\n            ariaLabel: DEFAULT_INPUT_ARIA_LABEL,\r\n            inputBackground: this.styles.inputBackground,\r\n            inputForeground: this.styles.inputForeground,\r\n            inputBorder: this.styles.inputBorder,\r\n            inputValidationInfoBackground: this.styles.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: this.styles.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: this.styles.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: this.styles.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: this.styles.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: this.styles.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: this.styles.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: this.styles.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: this.styles.inputValidationErrorBorder\r\n        }));\r\n        this.inputElement = this.inputBox.inputElement;\r\n        this.inputElement.setAttribute('role', 'combobox');\r\n        this.inputElement.setAttribute('aria-haspopup', 'false');\r\n        this.inputElement.setAttribute('aria-autocomplete', 'list');\r\n        this._register(DOM.addDisposableListener(this.inputBox.inputElement, DOM.EventType.INPUT, function (e) { return _this.onType(); }));\r\n        this._register(DOM.addDisposableListener(this.inputBox.inputElement, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            var shouldOpenInBackground = _this.shouldOpenInBackground(keyboardEvent);\r\n            // Do not handle Tab: It is used to navigate between elements without mouse\r\n            if (keyboardEvent.keyCode === 2 /* Tab */) {\r\n                return;\r\n            }\r\n            // Pass tree navigation keys to the tree but leave focus in input field\r\n            else if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode, keyboardEvent.shiftKey);\r\n                // Position cursor at the end of input to allow right arrow (open in background)\r\n                // to function immediately unless the user has made a selection\r\n                if (_this.inputBox.inputElement.selectionStart === _this.inputBox.inputElement.selectionEnd) {\r\n                    _this.inputBox.inputElement.selectionStart = _this.inputBox.value.length;\r\n                }\r\n            }\r\n            // Select element on Enter or on Arrow-Right if we are at the end of the input\r\n            else if (keyboardEvent.keyCode === 3 /* Enter */ || shouldOpenInBackground) {\r\n                DOM.EventHelper.stop(e, true);\r\n                var focus_1 = _this.tree.getFocus();\r\n                if (focus_1) {\r\n                    _this.elementSelected(focus_1, e, shouldOpenInBackground ? 2 /* OPEN_IN_BACKGROUND */ : 1 /* OPEN */);\r\n                }\r\n            }\r\n        }));\r\n        // Result count for screen readers\r\n        this.resultCount = document.createElement('div');\r\n        DOM.addClass(this.resultCount, 'quick-open-result-count');\r\n        this.resultCount.setAttribute('aria-live', 'polite');\r\n        this.resultCount.setAttribute('aria-atomic', 'true');\r\n        this.element.appendChild(this.resultCount);\r\n        // Tree\r\n        this.treeContainer = document.createElement('div');\r\n        DOM.addClass(this.treeContainer, 'quick-open-tree');\r\n        this.element.appendChild(this.treeContainer);\r\n        var createTree = this.options.treeCreator || (function (container, config, opts) { return new Tree(container, config, opts); });\r\n        this.tree = this._register(createTree(this.treeContainer, {\r\n            dataSource: new DataSource(this),\r\n            controller: new QuickOpenController({ clickBehavior: 1 /* ON_MOUSE_UP */, keyboardSupport: this.options.keyboardSupport }),\r\n            renderer: (this.renderer = new Renderer(this, this.styles)),\r\n            filter: new Filter(this),\r\n            accessibilityProvider: new AccessibilityProvider(this)\r\n        }, {\r\n            twistiePixels: 11,\r\n            indentPixels: 0,\r\n            alwaysFocused: true,\r\n            verticalScrollMode: 3 /* Visible */,\r\n            horizontalScrollMode: 2 /* Hidden */,\r\n            ariaLabel: nls.localize('treeAriaLabel', \"Quick Picker\"),\r\n            keyboardSupport: this.options.keyboardSupport,\r\n            preventRootFocus: false\r\n        }));\r\n        this.treeElement = this.tree.getHTMLElement();\r\n        // Handle Focus and Selection event\r\n        this._register(this.tree.onDidChangeFocus(function (event) {\r\n            _this.elementFocused(event.focus, event);\r\n        }));\r\n        this._register(this.tree.onDidChangeSelection(function (event) {\r\n            if (event.selection && event.selection.length > 0) {\r\n                var mouseEvent = event.payload && event.payload.originalEvent instanceof StandardMouseEvent ? event.payload.originalEvent : undefined;\r\n                var shouldOpenInBackground = mouseEvent ? _this.shouldOpenInBackground(mouseEvent) : false;\r\n                _this.elementSelected(event.selection[0], event, shouldOpenInBackground ? 2 /* OPEN_IN_BACKGROUND */ : 1 /* OPEN */);\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            // Only handle when in quick navigation mode\r\n            if (!_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            // Support keyboard navigation in quick navigation mode\r\n            if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode);\r\n            }\r\n            // Support to open item with Enter still even in quick nav mode\r\n            else if (keyboardEvent.keyCode === 3 /* Enter */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                var focus_2 = _this.tree.getFocus();\r\n                if (focus_2) {\r\n                    _this.elementSelected(focus_2, e);\r\n                }\r\n            }\r\n        }));\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_UP, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            var keyCode = keyboardEvent.keyCode;\r\n            // Only handle when in quick navigation mode\r\n            if (!_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            // Select element when keys are pressed that signal it\r\n            var quickNavKeys = _this.quickNavigateConfiguration.keybindings;\r\n            var wasTriggerKeyPressed = quickNavKeys.some(function (k) {\r\n                var _a = k.getParts(), firstPart = _a[0], chordPart = _a[1];\r\n                if (chordPart) {\r\n                    return false;\r\n                }\r\n                if (firstPart.shiftKey && keyCode === 4 /* Shift */) {\r\n                    if (keyboardEvent.ctrlKey || keyboardEvent.altKey || keyboardEvent.metaKey) {\r\n                        return false; // this is an optimistic check for the shift key being used to navigate back in quick open\r\n                    }\r\n                    return true;\r\n                }\r\n                if (firstPart.altKey && keyCode === 6 /* Alt */) {\r\n                    return true;\r\n                }\r\n                if (firstPart.ctrlKey && keyCode === 5 /* Ctrl */) {\r\n                    return true;\r\n                }\r\n                if (firstPart.metaKey && keyCode === 57 /* Meta */) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (wasTriggerKeyPressed) {\r\n                var focus_3 = _this.tree.getFocus();\r\n                if (focus_3) {\r\n                    _this.elementSelected(focus_3, e);\r\n                }\r\n            }\r\n        }));\r\n        // Support layout\r\n        if (this.layoutDimensions) {\r\n            this.layout(this.layoutDimensions);\r\n        }\r\n        this.applyStyles();\r\n        // Allows focus to switch to next/previous entry after tab into an actionbar item\r\n        this._register(DOM.addDisposableListener(this.treeContainer, DOM.EventType.KEY_DOWN, function (e) {\r\n            var keyboardEvent = new StandardKeyboardEvent(e);\r\n            // Only handle when not in quick navigation mode\r\n            if (_this.quickNavigateConfiguration) {\r\n                return;\r\n            }\r\n            if (keyboardEvent.keyCode === 18 /* DownArrow */ || keyboardEvent.keyCode === 16 /* UpArrow */ || keyboardEvent.keyCode === 12 /* PageDown */ || keyboardEvent.keyCode === 11 /* PageUp */) {\r\n                DOM.EventHelper.stop(e, true);\r\n                _this.navigateInTree(keyboardEvent.keyCode, keyboardEvent.shiftKey);\r\n                _this.treeElement.focus();\r\n            }\r\n        }));\r\n        return this.element;\r\n    };\r\n    QuickOpenWidget.prototype.style = function (styles) {\r\n        this.styles = styles;\r\n        this.applyStyles();\r\n    };\r\n    QuickOpenWidget.prototype.applyStyles = function () {\r\n        if (this.element) {\r\n            var foreground = this.styles.foreground ? this.styles.foreground.toString() : '';\r\n            var background = this.styles.background ? this.styles.background.toString() : '';\r\n            var borderColor = this.styles.borderColor ? this.styles.borderColor.toString() : '';\r\n            var widgetShadow = this.styles.widgetShadow ? this.styles.widgetShadow.toString() : '';\r\n            this.element.style.color = foreground;\r\n            this.element.style.backgroundColor = background;\r\n            this.element.style.borderColor = borderColor;\r\n            this.element.style.borderWidth = borderColor ? '1px' : '';\r\n            this.element.style.borderStyle = borderColor ? 'solid' : '';\r\n            this.element.style.boxShadow = widgetShadow ? \"0 5px 8px \" + widgetShadow : '';\r\n        }\r\n        if (this.progressBar) {\r\n            this.progressBar.style({\r\n                progressBarBackground: this.styles.progressBarBackground\r\n            });\r\n        }\r\n        if (this.inputBox) {\r\n            this.inputBox.style({\r\n                inputBackground: this.styles.inputBackground,\r\n                inputForeground: this.styles.inputForeground,\r\n                inputBorder: this.styles.inputBorder,\r\n                inputValidationInfoBackground: this.styles.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.styles.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.styles.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.styles.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.styles.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.styles.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.styles.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.styles.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.styles.inputValidationErrorBorder\r\n            });\r\n        }\r\n        if (this.tree && !this.options.treeCreator) {\r\n            this.tree.style(this.styles);\r\n        }\r\n        if (this.renderer) {\r\n            this.renderer.updateStyles(this.styles);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.shouldOpenInBackground = function (e) {\r\n        // Keyboard\r\n        if (e instanceof StandardKeyboardEvent) {\r\n            if (e.keyCode !== 17 /* RightArrow */) {\r\n                return false; // only for right arrow\r\n            }\r\n            if (e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) {\r\n                return false; // no modifiers allowed\r\n            }\r\n            // validate the cursor is at the end of the input and there is no selection,\r\n            // and if not prevent opening in the background such as the selection can be changed\r\n            var element = this.inputBox.inputElement;\r\n            return element.selectionEnd === this.inputBox.value.length && element.selectionStart === element.selectionEnd;\r\n        }\r\n        // Mouse\r\n        return e.middleButton;\r\n    };\r\n    QuickOpenWidget.prototype.onType = function () {\r\n        var value = this.inputBox.value;\r\n        // Adjust help text as needed if present\r\n        if (this.helpText) {\r\n            if (value) {\r\n                DOM.hide(this.helpText);\r\n            }\r\n            else {\r\n                DOM.show(this.helpText);\r\n            }\r\n        }\r\n        // Send to callbacks\r\n        this.callbacks.onType(value);\r\n    };\r\n    QuickOpenWidget.prototype.navigateInTree = function (keyCode, isShift) {\r\n        var model = this.tree.getInput();\r\n        var entries = model ? model.entries : [];\r\n        var oldFocus = this.tree.getFocus();\r\n        // Normal Navigation\r\n        switch (keyCode) {\r\n            case 18 /* DownArrow */:\r\n                this.tree.focusNext();\r\n                break;\r\n            case 16 /* UpArrow */:\r\n                this.tree.focusPrevious();\r\n                break;\r\n            case 12 /* PageDown */:\r\n                this.tree.focusNextPage();\r\n                break;\r\n            case 11 /* PageUp */:\r\n                this.tree.focusPreviousPage();\r\n                break;\r\n            case 2 /* Tab */:\r\n                if (isShift) {\r\n                    this.tree.focusPrevious();\r\n                }\r\n                else {\r\n                    this.tree.focusNext();\r\n                }\r\n                break;\r\n        }\r\n        var newFocus = this.tree.getFocus();\r\n        // Support cycle-through navigation if focus did not change\r\n        if (entries.length > 1 && oldFocus === newFocus) {\r\n            // Up from no entry or first entry goes down to last\r\n            if (keyCode === 16 /* UpArrow */ || (keyCode === 2 /* Tab */ && isShift)) {\r\n                this.tree.focusLast();\r\n            }\r\n            // Down from last entry goes to up to first\r\n            else if (keyCode === 18 /* DownArrow */ || keyCode === 2 /* Tab */ && !isShift) {\r\n                this.tree.focusFirst();\r\n            }\r\n        }\r\n        // Reveal\r\n        newFocus = this.tree.getFocus();\r\n        if (newFocus) {\r\n            this.tree.reveal(newFocus);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.elementFocused = function (value, event) {\r\n        if (!value || !this.isVisible()) {\r\n            return;\r\n        }\r\n        // ARIA\r\n        var arivaActiveDescendant = this.treeElement.getAttribute('aria-activedescendant');\r\n        if (arivaActiveDescendant) {\r\n            this.inputElement.setAttribute('aria-activedescendant', arivaActiveDescendant);\r\n        }\r\n        else {\r\n            this.inputElement.removeAttribute('aria-activedescendant');\r\n        }\r\n        var context = { event: event, keymods: this.extractKeyMods(event), quickNavigateConfiguration: this.quickNavigateConfiguration };\r\n        this.model.runner.run(value, 0 /* PREVIEW */, context);\r\n    };\r\n    QuickOpenWidget.prototype.elementSelected = function (value, event, preferredMode) {\r\n        var hide = true;\r\n        // Trigger open of element on selection\r\n        if (this.isVisible()) {\r\n            var mode = preferredMode || 1 /* OPEN */;\r\n            var context = { event: event, keymods: this.extractKeyMods(event), quickNavigateConfiguration: this.quickNavigateConfiguration };\r\n            hide = this.model.runner.run(value, mode, context);\r\n        }\r\n        // Hide if command was run successfully\r\n        if (hide) {\r\n            this.hide(0 /* ELEMENT_SELECTED */);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.extractKeyMods = function (event) {\r\n        return {\r\n            ctrlCmd: event && (event.ctrlKey || event.metaKey || (event.payload && event.payload.originalEvent && (event.payload.originalEvent.ctrlKey || event.payload.originalEvent.metaKey))),\r\n            alt: event && (event.altKey || (event.payload && event.payload.originalEvent && event.payload.originalEvent.altKey))\r\n        };\r\n    };\r\n    QuickOpenWidget.prototype.show = function (param, options) {\r\n        this.visible = true;\r\n        this.isLoosingFocus = false;\r\n        this.quickNavigateConfiguration = options ? options.quickNavigateConfiguration : undefined;\r\n        // Adjust UI for quick navigate mode\r\n        if (this.quickNavigateConfiguration) {\r\n            DOM.hide(this.inputContainer);\r\n            DOM.show(this.element);\r\n            this.tree.domFocus();\r\n        }\r\n        // Otherwise use normal UI\r\n        else {\r\n            DOM.show(this.inputContainer);\r\n            DOM.show(this.element);\r\n            this.inputBox.focus();\r\n        }\r\n        // Adjust Help text for IE\r\n        if (this.helpText) {\r\n            if (this.quickNavigateConfiguration || types.isString(param)) {\r\n                DOM.hide(this.helpText);\r\n            }\r\n            else {\r\n                DOM.show(this.helpText);\r\n            }\r\n        }\r\n        // Show based on param\r\n        if (types.isString(param)) {\r\n            this.doShowWithPrefix(param);\r\n        }\r\n        else {\r\n            if (options && options.value) {\r\n                this.restoreLastInput(options.value);\r\n            }\r\n            this.doShowWithInput(param, options && options.autoFocus ? options.autoFocus : {});\r\n        }\r\n        // Respect selectAll option\r\n        if (options && options.inputSelection && !this.quickNavigateConfiguration) {\r\n            this.inputBox.select(options.inputSelection);\r\n        }\r\n        if (this.callbacks.onShow) {\r\n            this.callbacks.onShow();\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.restoreLastInput = function (lastInput) {\r\n        this.inputBox.value = lastInput;\r\n        this.inputBox.select();\r\n        this.callbacks.onType(lastInput);\r\n    };\r\n    QuickOpenWidget.prototype.doShowWithPrefix = function (prefix) {\r\n        this.inputBox.value = prefix;\r\n        this.callbacks.onType(prefix);\r\n    };\r\n    QuickOpenWidget.prototype.doShowWithInput = function (input, autoFocus) {\r\n        this.setInput(input, autoFocus);\r\n    };\r\n    QuickOpenWidget.prototype.setInputAndLayout = function (input, autoFocus) {\r\n        var _this = this;\r\n        this.treeContainer.style.height = this.getHeight(input) + \"px\";\r\n        this.tree.setInput(null).then(function () {\r\n            _this.model = input;\r\n            // ARIA\r\n            _this.inputElement.setAttribute('aria-haspopup', String(input && input.entries && input.entries.length > 0));\r\n            return _this.tree.setInput(input);\r\n        }).then(function () {\r\n            // Indicate entries to tree\r\n            _this.tree.layout();\r\n            var entries = input ? input.entries.filter(function (e) { return _this.isElementVisible(input, e); }) : [];\r\n            _this.updateResultCount(entries.length);\r\n            // Handle auto focus\r\n            if (entries.length) {\r\n                _this.autoFocus(input, entries, autoFocus);\r\n            }\r\n        });\r\n    };\r\n    QuickOpenWidget.prototype.isElementVisible = function (input, e) {\r\n        if (!input.filter) {\r\n            return true;\r\n        }\r\n        return input.filter.isVisible(e);\r\n    };\r\n    QuickOpenWidget.prototype.autoFocus = function (input, entries, autoFocus) {\r\n        if (autoFocus === void 0) { autoFocus = {}; }\r\n        // First check for auto focus of prefix matches\r\n        if (autoFocus.autoFocusPrefixMatch) {\r\n            var caseSensitiveMatch = void 0;\r\n            var caseInsensitiveMatch = void 0;\r\n            var prefix = autoFocus.autoFocusPrefixMatch;\r\n            var lowerCasePrefix = prefix.toLowerCase();\r\n            for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n                var entry = entries_1[_i];\r\n                var label = input.dataSource.getLabel(entry) || '';\r\n                if (!caseSensitiveMatch && label.indexOf(prefix) === 0) {\r\n                    caseSensitiveMatch = entry;\r\n                }\r\n                else if (!caseInsensitiveMatch && label.toLowerCase().indexOf(lowerCasePrefix) === 0) {\r\n                    caseInsensitiveMatch = entry;\r\n                }\r\n                if (caseSensitiveMatch && caseInsensitiveMatch) {\r\n                    break;\r\n                }\r\n            }\r\n            var entryToFocus = caseSensitiveMatch || caseInsensitiveMatch;\r\n            if (entryToFocus) {\r\n                this.tree.setFocus(entryToFocus);\r\n                this.tree.reveal(entryToFocus, 0.5);\r\n                return;\r\n            }\r\n        }\r\n        // Second check for auto focus of first entry\r\n        if (autoFocus.autoFocusFirstEntry) {\r\n            this.tree.focusFirst();\r\n            this.tree.reveal(this.tree.getFocus());\r\n        }\r\n        // Third check for specific index option\r\n        else if (typeof autoFocus.autoFocusIndex === 'number') {\r\n            if (entries.length > autoFocus.autoFocusIndex) {\r\n                this.tree.focusNth(autoFocus.autoFocusIndex);\r\n                this.tree.reveal(this.tree.getFocus());\r\n            }\r\n        }\r\n        // Check for auto focus of second entry\r\n        else if (autoFocus.autoFocusSecondEntry) {\r\n            if (entries.length > 1) {\r\n                this.tree.focusNth(1);\r\n            }\r\n        }\r\n        // Finally check for auto focus of last entry\r\n        else if (autoFocus.autoFocusLastEntry) {\r\n            if (entries.length > 1) {\r\n                this.tree.focusLast();\r\n                this.tree.reveal(this.tree.getFocus());\r\n            }\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.getHeight = function (input) {\r\n        var _this = this;\r\n        var renderer = input.renderer;\r\n        if (!input) {\r\n            var itemHeight = renderer.getHeight(null);\r\n            return this.options.minItemsToShow ? this.options.minItemsToShow * itemHeight : 0;\r\n        }\r\n        var height = 0;\r\n        var preferredItemsHeight;\r\n        if (this.layoutDimensions && this.layoutDimensions.height) {\r\n            preferredItemsHeight = (this.layoutDimensions.height - 50 /* subtract height of input field (30px) and some spacing (drop shadow) to fit */) * 0.4 /* max 40% of screen */;\r\n        }\r\n        if (!preferredItemsHeight || preferredItemsHeight > QuickOpenWidget.MAX_ITEMS_HEIGHT) {\r\n            preferredItemsHeight = QuickOpenWidget.MAX_ITEMS_HEIGHT;\r\n        }\r\n        var entries = input.entries.filter(function (e) { return _this.isElementVisible(input, e); });\r\n        var maxEntries = this.options.maxItemsToShow || entries.length;\r\n        for (var i = 0; i < maxEntries && i < entries.length; i++) {\r\n            var entryHeight = renderer.getHeight(entries[i]);\r\n            if (height + entryHeight <= preferredItemsHeight) {\r\n                height += entryHeight;\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return height;\r\n    };\r\n    QuickOpenWidget.prototype.updateResultCount = function (count) {\r\n        this.resultCount.textContent = nls.localize({ key: 'quickInput.visibleCount', comment: ['This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers.'] }, \"{0} Results\", count);\r\n    };\r\n    QuickOpenWidget.prototype.hide = function (reason) {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        this.visible = false;\r\n        DOM.hide(this.element);\r\n        this.element.blur();\r\n        // Clear input field and clear tree\r\n        this.inputBox.value = '';\r\n        this.tree.setInput(null);\r\n        // ARIA\r\n        this.inputElement.setAttribute('aria-haspopup', 'false');\r\n        // Reset Tree Height\r\n        this.treeContainer.style.height = (this.options.minItemsToShow ? this.options.minItemsToShow * 22 : 0) + \"px\";\r\n        // Clear any running Progress\r\n        this.progressBar.stop().hide();\r\n        // Clear Focus\r\n        if (this.tree.isDOMFocused()) {\r\n            this.tree.domBlur();\r\n        }\r\n        else if (this.inputBox.hasFocus()) {\r\n            this.inputBox.blur();\r\n        }\r\n        // Callbacks\r\n        if (reason === 0 /* ELEMENT_SELECTED */) {\r\n            this.callbacks.onOk();\r\n        }\r\n        else {\r\n            this.callbacks.onCancel();\r\n        }\r\n        if (this.callbacks.onHide) {\r\n            this.callbacks.onHide(reason);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.setInput = function (input, autoFocus, ariaLabel) {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        // If the input changes, indicate this to the tree\r\n        if (!!this.getInput()) {\r\n            this.onInputChanging();\r\n        }\r\n        // Adapt tree height to entries and apply input\r\n        this.setInputAndLayout(input, autoFocus);\r\n        // Apply ARIA\r\n        if (this.inputBox) {\r\n            this.inputBox.setAriaLabel(ariaLabel || DEFAULT_INPUT_ARIA_LABEL);\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.onInputChanging = function () {\r\n        var _this = this;\r\n        if (this.inputChangingTimeoutHandle) {\r\n            clearTimeout(this.inputChangingTimeoutHandle);\r\n            this.inputChangingTimeoutHandle = null;\r\n        }\r\n        // when the input is changing in quick open, we indicate this as CSS class to the widget\r\n        // for a certain timeout. this helps reducing some hectic UI updates when input changes quickly\r\n        DOM.addClass(this.element, 'content-changing');\r\n        this.inputChangingTimeoutHandle = setTimeout(function () {\r\n            DOM.removeClass(_this.element, 'content-changing');\r\n        }, 500);\r\n    };\r\n    QuickOpenWidget.prototype.getInput = function () {\r\n        return this.tree.getInput();\r\n    };\r\n    QuickOpenWidget.prototype.isVisible = function () {\r\n        return this.visible;\r\n    };\r\n    QuickOpenWidget.prototype.layout = function (dimension) {\r\n        this.layoutDimensions = dimension;\r\n        // Apply to quick open width (height is dynamic by number of items to show)\r\n        var quickOpenWidth = Math.min(this.layoutDimensions.width * 0.62 /* golden cut */, QuickOpenWidget.MAX_WIDTH);\r\n        if (this.element) {\r\n            // quick open\r\n            this.element.style.width = quickOpenWidth + \"px\";\r\n            this.element.style.marginLeft = \"-\" + quickOpenWidth / 2 + \"px\";\r\n            // input field\r\n            this.inputContainer.style.width = quickOpenWidth - 12 + \"px\";\r\n        }\r\n    };\r\n    QuickOpenWidget.prototype.gainingFocus = function () {\r\n        this.isLoosingFocus = false;\r\n    };\r\n    QuickOpenWidget.prototype.loosingFocus = function (e) {\r\n        var _this = this;\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n        var relatedTarget = e.relatedTarget;\r\n        if (!this.quickNavigateConfiguration && DOM.isAncestor(relatedTarget, this.element)) {\r\n            return; // user clicked somewhere into quick open widget, do not close thereby\r\n        }\r\n        this.isLoosingFocus = true;\r\n        setTimeout(function () {\r\n            if (!_this.isLoosingFocus || _this.isDisposed) {\r\n                return;\r\n            }\r\n            var veto = _this.callbacks.onFocusLost && _this.callbacks.onFocusLost();\r\n            if (!veto) {\r\n                _this.hide(1 /* FOCUS_LOST */);\r\n            }\r\n        }, 0);\r\n    };\r\n    QuickOpenWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this.isDisposed = true;\r\n    };\r\n    QuickOpenWidget.MAX_WIDTH = 600; // Max total width of quick open widget\r\n    QuickOpenWidget.MAX_ITEMS_HEIGHT = 20 * 22; // Max height of item list below input field\r\n    return QuickOpenWidget;\r\n}(Disposable));\r\nexport { QuickOpenWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Dimension } from '../../../../base/browser/dom.js';\r\nimport { QuickOpenWidget } from '../../../../base/parts/quickopen/browser/quickOpenWidget.js';\r\nimport { foreground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { attachQuickOpenStyler } from '../../../../platform/theme/common/styler.js';\r\nvar QuickOpenEditorWidget = /** @class */ (function () {\r\n    function QuickOpenEditorWidget(codeEditor, onOk, onCancel, onType, configuration, themeService) {\r\n        this.codeEditor = codeEditor;\r\n        this.themeService = themeService;\r\n        this.visible = false;\r\n        this.domNode = document.createElement('div');\r\n        this.quickOpenWidget = new QuickOpenWidget(this.domNode, {\r\n            onOk: onOk,\r\n            onCancel: onCancel,\r\n            onType: onType\r\n        }, {\r\n            inputPlaceHolder: undefined,\r\n            inputAriaLabel: configuration.inputAriaLabel,\r\n            keyboardSupport: true\r\n        });\r\n        this.styler = attachQuickOpenStyler(this.quickOpenWidget, this.themeService, {\r\n            pickerGroupForeground: foreground\r\n        });\r\n        this.quickOpenWidget.create();\r\n        this.codeEditor.addOverlayWidget(this);\r\n    }\r\n    QuickOpenEditorWidget.prototype.setInput = function (model, focus) {\r\n        this.quickOpenWidget.setInput(model, focus);\r\n    };\r\n    QuickOpenEditorWidget.prototype.getId = function () {\r\n        return QuickOpenEditorWidget.ID;\r\n    };\r\n    QuickOpenEditorWidget.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    QuickOpenEditorWidget.prototype.destroy = function () {\r\n        this.codeEditor.removeOverlayWidget(this);\r\n        this.quickOpenWidget.dispose();\r\n        this.styler.dispose();\r\n    };\r\n    QuickOpenEditorWidget.prototype.show = function (value) {\r\n        this.visible = true;\r\n        var editorLayout = this.codeEditor.getLayoutInfo();\r\n        if (editorLayout) {\r\n            this.quickOpenWidget.layout(new Dimension(editorLayout.width, editorLayout.height));\r\n        }\r\n        this.quickOpenWidget.show(value);\r\n        this.codeEditor.layoutOverlayWidget(this);\r\n    };\r\n    QuickOpenEditorWidget.prototype.getPosition = function () {\r\n        if (this.visible) {\r\n            return {\r\n                preference: 2 /* TOP_CENTER */\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    QuickOpenEditorWidget.ID = 'editor.contrib.quickOpenEditorWidget';\r\n    return QuickOpenEditorWidget;\r\n}());\r\nexport { QuickOpenEditorWidget };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './editorQuickOpen.css';\r\nimport { EditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\r\nimport { QuickOpenEditorWidget } from './quickOpenEditorWidget.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nvar QuickOpenController = /** @class */ (function () {\r\n    function QuickOpenController(editor, themeService) {\r\n        this.themeService = themeService;\r\n        this.widget = null;\r\n        this.rangeHighlightDecorationId = null;\r\n        this.lastKnownEditorSelection = null;\r\n        this.editor = editor;\r\n    }\r\n    QuickOpenController.get = function (editor) {\r\n        return editor.getContribution(QuickOpenController.ID);\r\n    };\r\n    QuickOpenController.prototype.dispose = function () {\r\n        // Dispose widget\r\n        if (this.widget) {\r\n            this.widget.destroy();\r\n            this.widget = null;\r\n        }\r\n    };\r\n    QuickOpenController.prototype.run = function (opts) {\r\n        var _this = this;\r\n        if (this.widget) {\r\n            this.widget.destroy();\r\n            this.widget = null;\r\n        }\r\n        // Create goto line widget\r\n        var onClose = function (canceled) {\r\n            // Clear Highlight Decorations if present\r\n            _this.clearDecorations();\r\n            // Restore selection if canceled\r\n            if (canceled && _this.lastKnownEditorSelection) {\r\n                _this.editor.setSelection(_this.lastKnownEditorSelection);\r\n                _this.editor.revealRangeInCenterIfOutsideViewport(_this.lastKnownEditorSelection, 0 /* Smooth */);\r\n            }\r\n            _this.lastKnownEditorSelection = null;\r\n            // Return focus to the editor if\r\n            // - focus is back on the <body> element because no other focusable element was clicked\r\n            // - a command was picked from the picker which indicates the editor should get focused\r\n            if (document.activeElement === document.body || !canceled) {\r\n                _this.editor.focus();\r\n            }\r\n        };\r\n        this.widget = new QuickOpenEditorWidget(this.editor, function () { return onClose(false); }, function () { return onClose(true); }, function (value) {\r\n            _this.widget.setInput(opts.getModel(value), opts.getAutoFocus(value));\r\n        }, {\r\n            inputAriaLabel: opts.inputAriaLabel\r\n        }, this.themeService);\r\n        // Remember selection to be able to restore on cancel\r\n        if (!this.lastKnownEditorSelection) {\r\n            this.lastKnownEditorSelection = this.editor.getSelection();\r\n        }\r\n        // Show\r\n        this.widget.show('');\r\n    };\r\n    QuickOpenController.prototype.decorateLine = function (range, editor) {\r\n        var oldDecorations = [];\r\n        if (this.rangeHighlightDecorationId) {\r\n            oldDecorations.push(this.rangeHighlightDecorationId);\r\n            this.rangeHighlightDecorationId = null;\r\n        }\r\n        var newDecorations = [\r\n            {\r\n                range: range,\r\n                options: QuickOpenController._RANGE_HIGHLIGHT_DECORATION\r\n            }\r\n        ];\r\n        var decorations = editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.rangeHighlightDecorationId = decorations[0];\r\n    };\r\n    QuickOpenController.prototype.clearDecorations = function () {\r\n        if (this.rangeHighlightDecorationId) {\r\n            this.editor.deltaDecorations([this.rangeHighlightDecorationId], []);\r\n            this.rangeHighlightDecorationId = null;\r\n        }\r\n    };\r\n    QuickOpenController.ID = 'editor.controller.quickOpenController';\r\n    QuickOpenController._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\r\n        className: 'rangeHighlight',\r\n        isWholeLine: true\r\n    });\r\n    QuickOpenController = __decorate([\r\n        __param(1, IThemeService)\r\n    ], QuickOpenController);\r\n    return QuickOpenController;\r\n}());\r\nexport { QuickOpenController };\r\n/**\r\n * Base class for providing quick open in the editor.\r\n */\r\nvar BaseEditorQuickOpenAction = /** @class */ (function (_super) {\r\n    __extends(BaseEditorQuickOpenAction, _super);\r\n    function BaseEditorQuickOpenAction(inputAriaLabel, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._inputAriaLabel = inputAriaLabel;\r\n        return _this;\r\n    }\r\n    BaseEditorQuickOpenAction.prototype.getController = function (editor) {\r\n        return QuickOpenController.get(editor);\r\n    };\r\n    BaseEditorQuickOpenAction.prototype._show = function (controller, opts) {\r\n        controller.run({\r\n            inputAriaLabel: this._inputAriaLabel,\r\n            getModel: function (value) { return opts.getModel(value); },\r\n            getAutoFocus: function (searchValue) { return opts.getAutoFocus(searchValue); }\r\n        });\r\n    };\r\n    return BaseEditorQuickOpenAction;\r\n}(EditorAction));\r\nexport { BaseEditorQuickOpenAction };\r\nregisterEditorContribution(QuickOpenController.ID, QuickOpenController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './gotoLine.css';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { QuickOpenEntry, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { GoToLineNLS } from '../../../common/standaloneStrings.js';\r\nvar GotoLineEntry = /** @class */ (function (_super) {\r\n    __extends(GotoLineEntry, _super);\r\n    function GotoLineEntry(line, editor, decorator) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.decorator = decorator;\r\n        _this.parseResult = _this.parseInput(line);\r\n        return _this;\r\n    }\r\n    GotoLineEntry.prototype.parseInput = function (line) {\r\n        var numbers = line.split(',').map(function (part) { return parseInt(part, 10); }).filter(function (part) { return !isNaN(part); });\r\n        var position;\r\n        if (numbers.length === 0) {\r\n            position = new Position(-1, -1);\r\n        }\r\n        else if (numbers.length === 1) {\r\n            position = new Position(numbers[0], 1);\r\n        }\r\n        else {\r\n            position = new Position(numbers[0], numbers[1]);\r\n        }\r\n        var model;\r\n        if (isCodeEditor(this.editor)) {\r\n            model = this.editor.getModel();\r\n        }\r\n        else {\r\n            var diffModel = this.editor.getModel();\r\n            model = diffModel ? diffModel.modified : null;\r\n        }\r\n        var isValid = model ? model.validatePosition(position).equals(position) : false;\r\n        var label;\r\n        if (isValid) {\r\n            if (position.column && position.column > 1) {\r\n                label = strings.format(GoToLineNLS.gotoLineLabelValidLineAndColumn, position.lineNumber, position.column);\r\n            }\r\n            else {\r\n                label = strings.format(GoToLineNLS.gotoLineLabelValidLine, position.lineNumber);\r\n            }\r\n        }\r\n        else if (position.lineNumber < 1 || position.lineNumber > (model ? model.getLineCount() : 0)) {\r\n            label = strings.format(GoToLineNLS.gotoLineLabelEmptyWithLineLimit, model ? model.getLineCount() : 0);\r\n        }\r\n        else {\r\n            label = strings.format(GoToLineNLS.gotoLineLabelEmptyWithLineAndColumnLimit, model ? model.getLineMaxColumn(position.lineNumber) : 0);\r\n        }\r\n        return {\r\n            position: position,\r\n            isValid: isValid,\r\n            label: label\r\n        };\r\n    };\r\n    GotoLineEntry.prototype.getLabel = function () {\r\n        return this.parseResult.label;\r\n    };\r\n    GotoLineEntry.prototype.getAriaLabel = function () {\r\n        var position = this.editor.getPosition();\r\n        var currentLine = position ? position.lineNumber : 0;\r\n        return strings.format(GoToLineNLS.gotoLineAriaLabel, currentLine, this.parseResult.label);\r\n    };\r\n    GotoLineEntry.prototype.run = function (mode, _context) {\r\n        if (mode === 1 /* OPEN */) {\r\n            return this.runOpen();\r\n        }\r\n        return this.runPreview();\r\n    };\r\n    GotoLineEntry.prototype.runOpen = function () {\r\n        // No-op if range is not valid\r\n        if (!this.parseResult.isValid) {\r\n            return false;\r\n        }\r\n        // Apply selection and focus\r\n        var range = this.toSelection();\r\n        this.editor.setSelection(range);\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        this.editor.focus();\r\n        return true;\r\n    };\r\n    GotoLineEntry.prototype.runPreview = function () {\r\n        // No-op if range is not valid\r\n        if (!this.parseResult.isValid) {\r\n            this.decorator.clearDecorations();\r\n            return false;\r\n        }\r\n        // Select Line Position\r\n        var range = this.toSelection();\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        // Decorate if possible\r\n        this.decorator.decorateLine(range, this.editor);\r\n        return false;\r\n    };\r\n    GotoLineEntry.prototype.toSelection = function () {\r\n        return new Range(this.parseResult.position.lineNumber, this.parseResult.position.column, this.parseResult.position.lineNumber, this.parseResult.position.column);\r\n    };\r\n    return GotoLineEntry;\r\n}(QuickOpenEntry));\r\nexport { GotoLineEntry };\r\nvar GotoLineAction = /** @class */ (function (_super) {\r\n    __extends(GotoLineAction, _super);\r\n    function GotoLineAction() {\r\n        return _super.call(this, GoToLineNLS.gotoLineActionInput, {\r\n            id: 'editor.action.gotoLine',\r\n            label: GoToLineNLS.gotoLineActionLabel,\r\n            alias: 'Go to Line...',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 37 /* KEY_G */,\r\n                mac: { primary: 256 /* WinCtrl */ | 37 /* KEY_G */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    GotoLineAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel([new GotoLineEntry(value, editor, _this.getController(editor))]);\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                return {\r\n                    autoFocusFirstEntry: searchValue.length > 0\r\n                };\r\n            }\r\n        });\r\n    };\r\n    return GotoLineAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { GotoLineAction };\r\nregisterEditorAction(GotoLineAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { matchesFuzzy } from '../../../../base/common/filters.js';\r\nimport { QuickOpenEntryGroup, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { QuickCommandNLS } from '../../../common/standaloneStrings.js';\r\nvar EditorActionCommandEntry = /** @class */ (function (_super) {\r\n    __extends(EditorActionCommandEntry, _super);\r\n    function EditorActionCommandEntry(key, keyAriaLabel, highlights, action, editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.key = key;\r\n        _this.keyAriaLabel = keyAriaLabel;\r\n        _this.setHighlights(highlights);\r\n        _this.action = action;\r\n        _this.editor = editor;\r\n        return _this;\r\n    }\r\n    EditorActionCommandEntry.prototype.getLabel = function () {\r\n        return this.action.label;\r\n    };\r\n    EditorActionCommandEntry.prototype.getAriaLabel = function () {\r\n        if (this.keyAriaLabel) {\r\n            return strings.format(QuickCommandNLS.ariaLabelEntryWithKey, this.getLabel(), this.keyAriaLabel);\r\n        }\r\n        return strings.format(QuickCommandNLS.ariaLabelEntry, this.getLabel());\r\n    };\r\n    EditorActionCommandEntry.prototype.getGroupLabel = function () {\r\n        return this.key;\r\n    };\r\n    EditorActionCommandEntry.prototype.run = function (mode, context) {\r\n        var _this = this;\r\n        if (mode === 1 /* OPEN */) {\r\n            // Use a timeout to give the quick open widget a chance to close itself first\r\n            setTimeout(function () {\r\n                // Some actions are enabled only when editor has focus\r\n                _this.editor.focus();\r\n                try {\r\n                    var promise = _this.action.run() || Promise.resolve();\r\n                    promise.then(undefined, onUnexpectedError);\r\n                }\r\n                catch (error) {\r\n                    onUnexpectedError(error);\r\n                }\r\n            }, 50);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return EditorActionCommandEntry;\r\n}(QuickOpenEntryGroup));\r\nexport { EditorActionCommandEntry };\r\nvar QuickCommandAction = /** @class */ (function (_super) {\r\n    __extends(QuickCommandAction, _super);\r\n    function QuickCommandAction() {\r\n        return _super.call(this, QuickCommandNLS.quickCommandActionInput, {\r\n            id: 'editor.action.quickCommand',\r\n            label: QuickCommandNLS.quickCommandActionLabel,\r\n            alias: 'Command Palette',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: (browser.isIE ? 512 /* Alt */ | 59 /* F1 */ : 59 /* F1 */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'z_commands',\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickCommandAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var keybindingService = accessor.get(IKeybindingService);\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel(_this._editorActionsToEntries(keybindingService, editor, value));\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                return {\r\n                    autoFocusFirstEntry: true,\r\n                    autoFocusPrefixMatch: searchValue\r\n                };\r\n            }\r\n        });\r\n    };\r\n    QuickCommandAction.prototype._sort = function (elementA, elementB) {\r\n        var elementAName = (elementA.getLabel() || '').toLowerCase();\r\n        var elementBName = (elementB.getLabel() || '').toLowerCase();\r\n        return elementAName.localeCompare(elementBName);\r\n    };\r\n    QuickCommandAction.prototype._editorActionsToEntries = function (keybindingService, editor, searchValue) {\r\n        var actions = editor.getSupportedActions();\r\n        var entries = [];\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            var keybinding = keybindingService.lookupKeybinding(action.id);\r\n            if (action.label) {\r\n                var highlights = matchesFuzzy(searchValue, action.label);\r\n                if (highlights) {\r\n                    entries.push(new EditorActionCommandEntry(keybinding ? keybinding.getLabel() || '' : '', keybinding ? keybinding.getAriaLabel() || '' : '', highlights, action, editor));\r\n                }\r\n            }\r\n        }\r\n        // Sort by name\r\n        entries = entries.sort(this._sort);\r\n        return entries;\r\n    };\r\n    return QuickCommandAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { QuickCommandAction };\r\nregisterEditorAction(QuickCommandAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { equals } from '../../../base/common/arrays.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { first } from '../../../base/common/collections.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { LRUCache } from '../../../base/common/map.js';\r\nimport { DocumentSymbolProviderRegistry } from '../../common/modes.js';\r\nvar TreeElement = /** @class */ (function () {\r\n    function TreeElement() {\r\n    }\r\n    TreeElement.prototype.remove = function () {\r\n        if (this.parent) {\r\n            delete this.parent.children[this.id];\r\n        }\r\n    };\r\n    TreeElement.findId = function (candidate, container) {\r\n        // complex id-computation which contains the origin/extension,\r\n        // the parent path, and some dedupe logic when names collide\r\n        var candidateId;\r\n        if (typeof candidate === 'string') {\r\n            candidateId = container.id + \"/\" + candidate;\r\n        }\r\n        else {\r\n            candidateId = container.id + \"/\" + candidate.name;\r\n            if (container.children[candidateId] !== undefined) {\r\n                candidateId = container.id + \"/\" + candidate.name + \"_\" + candidate.range.startLineNumber + \"_\" + candidate.range.startColumn;\r\n            }\r\n        }\r\n        var id = candidateId;\r\n        for (var i = 0; container.children[id] !== undefined; i++) {\r\n            id = candidateId + \"_\" + i;\r\n        }\r\n        return id;\r\n    };\r\n    TreeElement.empty = function (element) {\r\n        for (var _key in element.children) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    return TreeElement;\r\n}());\r\nexport { TreeElement };\r\nvar OutlineElement = /** @class */ (function (_super) {\r\n    __extends(OutlineElement, _super);\r\n    function OutlineElement(id, parent, symbol) {\r\n        var _this = _super.call(this) || this;\r\n        _this.id = id;\r\n        _this.parent = parent;\r\n        _this.symbol = symbol;\r\n        _this.children = Object.create(null);\r\n        return _this;\r\n    }\r\n    return OutlineElement;\r\n}(TreeElement));\r\nexport { OutlineElement };\r\nvar OutlineGroup = /** @class */ (function (_super) {\r\n    __extends(OutlineGroup, _super);\r\n    function OutlineGroup(id, parent, provider, providerIndex) {\r\n        var _this = _super.call(this) || this;\r\n        _this.id = id;\r\n        _this.parent = parent;\r\n        _this.provider = provider;\r\n        _this.providerIndex = providerIndex;\r\n        _this.children = Object.create(null);\r\n        return _this;\r\n    }\r\n    return OutlineGroup;\r\n}(TreeElement));\r\nexport { OutlineGroup };\r\nvar MovingAverage = /** @class */ (function () {\r\n    function MovingAverage() {\r\n        this._n = 1;\r\n        this._val = 0;\r\n    }\r\n    MovingAverage.prototype.update = function (value) {\r\n        this._val = this._val + (value - this._val) / this._n;\r\n        this._n += 1;\r\n        return this;\r\n    };\r\n    return MovingAverage;\r\n}());\r\nvar OutlineModel = /** @class */ (function (_super) {\r\n    __extends(OutlineModel, _super);\r\n    function OutlineModel(textModel) {\r\n        var _this = _super.call(this) || this;\r\n        _this.textModel = textModel;\r\n        _this.id = 'root';\r\n        _this.parent = undefined;\r\n        _this._groups = Object.create(null);\r\n        _this.children = Object.create(null);\r\n        _this.id = 'root';\r\n        _this.parent = undefined;\r\n        return _this;\r\n    }\r\n    OutlineModel.create = function (textModel, token) {\r\n        var _this = this;\r\n        var key = this._keys.for(textModel, true);\r\n        var data = OutlineModel._requests.get(key);\r\n        if (!data) {\r\n            var source = new CancellationTokenSource();\r\n            data = {\r\n                promiseCnt: 0,\r\n                source: source,\r\n                promise: OutlineModel._create(textModel, source.token),\r\n                model: undefined,\r\n            };\r\n            OutlineModel._requests.set(key, data);\r\n            // keep moving average of request durations\r\n            var now_1 = Date.now();\r\n            data.promise.then(function () {\r\n                var key = _this._keys.for(textModel, false);\r\n                var avg = _this._requestDurations.get(key);\r\n                if (!avg) {\r\n                    avg = new MovingAverage();\r\n                    _this._requestDurations.set(key, avg);\r\n                }\r\n                avg.update(Date.now() - now_1);\r\n            });\r\n        }\r\n        if (data.model) {\r\n            // resolved -> return data\r\n            return Promise.resolve(data.model);\r\n        }\r\n        // increase usage counter\r\n        data.promiseCnt += 1;\r\n        token.onCancellationRequested(function () {\r\n            // last -> cancel provider request, remove cached promise\r\n            if (--data.promiseCnt === 0) {\r\n                data.source.cancel();\r\n                OutlineModel._requests.delete(key);\r\n            }\r\n        });\r\n        return new Promise(function (resolve, reject) {\r\n            data.promise.then(function (model) {\r\n                data.model = model;\r\n                resolve(model);\r\n            }, function (err) {\r\n                OutlineModel._requests.delete(key);\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    OutlineModel._create = function (textModel, token) {\r\n        var cts = new CancellationTokenSource(token);\r\n        var result = new OutlineModel(textModel);\r\n        var provider = DocumentSymbolProviderRegistry.ordered(textModel);\r\n        var promises = provider.map(function (provider, index) {\r\n            var id = TreeElement.findId(\"provider_\" + index, result);\r\n            var group = new OutlineGroup(id, result, provider, index);\r\n            return Promise.resolve(provider.provideDocumentSymbols(result.textModel, cts.token)).then(function (result) {\r\n                for (var _i = 0, _a = result || []; _i < _a.length; _i++) {\r\n                    var info = _a[_i];\r\n                    OutlineModel._makeOutlineElement(info, group);\r\n                }\r\n                return group;\r\n            }, function (err) {\r\n                onUnexpectedExternalError(err);\r\n                return group;\r\n            }).then(function (group) {\r\n                if (!TreeElement.empty(group)) {\r\n                    result._groups[id] = group;\r\n                }\r\n                else {\r\n                    group.remove();\r\n                }\r\n            });\r\n        });\r\n        var listener = DocumentSymbolProviderRegistry.onDidChange(function () {\r\n            var newProvider = DocumentSymbolProviderRegistry.ordered(textModel);\r\n            if (!equals(newProvider, provider)) {\r\n                cts.cancel();\r\n            }\r\n        });\r\n        return Promise.all(promises).then(function () {\r\n            if (cts.token.isCancellationRequested && !token.isCancellationRequested) {\r\n                return OutlineModel._create(textModel, token);\r\n            }\r\n            else {\r\n                return result._compact();\r\n            }\r\n        }).finally(function () {\r\n            listener.dispose();\r\n        });\r\n    };\r\n    OutlineModel._makeOutlineElement = function (info, container) {\r\n        var id = TreeElement.findId(info, container);\r\n        var res = new OutlineElement(id, container, info);\r\n        if (info.children) {\r\n            for (var _i = 0, _a = info.children; _i < _a.length; _i++) {\r\n                var childInfo = _a[_i];\r\n                OutlineModel._makeOutlineElement(childInfo, res);\r\n            }\r\n        }\r\n        container.children[res.id] = res;\r\n    };\r\n    OutlineModel.prototype._compact = function () {\r\n        var count = 0;\r\n        for (var key in this._groups) {\r\n            var group = this._groups[key];\r\n            if (first(group.children) === undefined) { // empty\r\n                delete this._groups[key];\r\n            }\r\n            else {\r\n                count += 1;\r\n            }\r\n        }\r\n        if (count !== 1) {\r\n            //\r\n            this.children = this._groups;\r\n        }\r\n        else {\r\n            // adopt all elements of the first group\r\n            var group = first(this._groups);\r\n            for (var key in group.children) {\r\n                var child = group.children[key];\r\n                child.parent = this;\r\n                this.children[child.id] = child;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    OutlineModel._requestDurations = new LRUCache(50, 0.7);\r\n    OutlineModel._requests = new LRUCache(9, 0.75);\r\n    OutlineModel._keys = new /** @class */ (function () {\r\n        function class_1() {\r\n            this._counter = 1;\r\n            this._data = new WeakMap();\r\n        }\r\n        class_1.prototype.for = function (textModel, version) {\r\n            return textModel.id + \"/\" + (version ? textModel.getVersionId() : '') + \"/\" + this._hash(DocumentSymbolProviderRegistry.all(textModel));\r\n        };\r\n        class_1.prototype._hash = function (providers) {\r\n            var result = '';\r\n            for (var _i = 0, providers_1 = providers; _i < providers_1.length; _i++) {\r\n                var provider = providers_1[_i];\r\n                var n = this._data.get(provider);\r\n                if (typeof n === 'undefined') {\r\n                    n = this._counter++;\r\n                    this._data.set(provider, n);\r\n                }\r\n                result += n;\r\n            }\r\n            return result;\r\n        };\r\n        return class_1;\r\n    }());\r\n    return OutlineModel;\r\n}(TreeElement));\r\nexport { OutlineModel };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { OutlineModel, OutlineElement } from '../documentSymbols/outlineModel.js';\r\nimport { values } from '../../../base/common/collections.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport function getDocumentSymbols(document, flat, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var model, roots, _i, _a, child, flatEntries;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, OutlineModel.create(document, token)];\r\n                case 1:\r\n                    model = _b.sent();\r\n                    roots = [];\r\n                    for (_i = 0, _a = values(model.children); _i < _a.length; _i++) {\r\n                        child = _a[_i];\r\n                        if (child instanceof OutlineElement) {\r\n                            roots.push(child.symbol);\r\n                        }\r\n                        else {\r\n                            roots.push.apply(roots, values(child.children).map(function (child) { return child.symbol; }));\r\n                        }\r\n                    }\r\n                    flatEntries = [];\r\n                    if (token.isCancellationRequested) {\r\n                        return [2 /*return*/, flatEntries];\r\n                    }\r\n                    if (flat) {\r\n                        flatten(flatEntries, roots, '');\r\n                    }\r\n                    else {\r\n                        flatEntries = roots;\r\n                    }\r\n                    return [2 /*return*/, flatEntries.sort(compareEntriesUsingStart)];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction compareEntriesUsingStart(a, b) {\r\n    return Range.compareRangesUsingStarts(a.range, b.range);\r\n}\r\nfunction flatten(bucket, entries, overrideContainerLabel) {\r\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n        var entry = entries_1[_i];\r\n        bucket.push({\r\n            kind: entry.kind,\r\n            tags: entry.tags,\r\n            name: entry.name,\r\n            detail: entry.detail,\r\n            containerName: entry.containerName || overrideContainerLabel,\r\n            range: entry.range,\r\n            selectionRange: entry.selectionRange,\r\n            children: undefined,\r\n        });\r\n        if (entry.children) {\r\n            flatten(bucket, entry.children, entry.name);\r\n        }\r\n    }\r\n}\r\nCommandsRegistry.registerCommand('_executeDocumentSymbolProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var resource, model, reference;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    resource = args[0];\r\n                    assertType(URI.isUri(resource));\r\n                    model = accessor.get(IModelService).getModel(resource);\r\n                    if (model) {\r\n                        return [2 /*return*/, getDocumentSymbols(model, false, CancellationToken.None)];\r\n                    }\r\n                    return [4 /*yield*/, accessor.get(ITextModelService).createModelReference(resource)];\r\n                case 1:\r\n                    reference = _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    _a.trys.push([2, , 4, 5]);\r\n                    return [4 /*yield*/, getDocumentSymbols(reference.object.textEditorModel, false, CancellationToken.None)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    reference.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './quickOutline.css';\r\nimport '../../../../base/browser/ui/codiconLabel/codiconLabel.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../../../contrib/documentSymbols/outlineTree.js'; // The codicon symbol colors are defined here and must be loaded\r\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\r\nimport { matchesFuzzy } from '../../../../base/common/filters.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { QuickOpenEntryGroup, QuickOpenModel } from '../../../../base/parts/quickopen/browser/quickOpenModel.js';\r\nimport { registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { DocumentSymbolProviderRegistry, SymbolKinds } from '../../../common/modes.js';\r\nimport { getDocumentSymbols } from '../../../contrib/quickOpen/quickOpen.js';\r\nimport { BaseEditorQuickOpenAction } from './editorQuickOpen.js';\r\nimport { QuickOutlineNLS } from '../../../common/standaloneStrings.js';\r\nvar SCOPE_PREFIX = ':';\r\nvar SymbolEntry = /** @class */ (function (_super) {\r\n    __extends(SymbolEntry, _super);\r\n    function SymbolEntry(name, type, description, range, highlights, editor, decorator) {\r\n        var _this = _super.call(this) || this;\r\n        _this.name = name;\r\n        _this.type = type;\r\n        _this.description = description;\r\n        _this.range = range;\r\n        _this.setHighlights(highlights);\r\n        _this.editor = editor;\r\n        _this.decorator = decorator;\r\n        return _this;\r\n    }\r\n    SymbolEntry.prototype.getLabel = function () {\r\n        return this.name;\r\n    };\r\n    SymbolEntry.prototype.getAriaLabel = function () {\r\n        return strings.format(QuickOutlineNLS.entryAriaLabel, this.name);\r\n    };\r\n    SymbolEntry.prototype.getIcon = function () {\r\n        return this.type;\r\n    };\r\n    SymbolEntry.prototype.getDescription = function () {\r\n        return this.description;\r\n    };\r\n    SymbolEntry.prototype.getType = function () {\r\n        return this.type;\r\n    };\r\n    SymbolEntry.prototype.getRange = function () {\r\n        return this.range;\r\n    };\r\n    SymbolEntry.prototype.run = function (mode, context) {\r\n        if (mode === 1 /* OPEN */) {\r\n            return this.runOpen(context);\r\n        }\r\n        return this.runPreview();\r\n    };\r\n    SymbolEntry.prototype.runOpen = function (_context) {\r\n        // Apply selection and focus\r\n        var range = this.toSelection();\r\n        this.editor.setSelection(range);\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        this.editor.focus();\r\n        return true;\r\n    };\r\n    SymbolEntry.prototype.runPreview = function () {\r\n        // Select Outline Position\r\n        var range = this.toSelection();\r\n        this.editor.revealRangeInCenter(range, 0 /* Smooth */);\r\n        // Decorate if possible\r\n        this.decorator.decorateLine(this.range, this.editor);\r\n        return false;\r\n    };\r\n    SymbolEntry.prototype.toSelection = function () {\r\n        return new Range(this.range.startLineNumber, this.range.startColumn || 1, this.range.startLineNumber, this.range.startColumn || 1);\r\n    };\r\n    return SymbolEntry;\r\n}(QuickOpenEntryGroup));\r\nexport { SymbolEntry };\r\nvar QuickOutlineAction = /** @class */ (function (_super) {\r\n    __extends(QuickOutlineAction, _super);\r\n    function QuickOutlineAction() {\r\n        return _super.call(this, QuickOutlineNLS.quickOutlineActionInput, {\r\n            id: 'editor.action.quickOutline',\r\n            label: QuickOutlineNLS.quickOutlineActionLabel,\r\n            alias: 'Go to Symbol...',\r\n            precondition: EditorContextKeys.hasDocumentSymbolProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 45 /* KEY_O */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    QuickOutlineAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return undefined;\r\n        }\r\n        var model = editor.getModel();\r\n        if (!DocumentSymbolProviderRegistry.has(model)) {\r\n            return undefined;\r\n        }\r\n        // Resolve outline\r\n        return getDocumentSymbols(model, true, CancellationToken.None).then(function (result) {\r\n            if (result.length === 0) {\r\n                return;\r\n            }\r\n            _this._run(editor, result);\r\n        });\r\n    };\r\n    QuickOutlineAction.prototype._run = function (editor, result) {\r\n        var _this = this;\r\n        this._show(this.getController(editor), {\r\n            getModel: function (value) {\r\n                return new QuickOpenModel(_this.toQuickOpenEntries(editor, result, value));\r\n            },\r\n            getAutoFocus: function (searchValue) {\r\n                // Remove any type pattern (:) from search value as needed\r\n                if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n                    searchValue = searchValue.substr(SCOPE_PREFIX.length);\r\n                }\r\n                return {\r\n                    autoFocusPrefixMatch: searchValue,\r\n                    autoFocusFirstEntry: !!searchValue\r\n                };\r\n            }\r\n        });\r\n    };\r\n    QuickOutlineAction.prototype.symbolEntry = function (name, type, description, range, highlights, editor, decorator) {\r\n        return new SymbolEntry(name, type, description, Range.lift(range), highlights, editor, decorator);\r\n    };\r\n    QuickOutlineAction.prototype.toQuickOpenEntries = function (editor, flattened, searchValue) {\r\n        var controller = this.getController(editor);\r\n        var results = [];\r\n        // Convert to Entries\r\n        var normalizedSearchValue = searchValue;\r\n        if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n            normalizedSearchValue = normalizedSearchValue.substr(SCOPE_PREFIX.length);\r\n        }\r\n        for (var _i = 0, flattened_1 = flattened; _i < flattened_1.length; _i++) {\r\n            var element = flattened_1[_i];\r\n            var label = strings.trim(element.name);\r\n            // Check for meatch\r\n            var highlights = matchesFuzzy(normalizedSearchValue, label);\r\n            if (highlights) {\r\n                // Show parent scope as description\r\n                var description = undefined;\r\n                if (element.containerName) {\r\n                    description = element.containerName;\r\n                }\r\n                // Add\r\n                results.push(this.symbolEntry(label, SymbolKinds.toCssClassName(element.kind), description, element.range, highlights, editor, controller));\r\n            }\r\n        }\r\n        // Sort properly if actually searching\r\n        if (searchValue) {\r\n            if (searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n                results = results.sort(this.sortScoped.bind(this, searchValue.toLowerCase()));\r\n            }\r\n            else {\r\n                results = results.sort(this.sortNormal.bind(this, searchValue.toLowerCase()));\r\n            }\r\n        }\r\n        // Mark all type groups\r\n        if (results.length > 0 && searchValue.indexOf(SCOPE_PREFIX) === 0) {\r\n            var currentType = null;\r\n            var currentResult = null;\r\n            var typeCounter = 0;\r\n            for (var i = 0; i < results.length; i++) {\r\n                var result = results[i];\r\n                // Found new type\r\n                if (currentType !== result.getType()) {\r\n                    // Update previous result with count\r\n                    if (currentResult) {\r\n                        currentResult.setGroupLabel(this.typeToLabel(currentType || '', typeCounter));\r\n                    }\r\n                    currentType = result.getType();\r\n                    currentResult = result;\r\n                    typeCounter = 1;\r\n                    result.setShowBorder(i > 0);\r\n                }\r\n                // Existing type, keep counting\r\n                else {\r\n                    typeCounter++;\r\n                }\r\n            }\r\n            // Update previous result with count\r\n            if (currentResult) {\r\n                currentResult.setGroupLabel(this.typeToLabel(currentType || '', typeCounter));\r\n            }\r\n        }\r\n        // Mark first entry as outline\r\n        else if (results.length > 0) {\r\n            results[0].setGroupLabel(strings.format(QuickOutlineNLS._symbols_, results.length));\r\n        }\r\n        return results;\r\n    };\r\n    QuickOutlineAction.prototype.typeToLabel = function (type, count) {\r\n        switch (type) {\r\n            case 'module': return strings.format(QuickOutlineNLS._modules_, count);\r\n            case 'class': return strings.format(QuickOutlineNLS._class_, count);\r\n            case 'interface': return strings.format(QuickOutlineNLS._interface_, count);\r\n            case 'method': return strings.format(QuickOutlineNLS._method_, count);\r\n            case 'function': return strings.format(QuickOutlineNLS._function_, count);\r\n            case 'property': return strings.format(QuickOutlineNLS._property_, count);\r\n            case 'variable': return strings.format(QuickOutlineNLS._variable_, count);\r\n            case 'var': return strings.format(QuickOutlineNLS._variable2_, count);\r\n            case 'constructor': return strings.format(QuickOutlineNLS._constructor_, count);\r\n            case 'call': return strings.format(QuickOutlineNLS._call_, count);\r\n        }\r\n        return type;\r\n    };\r\n    QuickOutlineAction.prototype.sortNormal = function (searchValue, elementA, elementB) {\r\n        var elementAName = elementA.getLabel().toLowerCase();\r\n        var elementBName = elementB.getLabel().toLowerCase();\r\n        // Compare by name\r\n        var r = elementAName.localeCompare(elementBName);\r\n        if (r !== 0) {\r\n            return r;\r\n        }\r\n        // If name identical sort by range instead\r\n        var elementARange = elementA.getRange();\r\n        var elementBRange = elementB.getRange();\r\n        return elementARange.startLineNumber - elementBRange.startLineNumber;\r\n    };\r\n    QuickOutlineAction.prototype.sortScoped = function (searchValue, elementA, elementB) {\r\n        // Remove scope char\r\n        searchValue = searchValue.substr(SCOPE_PREFIX.length);\r\n        // Sort by type first if scoped search\r\n        var elementAType = elementA.getType();\r\n        var elementBType = elementB.getType();\r\n        var r = elementAType.localeCompare(elementBType);\r\n        if (r !== 0) {\r\n            return r;\r\n        }\r\n        // Special sort when searching in scoped mode\r\n        if (searchValue) {\r\n            var elementAName = elementA.getLabel().toLowerCase();\r\n            var elementBName = elementB.getLabel().toLowerCase();\r\n            // Compare by name\r\n            var r_1 = elementAName.localeCompare(elementBName);\r\n            if (r_1 !== 0) {\r\n                return r_1;\r\n            }\r\n        }\r\n        // Default to sort by range\r\n        var elementARange = elementA.getRange();\r\n        var elementBRange = elementB.getRange();\r\n        return elementARange.startLineNumber - elementBRange.startLineNumber;\r\n    };\r\n    return QuickOutlineAction;\r\n}(BaseEditorQuickOpenAction));\r\nexport { QuickOutlineAction };\r\nregisterEditorAction(QuickOutlineAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { ReferencesController } from '../../../contrib/gotoSymbol/peek/referencesController.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nvar StandaloneReferencesController = /** @class */ (function (_super) {\r\n    __extends(StandaloneReferencesController, _super);\r\n    function StandaloneReferencesController(editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService) {\r\n        return _super.call(this, true, editor, contextKeyService, editorService, notificationService, instantiationService, storageService, configurationService) || this;\r\n    }\r\n    StandaloneReferencesController = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, ICodeEditorService),\r\n        __param(3, INotificationService),\r\n        __param(4, IInstantiationService),\r\n        __param(5, IStorageService),\r\n        __param(6, IConfigurationService)\r\n    ], StandaloneReferencesController);\r\n    return StandaloneReferencesController;\r\n}(ReferencesController));\r\nexport { StandaloneReferencesController };\r\nregisterEditorContribution(ReferencesController.ID, StandaloneReferencesController);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { IStandaloneThemeService } from '../../common/standaloneThemeService.js';\r\nimport { ToggleHighContrastNLS } from '../../../common/standaloneStrings.js';\r\nvar ToggleHighContrast = /** @class */ (function (_super) {\r\n    __extends(ToggleHighContrast, _super);\r\n    function ToggleHighContrast() {\r\n        var _this = _super.call(this, {\r\n            id: 'editor.action.toggleHighContrast',\r\n            label: ToggleHighContrastNLS.toggleHighContrast,\r\n            alias: 'Toggle High Contrast Theme',\r\n            precondition: undefined\r\n        }) || this;\r\n        _this._originalThemeName = null;\r\n        return _this;\r\n    }\r\n    ToggleHighContrast.prototype.run = function (accessor, editor) {\r\n        var standaloneThemeService = accessor.get(IStandaloneThemeService);\r\n        if (this._originalThemeName) {\r\n            // We must toggle back to the integrator's theme\r\n            standaloneThemeService.setTheme(this._originalThemeName);\r\n            this._originalThemeName = null;\r\n        }\r\n        else {\r\n            this._originalThemeName = standaloneThemeService.getTheme().themeName;\r\n            standaloneThemeService.setTheme('hc-black');\r\n        }\r\n    };\r\n    return ToggleHighContrast;\r\n}(EditorAction));\r\nregisterEditorAction(ToggleHighContrast);\r\n"],"sourceRoot":""}